"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[253],{7081:(e,t,n)=>{n.d(t,{lb:()=>l,wl:()=>o,ZP:()=>i});var r=n(40400);const l={name:"PlusCircleIcon",height:512,width:512,svgPath:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z",yOffset:0,xOffset:0},o=(0,r.IU)(l),i=o},59253:(e,t,n)=>{n.r(t),n.d(t,{SystemDetails:()=>de,default:()=>me});var r=n(87462),l=n(45987),o=n(4942),i=n(42982),a=n(70885),s=n(30168),c=n(92950),u=n.n(c),d=n(45697),p=n.n(d),m=n(15671),y=n(43144),f=n(60136),h=n(82963),v=n(61120),g=n(65832),E=n(97326),P=n(68778),b=n(43047),S=n(62410),T=n(67585),C=n(91290),Z=n(72971),x=["ssgVersion","style"],I=function(e){var t=e.ssgVersion,n=e.style,o=(0,l.Z)(e,x),i=u().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:Z.iK},"Supported SSG versions");return u().createElement(g.Alert,(0,r.Z)({variant:"warning",isInline:!0,style:n,title:u().createElement(u().Fragment,null,"Unsupported SSG version (",t,")",u().createElement(g.Popover,{position:"right",bodyContent:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:i},u().createElement(C.ZP,{style:{marginLeft:".5em",cursor:"pointer",color:"var(--pf-global--Color--200)"}})))},o))};I.propTypes={ssgVersion:p().string,style:p().object};const w=I;var R=function(e){(0,f.Z)(i,e);var t,n,l=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,v.Z)(t);if(n){var l=(0,v.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,h.Z)(this,e)});function i(){var e;(0,m.Z)(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=l.call.apply(l,[this].concat(n)),(0,o.Z)((0,E.Z)(e),"complianceIcon",(function(e){return e?u().createElement("div",{className:"ins-c-policy-card ins-m-compliant"},u().createElement(P.ZP,null)," Compliant"):u().createElement("div",{className:"ins-c-policy-card ins-m-noncompliant"},u().createElement(b.ZP,null)," Not compliant")})),(0,o.Z)((0,E.Z)(e),"fixedPercentage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.toFixed(t)+(n?"%":"")})),e}return(0,y.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.policy,n=e.style,l=e.onClick,o=e.isSelected,i=t.rulesFailed,a=t.compliant,s=t.lastScanned,c=t.score,d=t.ssgVersion,p=t.supported,m=t.name,y=t.policyType,f=this.fixedPercentage(c),h={expandOnMouseOver:!0,hideExpandText:!0};return u().createElement(g.Card,{ouiaId:"PolicyCard",onClick:function(e){e.stopPropagation(),l(t)},isSelectable:!0,isSelected:o,style:n},u().createElement(g.CardBody,null,u().createElement(g.TextContent,{className:"margin-bottom-md"},u().createElement(g.Text,{ouiaId:"PolicyCardName",className:"margin-bottom-top-none",component:g.TextVariants.h4},u().createElement(T.Z,(0,r.Z)({text:m,length:110},h))),u().createElement(g.Text,{ouiaId:"PolicyCardType",style:{color:"var(--pf-global--Color--200)"},component:g.TextVariants.small},u().createElement(T.Z,(0,r.Z)({text:y,length:110},h)))),u().createElement("div",{className:"margin-bottom-md"},p&&this.complianceIcon(a),u().createElement(g.Text,{ouiaId:"PolicyCardFailedRulesScore",component:g.TextVariants.small},i," rule",1===i?"":"s"," failed"," ",u().createElement(g.Tooltip,{position:"bottom",maxWidth:"22em",content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},u().createElement("span",null,"(Score: ",f,")")))),u().createElement(g.Text,{className:"margin-bottom-none",component:g.TextVariants.small},u().createElement(g.Text,{ouiaId:"PolicyCardSSGVersion"},"SSG version: ",d),u().createElement(g.Text,{ouiaId:"PolicyCardLastScanned"},"Last scanned:"," ","Never"!==s?u().createElement(S.Z,{date:Date.parse(s),type:"relative"}):s))),!p&&u().createElement(g.CardFooter,{style:{padding:"0"}},u().createElement(w,{ouiaId:"PolicyCardUnsupportedSSG",ssgVersion:d,style:{paddingTop:"var(--pf-c-alert--PaddingTop)",paddingRight:"var(--pf-c-card--child--PaddingRight)",paddingLeft:"var(--pf-c-card--child--PaddingLeft)",paddingBottom:"var(--pf-c-alert--PaddingBottom)"}})))}}]),i}(u().Component);R.propTypes={policy:p().shape({rulesPassed:p().number,rulesFailed:p().number,score:p().number,lastScanned:p().string,refId:p().string,name:p().string,policyType:p().string,compliant:p().bool,ssgVersion:p().string,supported:p().bool}),style:p().object,onClick:p().func,isSelected:p().bool};const O=R;var k=n(24561);var B=function(e){(0,f.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,v.Z)(t);if(n){var l=(0,v.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,h.Z)(this,e)});function l(){return(0,m.Z)(this,l),r.apply(this,arguments)}return(0,y.Z)(l,[{key:"systemPolicyCards",value:function(){var e=this.props,t=e.policies,n=e.selectedPolicies,r=e.onCardClick;return t.filter((function(e){return e.rulesFailed+e.rulesPassed>0})).map((function(e,t){return u().createElement(g.GridItem,{sm:12,md:12,lg:6,xl:4,key:t},u().createElement(O,{policy:e,style:{height:"100%"},onClick:function(e){return r(e)},isSelected:null==n?void 0:n.find((function(t){return t===e.id}))}))}))}},{key:"render",value:function(){var e=this.props.loading;return u().createElement(u().Fragment,null,u().createElement(g.Grid,{hasGutter:!0},this.systemPolicyCards(),e&&(0,i.Z)(Array(3)).map((function(e,t){return u().createElement(g.GridItem,{span:4,key:t},u().createElement(g.Card,null,u().createElement(g.CardBody,null,u().createElement(k.mr,null))))}))))}}]),l}(u().Component);B.propTypes={policies:p().array,loading:p().bool,onCardClick:p().func,selectedPolicies:p().string},B.defaultProps={policies:[]};const j=B;var F=n(91989),N=n(19949),V=n(90570),_=n(67521),A=n(73980),G=n(48830),L=n(76309),W=n(36689),z=n(6023),D=n(69888),U=n(19232),q=n(334),M=n(28216),$=n(30319),K=n(81778),H=function(e){var t=e.titleText,n=e.bodyText,r=e.buttonText;return u().createElement(g.EmptyState,null,u().createElement(g.EmptyStateIcon,{icon:K.DisconnectedIcon}),u().createElement(g.Title,{headingLevel:"h5",size:"lg"},t),u().createElement(g.EmptyStateBody,null,n),u().createElement(g.Button,{variant:"primary",component:"a",href:"http://access.redhat.com/products/cloud_management_services_for_rhel#getstarted",target:"_blank",rel:"noopener noreferrer",className:"pf-u-mt-lg"},r))};H.propTypes={titleText:p().node,bodyText:p().node,buttonText:p().node},H.defaultProps={titleText:"This system isnâ€™t connected to Insights yet",bodyText:"To get started, activate the Insights client for this system.",buttonText:"Learn how to activate the Insights client"};const J=H;var Q=n(7081);const X=function(){return u().createElement(g.Bullseye,null,u().createElement(g.EmptyState,null,u().createElement(g.EmptyStateIcon,{icon:Q.ZP}),u().createElement(g.Title,{headingLevel:"h1",size:"lg"},"This system is not part of any SCAP policies defined within Compliance."),u().createElement(g.EmptyStateBody,null,"To assess and monitor compliance against a SCAP policy for this system, add it to an existing policy or create a new policy."),u().createElement(g.EmptyStatePrimary,null,u().createElement(D.mR,{to:"/scappolicies/new"},u().createElement(g.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))),u().createElement(g.EmptyStateSecondaryActions,null,u().createElement(g.Button,{variant:"link",component:"a",href:"/insights/compliance/scappolicies"},"View compliance policies"))))};var Y=n(7162),ee=function(e){var t,n,r=e.system;return u().createElement(g.Bullseye,null,u().createElement(g.EmptyState,null,u().createElement(g.EmptyStateIcon,{icon:Y.ZP,title:"Compliance",size:"xl",style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"}}),u().createElement(g.Title,{headingLevel:"h1",size:"lg"},"No results reported"),u().createElement(g.EmptyStateBody,null,"This system is part of ",null==r||null===(t=r.policies)||void 0===t?void 0:t.length,(null==r||null===(n=r.policies)||void 0===n?void 0:n.length)>1?" policies":" policy",", but has not returned any results."),u().createElement(g.EmptyStateBody,null,"Reports are returned when the system checks into Insights. By default, systems check in every 24 hours.")))};ee.propTypes={system:p().shape({policies:p().array})};const te=ee;var ne=function(e){var t,n,r=e.system;return!e.isWrapped||null!=r&&r.hasPolicy||0!==(null==r||null===(t=r.testResultProfiles)||void 0===t?void 0:t.length)?null!=r&&r.hasPolicy?null!=r&&r.hasPolicy&&0===(null==r||null===(n=r.testResultProfiles)||void 0===n?void 0:n.length)?u().createElement(te,{system:r}):void 0:u().createElement(X,{system:r}):u().createElement(J,null)};ne.propTypes={system:p().object,isWrapped:p().bool};const re=ne;var le,oe=["inventoryId","hidePassed"],ie=["customItnl","customRouter","intlProps","client"];function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=(0,_.ZP)(le||(le=(0,s.Z)(["\n  query System($systemId: String!) {\n    system(id: $systemId) {\n      id\n      name\n      hasPolicy\n      policies {\n        id\n      }\n      testResultProfiles {\n        id\n        name\n        policyType\n        refId\n        compliant\n        rulesFailed\n        rulesPassed\n        lastScanned\n        score\n        supported\n        ssgVersion\n        majorOsVersion\n        policy {\n          id\n        }\n        rules {\n          title\n          severity\n          rationale\n          refId\n          description\n          compliant\n          remediationAvailable\n          references\n          identifier\n        }\n      }\n    }\n  }\n"]))),ue=function(e){var t,n=e.data.system,r=e.loading,l=e.hidePassed,o=e.isWrapped,s=(0,c.useState)(),d=(0,a.Z)(s,2),p=d[0],m=d[1],y=null==n?void 0:n.testResultProfiles,f=function(e){if(e)if(null==p?void 0:p.find((function(t){return(null==e?void 0:e.id)===t}))){var t=null==p?void 0:p.filter((function(t){return e.id!==t}));m(t.length>0?t:void 0)}else m([].concat((0,i.Z)(p||[]),[null==e?void 0:e.id]))};return u().createElement(u().Fragment,null,u().createElement(j,{policies:y,loading:r,selectedPolicies:p,onCardClick:function(e){f(e)}}),u().createElement("br",null),null!=n&&null!==(t=n.testResultProfiles)&&void 0!==t&&t.length?u().createElement(F.Z,{remediationAvailableFilter:!0,hidePassed:l,system:se(se({},n),{},{supported:((null==n?void 0:n.testResultProfiles)||[]).filter((function(e){return e.supported})).length>0}),profileRules:null==n?void 0:n.testResultProfiles.map((function(e){return{system:n,profile:e,rules:e.rules}})),loading:r,options:{sortBy:{index:4,direction:"asc",property:"severity"},onDeleteFilter:function(e,t){var n,r,l=null===(n=e.find((function(e){return"Policy"===e.category})))||void 0===n?void 0:n.chips.map((function(e){return e.name})),o=null===(r=y.find((function(e){var t=e.name;return null==l?void 0:l.includes(t)})))||void 0===r?void 0:r.id;o&&(t?m(void 0):f(o?{id:o}:{}))}},activeFilters:{policy:p}}):u().createElement(re,{system:n,isWrapped:o}))};ue.propTypes={data:p().shape({system:p().shape({hasPolicy:p().bool,policies:p().shape({id:p().string}),profiles:p().array,testResultProfiles:p().array})}),loading:p().bool,hidePassed:p().bool,isWrapped:p().bool},ue.defaultProps={loading:!0,isWrapped:!1};var de=function(e){var t,n=e.inventoryId,o=e.hidePassed,i=(0,l.Z)(e,oe),a=(0,V.a)(ce,{variables:{systemId:n},fetchPolicy:"no-cache"}),s=a.data,c=a.error,d=a.loading,p=404===(null==c||null===(t=c.networkError)||void 0===t?void 0:t.statusCode);if(d)return u().createElement(z.Z,null);if(c&&!p){var m="Oops! Error loading System data: ".concat(c);return u().createElement(D._U,{message:m})}return u().createElement("div",{className:"ins-c-compliance__scope"},null==s||!s.system||p?u().createElement(N.Z,{title:"No policies are reporting for this system"}):u().createElement(ue,(0,r.Z)({},i,{hidePassed:o,data:s,loading:d})))};de.propTypes={inventoryId:p().string,hidePassed:p().bool};var pe=function(e){var t=e.customItnl,n=e.customRouter,o=e.intlProps,i=e.client,a=(0,l.Z)(e,ie),s=t?U.Z:u().Fragment,c=n?q.BrowserRouter:u().Fragment,d=(0,$.S1)().getStore();return u().createElement(c,null,u().createElement(s,t&&o,u().createElement(W.e,{client:i},u().createElement(M.zt,{store:d},u().createElement(de,(0,r.Z)({},a,{isWrapped:!0}))))))};pe.propTypes={customItnl:p().bool,intlProps:p().any,customRouter:p().bool,client:p().object},pe.defaultProps={client:new A.fe({link:new G.u({uri:"/api/compliance/graphql",credentials:"include"}),cache:new L.h4})};const me=878==n.j?pe:null}}]);
//# sourceMappingURL=../sourcemaps/253.828801624686e90544a3de02d387abb9.js.map