(self.webpackChunkcompliance=self.webpackChunkcompliance||[]).push([[726,953,164],{44434:(e,n,t)=>{"use strict";t.r(n),t.d(n,{ComplianceSystems:()=>b,default:()=>v});var r,o=t(30168),i=t(92950),s=t.n(i),a=t(67521),l=t(90570),c=t(46818),u=t(89376),p=t(39173),d=t(32467),f=t(60986),m=t(31499),y=(0,a.ZP)(r||(r=(0,o.Z)(['\n  {\n    profiles(search: "external = false and canonical = false") {\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n        }\n      }\n    }\n  }\n']))),b=function(){var e,n=(0,l.a)(y),t=n.data,r=n.error,o=n.loading,i=null==t||null===(e=t.profiles)||void 0===e?void 0:e.edges.map((function(e){return e.node}));return s().createElement(s().Fragment,null,s().createElement(u.Z,{className:"page-header"},s().createElement(p.Z,{title:"Compliance systems"})),s().createElement("section",{className:"pf-c-page__main-section"},s().createElement(d.tC,{stateValues:{error:r,data:t,loading:o}},s().createElement(d.K7,{stateKey:"data"},i&&s().createElement(f.r0,{columns:[m.Zw({showLink:!0}),m.MO("tags"),m.OS,m.rE,m.MO("updated",{props:{isStatic:!0},transforms:[c.P8]})],defaultFilter:"has_test_results = true or has_policy = true",systemProps:{isFullView:!0},showOsMinorVersionFilter:i.map((function(e){return e.osMajorVersion})),showComplianceSystemsInfo:!0,enableEditPolicy:!1,remediationsEnabled:!1,policies:i})))))};const v=b},88718:(e,n,t)=>{"use strict";t.r(n),t.d(n,{CreatePolicyForm:()=>Le,default:()=>Ne});var r=t(4942),o=t(70885),i=t(92950),s=t.n(i),a=t(45697),l=t.n(a),c=t(46314),u=t(33766),p=t(28216),d=t(98773),f=t(65115),m=t(30168),y=t(67521),b=t(90570),v=t(97481),h=t(15113),g=t(97779),O=t(32467),E=t(46818),j=t(86379),P=t(67702),S=t(79886),I=t(83237),V=function(e){var n=e.item.description,t=e.key;return s().createElement(f.Text,{key:t,style:{margin:"var(--pf-global--spacer--lg) 0"}},n)};V.propTypes={item:l().object,key:l().string};const T=V;var w=t(41532);function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var k=function(e){var n=e.name,t=e.disabled;return s().createElement(s().Fragment,null,t&&s().createElement(O.Nj,{compact:!0}),n)};k.propTypes={name:l().string,disabled:l().boolean};var R=function(e){var n=e.profiles,t=e.onChange,r=e.selectedProfile,o=[{title:"Policy name",key:"name",transforms:[(0,j.u)({tooltip:"In use policies have already been used and therefore can not be applied to another SCAP Policy under the selected OS."})],sortByProp:"name",renderFunc:(0,S.SO)(k)},{title:"Supported OS versions",transforms:[E.E0],sortByProp:"supportedOsVersions",renderFunc:function(e,n,t){return t.supportedOsVersions.join(", ")}}];return s().createElement(P.v,{items:n.map((function(e){return Z(Z({},e),{},{rowProps:{selected:e.id===(null==r?void 0:r.id),disableSelection:e.disabled}})})),filters:{filterConfig:[{type:I.Y.text,label:"Policy Name",filter:function(e,n){return e.filter((function(e){return null==e?void 0:e.name.toLowerCase().includes(n.toLowerCase())}))}}]},columns:o,options:{detailsComponent:T,onRadioSelect:function(e,r,o,i){var s=i.itemId;return t&&t(n.find((function(e){return e.id===s})))},sortBy:{index:2,direction:"asc",property:"name"},emptyRows:(0,w.fQ)("policy types",o.length)},variant:"compact"})};R.propTypes={profiles:l().array,onChange:l().func,selectedProfile:l().string};const M=R;var x=t(91290);const D=function(){return s().createElement(f.Tooltip,{position:"right",content:"Policy types are OpenSCAP policies that are supported by RHEL. For each major version of RHEL, users can create one policy of each type."},s().createElement(x.ZP,{className:"grey-icon"}))};var F;function L(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?L(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var B=(0,y.ZP)(F||(F=(0,m.Z)(['\n  query supportedProfilesByOSMajor {\n    osMajorVersions {\n      edges {\n        node {\n          osMajorVersion\n          profiles {\n            id\n            name\n            refId\n            description\n            supportedOsVersions\n            benchmark {\n              id\n              refId\n            }\n          }\n        }\n      }\n    }\n    profiles(search: "external = false and canonical = false") {\n      edges {\n        node {\n          id\n          refId\n          benchmark {\n            refId\n          }\n        }\n      }\n    }\n  }\n']))),N=function(e){var n,t=e.change,r=e.selectedProfile,o=e.selectedOsMajorVersion,i=(0,b.a)(B,{fetchPolicy:"no-cache"}),a=i.data,l=i.error,c=i.loading,u=null==a||null===(n=a.osMajorVersions)||void 0===n?void 0:n.edges.map((function(e){return e.node})),p=null==u?void 0:u.find((function(e){return e.osMajorVersion===o})),d=null==p?void 0:p.profiles.map((function(e){return _(_({},e),{},{disabled:(n=e.refId,t=e.benchmark.refId,!(null==a||null===(r=a.profiles)||void 0===r||!r.edges.map((function(e){return e.node})).find((function(e){return e.refId===n&&t===e.benchmark.refId}))))});var n,t,r}));return s().createElement(O.tC,{stateValues:{error:l,data:a,loading:c}},s().createElement(O.K7,{stateKey:"loading"},s().createElement(v.Z,null)),s().createElement(O.K7,{stateKey:"data"},s().createElement(f.TextContent,null,s().createElement(f.Text,{component:f.TextVariants.h1,className:"pf-u-mb-md"},"Create SCAP policy"),s().createElement(f.Text,{className:"pf-u-mb-md"},"Select the operating system and policy type for this policy.")),s().createElement(f.Form,null,s().createElement(f.FormGroup,{label:"Operating system",isRequired:!0,fieldId:"benchmark"},u&&u.map((function(e){var n=e.osMajorVersion;return s().createElement(f.Tile,{key:"rhel".concat(n,"-select"),className:"pf-u-mr-md",title:"RHEL ".concat(n),onClick:function(){t("osMajorVersion",n)},isSelected:o===n,isStacked:!0})}))),o&&s().createElement(f.FormGroup,{isRequired:!0,labelIcon:s().createElement(D,null),label:"Policy type",fieldId:"policy-type"},s().createElement(M,{"aria-label":"PolicyTypeTable",profiles:d,onChange:function(e){t("profile",e),t("benchmark",e.benchmark.id),t("selectedRuleRefIds",void 0),t("systems",[])},selectedProfile:r})))))};N.propTypes={change:h.ZP.change,selectedProfile:l().object,selectedOsMajorVersion:l().string};var $=(0,u.Z)("policyForm");const A=(0,g.qC)((0,p.$j)((function(e){return{selectedProfile:$(e,"profile"),selectedOsMajorVersion:$(e,"osMajorVersion")}})),(0,c.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(N);var q,K,H,U,G=t(58247),z=t(66826),W=t(94263),Y=t(77346),J=(0,y.ZP)(q||(q=(0,m.Z)(["\n  query CP_Benchmarks($filter: String!) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        latestSupportedOsMinorVersions\n        ruleTree\n        valueDefinitions {\n          defaultValue\n          description\n          id\n          refId\n          title\n          valueType\n        }\n        profiles {\n          id\n          refId\n          osMajorVersion\n        }\n        version\n      }\n    }\n  }\n"]))),Q=(0,y.ZP)(K||(K=(0,m.Z)(["\n  query CP_BenchmarksRuleTree($filter: String!) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        ruleTree\n      }\n    }\n  }\n"]))),X=(0,y.ZP)(H||(H=(0,m.Z)(["\n  query CP_BenchmarksValueDefinitions($filter: String!) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        latestSupportedOsMinorVersions\n        ruleTree\n        valueDefinitions {\n          defaultValue\n          description\n          id\n          refId\n          title\n          valueType\n        }\n        profiles {\n          id\n          refId\n          osMajorVersion\n        }\n        version\n      }\n    }\n  }\n"]))),ee=(0,y.ZP)(U||(U=(0,m.Z)(["\n  query CP_Profiles($filter: String!) {\n    profiles(search: $filter) {\n      edges {\n        node {\n          id\n          refId\n          osMinorVersion\n          benchmark {\n            id\n            latestSupportedOsMinorVersions\n          }\n          rules {\n            refId\n          }\n        }\n      }\n    }\n  }\n"])));function ne(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function te(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ne(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function re(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function oe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?re(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ie=function(e){var n,t=e.policy,o=e.selectedRuleRefIds,a=e.change,l=e.osMajorVersion,c=e.osMinorVersionCounts,u=e.ruleValues,p=[W.VG,W.zb,W.uH],d=function(e){var n=e.osMajorVersion,t=e.osMinorVersions,r="os_major_version = ".concat(n," ")+'and latest_supported_os_minor_version ^ "'.concat(t.join(","),'"'),o=(0,Y.ZP)("ruleGroups"),s=(0,Y.ZP)("valueEditing"),a=(0,b.a)(J,{variables:{filter:r},skip:0===t.length,fetchPolicy:"no-cache"}),l=a.data,c=a.error,u=a.loading,p=a.refetch,d=(0,b.a)(Q,{variables:{filter:r},skip:0===t.length||!o,fetchPolicy:"no-cache"}),f=d.data,m=d.error,y=d.loading,v=d.refetch,h=(0,b.a)(X,{variables:{filter:r},skip:0===t.length||!s,fetchPolicy:"no-cache"}),g=h.data,O=h.error,E=h.loading,j=h.refetch,P=(0,i.useMemo)((function(){return function(e,n,t){return{benchmarks:{nodes:null==e?void 0:e.benchmarks.nodes.map((function(e){var r,o,i=null==n||null===(r=n.benchmarks.nodes.find((function(n){return n.id===e.id})))||void 0===r?void 0:r.ruleTree,s=null==t||null===(o=t.benchmarks.nodes.find((function(n){return n.id===e.id})))||void 0===o?void 0:o.valueDefinitions;return te(te({},e),{},{ruleTree:i,valueDefinitions:s})}))}}}(l,f,g)}),[l,f,g]);return{data:P,error:(0,i.useMemo)((function(){return(0,S.Uv)(c,m,O)}),[c,m,O]),loading:u||y||E,refetch:(0,i.useCallback)((function(){p(),v(),j()}),[p,v,j])}}({osMajorVersion:l,osMinorVersions:c.map((function(e){return e.osMinorVersion})).sort()}),m=d.data,y=d.error,h=d.loading,g=null==m||null===(n=m.benchmarks)||void 0===n?void 0:n.nodes,E=(0,i.useMemo)((function(){return c.map((function(e){var n,r=e.osMinorVersion,o=e.count;if(r="".concat(r),g){var i=function(e,n){return e.find((function(e){var t;return null===(t=e.latestSupportedOsMinorVersions)||void 0===t?void 0:t.includes(n)}))}(g,r);i&&(n=function(e,n){return e.profiles.find((function(e){return e.refId===n}))}(i,t.refId),n&&(n=oe(oe({},n),{},{benchmark:oe(oe({},n.benchmark),i)})))}return{profile:n,systemCount:o,newOsMinorVersion:r}})).filter((function(e){return!!e.profile}))}),[c,g,t]),j=(0,z.b4)(E),P=Object.keys(j),I=P.map((function(e){return"id = ".concat(e)})).join(" OR "),V=(0,b.a)(ee,{variables:{filter:I},skip:0===P.length,fetchPolicy:"no-cache"}),T=V.data,w=V.error,C=V.loading,Z=y||w,k=(null==P?void 0:P.length)>0?T:void 0,R=!(!C&&!h)||void 0,M=!Z&&!R&&0===(null==P?void 0:P.length),x=null==T?void 0:T.profiles.edges.map((function(e){return e.node})),D=function(e){a("selectedRuleRefIds",e)};return(0,i.useLayoutEffect)((function(){if(!R){var e=(0,z.uU)(x,j),n=(0,z.TB)(e,o,{only:!0});D(n)}}),[JSON.stringify(x),R]),s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-pb-md"},s().createElement(f.Text,{component:f.TextVariants.h1},"Rules"),s().createElement(f.Text,null,"Customize your ",s().createElement("b",null,t.name)," SCAP policy by including and excluding rules."),s().createElement(f.Text,null,"Each release of RHEL is supported with a unique and specific version of the SCAP Security Guide (SSG). You must customize each version of SSG for each release of RHEL.")),s().createElement(O.tC,{stateValues:{error:Z,data:k,loading:R,noRuleSets:M}},s().createElement(O.K7,{stateKey:"noRuleSets"},s().createElement(f.EmptyState,null,s().createElement(f.Title,{headingLevel:"h1",size:"xl"},"No rules can be configured"),s().createElement(f.EmptyStateBody,null,"The policy type selected does not exist for the systems and OS versions selected in the previous steps."))),s().createElement(O.K7,{stateKey:"loading"},s().createElement(G.Z,null,s().createElement(v.Z,null))),s().createElement(O.K7,{stateKey:"data"},s().createElement(z.Hv,{tabsData:E,selectedRuleRefIds:o,setRuleValues:function(e,n,t){var o=oe(oe({},u||{}),{},(0,r.Z)({},e,oe(oe({},(u||{})[e]),{},(0,r.Z)({},n.refId,t))));a("ruleValues",o)},ruleValues:u,columns:p,remediationsEnabled:!1,selectedFilter:!0,level:1,setSelectedRuleRefIds:D,ouiaId:"RHELVersions",resetLink:!0,rulesPageLink:!0}))))};ie.propTypes={policy:l().object,change:h.ZP.change,osMajorVersion:l().string,osMinorVersionCounts:l().arrayOf(l().shape({osMinorVersion:l().number,count:l().number})),selectedRuleRefIds:l().array,ruleValues:l().array};var se=(0,u.Z)("policyForm");const ae=(0,g.qC)((0,p.$j)((function(e){return{policy:se(e,"profile"),osMajorVersion:se(e,"osMajorVersion"),osMinorVersionCounts:se(e,"osMinorVersionCounts"),selectedRuleRefIds:se(e,"selectedRuleRefIds"),ruleValues:se(e,"ruleValues")}})),(0,c.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(ie);var le=t(60986),ce=t(99030),ue=t(31499);function pe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function de(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?pe(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var fe=function(e){var n=e.osMajorVersion;return s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,null,"You do not have any ",s().createElement("b",null,"RHEL ",n)," systems connected to Insights and enabled for Compliance.",s().createElement("br",null),"Policies must be created with at least one system.")),s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,null,"Choose a different operating system, or connect"," ",s().createElement("b",null,"RHEL ",n)," systems to Insights.")),s().createElement(f.WizardContextConsumer,null,(function(e){var n=e.goToStepById;return s().createElement(f.Button,{onClick:function(){return n(1)}},"Choose a different operating system")})))};fe.propTypes={osMajorVersion:l().string};var me=function(e){var n=e.osMajorVersion;return s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,null,"Select which of your ",s().createElement("b",null,"RHEL ",n)," systems should be included in this policy.",s().createElement("br",null),"Systems can be added or removed at any time.")))};me.propTypes={osMajorVersion:l().string};var ye=function(e){var n=e.policy,t=e.change,r=e.osMajorVersion,o=e.selectedSystems,i=n.supportedOsVersions.map((function(e){return e.split(".")[1]}));return s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,{component:f.TextVariants.h1},"Systems")),s().createElement(f.Form,null,s().createElement(f.FormGroup,null,s().createElement(le.r0,{showOsMinorVersionFilter:[r],prependComponent:s().createElement(me,{osMajorVersion:r}),emptyStateComponent:s().createElement(fe,{osMajorVersion:r}),columns:[de(de({},ue.VG),{},{props:{width:40},sortBy:["name"]}),ue.MO("tags"),ue.U5],remediationsEnabled:!1,compact:!0,showActions:!1,defaultFilter:r&&"os_major_version = ".concat(r," AND os_minor_version ^ (").concat(i.join(","),")"),enableExport:!1,preselectedSystems:o,onSelect:function(e){t("systems",e),t("osMinorVersionCounts",(0,ce.Nw)(e))}}))))};ye.propTypes={osMajorVersion:l().string,policy:l().object,selectedSystems:l().array,change:h.ZP.change},ye.defaultProps={selectedSystems:[]};var be=(0,u.Z)("policyForm");const ve=(0,g.qC)((0,p.$j)((function(e){return{policy:be(e,"profile"),osMajorVersion:be(e,"osMajorVersion"),selectedSystems:be(e,"systems")}})),(0,c.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(ye);var he=t(6455),ge=t(74726),Oe=function(e){var n=e.change,t=e.policy,r=e.refId;return(0,i.useEffect)((function(){t&&t.refId!==r&&(n("name","".concat(t.name)),n("refId","".concat(t.refId)),n("description","".concat(t.description)))}),[t]),s().createElement(s().Fragment,null,s().createElement(f.TextContent,null,s().createElement(f.Text,{component:f.TextVariants.h1},"Details")),s().createElement("br",null),s().createElement(f.Form,{id:"editpolicydetails"},s().createElement(f.FormGroup,{label:"Policy name",isRequired:!0,fieldId:"name"},s().createElement(he.Z,{component:ge._,type:"text",isRequired:!0,id:"name",name:"name","aria-describedby":"name"})),s().createElement(f.FormGroup,{label:"Reference ID",isRequired:!0,fieldId:"refId"},s().createElement(he.Z,{type:"text",component:ge._,isDisabled:!0,id:"refId",name:"refId","aria-describedby":"refId"})),s().createElement(f.FormGroup,{label:"Description",fieldId:"description"},s().createElement(he.Z,{type:"text",component:ge.d,id:"description",name:"description","aria-describedby":"description"})),s().createElement(f.FormGroup,{label:"Business objective",labelIcon:s().createElement(O.xB,null),fieldId:"businessObjective"},s().createElement(he.Z,{type:"text",component:ge._,id:"businessObjective",name:"businessObjective","aria-describedby":"businessObjective",defaultValue:t.businessObjective})),s().createElement(O._z,{previousThreshold:100})))},Ee=(0,u.Z)("policyForm");Oe.propTypes={policy:l().object,refId:l().string,change:h.ZP.change};const je=(0,g.qC)((0,p.$j)((function(e){var n=Ee(e,"profile");return{policy:n,refId:Ee(e,"refId"),initialValues:{name:"".concat(n.name),refId:"".concat(n.refId),description:"".concat(n.description),benchmark:Ee(e,"benchmark"),osMajorVersion:Ee(e,"osMajorVersion"),profile:Ee(e,"profile")}}})),(0,c.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(Oe);var Pe=function(e){var n=e.name,t=e.businessObjective,r=e.complianceThreshold,o=e.parentProfileName,i=e.osMinorVersionCounts,a=e.osMajorVersion;return s().createElement(f.TextContent,null,s().createElement(f.Text,{component:f.TextVariants.h1},"Review"),s().createElement(f.Text,null,"Review your SCAP policy before finishing."),s().createElement(f.Text,{component:f.TextVariants.h3,style:{marginTop:0}},n),s().createElement(f.TextList,{component:f.TextListVariants.dl},s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Policy type"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},o),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Compliance threshold"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},r,"%"),t&&s().createElement(s().Fragment,null,s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Business objective"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},t)),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Systems"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},s().createElement(f.TextList,{component:f.TextListVariants.dl},i.map((function(e){var n=e.osMinorVersion,t=e.count;return s().createElement(s().Fragment,{key:n},s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt,style:{fontWeight:"normal"}},"RHEL ",a,".",n),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},s().createElement(f.Label,{color:"grey",isCompact:!0},t," ",t>1?"systems":"system")))}))))))};Pe.propTypes={benchmarkId:l().string,refId:l().string,name:l().string,businessObjective:l().string,complianceThreshold:l().number,parentProfileName:l().string,osMinorVersionCounts:l().arrayOf(l().shape({osMinorVersion:l().number,count:l().number})),osMajorVersion:l().string.isRequired};var Se=(0,u.Z)("policyForm");const Ie=(0,p.$j)((function(e){return{benchmarkId:Se(e,"benchmark"),refId:Se(e,"refId"),name:Se(e,"name"),businessObjective:Se(e,"businessObjective"),osMinorVersionCounts:Se(e,"osMinorVersionCounts"),complianceThreshold:parseFloat(Se(e,"complianceThreshold"))||100,parentProfileName:Se(e,"profile").name,rulesCount:Se(e,"selectedRuleRefIds").length}}))(Pe);var Ve=t(5913),Te=t(19398),we=t(4992),Ce=t(65811),Ze=function(e){var n=e.errors;return n&&Array.isArray(n)&&n.length>0?s().createElement(f.EmptyStateBody,{className:"wizard-failed-errors"},s().createElement(f.List,null,n.map((function(e){return s().createElement(f.ListItem,{key:e},e)})))):null};Ze.propTypes={errors:l().array};var ke=function(e){var n=e.onWizardFinish,t=e.cloneFromProfileId,r=e.description,a=e.name,l=e.complianceThreshold,c=e.businessObjective,u=e.refId,p=e.benchmarkId,d=e.systems,m=e.selectedRuleRefIds,y=e.ruleValues,b=(0,i.useState)(0),v=(0,o.Z)(b,2),h=v[0],g=v[1],E=(0,i.useState)("This usually takes a minute or two."),j=(0,o.Z)(E,2),P=j[0],S=j[1],I=(0,i.useState)(null),V=(0,o.Z)(I,2),T=V[0],w=V[1],C=(0,i.useState)(!1),Z=(0,o.Z)(C,2),k=Z[0],R=Z[1],M=(0,we.a7)(),x=function(e){g(100*e)};return(0,i.useEffect)((function(){M(null,{cloneFromProfileId:t,description:r,name:a,complianceThreshold:l,businessObjective:{title:c},refId:u,benchmarkId:p,hosts:d,selectedRuleRefIds:m,values:y},x).then((function(e){var n=e.id;g(100),S(),(0,Ce.q)({variant:"success",title:'Created policy "'.concat(a,'"'),autoDismiss:!0,description:s().createElement("span",null,"From the ",s().createElement("strong",null,"SCAP Policies")," list, open"," ",s().createElement(O.nv,{to:"/scappolicies/".concat(n)},a),".")})})).catch((function(e){var n,t;S(null===(n=e.networkError)||void 0===n?void 0:n.message),w(null===(t=e.networkError)||void 0===t||null===(t=t.result)||void 0===t?void 0:t.errors),R(!0),(0,Ce.q)({variant:"danger",title:"Error creating policy",description:e.message})}))}),[]),s().createElement(f.Bullseye,null,s().createElement(f.EmptyState,{variant:f.EmptyStateVariant.full},s().createElement(f.EmptyStateIcon,{icon:Ve.ZP}),s().createElement("br",null),s().createElement(f.Title,{headingLevel:"h1",size:"lg"},"Creating policy"),s().createElement(f.EmptyStateBody,null,s().createElement(O.ko,{percent:h,failed:k})),s().createElement(f.EmptyStateBody,{className:k&&"wizard-failed-message"},P),s().createElement(Ze,{error:T}),s().createElement(f.EmptyStateSecondaryActions,null,(100===h||k)&&s().createElement(f.Button,{variant:"primary",ouiaId:"ReturnToAppButton",onClick:function(){n()}},k?"Back":"Return to application"))))};ke.propTypes={benchmarkId:l().string.isRequired,businessObjective:l().object,cloneFromProfileId:l().string.isRequired,refId:l().string.isRequired,name:l().string.isRequired,description:l().string,systems:l().array,complianceThreshold:l().number,onWizardFinish:l().func,selectedRuleRefIds:l().arrayOf(l().string).isRequired,ruleValues:l().object};var Re=(0,u.Z)("policyForm");const Me=(0,g.qC)((0,p.$j)((function(e){return{benchmarkId:Re(e,"benchmark"),businessObjective:Re(e,"businessObjective"),cloneFromProfileId:Re(e,"profile").id,refId:Re(e,"refId"),name:Re(e,"name"),description:Re(e,"description"),complianceThreshold:parseFloat(Re(e,"complianceThreshold"))||100,systems:Re(e,"systems"),selectedRuleRefIds:Re(e,"selectedRuleRefIds"),ruleValues:Re(e,"ruleValues")}})),(0,c.Z)({form:"policyForm",destroyOnUnmount:!0,forceUnregisterOnUnmount:!0}),Te.C)(ke);var xe=t(70597);function De(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Fe(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?De(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):De(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Le=function(e){var n=e.benchmark,t=e.osMajorVersion,r=e.complianceThreshold,a=e.name,l=e.profile,c=e.refId,u=e.selectedRuleRefIds,p=e.systemIds,m=e.reset,y=(0,d.Z)(),b=(0,i.useState)(1),v=(0,o.Z)(b,2),h=v[0],g=v[1],O=function(){var e=history.location;e.hash&&history.push(Fe(Fe({},e),{},{hash:""}))},E=function(){m(),y("/scappolicies")},j=[{id:1,name:"Create SCAP policy",component:s().createElement(A,null),enableNext:(0,xe.$H)(n,t,l)},{id:2,name:"Details",component:s().createElement(je,null),canJumpTo:h>=2,enableNext:(0,xe.Ay)(a,c,r)},{id:3,name:"Systems",component:s().createElement(ve,null),canJumpTo:h>=3,enableNext:(0,xe.Qy)(p)},{id:4,name:"Rules",component:s().createElement(ae,null),canJumpTo:(null==p?void 0:p.length)>0&&h>=4,enableNext:(0,xe.hT)(u)},{id:5,name:"Review",component:s().createElement(Ie,{osMajorVersion:t}),nextButtonText:"Finish",canJumpTo:(0,xe.hT)(u)&&(null==p?void 0:p.length)>0&&h>=5},{id:6,name:"Finished",component:s().createElement(Me,{onWizardFinish:E}),isFinishedStep:!0,canJumpTo:(null==p?void 0:p.length)>0&&h>=6}];return s().createElement(s().Fragment,null,s().createElement(f.Wizard,{width:1300,className:"compliance",isOpen:!0,onNext:function(e){var n=e.id;g(h<n?n:h),O()},onGoToStep:O,onBack:O,onClose:E,title:"Create SCAP policy",description:"Create a new policy for managing SCAP compliance",steps:j}))};Le.propTypes={benchmark:l().string,osMajorVersion:l().string,osMinorVersionCounts:l().arrayOf(l().shape({osMinorVersion:l().number,count:l().number})),complianceThreshold:l().string,businessObjective:l().object,dispatch:l().func,isOpen:l().bool,name:l().string,onWizardFinish:l().func,profile:l().string,refId:l().string,selectedRuleRefIds:l().arrayOf(l().string),systemIds:l().arrayOf(l().string),reset:l().func},Le.defaultProps={isOpen:!1};var _e=(0,c.Z)({form:"policyForm"})(Le),Be=(0,u.Z)("policyForm");const Ne=(0,p.$j)((function(e){return{benchmark:Be(e,"benchmark"),osMajorVersion:Be(e,"osMajorVersion"),osMinorVersionCounts:Be(e,"osMinorVersionCounts"),businessObjective:Be(e,"businessObjective"),complianceThreshold:Be(e,"complianceThreshold")||100,name:Be(e,"name"),profile:Be(e,"profile"),refId:Be(e,"refId"),selectedRuleRefIds:Be(e,"selectedRuleRefIds"),systemIds:Be(e,"systems")}}))(_e)},89671:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>h});var r=t(70885),o=t(92950),i=t.n(o),s=t(45697),a=t.n(s),l=t(62012),c=t(61770),u=t(65115),p=t(98773),d=t(4992),f=t(83215),m=t(32467),y=t(65811),b=t(79315),v=function(){var e=(0,o.useState)(!1),n=(0,r.Z)(e,2),t=n[0],s=n[1],a=(0,p.Z)(),v=(0,l.useParams)().policy_id,h=(0,b.Z)({policyId:v,minimal:!0}),g=h.data,O=h.error,E=h.loading,j=(g||{profile:{}}).profile,P=j.name,S=j.id,I=function(){a("/scappolicies")},V=(0,c.D)(d._v,{onCompleted:function(){(0,y.C)((0,f.wN)({variant:"success",title:'Deleted "'.concat(P,'" and its associated reports')})),I()},onError:function(e){(0,y.C)((0,f.wN)({variant:"danger",title:"Error removing policy",description:e.message})),I()}}),T=(0,r.Z)(V,1)[0];return i().createElement(m.C,{variant:u.ModalVariant.small,title:"Delete policy?",titleIconVariant:"warning",ouiaId:"DeletePolicyModal",isOpen:!0,onClose:I,actions:[i().createElement(u.Button,{key:"destroy",ouiaId:"DeletePolicyButton","aria-label":"delete",isDisabled:!t,variant:"danger",onClick:function(){return T({variables:{input:{id:S}}})}},"Delete policy and associated reports"),i().createElement(u.Button,{key:"cancel",ouiaId:"DeletePolicyCancelButton",variant:"secondary",onClick:I},"Cancel")]},i().createElement(m.tC,{stateValues:{error:O,data:g,loading:E}},i().createElement(m.K7,{stateKey:"loading"},i().createElement(u.Spinner,null)),i().createElement(m.K7,{stateKey:"data"},i().createElement(u.Text,{className:"policy-delete-body-text"},"Deleting the policy ",i().createElement("b",null,P)," will also delete its associated reports."),i().createElement(u.Checkbox,{label:"I understand this will delete the policy and all associated reports",id:"deleting-policy-check-".concat(S),isChecked:t,onChange:s}))))};v.propTypes={policy:a().object};const h=v},57481:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>v});var r=t(70885),o=t(65115),i=t(45697),s=t.n(i),a=t(92950),l=t.n(a),c=t(62012),u=t(98773),p=t(61770),d=t(4992),f=t(83215),m=t(32467),y=t(65811),b=function(){var e=(0,u.Z)(),n=(0,c.useParams)().report_id,t=function(){e(-1)},i=(0,p.D)(d._M,{onCompleted:function(){(0,y.C)((0,f.wN)({variant:"success",title:"Report deleted",description:"Systems associated with this policy will upload reports on the next check-in."})),e("/reports")},onError:function(e){(0,y.C)((0,f.wN)({variant:"danger",title:"Error removing report",description:e.message})),t()}}),s=(0,r.Z)(i,1)[0];return l().createElement(m.C,{isOpen:!0,variant:o.ModalVariant.small,title:"Delete report?",titleIconVariant:"warning",ouiaId:"DeleteReportModal",onClose:t,actions:[l().createElement(o.Button,{key:"destroy",ouiaId:"DeleteReportButton","aria-label":"delete",variant:"danger",onClick:function(){return s({variables:{input:{profileId:n}}})}},"Delete report"),l().createElement(o.Button,{key:"cancel",ouiaId:"DeleteReportCancelButton",variant:"secondary",onClick:function(){return t()}},"Cancel")]},l().createElement(o.TextContent,null,"Deleting a report is permanent and cannot be undone."))};b.propTypes={onClose:s().func,isModalOpen:s().bool,onDelete:s().func,policyId:s().string},b.defaultProps={onDelete:function(){},onClose:function(){}};const v=b},30845:(e,n,t)=>{"use strict";t.r(n),t.d(n,{EditPolicy:()=>Y,default:()=>J});var r,o,i,s=t(4942),a=t(70885),l=t(92950),c=t.n(l),u=t(45697),p=t.n(u),d=t(65115),f=t(62012),m=t(98773),y=t(7648),b=t(32467),v=t(90570),h=t(58247),g=t(97481),O=t(66826),E=t(79886),j=t(94263),P=t(30168),S=t(67521),I=(0,S.ZP)(r||(r=(0,P.Z)(["\n  query EP_Benchmarks($filter: String!, $enableRuleTree: Boolean = false) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        latestSupportedOsMinorVersions\n        ruleTree @include(if: $enableRuleTree)\n        valueDefinitions {\n          defaultValue\n          description\n          id\n          refId\n          title\n          valueType\n        }\n        profiles {\n          id\n          refId\n          ssgVersion\n        }\n      }\n    }\n  }\n"])));function V(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function T(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?V(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):V(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}(0,S.ZP)(o||(o=(0,P.Z)(["\n  query EP_Profile($policyId: String!, $enableRuleTree: Boolean = false) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      external\n      description\n      totalHostCount\n      compliantHostCount\n      complianceThreshold\n      osMajorVersion\n      supportedOsVersions\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        refId\n        profiles {\n          id\n          parentProfileId\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          values\n          benchmark {\n            id\n            title\n            latestSupportedOsMinorVersions\n            osMajorVersion\n            version\n            ruleTree @include(if: $enableRuleTree)\n          }\n          rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n            values\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n      hosts {\n        id\n        osMinorVersion\n        osMajorVersion\n      }\n    }\n  }\n"]))),(0,S.ZP)(i||(i=(0,P.Z)(["\n  query EP_ProfileValueDefinitions(\n    $policyId: String!\n    $enableRuleTree: Boolean = false\n  ) {\n    profile(id: $policyId) {\n      id\n      policy {\n        id\n        refId\n        profiles {\n          id\n          parentProfileId\n          refId\n          benchmark {\n            id\n            ruleTree @include(if: $enableRuleTree)\n            valueDefinitions {\n              defaultValue\n              description\n              id\n              refId\n              title\n              valueType\n            }\n          }\n        }\n      }\n    }\n  }\n"])));var w=function(){return c().createElement(d.EmptyState,null,c().createElement(d.Title,{headingLevel:"h5",size:"lg"},"No rules can be configured"),c().createElement(d.EmptyStateBody,null,"This policy has no associated systems, and therefore no rules can be configured."),c().createElement(d.EmptyStateBody,null,"Add at least one system to configure rules for this policy."))},C=function(e){var n,t=e.policy,r=e.selectedRuleRefIds,o=e.setSelectedRuleRefIds,i=e.osMinorVersionCounts,s=e.setRuleValues,a=e.ruleValues,u=null==t?void 0:t.osMajorVersion,p=Object.keys(i).sort(),f="os_major_version = ".concat(u," ")+'and latest_supported_os_minor_version ^ "'.concat(p.join(","),'"'),m=(0,v.a)(I,{variables:{filter:f},skip:0===p.length}),y=m.data,P=m.error,S=m.loading,V=null==y||null===(n=y.benchmarks)||void 0===n?void 0:n.nodes,C=function(e,n,t){return Object.values(n).sort((0,E.Sj)("osMinorVersion","desc")).map((function(n){var r=n.osMinorVersion,o=n.count;r="".concat(r);var i=e.policy.profiles.find((function(e){return e.osMinorVersion===r})),s=e.osMajorVersion;if(!i&&t){var a=function(e,n){return e.find((function(e){var t;return null===(t=e.latestSupportedOsMinorVersions)||void 0===t?void 0:t.includes(n)}))}(t,r);if(a){var l=function(e,n){return e.profiles.find((function(e){return e.refId===n}))}(a,e.refId);l&&(i=e.policy.profiles.find((function(e){return e.parentProfileId===l.id&&e.osMinorVersion===r})),i=T(T({},l),{},{benchmark:a,osMajorVersion:s},i))}}return{profile:i,systemCount:o,newOsMinorVersion:r}})).filter((function(e){var n=e.profile,t=e.newOsMinorVersion;return!!n&&t}))}(t,i,V),Z=(0,O.b4)(C),k=!S&&(null==C?void 0:C.length)>0?C:void 0;return(0,l.useEffect)((function(){if(t.policy.profiles){var e=t.policy.profiles,n=(0,O.uU)(e,Z);o((function(e){return(0,O.TB)(n,e)}))}}),[t.policy.profiles]),c().createElement(b.tC,{stateValues:{error:P,data:!P&&k,loading:S,empty:!S&&!k&&!P}},c().createElement(b.K7,{stateKey:"loading"},c().createElement(h.Z,null,c().createElement(g.Z,null))),c().createElement(b.K7,{stateKey:"data"},c().createElement(d.TextContent,null,c().createElement(d.Text,null,"Different release versions of RHEL are associated with different versions of the SCAP Security Guide (SSG), therefore each release must be customized independently.")),C.length>0&&c().createElement(O.Hv,{resetLink:!0,rulesPageLink:!0,selectedFilter:!0,remediationsEnabled:!1,columns:[j.VG,j.zb,j.uH],tabsData:C,ruleValues:function(e){var n,t=function(e,n){return T(T({},n),(null==a?void 0:a[e])||{})};return Object.fromEntries((null==e||null===(n=e.policy)||void 0===n||null===(n=n.profiles)||void 0===n?void 0:n.map((function(e){var n=e.id,r=e.values;return e.benchmark.valueDefinitions,[n,t(n,r)]})))||[])}(t),selectedRuleRefIds:r,setSelectedRuleRefIds:o,setRuleValues:s,level:1,ouiaId:"RHELVersions"})),c().createElement(b.K7,{stateKey:"empty"},c().createElement(w,null)))};C.propTypes={setNewRuleTabs:p().func,policy:p().object,osMinorVersionCounts:p().shape({osMinorVersion:p().shape({osMinorVersion:p().number,count:p().number})}),selectedRuleRefIds:p().array,setSelectedRuleRefIds:p().func,setRuleValues:p().func,ruleValues:p().array};const Z=C;var k=t(60986),R=t(31499),M=function(e){var n=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(d.TextContent,{className:"pf-u-mb-md"},c().createElement(d.Text,null,"You do not have any ",c().createElement("b",null,"RHEL ",n)," systems connected to Insights and enabled for Compliance.")),c().createElement(d.TextContent,{className:"pf-u-mb-md"},c().createElement(d.Text,null,"Connect RHEL ",n," systems to Insights.")))};M.propTypes={osMajorVersion:p().string};var x=function(e){var n=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(d.TextContent,{className:"pf-u-mb-md"},c().createElement(d.Text,null,"Select which of your ",c().createElement("b",null,"RHEL ",n)," systems should be included in this policy.")))};x.propTypes={osMajorVersion:p().string};var D=function(e){var n=e.policy,t=e.onSystemSelect,r=e.selectedSystems,o=n.id,i=n.osMajorVersion,s=n.supportedOsVersions.map((function(e){return e.split(".")[1]})),a=i&&"os_major_version = ".concat(i," AND os_minor_version ^ (").concat(s.join(","),")"),l=a?"".concat(a," or policy_id = ").concat(o):"policy_id = ".concat(o);return console.log("POL",n),c().createElement(c().Fragment,null,c().createElement(k.r0,{columns:[R.VG,R.MO("tags"),R.U5],showOsMinorVersionFilter:[i],prependComponent:c().createElement(x,{osMajorVersion:i}),emptyStateComponent:c().createElement(M,{osMajorVersion:i}),compact:!0,showActions:!1,defaultFilter:l,enableExport:!1,remediationsEnabled:!1,preselectedSystems:r,onSelect:t}))};D.propTypes={policy:p().object,newRuleTabs:p().bool,onSystemSelect:p().func,selectedSystems:p().array};const F=D;function L(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?L(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):L(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const B=function(){var e=(0,m.Z)(),n=(0,f.useLocation)();return c().createElement(d.Alert,{variant:"info",isInline:!0,title:"You selected a system that has a release version previously not included in this policy.",actionLinks:c().createElement(d.AlertActionLink,{onClick:function(){return e(_(_({},n),{},{hash:"#rules"}))}},"Open rule editing")},c().createElement("p",null,"If you have edited any rules for this policy, you will need to do so for this release version as well."))};var N=t(99030),$=t(70597);function A(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?A(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var K=function(e){var n,t=e.policy,r=e.setUpdatedPolicy,o=e.selectedRuleRefIds,i=e.setSelectedRuleRefIds,s=e.selectedSystems,u=e.setSelectedSystems,p=e.setRuleValues,f=e.ruleValues,m=(null==t||null===(n=t.policy)||void 0===n?void 0:n.profiles)||[],y=(0,l.useState)({}),v=(0,a.Z)(y,2),h=v[0],g=v[1],E=function(){return l.useState.apply(void 0,arguments)}(!1),j=(0,a.Z)(E,2),P=j[0],S=j[1],I=(0,l.useCallback)((function(e){var n,r=t.hosts.map((function(e){return e.osMinorVersion})),o=e.filter((function(e){var n=e.osMinorVersion;return!r.includes(n)})).length>0;u(e),S(o),g((n=e,(m||[]).reduce((function(e,n){var t;return""!==n.osMinorVersion&&(e[t=n.osMinorVersion]||(e[t]={osMinorVersion:n.osMinorVersion,count:0})),e}),(0,N.UP)(n||[]))))}),[m,o]);return(0,l.useEffect)((function(){if(t){var e=(0,$.KJ)(t.complianceThreshold),n=m.filter((function(e){return!!e.osMinorVersion}));r(q(q({},t),{},{complianceThresholdValid:e})),i((0,O.TB)(n)),I(t.hosts)}}),[t]),c().createElement(d.Form,null,c().createElement(b.tn,{ouiaId:"EditSystems",defaultTab:"rules",id:"policy-tabs"},c().createElement(d.Tab,{eventKey:"rules",ouiaId:"Rules",title:c().createElement(d.TabTitleText,null,"Rules")},c().createElement(Z,{policy:t,setSelectedRuleRefIds:i,setRuleValues:p,ruleValues:f,selectedRuleRefIds:o,osMinorVersionCounts:h})),c().createElement(d.Tab,{eventKey:"systems",ouiaId:"Systems",title:c().createElement(d.TabTitleText,null,"Systems")},c().createElement(F,{policy:t,selectedSystems:s,onSystemSelect:I}),P&&c().createElement(B,null))))};K.propTypes={policy:p().object,updatedPolicy:p().object,setUpdatedPolicy:p().func,selectedRuleRefIds:p().arrayOf(p().object),setSelectedRuleRefIds:p().func,setSelectedSystems:p().func,selectedSystems:p().array,setRuleValues:p().func,ruleValues:p().array};const H=K;var U=t(88326),G=t(79315);function z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function W(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?z(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Y=function(e){var n=e.route,t=(0,m.Z)(),r=(0,f.useParams)().policy_id,o=(0,f.useLocation)(),i=(0,G.Z)({policyId:r}),u=i.data,p=i.error,v=i.loading,h=null==u?void 0:u.profile,g=(0,l.useState)(null),O=(0,a.Z)(g,2),E=O[0],j=O[1],P=(0,l.useState)([]),S=(0,a.Z)(P,2),I=S[0],V=S[1],T=(0,l.useState)([]),w=(0,a.Z)(T,2),C=w[0],Z=w[1],k=(0,l.useState)({}),R=(0,a.Z)(k,2),M=R[0],x=R[1],D=E&&!E.complianceThresholdValid,F=W(W({},E),{},{selectedRuleRefIds:I,hosts:C,values:M}),L=function(){var e;return t((null===(e=o.state)||void 0===e?void 0:e.returnTo)||-1)},_=(0,U.f)(h,F,{onSave:L,onError:L}),B=(0,a.Z)(_,2),N=B[0],$=B[1],A=[c().createElement(d.Button,{isDisabled:D,key:"save",ouiaId:"EditPolicySaveButton",variant:"primary",spinnerAriaValueText:"Saving",isLoading:N,onClick:$},"Save"),c().createElement(d.Button,{key:"cancel",ouiaId:"EditPolicyCancelButton",variant:"link",onClick:L},"Cancel")];return(0,y.a)(n,null==h?void 0:h.name),c().createElement(b.C,{isOpen:!0,position:"top",style:{minHeight:"350px"},width:1220,variant:"large",ouiaId:"EditPolicyModal",title:"Edit ".concat(h?h.name:""),onClose:L,actions:A},c().createElement(b.tC,{stateValues:{data:h&&!v,loading:v,error:p}},c().createElement(b.K7,{stateKey:"loading"},c().createElement(d.Spinner,null)),c().createElement(b.K7,{stateKey:"data"},c().createElement(H,{policy:h,updatedPolicy:E,setUpdatedPolicy:j,selectedRuleRefIds:I,setSelectedRuleRefIds:V,selectedSystems:C,setSelectedSystems:Z,setRuleValues:function(e,n,t){var r=Object.fromEntries((null==h?void 0:h.policy.profiles.map((function(e){return[e.id,e.values]})))||[]);x((function(o){return W(W(W({},r),o),{},(0,s.Z)({},e,W(W(W({},r[e]),o[e]),{},(0,s.Z)({},n.id,t))))}))},ruleValues:M}))))};Y.propTypes={route:p().object};const J=Y},31499:(e,n,t)=>{"use strict";t.d(n,{OF:()=>B,ll:()=>_,Hc:()=>N,VG:()=>x,OS:()=>A,U5:()=>$,rE:()=>L,hN:()=>F,Zw:()=>D,MO:()=>q});var r=t(4942),o=t(45987),i=t(92950),s=t.n(i),a=t(46818),l=t(65115),c=t(32467),u=t(79886),p=t(45697),d=t.n(p),f=t(69957),m=t(62410),y=t(19535),b=t(82176),v=function(e){var n=e.id,t=e.children;return s().createElement(c.nv,{to:{pathname:"/systems/".concat(n)}},t)};v.propTypes={id:d().string,children:d().node};var h=function(e){var n=e.id,t=e.name,r=e.osMajorVersion,o=e.osMinorVersion,i=e.showOsInfo,a=void 0!==i&&i,c=e.showLink,u=void 0!==c&&c;return s().createElement(l.TextContent,null,u?s().createElement(v,{id:n},t):t,function(e,n){return!!e&&!!n&&a}(r,o)&&s().createElement(l.Text,{component:l.TextVariants.small},"RHEL ",r,".",o))};h.propTypes={id:d().string,name:d().string,osMajorVersion:d().string,osMinorVersion:d().string,showOsInfo:d().bool,showLink:d().bool};var g=function(e){var n=e.ssgVersion,t=void 0===n?"Not available":n;return e.supported?t:s().createElement(c.cT,{messageVariant:"singular"},t)};g.propTypes={supported:d().bool,ssgVersion:d().string};var O=function(e){var n=e.testResultProfiles,t=void 0===n?[]:n;return 0!==t.length?t.map((function(e){var n;return s().createElement(g,{key:"ssgversion-".concat(e.id),ssgVersion:null==e||null===(n=e.benchmark)||void 0===n?void 0:n.version,supported:null==e?void 0:e.supported})})):"Unknown"};O.propTypes={testResultProfiles:d().array};var E=function(e){var n=e.policies;return(n||[]).length>0&&s().createElement(y.Z,{inline:!0,text:n.map((function(e){return e.name})).join(", "),length:215})};E.propTypes={policies:d().array};var j=function(e){var n=e.id,t=e.testResultProfiles.reduce((function(e,n){var t=n.rulesFailed;return e+parseInt(t||0)}),0);return s().createElement(v,{id:n},t>0?t:"N/A")};j.propTypes={id:d().string,testResultProfiles:d().array};var P=function(e){var n=e.testResultProfiles,t=n[0]||{},r=t.score,o=t.supported,i=t.compliant;return n.length>0?s().createElement(c.OF,{score:r,supported:o,compliant:i}):"N/A"};P.propTypes={testResultProfiles:d().array};var S=function(){return s().createElement(l.Tooltip,{position:"right",content:s().createElement(i.Fragment,null,"This system has never returned a report for this policy. This may be because it is disconnected, or the insights-client on this system is not configured to use Compliance.")},s().createElement("div",null,s().createElement(f.ZP,{color:"var(--pf-global--warning-color--100)"})," "+b.C4))},I=function(e){var n=e.map((function(e){return new Date(e.lastScanned)})),t=new Date(Math.max.apply(null,n.filter((function(e){return isFinite(e)}))));return t instanceof Date&&isFinite(t)?t:s().createElement(S,null)},V=function(e){var n=e.testResultProfiles,t=I(n||[]);return t instanceof Date?s().createElement(m.Z,{date:Date.parse(t),type:"relative"}):t};V.propTypes={testResultProfiles:d().array};var T=function(e){var n=e.osMinorVersion,t=e.osMajorVersion;return"RHEL ".concat(t,".").concat(n)},w=function(e){return T(e)},C=["cell"];function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function k(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var R={isStatic:!0},M=function(e){var n=e.cell,t=(0,o.Z)(e,C);return k(k({},t),{},{renderFunc:(0,u.SO)(n,t.props)})},x=M({key:"name",title:"Name",sortBy:["name"],props:{width:40},renderExport:function(e){return"".concat(e.name," (").concat(T(e),")")},cell:h}),D=function(e){return k(k({},x),{},{props:k(k({},x.props),e),renderFunc:(0,u.SO)(h,e)})},F={title:"SSG version",transforms:[a.P8],exportKey:"testResultProfiles",sortBy:["ssg_version"],key:"ssg_version",renderExport:function(e){return e.map((function(e){var n=e.supported,t=e.benchmark.version;return"".concat(n?"":"!").concat(t)})).join(", ")},renderFunc:(0,u.SO)(O)},L={title:"Policies",transforms:[a.P8],key:"policies",exportKey:"policies",renderExport:function(e){return e.map((function(e){return e.name})).join(", ")},props:k({width:40},R),renderFunc:(0,u.SO)(E)},_={title:"Failed rules",key:"failedRules",exportKey:"profiles",transforms:[a.P8],sortBy:["rulesFailed"],props:{width:5},renderExport:function(e){return e.reduce((function(e,n){return e+n.rulesFailed}),0)},renderFunc:(0,u.SO)(j)},B={title:"Compliance score",key:"complianceScore",exportKey:"testResultProfiles",sortBy:["score"],transforms:[a.P8],props:{width:5},renderExport:function(e){return(0,c.Oq)((0,b.RT)(e)).trim()},renderFunc:(0,u.SO)(P)},N={title:"Last scanned",key:"lastScanned",transforms:[a.P8],exportKey:"testResultProfiles",props:k({width:10},R),renderExport:function(e){return I(e)},renderFunc:(0,u.SO)(V)},$=M({title:"Operating system",key:"operatingSystem",sortBy:["osMajorVersion","osMinorVersion"],transforms:[a.P8],renderExport:function(e){return T(e)},cell:w}),A=M({title:s().createElement(l.Tooltip,{content:s().createElement("span",null,"Operating System")},s().createElement("span",null,"OS")),original:"Operating System",key:"operatingSystem",dataLabel:"OS",transforms:[a.P8],sortBy:["osMajorVersion","osMinorVersion"],props:{width:10},renderExport:function(e){return T(e)},cell:w}),q=function(e,n){return k({key:e},n)}},60986:(e,n,t)=>{"use strict";t.d(n,{Ey:()=>m,r0:()=>Oe}),t(44434);var r=t(4942),o=t(92950),i=t.n(o),s=t(45697),a=t.n(s),l=t(35664),c=t(30319),u=t(38775),p=t(53895);function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var f=function(e){var n=e.inventoryId;return i().createElement(u.Z,{onLoad:function(e){var n=e.mergeWithDetail;return(0,c.S1)().register(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},n()))},inventoryId:n},i().createElement(p.Z,{fallback:i().createElement(l.Z,{size:l.i.md})}))};f.propTypes={inventoryId:a().string};const m=f;t(88718),t(57481),t(30845),t(89671);var y,b=t(87462),v=t(42982),h=t(70885),g=t(65115),O=t(75863),E=t(33739),j=t(98773),P=t(45987),S=t(65811),I=t(98132),V=t(15861),T=t(64687),w=t.n(T),C=t(26075),Z=t(95417),k=t(30168),R=t(67521),M=(0,R.Ps)(y||(y=(0,k.Z)(["\n  query CRB_Systems(\n    $filter: String!\n    $policyId: ID\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          testResultProfiles(policyId: $policyId) {\n            id\n            refId\n            score\n            lastScanned\n            compliant\n            rulesFailed\n            rulesPassed\n            supported\n            osMajorVersion\n            rules {\n              id\n              refId\n              precedence\n              compliant\n              remediationAvailable\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),x=t(80976),D=t(55942),F=["rules","systems","policyId","onRemediationCreated"],L=function(e){e.rules;var n=e.systems,t=e.policyId,r=(e.onRemediationCreated,(0,P.Z)(e,F)),s=function(e,n,t){var r=(0,C.x)(),i=(0,Z.Z)(3),s=i.isResolving,a=i.results,l=i.resolve,c=(0,o.useCallback)(function(){var n=(0,V.Z)(w().mark((function n(o,i){var s;return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=t.length>0?"id ^ (".concat(t.join(","),")"):void 0,n.next=3,r.query({query:M,fetchPolicy:"no-cache",variables:{perPage:o,page:i,filter:"(".concat(s,") AND policy_id = ").concat(e),policyId:e}});case 3:return n.abrupt("return",n.sent.data.systems);case 4:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),[t,e]),u=(0,o.useCallback)((0,V.Z)(w().mark((function e(){var n,r,o,i=arguments;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:3,r=Math.ceil((null==t?void 0:t.length)/n)||1,e.next=4,l((0,v.Z)(new Array(r)).map((function(e,t){return function(){return c(n,t+1)}})));case 4:return o=e.sent,e.abrupt("return",o&&(0,x.k)(o));case 6:case"end":return e.stop()}}),e)}))),[t]);return{isLoading:s,data:a&&(0,x.k)(a),fetch:u}}(t,0,n),a=s.isLoading,l=s.fetch;return i().createElement(I.Z,(0,b.Z)({isDisabled:0===(null==n?void 0:n.length)||a,onRemediationCreated:function(e){(0,S.q)(e.getNotification())},dataProvider:l,buttonProps:{ouiaId:"RemediateButton",isLoading:a},fallback:i().createElement(D.Z,null)},r),"Remediate")};L.propTypes={rules:a().array,systems:a().array,onRemediationCreated:a().func,policyId:a().string};const _=L;var B,N,$=t(72971),A=t(32467),q=t(37948),K=(t(35937),t(67336)),H=t(83237),U=t(99030);function G(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}(0,R.ZP)(B||(B=(0,k.Z)(["\n  query ST_Systems(\n    $filter: String!\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n          osMinorVersion\n          culledTimestamp\n          staleWarningTimestamp\n          staleTimestamp\n          insightsId\n          lastScanned\n          updated\n        }\n      }\n    }\n  }\n"])));var z=(0,R.ZP)(N||(N=(0,k.Z)(["\n  query ST_SystemOS($filter: String!) {\n    systems(search: $filter) {\n      osVersions\n    }\n  }\n"]))),W=function(e,n){return[].concat((0,v.Z)((0,$.RM)(e)),(0,v.Z)(n?(0,$.iz)(e):[]))},Y=function(e){return function(n){var t=n.INVENTORY_ACTION_TYPES,o=n.mergeWithEntities;return(0,K.JH)().register(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?G(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({},o((0,U.zw)(t,e))))}},J=function(e){return[{type:H.Y.checkbox,label:"SSG Version",filterString:function(e){return"ssg_version = ".concat(e)},items:e.map((function(e){return{label:e,value:e}}))}]},Q=t(90570),X=t(28216),ee=t(43917),ne=t(82176),te=t(76316),re=t(77592),oe=t(40127),ie=function(e){return{type:oe.l,payload:e}},se=["culledTimestamp","staleWarningTimestamp","staleTimestamp","insightsId"],ae=["tagFilters"];function le(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ce(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?le(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):le(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ue=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,Q.a)(z,ce({skip:!e},n)).data,r=((null==t?void 0:t.systems)||{}).osVersions;return e?function(){return $.n3.apply(void 0,arguments)}(function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(n,t){var r;return r=t.major,e.length>0&&!e.map(String).includes(String(r))||(n[String(t.major)]=(0,v.Z)(new Set([].concat((0,v.Z)(n[t.major]||[]),[t.minor])))),n}),[])}(r,e)):[]},pe=function(e){var n=e.culledTimestamp,t=e.staleWarningTimestamp,r=e.staleTimestamp,o=e.insightsId;return ce(ce({},(0,P.Z)(e,se)),{},{insights_id:o,culled_timestamp:n,stale_warning_timestamp:t,stale_timestamp:r})},de=function(e){var n=e.query,t=e.onComplete,r=e.variables,o=void 0===r?{}:r,i=e.onError,s=(0,C.x)();return function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.query({query:n,fetchResults:!0,fetchPolicy:"no-cache",variables:ce(ce({perPage:e,page:r},o),a)}).then((function(e){var n,r,o=e.data,i=(null==o||null===(n=o.systems)||void 0===n||null===(n=n.edges)||void 0===n?void 0:n.map((function(e){return e.node})))||[],s={entities:(0,ne.qN)(i).map(pe),meta:ce(ce({},a.tags&&{tags:a.tags}),{},{totalCount:(null==o||null===(r=o.systems)||void 0===r?void 0:r.totalCount)||0})};return t&&t(s),s})).catch((function(e){if(i)return i(e),{entities:[],meta:{totalCount:0}};throw e}))}},fe=function(){var e=(0,Z.Z)(),n=e.isResolving,t=e.resolve;return{isLoading:n,fetchBatched:function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,i=Math.ceil(n/o)||1;return t((0,v.Z)(new Array(i)).map((function(n,t){return function(){return e(o,t+1,r)}})))}}},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.tagFilters,t=(0,P.Z)(e,ae),r=n?{tags:n.flatMap((function(e){return e.values.map((function(n){return"".concat(encodeURIComponent(e.key),"/").concat(encodeURIComponent(n.tagKey),"=").concat(encodeURIComponent(n.value))}))}))}:{};return ce(ce({},t),r)},ye=function(e){return(null==e?void 0:e.length)>0?"id ^ (".concat(e.join(","),")"):void 0},be=t(79886);function ve(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function he(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ve(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ve(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ge=function(e){var n=e.columns,t=e.showAllSystems,r=e.policyId,s=e.showActions,a=e.enableExport,l=e.compliantFilter,c=e.policies,u=e.showOnlySystemsWithTestResults,p=e.showOsFilter,d=e.error,f=e.showComplianceSystemsInfo,m=e.compact,y=e.remediationsEnabled,P=e.systemProps,I=e.defaultFilter,T=e.emptyStateComponent,C=e.prependComponent,Z=e.showOsMinorVersionFilter,k=e.preselectedSystems,R=e.onSelect,M=e.noSystemsTable,x=e.tableProps,D=e.ssgVersions,F=e.dedicatedAction,L=e.ruleSeverityFilter,B=(0,o.useRef)(null),N=(0,o.useState)(!1),K=(0,h.Z)(N,2),H=K[0],U=K[1],G=(0,o.useState)(!1),z=(0,h.Z)(G,2),Q=z[0],ne=z[1],oe=(0,o.useState)([]),se=(0,h.Z)(oe,2),ae=se[0],le=se[1],pe=(0,o.useState)(0),ve=(0,h.Z)(pe,2),ge=ve[0],Oe=ve[1],Ee=(0,o.useState)(50),je=(0,h.Z)(Ee,2),Pe=je[0],Se=je[1],Ie=(0,o.useState)([]),Ve=(0,h.Z)(Ie,2),Te=Ve[0],we=Ve[1],Ce=(0,j.Z)("inventory"),Ze=ue(Z,{variables:he({filter:I},r&&{policyId:r})}),ke=(0,q.Z)({filters:{filterConfig:[].concat((0,v.Z)($.qo),(0,v.Z)(l?$.rN:[]),(0,v.Z)((null==c?void 0:c.length)>0?W(c,p):[]),(0,v.Z)(D?J(D):[]),(0,v.Z)(Ze),(0,v.Z)(L?$.p5:[]))}}),Re=ke.toolbarProps,Me=ke.filterString,xe=ke.activeFilterValues,De=function(e,n,t){var r=[].concat((0,v.Z)(n?["has_test_results = true"]:[]),(0,v.Z)((null==e?void 0:e.length)>0?[e]:[])).join(" and ");return t?"(".concat(t,")")+(r?" and (".concat(r,")"):""):r}(Me(),u,I),Fe=(0,o.useMemo)((function(){return(0,be.AZ)(n)}),[n]),Le=(0,o.useMemo)((function(){return{query:Fe.query,variables:he(he({},Fe.fragments),{},{tags:Te,filter:De},r&&{policyId:r})}}),[Fe,Te,De,r]),_e=function(e){var n=e.total,t=e.onSelect,r=e.preselected,s=e.fetchArguments,a=e.currentPageIds,l=(0,X.I0)(),c=fe(),u=c.isLoading,p=c.fetchBatched,d=(0,o.useState)([]),f=(0,h.Z)(d,2),m=f[0],y=f[1],b=de(ce(ce({},s),{},{onError:function(e){(0,S.q)({variant:"danger",title:"Error selecting systems",description:e.message})}})),v=function(){var e=(0,V.Z)(w().mark((function e(n){var t,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.length){e.next=2;break}return e.abrupt("return",[]);case 2:return t=ye(n),e.next=5,p(b,n.length,ce({},t&&{filter:t}));case 5:return r=e.sent,e.abrupt("return",r.flatMap((function(e){return e.entities})));case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=function(){var e=(0,V.Z)(w().mark((function e(n){var r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(ie(!0));case 2:return e.next=4,v(n);case 4:return r=e.sent,y(r),e.next=8,l(ie(!1));case 8:t&&t(r);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E=function(){var e=(0,V.Z)(w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(b,n);case 2:return t=e.sent,e.abrupt("return",t.flatMap((function(e){return e.entities.map((function(e){return e.id}))})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=(0,re.Z)({total:n,onSelect:O,preselected:r,itemIdsInTable:E,itemIdsOnPage:function(){return a}});return ce(ce({selectedSystems:m},j),{},{toolbarProps:ce(ce({},j.toolbarProps),{},{bulkSelect:ce(ce({},j.toolbarProps.bulkSelect),u?{isDisabled:!0,toggleProps:{children:[i().createElement(g.Spinner,{size:"md",key:"spinner"})]}}:{})})})}({total:ge,perPage:Pe,onSelect:R,preselected:(0,o.useMemo)((function(){return k.map((function(e){return e.id}))}),[k]),fetchArguments:Le,currentPageIds:ae.map((function(e){return e.id}))}),Be=_e.selectedIds,Ne=_e.tableProps,$e=_e.toolbarProps;!function(e,n,t){var r=(0,X.I0)();(0,o.useLayoutEffect)((function(){r({type:"INVENTORY_INIT"})}),[]),(0,o.useEffect)((function(){r({type:"SELECT_ENTITIES",payload:{selected:n}})}),[n]);var i=(0,ee.Z)((function(){Promise.resolve(r({type:"RESET_PAGE"})).then((function(){var n;return null==e||null===(n=e.current)||void 0===n?void 0:n.onRefreshData()}))}),50);(0,o.useEffect)((function(){i()}),[t])}(B,Be,xe);var Ae=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=n.selected,r=n.columns,o=function(e,n){return e.map((function(e){return"".concat(e,":").concat(n)}))},i=function(e){return(r||[]).find((function(n){return n.key===e}))};return function(){var n=(0,V.Z)(w().mark((function n(r,s){var a,l,c,u,p,d,f,m,y,b,v,h,g;return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=s.page,l=void 0===a?1:a,c=s.per_page,u=s.orderBy,p=s.orderDirection,d=s.filters,f=i(u),m=f&&f.sortBy?o(f.sortBy,p):void 0,y=me(d),n.next=6,e(c,l,ce(ce({},y),{},{sortBy:m}));case 6:return b=n.sent,h=(v=b||{}).entities,g=v.meta.totalCount,n.abrupt("return",{results:h.map((function(e){return ce(ce({},e),{},{selected:(t||[]).map((function(e){return e})).includes(e.id)})})),orderBy:u,orderDirection:p,total:g});case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()}(de(he(he({},Le),{},{onComplete:function(e){var n,t;Oe(e.meta.totalCount),le(e.entities),Se(e.perPage),ne(!0),we&&we(e.meta.tags),!T||0!==e.meta.totalCount||0!==xe.length||void 0!==(null==e||null===(n=e.meta)||void 0===n?void 0:n.tags)&&0!==(null==e||null===(t=e.meta)||void 0===t||null===(t=t.tags)||void 0===t?void 0:t.length)||U(!0)}})),{selected:Be,columns:n}),qe=function(e){var n=e.columns,t=e.selected,r=e.total,o=e.fetchArguments,i=fe(),s=i.isLoading,a=i.fetchBatched,l=t?ye(t):void 0,c=de({query:o.query,variables:ce(ce(ce({},o.variables),o.tags&&{tags:o.tags}),{},{filter:l?"".concat(o.variables.filter," and (").concat(l,")"):o.variables.filter}),onError:function(){(0,S.q)({variant:"danger",title:"Couldn’t download export",description:"Reinitiate this export to try again."})}}),u=function(){var e=(0,V.Z)(w().mark((function e(){var n;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(c,r,(null==t?void 0:t.length)>0?ye(t):void 0);case 2:return n=e.sent,e.abrupt("return",n.flatMap((function(e){return e.entities})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,te.ZP)({exporter:u,columns:n,isDisabled:0===r||s,onStart:function(){(0,S.q)({variant:"info",title:"Preparing export",description:"Once complete, your download will start automatically."})},onComplete:function(){(0,S.q)({variant:"success",title:"Downloading export"})}}).toolbarProps.exportConfig}({columns:n,filter:De,selected:Be,total:ge,fetchArguments:he({},Le)});return i().createElement(A.Se,{stateValues:{error:d,noError:void 0===d&&!H,empty:H}},i().createElement(A.K7,{stateKey:"error"},!!C&&C,i().createElement(A.mf,{error:d})),i().createElement(A.K7,{stateKey:"empty"},T),i().createElement(A.K7,{stateKey:"noError"},!!C&&Q&&C,f&&i().createElement(g.Alert,{isInline:!0,variant:"info",ouiaId:"SystemsListIsDifferentAlert",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems currently associated with or reporting against compliance policies are displayed."}),i().createElement(E.Z,(0,b.Z)({},P,{disableDefaultColumns:!0,columns:function(e){return n.map((function(n){var t="string"==typeof n,r=t?n:n.key,o=e.find((function(e){return e.key===r}));return he(he(he({},o),t?{key:n}:n),{},{props:he(he({},null==o?void 0:o.props),null==n?void 0:n.props)})}))},noSystemsTable:M,ref:B,getEntities:Ae,hideFilters:{all:!0,tags:!1},showTags:!0,onLoad:Y(n),tableProps:he(he({},Ne),{},{isStickyHeader:!0},x),fallback:i().createElement(g.Spinner,null),variant:m?O.B.compact:""},$e,!t&&he(he({},Re),y&&{dedicatedAction:i().createElement(_,{policyId:r,systems:Be})}),F?{dedicatedAction:F}:{},a&&{exportConfig:qe},s&&{actions:[{title:"View in inventory",onClick:function(e,n,t){var r=t.id;return Ce("/"+r)}}]}))))};ge.propTypes={columns:a().arrayOf(a().oneOfType([a().shape({}),a().string])),policies:a().arrayOf(a().shape({})),showAllSystems:a().bool,policyId:a().string,query:a().oneOfType([a().string,a().object]),showActions:a().bool,enableExport:a().bool,compliantFilter:a().bool,showOnlySystemsWithTestResults:a().bool,showOsFilter:a().bool,showComplianceSystemsInfo:a().bool,error:a().object,compact:a().bool,remediationsEnabled:a().bool,defaultFilter:a().string,systemProps:a().shape({isFullView:a().bool}),emptyStateComponent:a().node,prependComponent:a().node,showOsMinorVersionFilter:a().oneOfType([a().bool,a().arrayOf(a().string)]),preselectedSystems:a().array,onSelect:a().func,noSystemsTable:a().node,tableProps:a().object,ssgVersions:a().array,dedicatedAction:a().object,ruleSeverityFilter:a().bool},ge.defaultProps={policyId:"",showActions:!0,enableExport:!0,compliantFilter:!1,showOnlySystemsWithTestResults:!1,showComplianceSystemsInfo:!1,compact:!1,remediationsEnabled:!0,preselectedSystems:[],ruleSeverityFilter:!1};const Oe=ge},79315:(e,n,t)=>{"use strict";t.d(n,{Z:()=>O});var r,o,i,s,a=t(92950),l=t(90570),c=t(79886),u=t(77346),p=t(30168),d=t(67521),f=(0,d.ZP)(r||(r=(0,p.Z)(["\n  query PQ_ProfileMinimal($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      external\n      description\n      totalHostCount\n      compliantHostCount\n      complianceThreshold\n      osMajorVersion\n      supportedOsVersions\n      lastScanned\n      policyType\n      businessObjective {\n        id\n        title\n      }\n    }\n  }\n"]))),m=(0,d.ZP)(o||(o=(0,p.Z)(["\n  query PQ_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      external\n      description\n      totalHostCount\n      compliantHostCount\n      complianceThreshold\n      osMajorVersion\n      supportedOsVersions\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        refId\n        profiles {\n          id\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          parentProfileId\n          benchmark {\n            id\n            title\n            latestSupportedOsMinorVersions\n            osMajorVersion\n            version\n            profiles {\n              id\n              refId\n              ssgVersion\n            }\n          }\n          rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            references\n            identifier\n            precedence\n            values\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n      hosts {\n        id\n        osMinorVersion\n        osMajorVersion\n      }\n    }\n  }\n"]))),y=(0,d.ZP)(i||(i=(0,p.Z)(["\n  query PQ_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      policy {\n        profiles {\n          id\n          benchmark {\n            ruleTree\n          }\n        }\n      }\n    }\n  }\n"]))),b=(0,d.ZP)(s||(s=(0,p.Z)(["\n  query PQ_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      policy {\n        profiles {\n          id\n          values\n          benchmark {\n            valueDefinitions {\n              id\n              refId\n              title\n              valueType\n              defaultValue\n              description\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),v=t(4942);function h(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?h(Object(t),!0).forEach((function(n){(0,v.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):h(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const O=function(e){var n=e.policyId,t=e.skip,r=e.minimal,o=(0,u.ZP)("ruleGroups"),i=(0,u.ZP)("valueEditing"),s="new"===n||t,p=(0,l.a)(r?f:m,{variables:{policyId:n},skip:s,fetchPolicy:"no-cache"}),d=p.data,v=p.error,h=p.loading,O=p.refetch,E=(0,l.a)(y,{variables:{policyId:n},skip:!o||r||s,fetchPolicy:"no-cache"}),j=E.data,P=E.error,S=E.loading,I=E.refetch,V=(0,l.a)(b,{variables:{policyId:n},skip:!i||r||s,fetchPolicy:"no-cache"}),T=V.data,w=V.error,C=V.loading,Z=V.refetch,k=(0,a.useMemo)((function(){return function(e,n,t){var r,o;return e&&{profile:g(g({},e.profile),{},{policy:g(g({},(null==e||null===(r=e.profile)||void 0===r?void 0:r.policy)||{}),{},{profiles:(null==e||null===(o=e.profile)||void 0===o||null===(o=o.policy)||void 0===o||null===(o=o.profiles)||void 0===o?void 0:o.map((function(e){var r,o,i,s=(null==n||null===(r=n.profile)||void 0===r||null===(r=r.policy)||void 0===r||null===(r=r.profiles)||void 0===r||null===(r=r.find((function(n){return n.id===e.id})))||void 0===r?void 0:r.benchmark.ruleTree)||{},a=(null==t||null===(o=t.profile)||void 0===o||null===(o=o.policy)||void 0===o||null===(o=o.profiles)||void 0===o||null===(o=o.find((function(n){return n.id===e.id})))||void 0===o?void 0:o.benchmark.valueDefinitions)||[],l=null==t||null===(i=t.profile)||void 0===i||null===(i=i.policy)||void 0===i||null===(i=i.profiles)||void 0===i||null===(i=i.find((function(n){return n.id===e.id})))||void 0===i?void 0:i.values;return g(g({},e),{},{values:l,benchmark:g(g({},e.benchmark),{},{ruleTree:s,valueDefinitions:a})})})))||[]})})}}(d,j,T)}),[d,j,T]),R=(0,a.useMemo)((function(){return(0,c.Uv)(v,P,w)}),[v,P,w]),M=h||S||C,x=(0,a.useCallback)((function(){s||(O(),I(),Z())}),[O,I,Z]);return"new"===n?{data:!0,refetch:function(){}}:{data:k,error:R,loading:M,refetch:x}}},95417:(e,n,t)=>{"use strict";t.d(n,{Z:()=>c});var r=t(15861),o=t(70885),i=t(64687),s=t.n(i),a=t(92950),l=t(57609);const c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=(0,a.useState)(!1),t=(0,o.Z)(n,2),i=t[0],c=t[1],u=(0,a.useState)(),p=(0,o.Z)(u,2),d=p[0],f=p[1],m=(0,a.useCallback)(function(){var n=(0,r.Z)(s().mark((function n(t){var r;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f(void 0);case 2:return n.next=4,c(!0);case 4:return n.next=6,(0,l.Z)(t,{concurrency:e});case 6:return r=n.sent,n.next=9,c(!1);case 9:return n.next=11,f(r);case 11:return n.abrupt("return",r);case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[e]);return{isResolving:i,results:d,resolve:m}}},99030:(e,n,t)=>{"use strict";t.d(n,{Nw:()=>d,UP:()=>p,zw:()=>u});var r=t(4942),o=t(18546),i=t(79886),s=t(40127);function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var c=function(e,n){return e.map((function(e){return l(l({},e),{},{selected:n.includes(e.id)})}))},u=function(){var e;return(0,o.Gg)((e={},(0,r.Z)(e,"INVENTORY_INIT",(function(){return{rows:[],total:0}})),(0,r.Z)(e,"RESET_PAGE",(function(e){return l(l({},e),{},{page:1})})),(0,r.Z)(e,"SELECT_ENTITIES",(function(e,n){var t=n.payload.selected;return l(l({},e),{},{rows:c(e.rows,t)})})),(0,r.Z)(e,s.l,(function(e,n){return l(l({},e),{},{rows:e.rows.map((function(e){return l(l({},e),{},{disableSelection:n.payload})}))})})),e))},p=function(e){return e?e.reduce((function(e,n){var t=n.osMinorVersion;return null!=t&&(e[t]=e[t]||{osMinorVersion:t,count:0}).count++,e}),{}):{}},d=function(e){return Object.values(p(e)).sort((0,i.Sj)("osMinorVersion","desc"))}},40127:(e,n,t)=>{"use strict";t.d(n,{l:()=>r});var r="SET_DISABLED_SYSTEM_SELECTION"},23663:()=>{}}]);