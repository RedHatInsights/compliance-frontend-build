"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[253],{7081:(e,t,n)=>{n.d(t,{lb:()=>l,wl:()=>o,ZP:()=>i});var r=n(40400);const l={name:"PlusCircleIcon",height:512,width:512,svgPath:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z",yOffset:0,xOffset:0},o=(0,r.IU)(l),i=o},59253:(e,t,n)=>{n.r(t),n.d(t,{SystemDetails:()=>ue,default:()=>pe});var r=n(87462),l=n(45987),o=n(4942),i=n(42982),a=n(70885),s=n(30168),c=n(92950),u=n.n(c),d=n(45697),p=n.n(d),m=n(15671),y=n(43144),f=n(60136),h=n(82963),v=n(61120),g=n(28553),E=n(97326),P=n(68778),b=n(43047),S=n(62410),C=n(19535),Z=n(91290),T=n(72971),I=["ssgVersion","style"],x=function(e){var t=e.ssgVersion,n=e.style,o=(0,l.Z)(e,I),i=u().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:T.iK},"Supported SSG versions");return u().createElement(g.Alert,(0,r.Z)({variant:"warning",isInline:!0,style:n,title:u().createElement(u().Fragment,null,"Unsupported SSG version (",t,")",u().createElement(g.Popover,{position:"right",bodyContent:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:i},u().createElement(Z.ZP,{style:{marginLeft:".5em",cursor:"pointer",color:"var(--pf-global--Color--200)"}})))},o))};x.propTypes={ssgVersion:p().string,style:p().object};const w=x;var R=function(e){(0,f.Z)(i,e);var t,n,l=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,v.Z)(t);if(n){var l=(0,v.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,h.Z)(this,e)});function i(){var e;(0,m.Z)(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=l.call.apply(l,[this].concat(n)),(0,o.Z)((0,E.Z)(e),"complianceIcon",(function(e){return e?u().createElement("div",{className:"ins-c-policy-card ins-m-compliant"},u().createElement(P.ZP,null)," Compliant"):u().createElement("div",{className:"ins-c-policy-card ins-m-noncompliant"},u().createElement(b.ZP,null)," Not compliant")})),(0,o.Z)((0,E.Z)(e),"fixedPercentage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.toFixed(t)+(n?"%":"")})),e}return(0,y.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.policy,n=e.style,l=e.onClick,o=e.isSelected,i=t.rulesFailed,a=t.compliant,s=t.lastScanned,c=t.score,d=t.ssgVersion,p=t.supported,m=t.name,y=t.policyType,f=this.fixedPercentage(c),h={expandOnMouseOver:!0,hideExpandText:!0};return u().createElement(g.Card,{ouiaId:"PolicyCard",onClick:function(e){e.stopPropagation(),l(t)},isSelectable:!0,isSelected:o,style:n},u().createElement(g.CardBody,null,u().createElement(g.TextContent,{className:"margin-bottom-md"},u().createElement(g.Text,{ouiaId:"PolicyCardName",className:"margin-bottom-top-none",component:g.TextVariants.h4},u().createElement(C.Z,(0,r.Z)({text:m,length:110},h))),u().createElement(g.Text,{ouiaId:"PolicyCardType",style:{color:"var(--pf-global--Color--200)"},component:g.TextVariants.small},u().createElement(C.Z,(0,r.Z)({text:y,length:110},h)))),u().createElement("div",{className:"margin-bottom-md"},p&&this.complianceIcon(a),u().createElement(g.Text,{ouiaId:"PolicyCardFailedRulesScore",component:g.TextVariants.small},i," rule",1===i?"":"s"," failed"," ",u().createElement(g.Tooltip,{position:"bottom",maxWidth:"22em",content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},u().createElement("span",null,"(Score: ",f,")")))),u().createElement(g.Text,{className:"margin-bottom-none",component:g.TextVariants.small},u().createElement(g.Text,{ouiaId:"PolicyCardSSGVersion"},"SSG version: ",d),u().createElement(g.Text,{ouiaId:"PolicyCardLastScanned"},"Last scanned:"," ","Never"!==s?u().createElement(S.Z,{date:Date.parse(s),type:"relative"}):s))),!p&&u().createElement(g.CardFooter,{style:{padding:"0"}},u().createElement(w,{ouiaId:"PolicyCardUnsupportedSSG",ssgVersion:d,style:{paddingTop:"var(--pf-c-alert--PaddingTop)",paddingRight:"var(--pf-c-card--child--PaddingRight)",paddingLeft:"var(--pf-c-card--child--PaddingLeft)",paddingBottom:"var(--pf-c-alert--PaddingBottom)"}})))}}]),i}(u().Component);R.propTypes={policy:p().shape({rulesPassed:p().number,rulesFailed:p().number,score:p().number,lastScanned:p().string,refId:p().string,name:p().string,policyType:p().string,compliant:p().bool,ssgVersion:p().string,supported:p().bool}),style:p().object,onClick:p().func,isSelected:p().bool};const O=R;var k=n(24561);var B=function(e){(0,f.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,v.Z)(t);if(n){var l=(0,v.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,h.Z)(this,e)});function l(){return(0,m.Z)(this,l),r.apply(this,arguments)}return(0,y.Z)(l,[{key:"systemPolicyCards",value:function(){var e=this.props,t=e.policies,n=e.selectedPolicies,r=e.onCardClick;return t.filter((function(e){return e.rulesFailed+e.rulesPassed>0})).map((function(e,t){return u().createElement(g.GridItem,{sm:12,md:12,lg:6,xl:4,key:t},u().createElement(O,{policy:e,style:{height:"100%"},onClick:function(e){return r(e)},isSelected:null==n?void 0:n.find((function(t){return t===e.id}))}))}))}},{key:"render",value:function(){var e=this.props.loading;return u().createElement(u().Fragment,null,u().createElement(g.Grid,{hasGutter:!0},this.systemPolicyCards(),e&&(0,i.Z)(Array(3)).map((function(e,t){return u().createElement(g.GridItem,{span:4,key:t},u().createElement(g.Card,null,u().createElement(g.CardBody,null,u().createElement(k.mr,null))))}))))}}]),l}(u().Component);B.propTypes={policies:p().array,loading:p().bool,onCardClick:p().func,selectedPolicies:p().string},B.defaultProps={policies:[]};const j=B;var F=n(91989),N=n(19949),V=n(90570),_=n(67521),G=n(73980),A=n(48830),L=n(76309),z=n(36689),D=n(97481),U=n(69073),q=n(19232),M=n(334),W=n(28216),$=n(30319),K=n(51225);const H=function(e){var t=e.titleText,n=void 0===t?"This system isnâ€™t connected to Insights yet":t,r=e.bodyText,l=void 0===r?"To get started, activate the Insights client for this system.":r,o=e.buttonText,i=void 0===o?"Learn how to activate the Insights client":o;return u().createElement(g.EmptyState,null,u().createElement(g.EmptyStateIcon,{icon:K.DisconnectedIcon}),u().createElement(g.Title,{headingLevel:"h5",size:"lg"},n),u().createElement(g.EmptyStateBody,null,l),u().createElement(g.Button,{variant:"primary",component:"a",href:"http://access.redhat.com/products/cloud_management_services_for_rhel#getstarted",target:"_blank",rel:"noopener noreferrer",className:"pf-u-mt-lg"},i))};var J=n(7081);const Q=function(){return u().createElement(g.Bullseye,null,u().createElement(g.EmptyState,null,u().createElement(g.EmptyStateIcon,{icon:J.ZP}),u().createElement(g.Title,{headingLevel:"h1",size:"lg"},"This system is not part of any SCAP policies defined within Compliance."),u().createElement(g.EmptyStateBody,null,"To assess and monitor compliance against a SCAP policy for this system, add it to an existing policy or create a new policy."),u().createElement(g.EmptyStatePrimary,null,u().createElement(U.mR,{to:"/scappolicies/new"},u().createElement(g.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))),u().createElement(g.EmptyStateSecondaryActions,null,u().createElement(g.Button,{variant:"link",component:"a",href:"/insights/compliance/scappolicies"},"View compliance policies"))))};var X=n(7162),Y=function(e){var t,n,r=e.system;return u().createElement(g.Bullseye,null,u().createElement(g.EmptyState,null,u().createElement(g.EmptyStateIcon,{icon:X.ZP,title:"Compliance",size:"xl",style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"}}),u().createElement(g.Title,{headingLevel:"h1",size:"lg"},"No results reported"),u().createElement(g.EmptyStateBody,null,"This system is part of ",null==r||null===(t=r.policies)||void 0===t?void 0:t.length,(null==r||null===(n=r.policies)||void 0===n?void 0:n.length)>1?" policies":" policy",", but has not returned any results."),u().createElement(g.EmptyStateBody,null,"Reports are returned when the system checks into Insights. By default, systems check in every 24 hours.")))};Y.propTypes={system:p().shape({policies:p().array})};const ee=Y;var te=function(e){var t,n=e.system;return null!=n&&n.insightsId?null!=n&&n.hasPolicy?null!=n&&n.hasPolicy&&0===(null==n||null===(t=n.testResultProfiles)||void 0===t?void 0:t.length)?u().createElement(ee,{system:n}):void 0:u().createElement(Q,{system:n}):u().createElement(H,null)};te.propTypes={system:p().object};const ne=te;var re,le=["inventoryId","hidePassed"],oe=["customItnl","customRouter","intlProps","client"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=(0,_.ZP)(re||(re=(0,s.Z)(["\n  query System($systemId: String!) {\n    system(id: $systemId) {\n      id\n      name\n      hasPolicy\n      insightsId\n      policies {\n        id\n      }\n      testResultProfiles {\n        id\n        name\n        policyType\n        refId\n        compliant\n        rulesFailed\n        rulesPassed\n        lastScanned\n        score\n        supported\n        ssgVersion\n        majorOsVersion\n        policy {\n          id\n        }\n        rules {\n          title\n          severity\n          rationale\n          refId\n          description\n          compliant\n          remediationAvailable\n          references\n          identifier\n          precedence\n        }\n      }\n    }\n  }\n"]))),ce=function(e){var t,n=e.data.system,r=e.loading,l=e.hidePassed,o=(0,c.useState)(),s=(0,a.Z)(o,2),d=s[0],p=s[1],m=null==n?void 0:n.testResultProfiles,y=function(e){if(e)if(null==d?void 0:d.find((function(t){return(null==e?void 0:e.id)===t}))){var t=null==d?void 0:d.filter((function(t){return e.id!==t}));p(t.length>0?t:void 0)}else p([].concat((0,i.Z)(d||[]),[null==e?void 0:e.id]))};return u().createElement(u().Fragment,null,u().createElement(j,{policies:m,loading:r,selectedPolicies:d,onCardClick:function(e){y(e)}}),u().createElement("br",null),null!=n&&null!==(t=n.testResultProfiles)&&void 0!==t&&t.length?u().createElement(F.Z,{ansibleSupportFilter:!0,hidePassed:l,system:ae(ae({},n),{},{supported:((null==n?void 0:n.testResultProfiles)||[]).filter((function(e){return e.supported})).length>0}),profileRules:null==n?void 0:n.testResultProfiles.map((function(e){return{system:n,profile:e,rules:e.rules}})),loading:r,options:{sortBy:{index:4,direction:"asc",property:"severity"},onDeleteFilter:function(e,t){var n,r,l=null===(n=e.find((function(e){return"Policy"===e.category})))||void 0===n?void 0:n.chips.map((function(e){return e.name})),o=null===(r=m.find((function(e){var t=e.name;return null==l?void 0:l.includes(t)})))||void 0===r?void 0:r.id;o&&(t?p(void 0):y(o?{id:o}:{}))}},activeFilters:{policy:d}}):u().createElement(ne,{system:n}))};ce.propTypes={data:p().shape({system:p().shape({hasPolicy:p().bool,policies:p().shape({id:p().string}),profiles:p().array,testResultProfiles:p().array})}),loading:p().bool,hidePassed:p().bool},ce.defaultProps={loading:!0};var ue=function(e){var t,n=e.inventoryId,o=e.hidePassed,i=(0,l.Z)(e,le),a=(0,V.a)(se,{variables:{systemId:n},fetchPolicy:"no-cache"}),s=a.data,c=a.error,d=a.loading,p=404===(null==c||null===(t=c.networkError)||void 0===t?void 0:t.statusCode);if(d)return u().createElement(D.Z,null);if(c&&!p){var m="Oops! Error loading System data: ".concat(c);return u().createElement(U._U,{message:m})}return u().createElement("div",{className:"ins-c-compliance__scope"},null==s||!s.system||p?u().createElement(N.Z,{title:"No policies are reporting for this system"}):u().createElement(ce,(0,r.Z)({},i,{hidePassed:o,data:s,loading:d})))};ue.propTypes={inventoryId:p().string,hidePassed:p().bool};var de=function(e){var t=e.customItnl,n=e.customRouter,r=e.intlProps,o=e.client,i=(0,l.Z)(e,oe),a=t?q.Z:u().Fragment,s=n?M.BrowserRouter:u().Fragment,c=(0,$.S1)().getStore();return u().createElement(s,null,u().createElement(a,t&&r,u().createElement(z.e,{client:o},u().createElement(W.zt,{store:c},u().createElement(ue,i)))))};de.propTypes={customItnl:p().bool,intlProps:p().any,customRouter:p().bool,client:p().object},de.defaultProps={client:new G.fe({link:new A.u({uri:"/api/compliance/graphql",credentials:"include"}),cache:new L.h4})};const pe=878==n.j?de:null}}]);
//# sourceMappingURL=../sourcemaps/253.4cc8162d758782f9f3d3efcfcf0991be.js.map