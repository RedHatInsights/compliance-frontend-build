(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[402],{44434:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComplianceSystems:()=>v,default:()=>O});var r,o=n(32465),i=n(92950),s=n.n(i),c=n(44119),a=n.n(c),l=n(46829),u=n(48716),p=n(39173),d=n(86350),f=n(84692),m=n(69030),y=n(27803),b=n(31499),h=a()(r||(r=(0,o.Z)(['\n{\n    profiles(search: "external = false and canonical = false") {\n        edges {\n            node {\n                id\n                name\n                refId\n                majorOsVersion\n            }\n        }\n    }\n}\n']))),v=function(){var e,t=(0,l.useQuery)(h),n=t.data,r=t.error,o=t.loading,i=null==n||null===(e=n.profiles)||void 0===e?void 0:e.edges.map((function(e){return e.node}));return s().createElement(s().Fragment,null,s().createElement(u.Z,{className:"page-header"},s().createElement(p.Z,{title:"Systems"})),s().createElement(d.Z,null,s().createElement(f.tC,{stateValues:{error:r,data:n,loading:o}},s().createElement(f.K7,{stateKey:"data"},i&&s().createElement(m.e_,{columns:[b.Zw({showLink:!0,showOsInfo:!0}),b.rE,b.ZC],query:y.Ep,defaultFilter:"has_test_results = true or has_policy = true",systemProps:{isFullView:!0},showOsFilter:!0,showComplianceSystemsInfo:!0,enableEditPolicy:!1,remediationsEnabled:!1,policies:i})))))};const O=v},69284:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CreatePolicy:()=>he,default:()=>Oe});var r,o=n(96156),i=n(28481),s=n(92950),c=n.n(s),a=n(334),l=n(33766),u=n(557),p=n(45697),d=n.n(p),f=n(92277),m=n(32465),y=n(42065),b=n(84692),h=n(44119),v=n.n(h),O=n(46829),g=n(6023),E=n(15113),j=n(46314),P=n(35592);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=v()(r||(r=(0,m.Z)(['\nquery benchmarksAndProfiles {\n    latestBenchmarks {\n        id\n        title\n        refId\n        version\n        osMajorVersion\n        profiles {\n            id\n            name\n            refId\n            description\n            complianceThreshold\n        }\n    }\n    profiles(search: "external = false and canonical = false") {\n        edges {\n            node {\n                id\n                refId\n                benchmark {\n                    refId\n                }\n            }\n        }\n    }\n}\n']))),T=function(){return c().createElement(f.Tooltip,{position:"right",content:"Policy types are OpenSCAP policies that are supported by RHEL. For each major version of RHEL, users can create one policy of each type."},c().createElement(y.ZP,{style:{opacity:.5}}))},V=function(e){var t=e.change,n=e.selectedBenchmarkId,r=(0,O.useQuery)(I,{fetchPolicy:"no-cache"}),o=r.data,i=r.error,s=r.loading;if(i)return i;if(s)return c().createElement(g.Z,null);var a,l,u,p,d=o.latestBenchmarks;if(n){a=d.find((function(e){return e.id===n}));var m=(u=o.profiles.edges,p=a,u.filter((function(e){return p.refId===e.node.benchmark.refId})).map((function(e){return e.node.refId})));l=a.profiles.map((function(e){return w(w({},e),{},{disabled:m.includes(e.refId)})}))}return c().createElement(c().Fragment,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h1,className:"pf-u-mb-md"},"Create SCAP policy"),c().createElement(f.Text,{className:"pf-u-mb-md"},"Select the operating system and policy type for this policy.")),c().createElement(f.Form,null,c().createElement(f.FormGroup,{label:"Operating system",isRequired:!0,fieldId:"benchmark"},d&&d.sort((function(e,t){return e.refId.localeCompare(t.refId)})).map((function(e){var r=e.id,o=e.osMajorVersion;return c().createElement(f.Tile,{key:r,className:"pf-u-mr-md",title:"RHEL ".concat(o),onClick:function(){return function(e){var n,r=e.id,o=e.osMajorVersion;(null===(n=a)||void 0===n?void 0:n.osMajorVersion)!==o&&t("systems",[]),t("benchmark",r),t("osMajorVersion",o)}(e)},isSelected:n===r,isStacked:!0})}))),c().createElement(f.FormGroup,{isRequired:!0,labelIcon:c().createElement(T,null),label:"Policy type",fieldId:"policy-type"},c().createElement(b.yL,{profiles:a&&l,onClick:function(){t("selectedRuleRefIds",null)}}))))};V.propTypes={selectedBenchmarkId:d().string,change:E.ZP.change};var R=(0,l.Z)("policyForm");const x=(0,P.compose)((0,u.connect)((function(e){return{selectedBenchmarkId:R(e,"benchmark")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(V);var k,Z,M=n(2707),C=n(92223);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=v()(k||(k=(0,m.Z)(["\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n"]))),N=v()(Z||(Z=(0,m.Z)(["\nquery Benchmarks($filter: String!){\n    benchmarks(search: $filter){\n        nodes {\n            id\n            latestSupportedOsMinorVersions\n            profiles {\n                id\n                refId\n                osMajorVersion\n                ssgVersion\n            }\n        }\n    }\n}\n"]))),A=function(e){var t,n=e.policy,r=e.selectedRuleRefIds,o=e.change,i=e.osMajorVersion,a=e.osMinorVersionCounts,l=(0,M.eo)(["Name","Severity","Ansible"]),u=a.map((function(e){return e.osMinorVersion})).sort(),p="os_major_version = ".concat(i," ")+'and latest_supported_os_minor_version ^ "'.concat(u.join(","),'"'),d=(0,O.useQuery)(N,{variables:{filter:p},skip:0===u.length}),m=d.data,y=d.error,h=d.loading,v=null==m||null===(t=m.benchmarks)||void 0===t?void 0:t.nodes,E=[],j=a.map((function(e){var t,o,i,s=e.osMinorVersion,c=e.count;if(s="".concat(s),v){var a=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(v,s);a&&(o=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(a,n.refId))&&(o=F(F({},o),{},{benchmark:a}),i=null==r?void 0:r.find((function(e){return e.id===o.id})),E.push(o.id))}return{profile:o,systemCount:c,newOsMinorVersion:s,selectedRuleRefIds:null===(t=i)||void 0===t?void 0:t.ruleRefIds}}));j=j.filter((function(e){return!!e.profile}));var P="".concat((E||[]).map((function(e){return"id = ".concat(e)})).join(" OR ")),S=h||0===P.length,w=(0,O.useQuery)(L,{variables:{filter:P},skip:S}),I=w.data,T=w.error,V=w.loading,R=y||T,x=(null==E?void 0:E.length)>0?I:void 0,k=!(!V&&!h)||void 0,Z=!R&&!k&&0===(null==E?void 0:E.length),D=S?[]:null==I?void 0:I.profiles.edges.map((function(e){return e.node}));return(0,s.useLayoutEffect)((function(){k||o("selectedRuleRefIds",D.map((function(e){var t;return{id:e.id,ruleRefIds:(null==r||null===(t=r.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.ruleRefIds)||e.rules.map((function(e){return e.refId}))}})))}),[D,k]),c().createElement(c().Fragment,null,c().createElement(f.TextContent,{className:"pf-u-pb-md"},c().createElement(f.Text,{component:f.TextVariants.h1},"Rules"),c().createElement(f.Text,null,"Customize your ",c().createElement("b",null,n.name)," SCAP policy by including and excluding rules."),c().createElement(f.Text,null,"Each release of RHEL is supported with a unique and specific version of the SCAP Security Guide (SSG). You must customize each version of SSG for each release of RHEL.")),c().createElement(b.tC,{stateValues:{error:R,data:x,loading:k,noRuleSets:Z}},c().createElement(b.K7,{stateKey:"noRuleSets"},c().createElement(f.EmptyState,null,c().createElement(f.Title,{headingLevel:"h1",size:"xl"},"No rules can be configured"),c().createElement(f.EmptyStateBody,null,"The policy type selected does not exist for the systems and OS versions selected in the previous steps."))),c().createElement(b.K7,{stateKey:"loading"},c().createElement(C.Z,null,c().createElement(g.Z,null))),c().createElement(b.K7,{stateKey:"data"},c().createElement(b.Hv,{tabsData:j,columns:l,remediationsEnabled:!1,selectedFilter:!0,level:1,handleSelect:function(e,t){var n=r.map((function(n){return n.id===e.id?{id:n.id,ruleRefIds:t}:n}));o("selectedRuleRefIds",n)}}))))};A.propTypes={policy:d().object,change:E.ZP.change,osMajorVersion:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number})),selectedRuleRefIds:d().array};var _=(0,l.Z)("policyForm");const U=(0,P.compose)((0,u.connect)((function(e){return{policy:JSON.parse(_(e,"profile")),osMajorVersion:_(e,"osMajorVersion"),osMinorVersionCounts:_(e,"osMinorVersionCounts"),selectedRuleRefIds:_(e,"selectedRuleRefIds")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(A);var q=n(69030),B=n(27803),K=n(99030),H=n(31499),$=function(e){var t=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(f.TextContent,{className:"pf-u-mb-md"},c().createElement(f.Text,null,"You do not have any ",c().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.",c().createElement("br",null),"Policies must be created with at least one system.")),c().createElement(f.TextContent,{className:"pf-u-mb-md"},c().createElement(f.Text,null,"Choose a different operating system, or connect ",c().createElement("b",null,"RHEL ",t)," systems to Insights.")),c().createElement(f.WizardContextConsumer,null,(function(e){var t=e.goToStepById;return c().createElement(f.Button,{onClick:function(){return t(1)}},"Choose a different operating system")})))};$.propTypes={osMajorVersion:d().string};var G=function(e){var t=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(f.TextContent,{className:"pf-u-mb-md"},c().createElement(f.Text,null,"Select which of your ",c().createElement("b",null,"RHEL ",t)," systems should be included in this policy.",c().createElement("br",null),"Systems can be added or removed at any time.")))};G.propTypes={osMajorVersion:d().string};var z=function(e){var t=e.change,n=e.osMajorVersion,r=e.selectedSystems;return c().createElement(c().Fragment,null,c().createElement(f.TextContent,{className:"pf-u-mb-md"},c().createElement(f.Text,{component:f.TextVariants.h1},"Systems")),c().createElement(f.Form,null,c().createElement(f.FormGroup,null,c().createElement(q.e_,{showOsMinorVersionFilter:[n],prependComponent:c().createElement(G,{osMajorVersion:n}),emptyStateComponent:c().createElement($,{osMajorVersion:n}),columns:[H.VG,H.U5],remediationsEnabled:!1,compact:!0,showActions:!1,query:B.Y0,defaultFilter:n&&"os_major_version = ".concat(n),enableExport:!1,preselectedSystems:r,onSelect:function(e){t("systems",e),t("osMinorVersionCounts",(0,K.Nw)(e))}}))))};z.propTypes={osMajorVersion:d().string,selectedSystems:d().array,change:E.ZP.change},z.defaultProps={selectedSystems:[]};var W=(0,l.Z)("policyForm");const J=(0,P.compose)((0,u.connect)((function(e){return{osMajorVersion:W(e,"osMajorVersion"),selectedSystems:W(e,"systems")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(z);var Y=n(6455),Q=n(74726),X=function(e){var t=e.change,n=e.policy,r=e.refId;return(0,s.useEffect)((function(){n&&n.refId!==r&&(t("name","".concat(n.name)),t("refId","".concat(n.refId)),t("description","".concat(n.description)))}),[n]),c().createElement(c().Fragment,null,c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h1},"Details")),c().createElement("br",null),c().createElement(f.Form,{id:"editpolicydetails"},c().createElement(f.FormGroup,{label:"Policy name",isRequired:!0,fieldId:"name"},c().createElement(Y.Z,{component:Q._c,type:"text",isRequired:!0,id:"name",name:"name","aria-describedby":"name"})),c().createElement(f.FormGroup,{label:"Reference ID",isRequired:!0,fieldId:"refId"},c().createElement(Y.Z,{type:"text",component:Q._c,isDisabled:!0,id:"refId",name:"refId","aria-describedby":"refId"})),c().createElement(f.FormGroup,{label:"Description",fieldId:"description"},c().createElement(Y.Z,{type:"text",component:Q.do,id:"description",name:"description","aria-describedby":"description"})),c().createElement(f.FormGroup,{label:"Business objective",labelIcon:c().createElement(b.xB,null),fieldId:"businessObjective"},c().createElement(Y.Z,{type:"text",component:Q._c,id:"businessObjective",name:"businessObjective","aria-describedby":"businessObjective",defaultValue:n.businessObjective})),c().createElement(b._z,{previousThreshold:n.complianceThreshold})))},ee=(0,l.Z)("policyForm");X.propTypes={policy:d().object,refId:d().string,change:E.ZP.change};const te=(0,P.compose)((0,u.connect)((function(e){var t=JSON.parse(ee(e,"profile"));return{policy:t,refId:ee(e,"refId"),initialValues:{name:"".concat(t.name),refId:"".concat(t.refId),description:"".concat(t.description),benchmark:ee(e,"benchmark"),osMajorVersion:ee(e,"osMajorVersion"),profile:ee(e,"profile")}}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(X);var ne,re=v()(ne||(ne=(0,m.Z)(["\nquery review($benchmarkId: String!) {\n    benchmark(id: $benchmarkId) {\n        id\n        osMajorVersion\n    }\n}\n"]))),oe=function(e){var t=e.benchmarkId,n=e.name,r=e.businessObjective,o=e.complianceThreshold,i=e.parentProfileName,s=e.osMinorVersionCounts,a=(0,O.useQuery)(re,{variables:{benchmarkId:t}}),l=a.data,u=a.error,p=a.loading;if(u)return u;if(p)return c().createElement(g.Z,null);var d=l.benchmark.osMajorVersion;return c().createElement(f.TextContent,null,c().createElement(f.Text,{component:f.TextVariants.h1},"Review"),c().createElement(f.Text,null,"Review your SCAP policy before finishing."),c().createElement(f.Text,{component:f.TextVariants.h3,style:{marginTop:0}},n),c().createElement(f.TextList,{component:f.TextListVariants.dl},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Policy type"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},i),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Compliance threshold"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},o,"%"),r&&c().createElement(c().Fragment,null,c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Business objective"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},r)),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Systems"),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},c().createElement(f.TextList,{component:f.TextListVariants.dl},s.map((function(e){var t=e.osMinorVersion,n=e.count;return c().createElement(c().Fragment,{key:t},c().createElement(f.TextListItem,{component:f.TextListItemVariants.dt,style:{fontWeight:"normal"}},"RHEL ",d,".",t),c().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},n," ",n>1?"systems":"system"))}))))))};oe.propTypes={benchmarkId:d().string,refId:d().string,name:d().string,businessObjective:d().string,complianceThreshold:d().number,parentProfileName:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number}))};var ie=(0,l.Z)("policyForm");const se=(0,u.connect)((function(e){return{benchmarkId:ie(e,"benchmark"),refId:ie(e,"refId"),name:ie(e,"name"),businessObjective:ie(e,"businessObjective"),osMinorVersionCounts:ie(e,"osMinorVersionCounts"),complianceThreshold:parseFloat(ie(e,"complianceThreshold"))||100,parentProfileName:JSON.parse(ie(e,"profile")).name,rulesCount:ie(e,"selectedRuleRefIds").length}}))(oe);var ce=n(5913),ae=n(92310),le=n(84351),ue=function(e){var t=e.errors;return t&&Array.isArray(t)&&t.length>0?c().createElement(f.EmptyStateBody,{className:"wizard-failed-errors"},c().createElement(f.List,null,t.map((function(e){return c().createElement(f.ListItem,{key:e},e)})))):null};ue.propTypes={errors:d().array};var pe=function(e){var t=e.onWizardFinish,n=e.cloneFromProfileId,r=e.description,o=e.name,a=e.complianceThreshold,l=e.businessObjective,u=e.refId,p=e.benchmarkId,d=e.systems,m=e.selectedRuleRefIds,y=(0,s.useState)(0),h=(0,i.Z)(y,2),v=h[0],O=h[1],g=(0,s.useState)("This usually takes a minute or two."),E=(0,i.Z)(g,2),j=E[0],P=E[1],S=(0,s.useState)(null),w=(0,i.Z)(S,2),I=w[0],T=w[1],V=(0,s.useState)(!1),R=(0,i.Z)(V,2),x=R[0],k=R[1],Z=(0,le.a7)(),M=function(e){O(100*e)};return(0,s.useEffect)((function(){Z(null,{cloneFromProfileId:n,description:r,name:o,complianceThreshold:a,businessObjective:{title:l},refId:u,benchmarkId:p,hosts:d,selectedRuleRefIds:m},M).then((function(){O(100),P()})).catch((function(e){var t,n,r;P(null===(t=e.networkError)||void 0===t?void 0:t.message),T(null===(n=e.networkError)||void 0===n||null===(r=n.result)||void 0===r?void 0:r.errors),k(!0)}))}),[]),c().createElement(f.Bullseye,null,c().createElement(f.EmptyState,{variant:f.EmptyStateVariant.full},c().createElement(f.EmptyStateIcon,{icon:ce.ZP}),c().createElement("br",null),c().createElement(f.Title,{headingLevel:"h1",size:"lg"},"Creating policy"),c().createElement(f.EmptyStateBody,null,c().createElement(b.ko,{percent:v,failed:x})),c().createElement(f.EmptyStateBody,{className:x&&"wizard-failed-message"},j),c().createElement(ue,{error:I}),c().createElement(f.EmptyStateSecondaryActions,null,(100===v||x)&&c().createElement(f.Button,{variant:"primary",onClick:function(){t()}},x?"Back":"Return to application"))))};pe.propTypes={benchmarkId:d().string.isRequired,businessObjective:d().object,cloneFromProfileId:d().string.isRequired,refId:d().string.isRequired,name:d().string.isRequired,description:d().string,systems:d().array,complianceThreshold:d().number,onWizardFinish:d().func,selectedRuleRefIds:d().arrayOf(d().string).isRequired};var de=(0,l.Z)("policyForm");const fe=(0,P.compose)((0,u.connect)((function(e){return{benchmarkId:de(e,"benchmark"),businessObjective:de(e,"businessObjective"),cloneFromProfileId:JSON.parse(de(e,"profile")).id,refId:de(e,"refId"),name:de(e,"name"),description:de(e,"description"),complianceThreshold:parseFloat(de(e,"complianceThreshold"))||100,systems:de(e,"systems"),selectedRuleRefIds:de(e,"selectedRuleRefIds")}})),(0,j.Z)({form:"policyForm",destroyOnUnmount:!0,forceUnregisterOnUnmount:!0}),ae.CG)(pe);var me=n(70597);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(e){var t=e.benchmark,n=e.osMajorVersion,r=e.complianceThreshold,o=e.name,l=e.profile,u=e.refId,p=e.selectedRuleRefIds,d=e.systemIds,m=(0,a.useHistory)(),y=(0,s.useState)(1),b=(0,i.Z)(y,2),h=b[0],v=b[1],O=function(){var e=m.location;e.hash&&m.push(be(be({},e),{},{hash:""}))},g=function(){m.push("/scappolicies")},E=[{id:1,name:"Create SCAP policy",component:c().createElement(x,null),enableNext:(0,me.$H)(t,n,l)},{id:2,name:"Details",component:c().createElement(te,null),canJumpTo:h>=2,enableNext:(0,me.Ay)(o,u,r)},{id:3,name:"Systems",component:c().createElement(J,null),canJumpTo:h>=3,enableNext:(0,me.Qy)(d)},{id:4,name:"Rules",component:c().createElement(U,null),canJumpTo:(null==d?void 0:d.length)>0&&h>=4,enableNext:(0,me.hT)(p)},{id:5,name:"Review",component:c().createElement(se,null),nextButtonText:"Finish",canJumpTo:(0,me.hT)(p)&&(null==d?void 0:d.length)>0&&h>=5},{id:6,name:"Finished",component:c().createElement(fe,{onWizardFinish:g}),isFinishedStep:!0,canJumpTo:(null==d?void 0:d.length)>0&&h>=6}];return c().createElement(c().Fragment,null,c().createElement(f.Wizard,{isOpen:!0,onNext:function(e){var t=e.id;v(h<t?t:h),O()},onGoToStep:O,onBack:O,onClose:g,title:"Create SCAP policy",description:"Create a new policy for managing SCAP compliance",steps:E}))};he.propTypes={benchmark:d().string,osMajorVersion:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number})),complianceThreshold:d().string,businessObjective:d().object,dispatch:d().func,isOpen:d().bool,name:d().string,onWizardFinish:d().func,profile:d().string,refId:d().string,selectedRuleRefIds:d().arrayOf(d().string),systemIds:d().arrayOf(d().string)},he.defaultProps={isOpen:!1};var ve=(0,l.Z)("policyForm");const Oe=(0,u.connect)((function(e){return{benchmark:ve(e,"benchmark"),osMajorVersion:ve(e,"osMajorVersion"),osMinorVersionCounts:ve(e,"osMinorVersionCounts"),businessObjective:ve(e,"businessObjective"),complianceThreshold:ve(e,"complianceThreshold")||"100.0",name:ve(e,"name"),profile:ve(e,"profile"),refId:ve(e,"refId"),selectedRuleRefIds:ve(e,"selectedRuleRefIds"),systemIds:ve(e,"systems")}}))(he)},52869:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EditPolicy:()=>re,MULTIVERSION_QUERY:()=>ne,default:()=>oe});var r=n(96156),o=n(28481),i=n(32465),s=n(92950),c=n.n(s),a=n(45697),l=n.n(a),u=n(334),p=n(44119),d=n.n(p),f=n(46829),m=n(92277),y=n(52710),b=n(7648),h=n(84692),v=n(85061),O=n(557),g=n(70597);function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){var t,n=e.policy,r=e.setUpdatedPolicy,i=function(){var e=(0,s.useState)(!0),t=(0,o.Z)(e,2),n=t[0],r=t[1];return[n,function(e){var t=(0,g.KJ)(e);return r(t),t}]}(),a=(0,o.Z)(i,2),l=a[0],u=a[1];return c().createElement("div",{className:"pf-c-form"},c().createElement(m.FormGroup,{label:"Policy description",isRequired:!0,fieldId:"description"},c().createElement(m.TextArea,{style:{width:800,height:110},isRequired:!0,type:"text",id:"description",name:"description","aria-describedby":"description",defaultValue:n.description,onChange:function(e){r((function(t){return j(j({},t),{},{description:e})}))}})),c().createElement(m.FormGroup,{label:"Business objective",labelIcon:c().createElement(h.xB,null),fieldId:"business-objective"},c().createElement(m.TextInput,{type:"text",style:{width:300},id:"business-objective",name:"business-objective","aria-describedby":"business-objective",defaultValue:null==n||null===(t=n.businessObjective)||void 0===t?void 0:t.title,onChange:function(e){r((function(t){return j(j({},t),{},{businessObjective:j(j({},t.businessObjective),{},{title:e})})}))}})),c().createElement(m.FormGroup,{validated:l?"default":"error",label:"Compliance threshold (%)",labelIcon:c().createElement(h.w8,null),fieldId:"policy-threshold",helperTextInvalid:"Threshold has to be a number between 0 and 100",helperText:"A value of 95% or higher is recommended"},c().createElement(m.TextInput,{type:"number",style:{width:150},name:"compliance-threshold",id:"compliance-threshold",defaultValue:n.complianceThreshold,"aria-describedby":"policy-threshold",onChange:function(e){r((function(t){return j(j({},t),{},{complianceThreshold:e,complianceThresholdValid:u(e)})}))}})))};P.propTypes={policy:l().shape({description:l().string,businessObjective:l().object,complianceThreshold:l().oneOfType([l().string,l().number])}),setUpdatedPolicy:l().func};const S=P;var w,I,T=n(92223),V=n(6023),R=n(79886);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=d()(w||(w=(0,i.Z)(["\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n"]))),M=d()(I||(I=(0,i.Z)(["\nquery Benchmarks($filter: String!){\n    benchmarks(search: $filter){\n        nodes {\n            id\n            latestSupportedOsMinorVersions\n            profiles {\n                id\n                refId\n                ssgVersion\n            }\n        }\n    }\n}\n"]))),C=function(){return c().createElement(m.EmptyState,null,c().createElement(m.Title,{headingLevel:"h5",size:"lg"},"No rules can be configured"),c().createElement(m.EmptyStateBody,null,"This policy has no associated systems, and therefore no rules can be configured."),c().createElement(m.EmptyStateBody,null,"Add at least one system to configure rules for this policy."))},D=function(e){var t,n=e.handleSelect,r=e.policy,o=e.selectedRuleRefIds,i=e.osMinorVersionCounts,a=e.setNewRuleTabs,l=null==r?void 0:r.osMajorVersion,u=Object.keys(i).sort(),p="os_major_version = ".concat(l," ")+'and latest_supported_os_minor_version ^ "'.concat(u.join(","),'"'),d=(0,f.useQuery)(M,{variables:{filter:p},skip:0===u.length}),y=d.data,b=d.error,v=d.loading,O=null==y||null===(t=y.benchmarks)||void 0===t?void 0:t.nodes,g=function(e,t,n,r){return Object.values(t).sort((0,R.S)("osMinorVersion","desc")).map((function(t){var o,i=t.osMinorVersion,s=t.count;i="".concat(i);var c=e.policy.profiles.find((function(e){return e.osMinorVersion===i})),a=e.osMajorVersion;if(!c&&n){var l=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(n,i);if(l){var u=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(l,e.refId);u&&(c=e.policy.profiles.find((function(e){return e.parentProfileId===u.id})),c=k(k({},u),{},{benchmark:l,osMajorVersion:a},c))}}return{profile:c,systemCount:s,newOsMinorVersion:i,selectedRuleRefIds:null==r||null===(o=r.find((function(e){var t;return e.id===(null===(t=c)||void 0===t?void 0:t.id)})))||void 0===o?void 0:o.ruleRefIds}})).filter((function(e){var t=e.profile,n=e.newOsMinorVersion;return!!t&&n}))}(r,i,O,o),E=g.map((function(e){return e.profile.id})),j="".concat((E||[]).map((function(e){return"id = ".concat(e)})).join(" OR ")),P=(0,f.useQuery)(Z,{variables:{filter:j},skip:0===j.length}),S=P.data,w=P.error,I=!(!P.loading&&!v)||void 0,x=!I&&(null==g?void 0:g.length)>0?S:void 0;I||a(!!g.find((function(e){return r.policy.profiles.find((function(t){return t.osMinorVersion!==e.newOsMinorVersion}))}))),(0,s.useLayoutEffect)((function(){S&&((null==S?void 0:S.profiles.edges.map((function(e){return e.node})))||[]).forEach((function(e){if(!(null==o?void 0:o.find((function(t){return t.id===(null==e?void 0:e.id)})))){var t=e.rules.map((function(e){return e.refId}));n(e,t)}}))}),[S]);var D=b||w;return c().createElement(h.tC,{stateValues:{error:D,data:!D&&x,loading:I,empty:!I&&!x&&!D}},c().createElement(h.K7,{stateKey:"loading"},c().createElement(T.Z,null,c().createElement(V.Z,null))),c().createElement(h.K7,{stateKey:"data"},c().createElement(m.TextContent,null,c().createElement(m.Text,null,"Different release versions of RHEL are associated with different versions of the SCAP Security Guide (SSG), therefore each release must be customized independently.")),c().createElement(h.Hv,{tabsData:g,remediationsEnabled:!1,selectedFilter:!0,level:1,handleSelect:n})),c().createElement(h.K7,{stateKey:"empty"},c().createElement(C,null)))};D.propTypes={handleSelect:l().func,setNewRuleTabs:l().func,policy:l().object,osMinorVersionCounts:l().shape({osMinorVersion:l().shape({osMinorVersion:l().number,count:l().number})}),selectedRuleRefIds:l().array};const F=D;var L=n(69030),N=n(27803),A=n(31499);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(m.TextContent,{className:"pf-u-mb-md"},c().createElement(m.Text,null,"You do not have any ",c().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.")),c().createElement(m.TextContent,{className:"pf-u-mb-md"},c().createElement(m.Text,null,"Connect RHEL ",t," systems to Insights.")))};q.propTypes={osMajorVersion:l().string};var B=function(e){var t=e.osMajorVersion;return c().createElement(c().Fragment,null,c().createElement(m.TextContent,{className:"pf-u-mb-md"},c().createElement(m.Text,null,"Select which of your ",c().createElement("b",null,"RHEL ",t)," systems should be included in this policy.")))};B.propTypes={osMajorVersion:l().string};var K=function(e){var t=e.policy,n=t.osMajorVersion,r=t.hosts,o=e.newRuleTabs,i=(0,u.useHistory)(),s=i.push,a=i.location;return c().createElement(c().Fragment,null,c().createElement(L.e_,{columns:[A.VG,A.U5],showOsMinorVersionFilter:[n],prependComponent:c().createElement(B,{osMajorVersion:n}),emptyStateComponent:c().createElement(q,{osMajorVersion:n}),compact:!0,showActions:!1,query:N.Y0,defaultFilter:n&&"os_major_version = ".concat(n),enableExport:!1,remediationsEnabled:!1,preselectedSystems:r}),o&&c().createElement(m.Alert,{variant:"info",isInline:!0,title:"You selected a system that has a release version previously not included in this policy.",actionLinks:c().createElement(m.AlertActionLink,{onClick:function(){return s(U(U({},a),{},{hash:"#rules"}))}},"Open rule editing")},c().createElement("p",null,"If you have edited any rules for this policy, you will need to do so for this release version as well.")))};K.propTypes={policy:l().object,newRuleTabs:l().bool};const H=K;var $=n(99030);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=function(e,t){return(e||[]).reduce((function(e,t){var n;return""!==t.osMinorVersion&&(e[n=t.osMinorVersion]||(e[n]={osMinorVersion:t.osMinorVersion,count:0})),e}),(0,$.UP)(t||[]))},J=function(e){var t,n=e.policy,r=e.setUpdatedPolicy,i=e.selectedRuleRefIds,a=e.setSelectedRuleRefIds,l=e.setSelectedHosts,u=(null==n||null===(t=n.policy)||void 0===t?void 0:t.profiles)||[],p=(0,s.useState)({}),d=(0,o.Z)(p,2),f=d[0],y=d[1],b=(0,s.useState)(!1),g=(0,o.Z)(b,2),E=g[0],j=g[1],P=(0,O.useSelector)((function(e){var t;return null==e||null===(t=e.entities)||void 0===t?void 0:t.selectedEntities}));return(0,s.useEffect)((function(){l(P||[]),y(W(u,P))}),[P]),(0,s.useEffect)((function(){if(n){var e=n.complianceThreshold<101&&n.complianceThreshold>0;r(z(z({},n),{},{complianceThresholdValid:e})),n&&a(u.map((function(e){return{id:e.id,ruleRefIds:e.rules.map((function(e){return e.refId}))}}))),y(W(u,n.hosts))}}),[n]),c().createElement(m.Form,null,c().createElement(h.tn,{defaultTab:"details"},c().createElement(m.Tab,{eventKey:"details",title:c().createElement(m.TabTitleText,null,"Details")},c().createElement(S,{policy:n,setUpdatedPolicy:r})),c().createElement(m.Tab,{eventKey:"rules",title:c().createElement(m.TabTitleText,null,"Rules")},c().createElement(F,{policy:n,setNewRuleTabs:j,handleSelect:function(e,t){var n=i.filter((function(t){return t.id!==e.id}));a([{id:e.id,ruleRefIds:t}].concat((0,v.Z)(n)))},selectedRuleRefIds:i,osMinorVersionCounts:f})),c().createElement(m.Tab,{eventKey:"systems",title:c().createElement(m.TabTitleText,null,"Systems")},c().createElement(H,{policy:n,newRuleTabs:E}))))};J.propTypes={policy:l().object,setUpdatedPolicy:l().func,selectedRuleRefIds:l().arrayOf(l().object),setSelectedRuleRefIds:l().func,setSelectedHosts:l().func};const Y=J;var Q,X=n(84351);function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=d()(Q||(Q=(0,i.Z)(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        osMajorVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                parentProfileId\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                benchmark {\n                    id\n                    title\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n            osMinorVersion\n            osMajorVersion\n        }\n    }\n}\n"]))),re=function(e){var t=e.route,n=(0,u.useParams)().policy_id,r=(0,f.useQuery)(ne,{variables:{policyId:n}}),i=r.data,a=r.loading,l=r.error,p=null==i?void 0:i.profile,d=(0,y.Wb)(),v=(0,s.useState)(null),O=(0,o.Z)(v,2),g=O[0],E=O[1],j=(0,s.useState)([]),P=(0,o.Z)(j,2),S=P[0],w=P[1],I=(0,s.useState)(),T=(0,o.Z)(I,2),V=T[0],R=T[1],x=(0,X.a7)(),k=(0,y.C3)("/scappolicies"),Z=(0,s.useState)(),M=(0,o.Z)(Z,2),C=M[0],D=M[1],F=g&&!g.complianceThresholdValid,L=function(){k({hash:d})},N=[c().createElement(m.Button,{isDisabled:F,key:"save",variant:"primary",spinnerAriaValueText:"Saving",isLoading:C,onClick:function(){if(!C){D(!0);var e=te(te({},g),{},{selectedRuleRefIds:S,hosts:V});x(p,e).then((function(){D(!1),L()})).catch((function(){D(!1),L()}))}}},"Save"),c().createElement(m.Button,{key:"cancel",variant:"link",onClick:function(){return L()}},"Cancel")];return(0,b.a)(t,null==p?void 0:p.name),c().createElement(m.Modal,{isOpen:!0,position:"top",style:{minHeight:"768px"},variant:"large",title:"Edit ".concat(p?p.name:""),onClose:function(){return L()},actions:N},c().createElement(h.tC,{stateValues:{policy:p,loading:a,error:l}},c().createElement(h.K7,{stateKey:"loading"},c().createElement(m.Spinner,null)),c().createElement(h.K7,{stateKey:"policy"},c().createElement(Y,{policy:p,updatedPolicy:g,setUpdatedPolicy:E,selectedRuleRefIds:S,setSelectedRuleRefIds:w,setSelectedHosts:R}))))};re.propTypes={route:l().object};const oe=re},31499:(e,t,n)=>{"use strict";n.d(t,{OF:()=>D,ZC:()=>M,ll:()=>C,Hc:()=>F,VG:()=>R,U5:()=>N,rE:()=>Z,hN:()=>k,Zw:()=>x});var r=n(96156),o=n(22122),i=n(92950),s=n.n(i),c=n(84692),a=n(82176),l=n(45697),u=n.n(l),p=n(334),d=n(92277),f=n(62410),m=function(e){var t=e.id,n=e.children;return s().createElement(p.Link,{to:{pathname:"/systems/".concat(t)}},n)};m.propTypes={id:u().string,children:u().node};var y=function(e){var t=e.id,n=e.name,r=e.osMajorVersion,o=e.osMinorVersion,i=e.showOsInfo,c=void 0!==i&&i,a=e.showLink,l=void 0!==a&&a;return s().createElement(d.TextContent,null,l?s().createElement(m,{id:t},n):n,function(e,t){return!!e&&!!t&&c}(r,o)&&s().createElement(d.Text,{component:d.TextVariants.small},"RHEL ",r,".",o))};y.propTypes={id:u().string,name:u().string,osMajorVersion:u().string,osMinorVersion:u().string,showOsInfo:u().bool,showLink:u().bool};var b=function(e){var t=e.ssgVersion,n=void 0===t?"Not available":t;return e.supported?n:s().createElement(c.cT,{messageVariant:"singular"},n)};b.propTypes={supported:u().bool,ssgVersion:u().string};var h=function(e){var t=e.testResultProfiles,n=void 0===t?[]:t;return 0!==n.length?n.map((function(e){return s().createElement(b,(0,o.Z)({key:"ssgversion-".concat(e.id)},e))})):"Not available"};h.propTypes={testResultProfiles:u().array};var v=function(e){var t=e.id,n=e.testResultProfiles;return(void 0===n?[]:n).length>0?s().createElement(m,{id:t},"View Report"):""};v.propTypes={id:u().string,testResultProfiles:u().array};var O=function(e){var t=e.id,n=e.testResultProfiles,r=(0,a.T4)(n).length;return s().createElement(m,{id:t},r)};O.propTypes={id:u().string,testResultProfiles:u().array};var g="Never",E=function(e){var t=e.reduce((function(e,t){return e+t.score}),0),n=(0,a.TU)(e).length,r=(0,a.T4)(e).length,o=e.reduce((function(e,t){return(0,a.TU)([t]).length+(0,a.T4)([t]).length>0?e+1:e}),0);return{score:o?t/o:0,rulesPassed:n,rulesFailed:r,compliant:e.every((function(e){return e.lastScanned===g||!0===e.compliant})),supported:(e||[]).reduce((function(e,t){return e&&t.supported}),!0)}},j=function(e){var t=e.testResultProfiles;return(0,c.OF)(E(t))};j.propTypes={testResultProfiles:u().array};var P=function(e){var t=e.map((function(e){return new Date(e.lastScanned)})),n=new Date(Math.max.apply(null,t.filter((function(e){return isFinite(e)}))));return n instanceof Date&&isFinite(n)?n:g},S=function(e){var t=e.testResultProfiles,n=P(t||[]);return n instanceof Date?s().createElement(f.Z,{date:Date.parse(n),type:"relative"}):n};function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}S.propTypes={testResultProfiles:u().array};var T=function(e,t){return function(n,r,i){return s().createElement(e,(0,o.Z)({},i,t))}},V={isStatic:!0},R={title:"Name",props:I({width:40},V),exportKey:"name",renderExport:function(e){return String(e)},renderFunc:T(y)},x=function(e){return I(I({},R),{},{props:I(I({},R.props),e),renderFunc:T(y,e)})},k={title:"SSG version",props:V,exportKey:"testResultProfiles",renderExport:function(e){return e.map((function(e){var t=e.supported,n=e.ssgVersion;return"".concat(t?"":"!").concat(n)})).join(", ")},renderFunc:T(h)},Z={title:"Policies",exportKey:"policies",props:I({width:40},V),renderFunc:T((function(e){return(e.policies||[]).map((function(e){return e.name})).join(", ")}))},M={title:"",export:!1,props:I({width:20},V),renderFunc:T(v)},C={title:"Failed rules",exportKey:"testResultProfiles",props:I({width:5},V),renderExport:function(e){return(0,a.T4)(e).length},renderFunc:T(O)},D={title:"Compliance score",exportKey:"testResultProfiles",props:I({width:5},V),renderExport:function(e){return(0,c.Oq)(E(e))},renderFunc:T(j)},F={title:"Last scanned",exportKey:"testResultProfiles",props:I({width:10},V),renderExport:function(e){return P(e)},renderFunc:T(S)},L=function(e){var t=e.osMinorVersion,n=e.osMajorVersion;return"RHEL ".concat(n,".").concat(t)},N={title:"Operating system",props:V,renderExport:function(e){return L(e)},renderFunc:function(e,t,n){return L(n)}}},27803:(e,t,n)=>{"use strict";n.d(t,{Ep:()=>m,Y0:()=>y,UD:()=>b,F4:()=>h,B4:()=>v});var r,o,i=n(96156),s=n(85061),c=n(32465),a=n(44119),l=n.n(a),u=(n(35937),n(99373)),p=n(67336),d=n(99030);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var m=l()(r||(r=(0,c.Z)(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    majorOsVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),y=l()(o||(o=(0,c.Z)(["\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n"]))),b=function(e,t){return[].concat((0,s.Z)((0,u.RM)(e)),(0,s.Z)(t?(0,u.iz)(e):[]))},h=function(){return u.n3.apply(void 0,arguments)},v=function(e){return function(t){var n=t.INVENTORY_ACTION_TYPES,r=t.mergeWithEntities;return(0,p.JH)().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r((0,d.zw)(n,e))))}}},69030:(e,t,n)=>{"use strict";n.d(t,{Ey:()=>g,e_:()=>ae}),n(44434);var r,o=n(96156),i=n(6610),s=n(5991),c=n(10379),a=n(46070),l=n(77608),u=n(92950),p=n.n(u),d=n(45697),f=n.n(d),m=n(56455),y=n(67336),b=n(38775),h=n(6363);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var O=(0,y.gu)()(r=function(e){(0,c.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,a.Z)(this,e)});function u(e){return(0,i.Z)(this,u),r.call(this,e)}return(0,s.Z)(u,[{key:"render",value:function(){var e=this;return p().createElement(b.Z,{onLoad:function(t){var n=t.mergeWithDetail;return e.getRegistry().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n()))}},p().createElement(h.Z,{fallback:p().createElement(m.Z,{size:m.i.md}),hideBack:!0}))}}]),u}(p().Component))||r;O.propTypes={entity:f().object};const g=function(e){return p().createElement(O,e)};n(69284),n(57481),n(52869),n(89671);var E=n(22122),j=n(85061),P=n(28481),S=n(557),w=n(92277),I=n(31095),T=n(22642),V=n(11865),R=n.n(V),x=n(38914),k=n.n(x),Z=function(e,t){var n=t.exportKey,r=t.renderExport,o=n?k()(e,n)[0]:e;return r&&(o=r(o)),"string"==typeof o&&o.includes(",")&&(o='"'+o+'"'),o},M=n(99373),C=n(84692),D=n(82176),F=n(17490),L=n(33739),N=n(27803),A=n(92137),_=n(87757),U=n.n(_),q=n(46829),B=n(48623),K=n(41800),H=n.n(K);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.Z)(this,e),(0,o.Z)(this,"DEFAULT_API_HEADERS",{"Content-Type":"application/vnd.api+json",Accept:"application/json"}),this.apiBase=t.apiBase||"/api",this.path=t.path||"",this.authenticate=t.authenticate||function(){return Promise.resolve({})},this.onUnauthorised=t.onUnauthorised||function(){return Promise.resolve({})},this.defaultHeaders=t.headers||this.DEFAULT_API_HEADERS}var t;return(0,s.Z)(e,[{key:"request",value:(t=(0,A.Z)(U().mark((function e(t,n,r){var o,i=this,s=arguments;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>3&&void 0!==s[3]?s[3]:{},e.next=3,this.callAuthenticate().then((function(){return i.fetch(t,n,r,o)})).then(this.checkForEmptyResponse).then((function(e){return i.checkForErrors(e,o)})).then((function(e){return e.json()})).catch(this.finalCatch);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"finalCatch",value:function(e){return void 0===e.errors?Promise.reject({title:"Error parsing"}):Promise.reject(G({},e))}},{key:"fetch",value:function(e){function t(t,n,r,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r){var o={method:n||"get",headers:this.defaultHeaders,credentials:"include"},i="".concat(this.apiBase).concat(this.path?this.path:"").concat(e||""),s=new URL(i,window.location.origin);if(r.params){var c=Object.keys(r.params).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r.params[e])})).join("&");s.search=new URLSearchParams(c)}return t&&(o.body=JSON.stringify(t)),fetch(s,o)}))},{key:"checkForEmptyResponse",value:function(e){return 204===e.status?{json:function(){return{}}}:e}},{key:"checkForErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(404===e.status&&t.ignore404)return{json:function(){return{}}};if(401===e.status)return this.onUnauthorised();var n=e.clone?e.clone().json():e;return 422===e.status?n.then((function(e){return Promise.reject(G(G({},e),{},{title:"Validation error"}))})):e.status>=400&&e.status<=600?n.then((function(e){return Promise.reject(e.errors[0])})):e}},{key:"callAuthenticate",value:function(){return Promise.resolve(this.authenticate()||!0)}},{key:"create",value:function(e,t){return this.request(e,t,"post")}},{key:"update",value:function(e,t){return this.request(e,t,"put")}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,null,"get",t)}},{key:"destroy",value:function(e){return this.request(e,null,"delete")}}]),e}();function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const J=function(e){return new z(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){return e&&function(e,t){var n=e[t],r=e;return delete r[t],Q(Q({},r),n)}(e,"attributes")},ee=function(e,t){var n,r=H()(e);return null===(n=Object.values(r[t]||{}))||void 0===n?void 0:n.map((function(e){return function(e,t){var n={};return Object.entries((null==e?void 0:e.relationships)||[]).forEach((function(e){var r=(0,P.Z)(e,2),o=r[0],i=r[1];n[o]=null==i?void 0:i.data.map((function(e){var n;return X(null==t||null===(n=t[e.type])||void 0===n?void 0:n[e.id])})).filter((function(e){return!!e}))})),delete e.relationships,Q(Q({},e),n)}(X(e),r)}))},te=function(){var e=(0,A.Z)(U().mark((function e(t,n){var r,o,i,s,c=arguments;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:{},o=c.length>3&&void 0!==c[3]?c[3]:{},e.next=4,t.get("/".concat(n),{params:r});case 4:return i=e.sent,e.next=7,ee(i,(null==o?void 0:o.type)||n);case 7:return s=e.sent,e.abrupt("return",{collection:s,meta:i.meta,total:i.meta.total,json:i});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe=function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=(0,u.useState)({data:void 0,loading:!1,error:void 0}),o=(0,P.Z)(r,2),i=o[0],s=o[1],c=J({apiBase:M.dT}),a=Q(Q({},(null==t?void 0:t.params)||{}),{},{include:(null==t?void 0:t.include)||[]});return(0,u.useEffect)((function(){null!=t&&t.skip||(s({data:void 0,loading:!0,error:void 0}),te(c,e,a,t).then((function(e){s({data:e,loading:!1,error:void 0})})))}),[].concat((0,j.Z)(n),[null==t?void 0:t.skip])),i}("supported_ssgs",{type:"supportedSsg",skip:!e}).data;return e?(0,N.F4)(function(){var e=arguments.length>1?arguments[1]:void 0,t=function(t){return!(e.length>0)||Array(e).map(String).includes(String(t))};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,n){return t(n.osMajorVersion)&&(e[String(n.osMajorVersion)]=(0,j.Z)(new Set([].concat((0,j.Z)(e[n.osMajorVersion]||[]),[n.osMinorVersion])))),e}),[])}(null==t?void 0:t.collection,e)):[]};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t=e.columns,n=e.showAllSystems,r=e.policyId,o=e.query,i=e.showActions,s=e.enableExport,c=e.compliantFilter,a=e.policies,l=e.showOnlySystemsWithTestResults,d=e.showOsFilter,f=e.error,m=e.showComplianceSystemsInfo,y=e.compact,b=e.remediationsEnabled,h=e.systemProps,v=e.defaultFilter,O=e.emptyStateComponent,g=e.prependComponent,V=e.showOsMinorVersionFilter,x=e.preselectedSystems,k=e.onSelect,_=e.noSystemsTable,K=(0,S.useStore)(),H=(0,u.useRef)(null),$=(0,u.useState)(!1),G=(0,P.Z)($,2),z=G[0],W=G[1],J=(0,u.useState)(!1),Y=(0,P.Z)(J,2),Q=Y[0],X=Y[1],ee=(0,u.useState)([]),te=(0,P.Z)(ee,2),ne=te[0],ie=te[1],ce=(0,u.useState)(0),ae=(0,P.Z)(ce,2),le=ae[0],ue=ae[1],pe=function(e,t,n,r){var o=(0,u.useState)(n),i=(0,P.Z)(o,2),s=i[0],c=i[1],a=s.map((function(e){return e.id})),l=t.filter((function(e){return a.includes(e.id)})).length===t.length,p=function(t){return e&&e(t)};return{onSelect:function(e,t,n,r){var o=t?[].concat((0,j.Z)(s),[r]):s.filter((function(e){return e.id!==r.id}));c(o),p(o)},onBulkSelect:function(){var e=(s||[]).filter((function(e){return!t.map((function(e){return e.id})).includes(e.id)})),n=s.length<=r?l?e:[].concat((0,j.Z)(e),(0,j.Z)(t)):[];c(n),p(n)},selectedSystems:s,isPageSelected:l}}(k,ne,x,le),de=pe.onSelect,fe=pe.onBulkSelect,me=pe.selectedSystems,ye=pe.isPageSelected,be=null==me?void 0:me.map((function(e){return e.id})),he=ne.filter((function(e){return be.includes(e.id)})),ve=me.length,Oe=oe(V),ge=(0,F.Z)([].concat((0,j.Z)(M.qo),(0,j.Z)(c?M.rN:[]),(0,j.Z)((null==a?void 0:a.length)>0?(0,N.UD)(a,d):[]),(0,j.Z)(Oe))),Ee=ge.conditionalFilter,je=ge.activeFilters,Pe=ge.buildFilterString,Se=ge.activeFilterValues;!function(e,t,n){var r=(0,S.useDispatch)();(0,u.useLayoutEffect)((function(){r({type:"INVENTORY_INIT"})}),[]),(0,u.useEffect)((function(){r({type:"SELECT_ENTITIES",payload:{selected:t}})}),[t]);var o=(0,B.Z)((function(){Promise.resolve(r({type:"RESET_PAGE"})).then((function(){var t;return null==e||null===(t=e.current)||void 0===t?void 0:t.onRefreshData()}))}),50);(0,u.useEffect)((function(){o()}),[n])}(H,me,Se);var we,Ie,Te=function(e,t,n,r,o,i){var s=(0,q.useApolloClient)(),c=n(),a=[].concat((0,j.Z)(r?["has_test_results = true"]:[]),(0,j.Z)((null==c?void 0:c.length)>0?[c]:[])).join(" and "),l=o?"(".concat(o,")")+"".concat(a?"and (".concat(a,")"):"",")"):a;return function(n,r){return s.query({query:e,fetchResults:!0,fetchPolicy:"no-cache",variables:re({filter:l,perPage:n,page:r},t&&{policyId:t})}).then((function(e){var t,n,r,o=e.data,s={entities:(null==o||null===(t=o.systems)||void 0===t||null===(n=t.edges)||void 0===n?void 0:n.map((function(e){return e.node})))||[],meta:{totalCount:(null==o||null===(r=o.systems)||void 0===r?void 0:r.totalCount)||0}};return i&&i(s),s}))}}(o,r,Pe,l,v,(function(e){ue(e.meta.totalCount),ie(e.entities),X(!0),O&&0===e.meta.totalCount&&0===Se.length&&W(!0)})),Ve=(we=Te,Ie={selected:me}.selected,function(){var e=(0,A.Z)(U().mark((function e(t,n){var r,o,i,s,c,a,l;return U().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.page,o=void 0===r?1:r,i=n.per_page,e.next=3,we(i,o);case 3:return s=e.sent,a=(c=s||{}).entities,l=c.meta.totalCount,e.abrupt("return",{results:a.map((function(e){return re(re({},e),{},{selected:Ie.map((function(e){return e.id})).includes(e.id)})})),total:l});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());return p().createElement(C.Se,{stateValues:{error:f,noError:void 0===f&&!z,empty:z}},p().createElement(C.K7,{stateKey:"error"},!!g&&g,p().createElement(C.mf,{error:f})),p().createElement(C.K7,{stateKey:"empty"},O),p().createElement(C.K7,{stateKey:"noError"},!!g&&Q&&g,m&&p().createElement(w.Alert,{isInline:!0,variant:"info",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems currently associated with or reporting against compliance policies are displayed."}),p().createElement(L.Z,(0,E.Z)({},h,{noSystemsTable:_,ref:H,activeFilters:je,getEntities:Ve,onLoad:(0,N.B4)(t),hideFilters:{name:!0,tags:!0,registeredWith:!0,stale:!0},tableProps:se({canSelectAll:!1},ne.length>0&&{onSelect:de}),fallback:p().createElement(w.Spinner,null),variant:y?I.TableVariant.compact:"",bulkSelect:{checked:ve>0&&(!!ye||null),onSelect:ne.length>0&&fe,count:ve,label:ve>0?"".concat(ve," Selected"):void 0}},!n&&se(se({},Ee),b&&{dedicatedAction:p().createElement(T.Z,{allSystems:(0,D.qN)(he),selectedRules:[]})}),s&&{exportConfig:{isDisabled:0===le&&0===ve,onSelect:function(e,t){var n;return function(e,t){var n;"csv"===t?n=function(e){var t=e.rows,n=e.columns,r=e.selectedEntities;if(t){var o=[n.map((function(e){return e.title})).join(",")];return o=o.concat((r||t).map((function(t){return e.columns.map((function(e){return!1!==e.export?Z(t,e):""})).join(",")}))),encodeURI("data:text/csv;charset=utf-8,"+o.join("\n"))}}(e):"json"===t&&(n=function(e){var t,n=e.rows,r=e.columns,o=e.selectedEntities;if(n)return t=(o||n).map((function(e){var t={};return r.forEach((function(n){var r=R()(n.title);!1!==n.export&&(t[r]=Z(e,n))})),t})),encodeURI("data:application/json;charset=utf-8,"+JSON.stringify(t))}(e)),function(e,t){if(e){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}}(n,function(e){return"compliance-export-"+(new Date).toISOString()+"."+e}(t))}(null===(n=K.getState())||void 0===n?void 0:n.entities,t)}}},i&&{actions:[{title:"View in inventory",onClick:function(e,t,n){var r=n.id,o="beta"===window.location.pathname.split("/")[1];window.location.href="".concat(window.location.origin).concat(o?"/beta":"","/insights/inventory/").concat(r)}}]}))))};ce.propTypes={columns:f().arrayOf(f().shape({})),policies:f().arrayOf(f().shape({})),showAllSystems:f().bool,policyId:f().string,query:f().oneOfType([f().string,f().object]),showActions:f().bool,enableExport:f().bool,compliantFilter:f().bool,showOnlySystemsWithTestResults:f().bool,showOsFilter:f().bool,showComplianceSystemsInfo:f().bool,error:f().object,compact:f().bool,remediationsEnabled:f().bool,defaultFilter:f().string,systemProps:f().shape({isFullView:f().bool}),emptyStateComponent:f().node,prependComponent:f().node,showOsMinorVersionFilter:f().oneOfType([f().bool,f().arrayOf(f().string)]),preselectedSystems:f().array,onSelect:f().func,noSystemsTable:f().node},ce.defaultProps={policyId:"",showActions:!0,enableExport:!0,compliantFilter:!1,showOnlySystemsWithTestResults:!1,showComplianceSystemsInfo:!1,compact:!1,remediationsEnabled:!0,preselectedSystems:[]};const ae=ce},82176:(e,t,n)=>{"use strict";n.d(t,{T4:()=>s,TU:()=>c,qN:()=>l});var r=n(96156);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return!e.compliant}))}))},c=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return e.compliant}))}))},a=function(e){return e.testResultProfiles?s(e.testResultProfiles):[]},l=function(e){return e.map((function(e){return i(i({},e),{},{ruleObjectsFailed:a(e),profiles:e.testResultProfiles})}))}},99030:(e,t,n)=>{"use strict";n.d(t,{zw:()=>l,UP:()=>u,Nw:()=>p});var r=n(96156),o=n(18546),i=n(79886);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=function(e,t){return e.map((function(e){return c(c({},e),{},{selected:t.map((function(e){return e.id})).includes(e.id)})}))},l=function(e,t){var n;return(0,o.Gg)((n={},(0,r.Z)(n,"INVENTORY_INIT",(function(){return{rows:[],total:0,columns:t}})),(0,r.Z)(n,e.LOAD_ENTITIES_PENDING,(function(e){return c(c({},e),{},{columns:t})})),(0,r.Z)(n,e.LOAD_ENTITIES_FULFILLED,(function(e){return c(c({},e),{},{columns:e.total>0?t:[{title:""}],rows:null!=e&&e.selectedEntities?a(e.rows,e.selectedEntities):e.rows})})),(0,r.Z)(n,"RESET_PAGE",(function(e){return c(c({},e),{},{page:1})})),(0,r.Z)(n,"SELECT_ENTITIES",(function(e,t){var n=t.payload.selected;return c(c({},e),{},{selectedEntities:n,rows:a(e.rows,n)})})),n))},u=function(e){return e?e.reduce((function(e,t){var n=t.osMinorVersion;return null!=n&&(e[n]=e[n]||{osMinorVersion:n,count:0}).count++,e}),{}):{}},p=function(e){return Object.values(u(e)).sort((0,i.S)("osMinorVersion","desc"))}}}]);
//# sourceMappingURL=../sourcemaps/EditPolicy.80ba491302a4291eb167.js.map