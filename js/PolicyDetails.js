(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1127:function(e,t,n){var a=n(1128);"string"==typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(9)(a,i);a.locals&&(e.exports=a.locals)},1128:function(e,t,n){(e.exports=n(7)(!1)).push([e.i,".threshold-tooltip{margin-bottom:var(--pf-global--spacer--md)}.grey-icon{color:var(--pf-global--Color--200)}.policy-description{padding-top:10px}\n",""])},1143:function(e,t,n){"use strict";n.r(t);var a=n(64),i=n.n(a),r=n(65),o=n.n(r),s=n(66),l=n.n(s),c=n(67),p=n.n(c),u=n(229),d=n.n(u),m=n(68),h=n.n(m),v=n(628),b=n.n(v),f=n(484),y=n.n(f),g=n(1),E=n.n(g),O=n(0),j=n.n(O),T=n(464),I=n(629),C=n(491),k=n(711),P=n(724),w=n(487),S=n(715),R=n(727),M=n(645),A=n(697),B=n(1144),F=n(568),N=function(e){function t(){var e,n;i()(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=l()(this,(e=p()(t)).call.apply(e,[this].concat(r)))).handleBusinessObjective=function(){var e=n.props,t=e.businessObjective,a=e.editPolicyBusinessObjective,i=e.mutate;return void 0===a?Promise.resolve(t?t.id:null):a&&!a.create&&t&&a.value!==t.id?Promise.resolve(a.value):a&&!a.create&&null===t?Promise.resolve(a.value):null===a?Promise.resolve(null):a.create?i({mutation:F.c,variables:{input:{title:a.label}}}).then((function(e){return e.data.createBusinessObjective.businessObjective.id})):void 0},n.onClick=function(){var e=n.props,t=e.mutate,a=e.policyId,i=e.threshold,r=e.onClick;return n.handleBusinessObjective().then((function(e){var n={id:a,complianceThreshold:parseFloat(i)};return e&&(n.businessObjectiveId=e),t({mutation:F.f,variables:{input:n}})})).then((function(){r()}))},n}return h()(t,e),o()(t,[{key:"render",value:function(){return E.a.createElement(M.a,{type:"submit",variant:"primary",onClick:this.onClick},"Save")}}]),t}(E.a.Component);N.propTypes={policyId:j.a.string.isRequired,businessObjective:j.a.object,editPolicyBusinessObjective:j.a.object,mutate:j.a.func.isRequired,threshold:j.a.number,onClick:j.a.func.isRequired};var _=Object(B.a)(F.f)(N),q=n(569),H=n(746),W=n(45),L=n(735),x=n.n(L),D=function(e){function t(e){var n;return i()(this,t),(n=l()(this,p()(t).call(this,e))).handleModalToggle=function(){var e=n.state.isModalOpen;insights.chrome.appAction(e?"":"edit-business-objective"),n.setState((function(){return{isModalOpen:!e,businessObjective:n.props.businessObjective}})),n.props.onClose()},n.onToggle=function(e){n.setState({isOpen:e})},n.onSelect=function(){n.setState({isOpen:!n.state.isOpen})},n.state={isOpen:!1,isModalOpen:!1,policyId:e.policyId,businessObjective:e.businessObjective},n}return h()(t,e),o()(t,[{key:"render",value:function(){var e=this.state,t=e.policyId,n=e.isOpen,a=e.isModalOpen,i=e.businessObjective,r=this.props,o=r.previousThreshold,s=r.editPolicyBusinessObjective,l=r.complianceThreshold,c=r.dispatch,p=[E.a.createElement(k.a,{key:"action",onClick:this.handleModalToggle,component:"button"},"Edit policy")];return E.a.createElement(E.a.Fragment,null,E.a.createElement(P.a,{onSelect:this.onSelect,className:"policy-details-dropdown",position:w.d.right,toggle:E.a.createElement(S.a,{onToggle:this.onToggle},"Actions"),isOpen:n,dropdownItems:p}),E.a.createElement(R.a,{isSmall:!0,title:"Edit policy details",isOpen:a,onClose:this.handleModalToggle,isFooterLeftAligned:!0,actions:[E.a.createElement(M.a,{key:"cancel",variant:"secondary",onClick:this.handleModalToggle},"Cancel"),E.a.createElement(_,{key:"confirm",policyId:t,threshold:x()(parseFloat(l||o),1),businessObjective:i,editPolicyBusinessObjective:s,onClick:this.handleModalToggle})]},E.a.createElement(A.a,null,E.a.createElement(q.b,{businessObjective:i,policyId:t,dispatch:c}),E.a.createElement(q.c,{previousThreshold:o}))))}}]),t}(g.Component);D.propTypes={policyId:j.a.string,previousThreshold:j.a.number,businessObjective:j.a.object,editPolicyBusinessObjective:j.a.object,complianceThreshold:j.a.string,onClose:j.a.func,dispatch:j.a.func};var J=Object(H.a)("policyForm"),Q=Object(W.connect)((function(e){return{complianceThreshold:J(e,"complianceThreshold"),editPolicyBusinessObjective:J(e,"businessObjective")}}))(D),U=n(747),V=n(561),$=n(174),Y=function(e){var t=e.loading,n=e.policy;return E.a.createElement(E.a.Fragment,null,E.a.createElement(U.a,{variant:"info",isInline:!0,title:"Rule editing coming soon"}),E.a.createElement(V.SystemRulesTable,{remediationsEnabled:!1,columns:[{title:"Rule",transforms:[$.a]},{title:"Severity",transforms:[$.a]},{title:E.a.createElement(E.a.Fragment,null,V.ANSIBLE_ICON," Ansible"),transforms:[$.a],original:"Ansible"}],loading:t,profileRules:!t&&[{profile:{refId:n.refId,name:n.name},rules:n.rules}]}))};Y.propTypes={loading:j.a.bool,policy:j.a.shape({name:j.a.string,refId:j.a.string,rules:j.a.array})};var z=Y,G=function(e){var t=e.policy,n=e.systemsTableRef;return E.a.createElement(q.d,{policyId:t.id,columns:[{composed:["facts.os_release","display_name"],key:"display_name",title:"System name",props:{width:40}},{key:"facts.compliance.compliance_score",title:"Compliance score",props:{width:10}},{key:"facts.compliance.last_scanned",title:"Last scanned",props:{width:10}}],ref:n})};G.propTypes={policy:j.a.shape({id:j.a.string.isRequired}),systemsTableRef:j.a.object};var K=G,X=n(496),Z=n.n(X),ee=n(63),te=n(481),ne=n.n(te),ae=(n(574),n(1127),n(717)),ie=n(718),re=n(641),oe=n(642),se=n(53);function le(){var e=y()(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        businessObjective {\n            id\n            title\n        }\n        rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n    }\n}\n"]);return le=function(){return e},e}n.d(t,"QUERY",(function(){return ce})),n.d(t,"PolicyDetailsQuery",(function(){return pe})),n.d(t,"PolicyDetails",(function(){return ue}));var ce=ne()(le()),pe=function(e){var t=e.policyId,n=e.onNavigateWithProps,a=Object(T.b)(ce,{variables:{policyId:t}}),i=a.data,r=a.error,o=a.loading,s=a.refetch,l=Object(g.useRef)(),c=Object(g.useState)(0),p=b()(c,2),u=p[0],d=p[1],m={};return r?(401===r.networkError.statusCode&&window.insights.chrome.auth.logout(),"Oops! Error loading Policy data: "+r):o?E.a.createElement(E.a.Fragment,null,E.a.createElement(ee.PageHeader,null,E.a.createElement(C.h,null)),E.a.createElement(ee.Main,null,E.a.createElement(ee.Spinner,null))):(m=i.profile,E.a.createElement(E.a.Fragment,null,E.a.createElement(ee.PageHeader,{className:"beta-page-header"},E.a.createElement(ae.a,null,E.a.createElement(ie.a,{to:"/rhel/compliance/policies",onClick:function(e){return n(e)}},"Policies"),E.a.createElement(ie.a,{isActive:!0},m.name)),E.a.createElement(re.a,null,E.a.createElement(oe.a,{span:10},E.a.createElement(ee.PageHeaderTitle,{title:m.name})),E.a.createElement(oe.a,{span:1},E.a.createElement(se.Link,{to:"/reports/"+m.id},E.a.createElement(M.a,{variant:"primary"},"View reports"))),E.a.createElement(oe.a,{span:1},E.a.createElement(Q,{policyId:m.id,previousThreshold:m.complianceThreshold,businessObjective:m.businessObjective,onClose:function(){s(),l.current.getWrappedInstance().systemFetch(),l.current.getWrappedInstance().forceUpdate()}}))),E.a.createElement(C.j,{activeTab:u,setActiveTab:d})),E.a.createElement(ee.Main,null,function(e){switch(e){case 0:return E.a.createElement(C.i,{policy:m});case 1:return E.a.createElement(z,{policy:m,loading:o});case 2:return E.a.createElement(K,{policy:m,systemsTableRef:l})}}(u))))};pe.propTypes={policyId:j.a.string,onNavigateWithProps:j.a.func};var ue=function(e){function t(e){var n;return i()(this,t),(n=l()(this,p()(t).call(this,e))).onNavigate=I.a.bind(d()(n)),n}return h()(t,e),o()(t,[{key:"render",value:function(){return E.a.createElement(pe,{policyId:this.props.match.params.policy_id,onNavigateWithProps:this.onNavigate})}}]),t}(E.a.Component);ue.propTypes={match:j.a.object};t.default=Z()(ue)},629:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(128);function i(e,t){e.preventDefault();var n=e.target.pathname.replace(a.b,"");(t||this.props.history).push(n)}}}]);
//# sourceMappingURL=../sourcemaps/PolicyDetails.js.map