"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[264],{22264:(e,t,n)=>{n.r(t),n.d(t,{default:()=>re});var r=n(45987),l=n(4942),o=n(30168),a=n(92950),s=n.n(a),i=n(45697),c=n.n(i),p=n(93433),u=n(15671),m=n(43144),d=n(60136),y=n(82963),f=n(61120),h=n(15040),g=n(87462),v=n(97326),E=n(68778),P=n(43047),b=n(62410),Z=n(67585),T=n(91290),S=n(72971),R=function(e){var t=e.ssgVersion,n=e.style,r=s().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:S.iK},"Supported SSG versions");return s().createElement(h.Alert,{variant:"warning",isInline:!0,style:n,title:s().createElement(s().Fragment,null,"Unsupported SSG version (",t,")",s().createElement(h.Popover,{position:"right",bodyContent:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:r},s().createElement(T.ZP,{style:{marginLeft:".5em",cursor:"pointer",color:"var(--pf-global--Color--200)"}})))})};R.propTypes={ssgVersion:c().string,style:c().object};const x=R;var w=function(e){(0,d.Z)(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,f.Z)(t);if(n){var l=(0,f.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,y.Z)(this,e)});function o(){var e;(0,u.Z)(this,o);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e=r.call.apply(r,[this].concat(n)),(0,l.Z)((0,v.Z)(e),"complianceIcon",(function(e){return e?s().createElement("div",{className:"ins-c-policy-card ins-m-compliant"},s().createElement(E.ZP,null)," Compliant"):s().createElement("div",{className:"ins-c-policy-card ins-m-noncompliant"},s().createElement(P.ZP,null)," Not compliant")})),(0,l.Z)((0,v.Z)(e),"fixedPercentage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.toFixed(t)+(n?"%":"")})),e}return(0,m.Z)(o,[{key:"render",value:function(){var e=this.props,t=e.policy,n=e.style,r=t.rulesFailed,l=t.compliant,o=t.lastScanned,a=t.score,i=t.ssgVersion,c=t.supported,p=t.name,u=t.policyType,m=this.fixedPercentage(a),d={expandOnMouseOver:!0,hideExpandText:!0};return s().createElement(h.Card,{style:n},s().createElement(h.CardBody,null,s().createElement(h.TextContent,{className:"margin-bottom-md"},s().createElement(h.Text,{className:"margin-bottom-top-none",component:h.TextVariants.h4},s().createElement(Z.Z,(0,g.Z)({text:p,length:110},d))),s().createElement(h.Text,{style:{color:"var(--pf-global--Color--200)"},component:h.TextVariants.small},s().createElement(Z.Z,(0,g.Z)({text:u,length:110},d)))),s().createElement("div",{className:"margin-bottom-md"},c&&this.complianceIcon(l),s().createElement(h.Text,{component:h.TextVariants.small},r," rule",1===r?"":"s"," failed"," ",s().createElement(h.Tooltip,{position:"bottom",maxWidth:"22em",content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},s().createElement("span",null,"(Score: ",m,")")))),s().createElement(h.Text,{className:"margin-bottom-none",component:h.TextVariants.small},s().createElement(h.Text,null,"SSG version: ",i),s().createElement(h.Text,null,"Last scanned:"," ","Never"!==o?s().createElement(b.Z,{date:Date.parse(o),type:"relative"}):o))),!c&&s().createElement(h.CardFooter,{style:{padding:"0"}},s().createElement(x,{ssgVersion:i,style:{paddingTop:"var(--pf-c-alert--PaddingTop)",paddingRight:"var(--pf-c-card--child--PaddingRight)",paddingLeft:"var(--pf-c-card--child--PaddingLeft)",paddingBottom:"var(--pf-c-alert--PaddingBottom)"}})))}}]),o}(s().Component);w.propTypes={policy:c().shape({rulesPassed:c().number,rulesFailed:c().number,score:c().number,lastScanned:c().string,refId:c().string,name:c().string,policyType:c().string,compliant:c().bool,ssgVersion:c().string,supported:c().bool}),style:c().object};const C=w;var O=n(24561);var I=function(e){(0,d.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,f.Z)(t);if(n){var l=(0,f.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,y.Z)(this,e)});function l(){return(0,u.Z)(this,l),r.apply(this,arguments)}return(0,m.Z)(l,[{key:"systemPolicyCards",value:function(){return this.props.policies.filter((function(e){return e.rulesFailed+e.rulesPassed>0})).map((function(e,t){return s().createElement(h.GridItem,{sm:12,md:12,lg:6,xl:4,key:t},s().createElement(C,{policy:e,style:{height:"100%"}}))}))}},{key:"render",value:function(){var e=this.props.loading;return s().createElement(s().Fragment,null,s().createElement(h.Grid,{hasGutter:!0},this.systemPolicyCards(),e&&(0,p.Z)(Array(3)).map((function(e,t){return s().createElement(h.GridItem,{span:4,key:t},s().createElement(h.Card,null,s().createElement(h.CardBody,null,s().createElement(O.mr,null))))}))))}}]),l}(s().Component);I.propTypes={policies:c().array,loading:c().bool},I.defaultProps={policies:[]};const B=I;var k=n(91989),j=n(19949),F=n(90570),N=n(67521),V=n(73980),A=n(48830),G=n(76309),L=n(6023),_=n(69888),D=n(19232),z=n(7162),q=function(e){var t,n,r,l=e.system;return null==l||!l.hasPolicy||null!=l&&null!==(t=l.testResultProfiles)&&void 0!==t&&t.length?s().createElement(s().Fragment,null):s().createElement(h.Bullseye,null,s().createElement(h.EmptyState,null,s().createElement(h.EmptyStateIcon,{icon:z.ZP,title:"Compliance",size:"xl",style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"}}),s().createElement(h.Title,{headingLevel:"h1",size:"lg"},"No results reported"),s().createElement(h.EmptyStateBody,null,"This system is part of ",null==l||null===(n=l.policies)||void 0===n?void 0:n.length,(null==l||null===(r=l.policies)||void 0===r?void 0:r.length)>1?" policies":" policy",", but has not returned any results."),s().createElement(h.EmptyStateBody,null,"Reports are returned when the system checks into Insights. By default, systems check in every 24 hours.")))};q.propTypes={system:c().shape({hasPolicy:c().bool,testResultProfiles:c().array,policies:c().array})};const U=q;var W=n(7081),$=function(e){var t=e.system;return null!=t&&t.hasPolicy?s().createElement(s().Fragment,null):s().createElement(h.Bullseye,null,s().createElement(h.EmptyState,null,s().createElement(h.EmptyStateIcon,{icon:W.ZP}),s().createElement(h.Title,{headingLevel:"h1",size:"lg"},"This system is not part of any SCAP policies defined within Compliance."),s().createElement(h.EmptyStateBody,null,"To assess and monitor compliance against a SCAP policy for this system, add it to an existing policy or create a new policy."),s().createElement(h.EmptyStatePrimary,null,s().createElement(_.mR,{to:"/scappolicies/new"},s().createElement(h.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))),s().createElement(h.EmptyStateSecondaryActions,null,s().createElement(h.Button,{variant:"link",component:"a",href:"/insights/compliance/scappolicies"},"View compliance policies"))))};$.propTypes={system:c().shape({hasPolicy:c().bool})};const K=$;var M,H=n(334),J=["customItnl","customRouter","intlProps"];function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Y=(0,N.ZP)(M||(M=(0,o.Z)(["\n  query System($systemId: String!) {\n    system(id: $systemId) {\n      id\n      name\n      hasPolicy\n      policies {\n        id\n      }\n      testResultProfiles {\n        id\n        name\n        policyType\n        refId\n        compliant\n        rulesFailed\n        rulesPassed\n        lastScanned\n        score\n        supported\n        ssgVersion\n        majorOsVersion\n        policy {\n          id\n        }\n        rules {\n          title\n          severity\n          rationale\n          refId\n          description\n          compliant\n          remediationAvailable\n          references\n          identifier\n        }\n      }\n    }\n  }\n"]))),ee=function(e){var t,n=e.data.system,r=e.loading,l=e.hidePassed;return s().createElement(s().Fragment,null,s().createElement(B,{policies:null==n?void 0:n.testResultProfiles,loading:r}),s().createElement(K,{system:n}),s().createElement(U,{system:n}),s().createElement("br",null),null!=n&&null!==(t=n.testResultProfiles)&&void 0!==t&&t.length?s().createElement(k.Z,{remediationAvailableFilter:!0,handleSelect:function(){},hidePassed:l,system:X(X({},n),{},{supported:((null==n?void 0:n.testResultProfiles)||[]).filter((function(e){return e.supported})).length>0}),profileRules:null==n?void 0:n.testResultProfiles.map((function(e){return{system:n,profile:e,rules:e.rules}})),loading:r,options:{sortBy:{index:4,direction:"asc",property:"severity"}}}):void 0)};ee.propTypes={data:c().shape({system:c().shape({hasPolicy:c().bool,policies:c().shape({id:c().string}),profiles:c().array,testResultProfiles:c().array})}),loading:c().bool,hidePassed:c().bool},ee.defaultProps={loading:!0};var te=function(e){var t,n=e.inventoryId,r=e.hidePassed,l=e.client,o=(0,F.a)(Y,{variables:{systemId:n},client:l,fetchPolicy:"no-cache"}),a=o.data,i=o.error,c=o.loading,p=404===(null==i||null===(t=i.networkError)||void 0===t?void 0:t.statusCode);if(c)return s().createElement(L.Z,null);if(i&&!p){var u="Oops! Error loading System data: ".concat(i);return s().createElement(_._U,{message:u})}return s().createElement("div",{className:"ins-c-compliance__scope"},null==a||!a.system||p?s().createElement(j.Z,{title:"No policies are reporting for this system"}):s().createElement(ee,{hidePassed:r,data:a,loading:c}))};te.propTypes={inventoryId:c().string,client:c().object,hidePassed:c().bool},te.defaultProps={client:new V.fe({link:new A.u({uri:"/api/compliance/graphql",credentials:"include"}),cache:new G.h4})};var ne=function(e){var t=e.customItnl,n=e.customRouter,l=e.intlProps,o=(0,r.Z)(e,J),a=t?D.Z:s().Fragment,i=n?H.BrowserRouter:s().Fragment;return s().createElement(i,null,s().createElement(a,t&&l,s().createElement(te,o)))};ne.propTypes={customItnl:c().bool,intlProps:c().any,customRouter:c().bool};const re=ne}}]);