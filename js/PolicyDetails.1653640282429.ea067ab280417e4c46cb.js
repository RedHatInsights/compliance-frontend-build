"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[6705,8402],{77388:(e,t,n)=>{n.r(t),n.d(t,{PolicyDetails:()=>q,QUERY:()=>Z,default:()=>x});var i=n(30168),r=n(92950),l=n.n(r),o=n(45697),a=n.n(o),s=n(67521),c=n(334),d=n(90570),u=n(89624),m=n(80123),p=n(39173),y=n(14748),E=n(97481),h=n(16051),f=n(52710),b=n(7648),v=n(94263),g=function(e){var t=e.policy,n=(0,f.Wb)();return l().createElement(u.ToolbarItem,null,l().createElement(h.mR,{to:"/scappolicies/".concat(t.id,"/edit"),state:{policy:t},hash:n,backgroundLocation:{hash:n}},l().createElement(u.Button,{variant:"primary",ouiaId:"EditRulesButton"},"Edit rules")))};g.propTypes={policy:a().object.isRequired};const I=g;var T=function(e){var t=e.loading,n=e.policy;return l().createElement(l().Fragment,null,l().createElement(u.Alert,{isInline:!0,ouiaId:"RuleEditingAvailableAlert",variant:"info",title:"Rule editing is now available."},'SCAP policies created before April 19th, 2021 with rule editing will use the full default set of rules for the policy with the most accurate benchmark for systems within the policy. Click the "Edit rules" or "Edit policy" button to edit rules.'),l().createElement(u.PageSection,{variant:u.PageSectionVariants.light},l().createElement(u.Text,{component:u.TextVariants.p},l().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",n.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),l().createElement(h.iK,{remediationsEnabled:!1,columns:[v.VG,v.zb,v.uH],loading:t,profileRules:[{profile:{refId:n.refId,name:n.name},rules:n.rules}],options:{dedicatedAction:function(){return l().createElement(I,{policy:n})}}}))};T.propTypes={loading:a().bool,policy:a().shape({name:a().string,refId:a().string,rules:a().array,benchmark:a().object})};const V=T;var P=n(87242),S=n(27803),M=n(31499),w=function(e){var t,n=e.policy;return l().createElement(P.r0,{columns:[M.Zw({showLink:!0}),M.MO("tags"),M.OS,M.hN],showOsMinorVersionFilter:[n.osMajorVersion],query:S.Mb,policyId:n.id,defaultFilter:"policy_id = ".concat(n.id),showActions:!1,remediationsEnabled:!1,noSystemsTable:0===(null==n||null===(t=n.hosts)||void 0===t?void 0:t.length)&&l().createElement(h.JS,null),complianceThreshold:n.complianceThreshold})};w.propTypes={policy:a().shape({id:a().string.isRequired,complianceThreshold:a().number.isRequired,osMajorVersion:a().string.isRequired,hosts:a().array.isRequired}),systemTableProps:a().object};const R=w;var k=n(99030),j=n(79886),K=function(e){var t=e.policy,n=t.hosts,i=t.policy.profiles.filter((function(e){return!!e.osMinorVersion})),r=(0,k.UP)(n),o=i.sort((0,j.Sj)("osMinorVersion","desc")).map((function(e){var t;return{profile:e,systemCount:(null===(t=r[e.osMinorVersion])||void 0===t?void 0:t.count)||0}}));return l().createElement(l().Fragment,null,l().createElement(u.PageSection,{variant:u.PageSectionVariants.light},l().createElement(h.Hv,{tabsData:o,columns:[v.VG,v.zb,v.uH],level:1,options:{dedicatedAction:function(){return l().createElement(I,{policy:t})}},ouiaId:"RHELVersions"})))};K.propTypes={policy:a().object.isRequired};const A=K;var C,Z=(0,s.ZP)(C||(C=(0,i.Z)(["\n  query Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      external\n      description\n      totalHostCount\n      compliantHostCount\n      complianceThreshold\n      osMajorVersion\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        refId\n        profiles {\n          id\n          ssgVersion\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          benchmark {\n            id\n            title\n            latestSupportedOsMinorVersions\n            osMajorVersion\n          }\n          rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationIssueId\n            identifier\n            precedence\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n      hosts {\n        id\n        osMinorVersion\n      }\n      benchmark {\n        id\n        title\n        version\n      }\n      rules {\n        title\n        severity\n        rationale\n        refId\n        description\n        remediationIssueId\n        identifier\n        precedence\n      }\n    }\n  }\n"]))),q=function(e){var t,n,i=e.route,o="details",a=(0,c.useParams)().policy_id,s=(0,c.useLocation)(),v=(0,f.Wb)(),g=(0,d.a)(Z,{variables:{policyId:a}}),I=g.data,T=g.error,P=g.loading,S=g.refetch,M=!0;return I&&!P&&(M=!!(n=I.profile).policy.profiles.find((function(e){return!!e.osMinorVersion}))),(0,r.useEffect)((function(){S()}),[s,S]),(0,b.a)(i,null===(t=n)||void 0===t?void 0:t.name),l().createElement(h.tC,{stateValues:{error:T,data:I,loading:P}},l().createElement(h.K7,{stateKey:"loading"},l().createElement(m.Z,null,l().createElement(h.PL,null)),l().createElement(y.Z,null,l().createElement(E.Z,null))),l().createElement(h.K7,{stateKey:"data"},n&&l().createElement(r.Fragment,null,l().createElement(m.Z,{className:"page-header-tabs"},l().createElement(u.Breadcrumb,{ouiaId:"PolicyDetailsPathBreadcrumb"},l().createElement(h.MU,{to:"/"},"Compliance"),l().createElement(h.MU,{to:"/scappolicies"},"SCAP policies"),l().createElement(u.BreadcrumbItem,{isActive:!0},n.name)),l().createElement(u.Grid,{gutter:"lg"},l().createElement(u.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},l().createElement(p.Z,{title:n.name})),l().createElement(u.GridItem,{className:"policy-details-button",xl2:1,xl:2,lg:2,md:3,sm:3},l().createElement(h.mR,{to:"/scappolicies/".concat(n.id,"/edit"),state:{policy:n},hash:v,backgroundLocation:{hash:"details"}},l().createElement(u.Button,{variant:"secondary",ouiaId:"EditPolicyButton"},"Edit policy")))),l().createElement(h.tn,{"aria-label":"Policy Tabs",ouiaId:"PolicyDetailsTabs",defaultTab:o},l().createElement(u.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),l().createElement(u.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),l().createElement(u.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),l().createElement(y.Z,null,l().createElement(h.Jm,{defaultTab:o},l().createElement(h.X8,{eventKey:"details"},l().createElement(h.NP,{policy:n})),l().createElement(h.X8,{eventKey:"rules"},M?l().createElement(A,{policy:n}):l().createElement(V,{policy:n})),l().createElement(h.X8,{eventKey:"systems"},l().createElement(R,{policy:n})))))))};q.propTypes={route:a().object};const x=q}}]);
//# sourceMappingURL=../sourcemaps/PolicyDetails.3ce2af54ebcfdd7822d660581ee6a23c.js.map