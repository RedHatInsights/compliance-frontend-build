(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[938,643],{6474:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n.Z});var n=r(51198)},74560:(e,t,r)=>{"use strict";r.d(t,{Z:()=>P});var n=r(87462),o=r(4942),a=r(70885),i=r(45987),c=r(92950),l=r.n(c),s=r(45697),u=r.n(s),p=r(58061),m=r(76450),d=r(41304),f=r(82176),h=r(75659),y=r(55817),v=r(16575),b=r(94263),g=r(88928),E=r(77346),O=["system","profileRules","columns","remediationsEnabled","ansibleSupportFilter","selectedFilter","handleSelect","selectedRules","hidePassed","options","activeFilters","showFailedCounts"];function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var w=function(e){var t=e.system,r=e.profileRules,o=e.columns,s=void 0===o?b.ZP:o,u=e.remediationsEnabled,T=void 0===u||u,w=e.ansibleSupportFilter,P=void 0!==w&&w,j=e.selectedFilter,Z=void 0!==j&&j,C=e.handleSelect,S=e.selectedRules,R=void 0===S?[]:S,k=e.hidePassed,I=void 0!==k&&k,N=e.options,V=e.activeFilters,F=e.showFailedCounts,L=void 0!==F&&F,D=(0,i.Z)(e,O),_=(0,E.ZP)("ruleGroups"),H=C?[R,C]:(0,c.useState)([]),B=(0,a.Z)(H,2),A=B[0],M=B[1],q=(0,f.uJ)(r),K=function(e){return(e||[]).filter((function(e){return e.remediationAvailable}))},U=s.filter((function(e){return"Rule state"===e.title})).length>0,z=r.filter((function(e){return!!e.profile})).map((function(e){var t=e.profile;return{id:t.id,name:t.name}}));return l().createElement(d.v,(0,n.Z)({"aria-label":"Rules Table",items:q,columns:s,isStickyHeader:!0,filters:x({filterConfig:(0,v.ZP)({showRuleStateFilter:U,policies:z,ansibleSupportFilter:P})},I&&{activeFilters:function(e){return x(x({},e),{},{passed:e.passed?e.passed:["failed"]},V)}}),options:x(x(x(x({},_?{tableTree:(0,g.w)(r[0].profile,q,L)}:{}),p.yi),N),{},{identifier:g.B,onSelect:(C||T)&&M,preselected:A,detailsComponent:h.Z,emptyRows:(0,y.Z)(s),selectedFilter:Z},T?{dedicatedAction:function(e){var r=e.selected;return l().createElement(m.Z,{allSystems:r.length>0?[t]:void 0,selectedRules:K(r)})}}:{})},D))};w.propTypes={profileRules:u().array,loading:u().bool,hidePassed:u().bool,system:u().object,remediationsEnabled:u().bool,ansibleSupportFilter:u().bool,selectedRules:u().array,selectedFilter:u().bool,handleSelect:u().func,columns:u().array,options:u().object,activeFilters:u().object,showFailedCounts:u().number};const P=w},56085:(e,t,r)=>{"use strict";r.d(t,{Hv:()=>b,uU:()=>d.uU,TB:()=>d.TB,b4:()=>d.b4});var n=r(42982),o=r(45987),a=r(92950),i=r.n(a),c=r(45697),l=r.n(c),s=r(65115),u=r(85836),p=r(4940),m=r(15293),d=r(87968),f=["tabsData","defaultTab","selectedRuleRefIds","setSelectedRuleRefIds","columns","level","ouiaId","resetLink","rulesPageLink"],h=function(e,t){var r=e.id,n=e.osMinorVersion;return"rules-".concat(r,"-").concat(n||t)},y=function(e,t){if(e&&0!==e.length){if(!t){var r=e[0];t={id:r.profile.id,osMinorVersion:r.profile.osMinorVersion||r.newOsMinorVersion}}return h(t)}},v=function(e){var t=e.tabsData,r=e.defaultTab,c=e.selectedRuleRefIds,l=e.setSelectedRuleRefIds,v=e.columns,b=e.level,g=void 0===b?0:b,E=e.ouiaId,O=e.resetLink,T=e.rulesPageLink,x=(0,o.Z)(e,f),w=(0,a.useCallback)((function(e,t,r){var o=(c||[]).filter((function(r){return!(0,d.Tn)(r,e,t)})),a={id:e.id,osMinorVersion:t||e.osMinorVersion,ruleRefIds:r};l([a].concat((0,n.Z)(o)))}),[c]);return i().createElement(u.tn,{ouiaId:E,level:g,defaultTab:y(t,r)},null==t?void 0:t.map((function(e){var t=e.profile,r=e.newOsMinorVersion,n=e.systemCount;return i().createElement(s.Tab,{key:h(t,r),eventKey:h(t,r),title:i().createElement("span",null,i().createElement("span",{className:"pf-u-pr-sm"},i().createElement(m.Z,{profile:t,newOsMinorVersion:r})),i().createElement(s.Badge,{isRead:!0},n)),ouiaId:"RHEL ".concat(t.osMajorVersion,".").concat(t.osMinorVersion||r)},i().createElement(p.Z,{profile:t,newOsMinorVersion:r,columns:v,rulesTableProps:x,systemCount:n,selectedRuleRefIds:(0,d.p$)(c,t,r),handleSelect:l?w:void 0,resetLink:O,rulesPageLink:T}))})))};v.propTypes={tabsData:l().arrayOf(l().shape({profile:l().object.isRequired,selectedRuleRefIds:l().arrayOf(l().string),newOsMinorVersion:l().string,systemCount:l().number})).isRequired,selectedRuleRefIds:l().arrayOf(l().shape({id:l().string,ruleRefIds:l().arrayOf(l().string)})),setSelectedRuleRefIds:l().func,columns:l().arrayOf(l().object),defaultTab:l().shape({id:l().string,osMinorVersion:l().string}),level:l().number,ouiaId:l().string,resetLink:l().bool,rulesPageLink:l().bool};const b=v},85836:(e,t,r)=>{"use strict";r.d(t,{mR:()=>Ce,MU:()=>Ne,C:()=>Ft,OF:()=>A,C$:()=>ht.Z,MT:()=>It.Z,X8:()=>pe,_U:()=>I.Z,mf:()=>k,AY:()=>N.Z,Nj:()=>Dt,Qj:()=>zt,nv:()=>qt,Ir:()=>j,JS:()=>Rt,V_:()=>rt,xB:()=>We,PL:()=>q,NP:()=>W,o$:()=>ze.Z,w8:()=>Ge.Z,_z:()=>ft,ko:()=>ce,Tq:()=>K,vu:()=>oe,vm:()=>Ue,Ek:()=>qe,Jm:()=>he,tn:()=>ye,iK:()=>kt.Z,Se:()=>ge,K7:()=>ve,tC:()=>Ee,Zr:()=>Ct,bL:()=>vt,UN:()=>Oe.Z,Hv:()=>St.Hv,cT:()=>jt,Vs:()=>Oe.V,fz:()=>Te.Z,zf:()=>_t.Z,Oq:()=>B});var n=r(42982),o=r(92950),a=r.n(o),i=r(3351),c=r(6934),l=r(22860),s=r(96541),u=r(45697),p=r.n(u),m=r(65115),d=r(46818),f=r(79886),h=function(e){var t=e.id,r=e.policy,n=e.policyType;return a().createElement(m.TextContent,null,a().createElement(qt,{to:"/scappolicies/"+t},r.name),a().createElement(N.Z,null,n))};h.propTypes={id:p().string,policy:p().object,policyType:p().string};var y={title:"Name",props:{width:45},sortByProp:"name",renderExport:function(e){return e.name},renderFunc:(0,f.SO)(h)},v=function(e){return"RHEL ".concat(e.osMajorVersion)},b={title:"Operating system",transforms:[d.E0],props:{width:15},sortByProp:"osMajorVersion",renderExport:v,renderFunc:function(e,t,r){return v(r)}},g={title:"Systems",props:{width:15},sortByProp:"totalHostCount",renderExport:function(e){return e.totalHostCount},renderFunc:function(e,t,r){return r.totalHostCount>0?r.totalHostCount:a().createElement(Oe.Z,{count:r.totalHostCount,variant:"count"})}},E=function(e){return e.businessObjective&&e.businessObjective.title||"--"},O={title:"Business objective",sortByFunction:function(e){var t;return null==e||null===(t=e.businessObjective)||void 0===t?void 0:t.title},renderExport:E,renderFunc:function(e,t,r){return E(r)}},T=function(e){return"".concat(e.complianceThreshold,"%")},x={title:"Compliance threshold",sortByProp:"complianceThreshold",renderExport:T,renderFunc:function(e,t,r){return T(r)}},w=[y,{title:"Policy Type",renderExport:function(e){return e.policyType}},b,g,O,x];const P=[y,b,g,O,x],j=function(){return a().createElement(i.i,{"aria-label":"policies-table",ouiaId:"PoliciesTable",cells:P,rows:(0,n.Z)(Array(5)).map((function(){return{cells:[{title:a().createElement(s.Z,null),colSpan:5}]}}))},a().createElement(c.x,null),a().createElement(l.R,null))};var Z=r(56700),C=r(85333),S=r(2443),R=function(e){var t=e.error;return t.networkError&&401===t.networkError.statusCode?(window.insights.chrome.auth.logout(!0),!1):t.networkError&&403===t.networkError.statusCode?a().createElement(C.Z,{serviceName:"Compliance"}):t.networkError&&404===t.networkError.statusCode?a().createElement(Z.Z,null):a().createElement(S.Z,null)};R.propTypes={error:p().object};const k=R;var I=r(54288),N=r(22169),V=(r(4745),r(56082),r(53947),r(44948),r(87462)),F=r(73479),L=r(68778),D=r(43047),_=r(11443),H=function(e){return e.supported||0===e.score?e.compliant?a().createElement(L.ZP,{color:"var(--pf-global--success-color--200)"}):a().createElement(D.ZP,{color:"var(--pf-global--danger-color--100)"}):a().createElement(F.ZP,{color:"var(--pf-global--disabled-color--100)"})},B=function(e){return e.supported?e.score||0===e.score?" "+(0,_.P0)(e.score):" N/A":" Unsupported"};const A=function(e){return a().createElement(m.Text,null,e.supported?a().createElement(m.Tooltip,{content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},a().createElement("span",null,a().createElement(H,(0,V.Z)({key:"system-compliance-icon-".concat(e.id)},e)),B(e))):B(e))};var M=r(24561);const q=function(){return a().createElement(M.ZP,{speed:2,width:1e3,height:400,viewBox:"0 0 1000 400",backgroundcolor:"#f3f3f3",foregroundcolor:"#ecebeb"},a().createElement("rect",{x:"-3",y:"7",rx:"3",ry:"3",width:"760",height:"19"}),a().createElement("rect",{x:"823",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),a().createElement("rect",{x:"910",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),a().createElement("rect",{x:"6",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),a().createElement("rect",{x:"68",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),a().createElement("rect",{x:"133",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),a().createElement("rect",{x:"3",y:"110",rx:"0",ry:"0",width:"255",height:"17"}),a().createElement("rect",{x:"1",y:"149",rx:"0",ry:"0",width:"47",height:"16"}),a().createElement("rect",{x:"1",y:"185",rx:"0",ry:"0",width:"255",height:"17"}),a().createElement("rect",{x:"-1",y:"224",rx:"0",ry:"0",width:"187",height:"16"}),a().createElement("rect",{x:"-4",y:"267",rx:"0",ry:"0",width:"255",height:"17"}),a().createElement("rect",{x:"-6",y:"306",rx:"0",ry:"0",width:"47",height:"16"}),a().createElement("rect",{x:"-6",y:"342",rx:"0",ry:"0",width:"255",height:"17"}),a().createElement("rect",{x:"-8",y:"381",rx:"0",ry:"0",width:"187",height:"16"}))},K=function(){return a().createElement(M.ZP,{height:320,width:1550,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},a().createElement("rect",{x:"18",y:"50",rx:"4",ry:"4",width:"478",height:"15"}),a().createElement("rect",{x:"19",y:"18",rx:"3",ry:"3",width:"220",height:"9"}),a().createElement("circle",{cx:"118",cy:"156",r:"73"}),a().createElement("rect",{x:"1002",y:"40",rx:"0",ry:"0",width:"69",height:"23"}),a().createElement("rect",{x:"47",y:"77",rx:"0",ry:"0",width:"0",height:"0"}),a().createElement("rect",{x:"36",y:"77",rx:"0",ry:"0",width:"16",height:"0"}),a().createElement("rect",{x:"409",y:"149",rx:"0",ry:"0",width:"0",height:"0"}),a().createElement("rect",{x:"214",y:"145",rx:"0",ry:"0",width:"205",height:"9"}),a().createElement("rect",{x:"216",y:"119",rx:"0",ry:"0",width:"205",height:"9"}),a().createElement("rect",{x:"526",y:"100",rx:"0",ry:"0",width:"431",height:"8"}),a().createElement("rect",{x:"526",y:"122",rx:"0",ry:"0",width:"431",height:"8"}),a().createElement("rect",{x:"526",y:"146",rx:"0",ry:"0",width:"431",height:"8"}),a().createElement("rect",{x:"527",y:"170",rx:"0",ry:"0",width:"431",height:"8"}),a().createElement("rect",{x:"527",y:"194",rx:"0",ry:"0",width:"431",height:"8"}),a().createElement("rect",{x:"527",y:"218",rx:"0",ry:"0",width:"431",height:"8"}),a().createElement("rect",{x:"529",y:"275",rx:"0",ry:"0",width:"231",height:"7"}))};var U=r(56163),z=r.n(U),G=r(83637),Y=function(e){var t=e.policy,r="".concat((0,_.P0)(t.complianceThreshold,1),' of rules must be\n  passed for a system to be labeled "Compliant"'),n=t.businessObjective&&t.businessObjective.title||"-",o=z()(t.description||"");return a().createElement(m.Card,{ouiaId:"PolicyDetailsCard"},a().createElement(m.CardHeader,null,a().createElement(m.Text,{style:{fontSize:20}},a().createElement("b",null,"Policy details"))),a().createElement(m.CardBody,null,a().createElement(m.TextContent,null,a().createElement(m.Text,null,a().createElement(G.Z,{policy:t,text:t.complianceThreshold,variant:"threshold",inlineClosedText:r,label:"Compliance threshold (%)",showTextUnderInline:"true",textUnderInline:"A value of 95% or higher is recommended",propertyName:"complianceThreshold",type:"number",className:"pf-c-form-control pf-u-w-100-on-lg","aria-label":"editable text input",id:"policydetails-input-threshold"})),a().createElement(m.Text,null,a().createElement(G.Z,{policy:t,text:n,variant:"business",inlineClosedText:n,label:"Business objective",propertyName:"businessObjective",typeOfInput:"text"})),a().createElement(m.Text,null,a().createElement(G.Z,{component:m.TextArea,policy:t,text:o,variant:"description",inlineClosedText:n,label:"Policy description",propertyName:"description",className:"pf-c-form-control pf-u-w-100-on-lg"})),a().createElement(m.Text,{component:m.TextVariants.h5},"Operating system"),a().createElement(m.Text,{component:m.TextVariants.p},"RHEL ",t.osMajorVersion),a().createElement(m.Text,{component:m.TextVariants.h5},"Policy type "),a().createElement(m.Text,{component:m.TextVariants.p},t.policyType),a().createElement(m.Text,{component:m.TextVariants.h5},"Reference ID"),a().createElement(m.Text,{component:m.TextVariants.p},t.refId))))};Y.propTypes={policy:p().object};const W=Y;var J=r(45987),$=["children"],Q=["children"],X={children:p().node},ee=function(e){var t=e.children,r=(0,J.Z)(e,$);return a().createElement(m.TextListItem,(0,V.Z)({},r,{component:m.TextListItemVariants.dt}),t)};ee.propTypes=X;var te=function(e){var t=e.children,r=(0,J.Z)(e,Q);return a().createElement(m.TextListItem,(0,V.Z)({},r,{component:m.TextListItemVariants.dd}),t)};te.propTypes=X;var re=function(e){var t=e.profile;return a().createElement(a().Fragment,null,a().createElement(m.TextList,{component:m.TextListVariants.dl},a().createElement(ee,null,a().createElement(m.Text,{className:"ins-c-non-bold-h2"},"Policy details")),a().createElement(ee,null,"Operating system"),a().createElement(te,null,"RHEL ",t.osMajorVersion),a().createElement(ee,null,"Compliance threshold"),a().createElement(te,null,"".concat((0,_.P0)(t.complianceThreshold,1),' of rules must be\n        passed for a system to be labeled "Compliant"')),a().createElement(ee,null,"Business objective"),a().createElement(te,null,t.businessObjective?t.businessObjective.title:"--")),a().createElement(qt,{to:"/scappolicies/"+t.policy.id},"View policy"))};re.propTypes={profile:p().shape({id:p().string,complianceThreshold:p().number,businessObjective:p().object,osMajorVersion:p().string,policy:p().shape({id:p().string}),benchmark:p().shape({version:p().string})})};var ne=function(e){var t=e.profile;return a().createElement(m.TextContent,{className:"policy-details"},a().createElement(re,{profile:t}))};ne.propTypes={profile:p().object};const oe=ne;var ae=r(48273),ie=function(e){var t,r,n=e.percent,o=e.failed;return 100===n?(r="Success",t=ae.ProgressVariant.success):o?(r="Error",t=ae.ProgressVariant.danger):(r="Progress",t=ae.ProgressVariant.info),a().createElement(ae.Progress,{id:"finished-create-policy",value:n,title:r,variant:t,className:"wizard-progress-bar"})};ie.propTypes={percent:p().number,failed:p().bool};const ce=ie;var le=r(96620),se=r(52710),ue=["children","defaultTab","level","ouiaId"],pe=function(e){return e.children},me=function(e,t){return e.find((function(e){return e.props.eventKey===t}))},de=function(e,t){var r=(0,se.Wb)(e).split("|");return{levels:r,currentAnchor:r[t]||e}},fe=function(e){var t=e.children,r=e.activeKey,n=e.defaultTab,o=me(t,r);return o?[o]:[n?me(t,n):t[0]]};fe.propTypes={activeTab:p().number,children:p().node};var he=function(e){var t=e.children,r=e.defaultTab,n=e.level,o=de(r,n).currentAnchor;return a().createElement(fe,{activeKey:o},t)};he.propTypes={children:p().node,defaultTab:p().string,level:p().number},he.defaultProps={level:0};var ye=function(e){var t=e.children,r=e.defaultTab,n=e.level,o=e.ouiaId,i=(0,J.Z)(e,ue),c=(0,le.useHistory)().push,l=(0,le.useLocation)(),s=l.pathname,u=l.state,p=de(r,n),d=p.currentAnchor,f=p.levels,h=t.map((function(e){return e.props.eventKey})).find((function(e){return e===d}));return a().createElement(m.Tabs,(0,V.Z)({},i,{ouiaId:o,onSelect:function(e,t){e.preventDefault();var r=t.replace("#",""),o=f;o[n]=r,c({state:u,to:s,hash:o.slice(0,n+1).join("|")})},activeKey:h?d:r}),t)};ye.defaultProps={level:0},ye.propTypes={children:p().node,defaultTab:p().string,level:p().number,ouiaId:p().string};var ve=function(e){return e.children},be={stateValues:p().object,children:p().node},ge=function(e){var t=e.stateValues;return e.children.flatMap((function(e){return e})).filter((function(e){return t[e.props.stateKey]}))};ge.propTypes=be;var Ee=function(e){var t=e.stateValues,r=e.children;return a().createElement(ge,{stateValues:t},a().createElement(ve,{key:"error-state",stateKey:"error"},a().createElement(k,{error:t.error})),r)};Ee.propTypes=be;var Oe=r(24014),Te=r(10490),xe=r(4942),we=["to","hash","children","state","backgroundLocation"];function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){(0,xe.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ze=function(e){var t=e.to,r=e.hash,n=e.children,o=e.state,i=e.backgroundLocation,c=(0,J.Z)(e,we),l=je(je({},(0,le.useLocation)()),i),s=je(je({},o),{},{background:l});return a().createElement(qt,(0,V.Z)({to:{pathname:t,state:s,hash:r}},c),n)};Ze.propTypes={backgroundLocation:p().object,children:p().node,hash:p().string,state:p().object,to:p().string.isRequired};const Ce=Ze;var Se=["href"],Re=["children"],ke=function(e){var t=e.href,r=(0,J.Z)(e,Se);return a().createElement(qt,(0,V.Z)({},r,{to:t}))};ke.propTypes={href:p().string};var Ie=function(e){var t=e.children,r=(0,J.Z)(e,Re);return a().createElement(m.BreadcrumbItem,(0,V.Z)({},r,{component:ke}),t)};Ie.propTypes={children:p().node};const Ne=Ie;var Ve=r(58061),Fe=r(41532),Le=r(41304),De=r(77346),_e=r(51105),He=r(10218);function Be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(r),!0).forEach((function(t){(0,xe.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Me=function(e){var t=e.profiles,r=(0,De.ZP)("manageColumns"),o=(0,De.ZP)("pdfReport"),i=(0,f.jj)(t.map((function(e){return e.policyType})).filter((function(e){return!!e}))),c=(0,f.jj)(t.map((function(e){return e.osMajorVersion})).filter((function(e){return!!e})));return a().createElement(Le.v,{"aria-label":"Reports",ouiaId:"ReportsTable",columns:[].concat((0,n.Z)(_e.ZP),(0,n.Z)(o&&[_e._C]||[])),items:t,isStickyHeader:!0,filters:{filterConfig:[].concat((0,n.Z)(He.Yv),(0,n.Z)(i.length>0&&(0,He.U3)(i)||[]),(0,n.Z)(c.length>0&&(0,He.W3)(c)||[]),(0,n.Z)(He.Zl))},options:Ae(Ae({},Ve.yi),{},{exportable:Ae(Ae({},Ve.yi.exportable),{},{columns:_e.dj}),manageColumns:r,emptyRows:(0,Fe.fQ)("reports",_e.ZP.length)}),className:"reports-table"})};Me.propTypes={profiles:p().array};const qe=Me;var Ke=r(6474);const Ue=function(){return a().createElement(Ke.Z,{title:"No policies are reporting",mainButton:a().createElement(Ce,{to:"/scappolicies/new",component:zt,variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy")})};var ze=r(84206),Ge=r(93805),Ye=r(91290);const We=function(){return a().createElement(m.Tooltip,{position:"right",content:a().createElement(o.Fragment,null,"This is an optional field that can be used to label policies that are related to specific business objectives.")},a().createElement("span",null,"Â ",a().createElement(Ye.ZP,{className:"grey-icon"})))};r(23690);var Je=r(48108),$e=r(81984);function Qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){(0,xe.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var et=function(){return a().createElement(Ce,{to:"/scappolicies/new",component:zt,variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy")},tt=function(e){var t=e.policies,r=(0,De.ZP)("manageColumns"),n=Object.values(Je),o=(0,$e.Z)(t);return a().createElement(Le.v,{"aria-label":"Policies",ouiaId:"PoliciesTable",className:"compliance-policies-table",columns:P,items:t,isStickyHeader:!0,filters:{filterConfig:n},options:Xe(Xe({},Ve.yi),{},{actionResolver:o,dedicatedAction:et,exportable:Xe(Xe({},Ve.yi.exportable),{},{columns:w}),manageColumns:r,emptyRows:(0,Fe.fQ)("policies",P.length)})})};tt.propTypes={policies:p().array.isRequired},tt.defaultProps={policies:[]};const rt=tt;var nt=r(15671),ot=r(43144),at=r(97326),it=r(60136),ct=r(82963),lt=r(61120),st=r(6455),ut=r(46314),pt=r(74726),mt=r(70597);var dt=function(e){(0,it.Z)(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=(0,lt.Z)(t);if(r){var o=(0,lt.Z)(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return(0,ct.Z)(this,e)});function o(){var e;(0,nt.Z)(this,o);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e=n.call.apply(n,[this].concat(r)),(0,xe.Z)((0,at.Z)(e),"state",{validThreshold:(0,mt.KJ)(e.props.previousThreshold),threshold:e.props.previousThreshold}),(0,xe.Z)((0,at.Z)(e),"handleThresholdChange",(function(t){e.setState({validThreshold:(0,mt.KJ)(t),threshold:t})})),e}return(0,ot.Z)(o,[{key:"render",value:function(){var e=this.state,t=e.threshold,r=e.validThreshold;return a().createElement(a().Fragment,null,a().createElement(m.FormGroup,{fieldId:"policy-threshold",validated:r?"default":"error",helperTextInvalid:a().createElement(ht.Z,{threshold:t}),helperText:"A value of 95% or higher is recommended",labelIcon:a().createElement(Ge.Z,null),label:"Compliance threshold (%)"},a().createElement(st.Z,{name:"complianceThreshold",id:"complianceThreshold",isRequired:!0,onChange:this.handleThresholdChange,validated:r?"default":"error",defaultValue:t,"aria-label":"compliance threshold",component:pt._,type:"number",style:{width:"60%",display:"block"}})))}}]),o}(a().Component);dt.propTypes={previousThreshold:p().number};const ft=(0,ut.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0})(dt);var ht=r(90061),yt=r(15265);const vt=function(){return a().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:Ve.iK},"Supported SSG versions ",a().createElement(yt.ZP,null))};var bt=r(69957);function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){(0,xe.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ot=a().createElement(a().Fragment,null,a().createElement(m.Text,{variant:"p",style:{marginBottom:"1rem"}},"These systems are running unsupported versions of the SCAP Security Guide (SSG) for the version of RHEL installed on them. Assessment of rules failed/passed on these systems is a best-guess effort and may not be accurate."),a().createElement(m.Text,{variant:"p"},"The policy's compliance score excludes these systems.")),Tt=function(e){var t=e.children,r=e.variant,n=void 0===r?"plural":r;return a().createElement(m.Popover,{id:"unsupported-popover",maxWidth:"25rem",headerContent:"Unsupported SSG versions",bodyContent:"plural"===n?Ot:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:a().createElement(vt,null)},t)};Tt.propTypes={children:p().node,variant:p().oneOf(["singular","plural"])};var xt=function(e){var t=e.children,r=e.content;return a().createElement(m.Tooltip,{content:r,position:"bottom"},t)};xt.propTypes={content:p().string,children:p().node};var wt=function(e){var t=e.variant,r=e.children,n=e.tooltipProps,o={tooltip:{Component:xt,componentProps:n},popover:{Component:Tt,componentProps:{showHeader:n.showPopupHeader,variant:n.messageVariant}}}[t],i=o.Component,c=o.componentProps;return a().createElement(i,c,r)};wt.propTypes={children:p().node,variant:p().oneOf(["tooltip","popover"]),tooltipProps:p().object};var Pt=function(e){var t=e.children,r=e.showWarningIcon,n=void 0===r||r,o=e.showHelpIcon,i=void 0!==o&&o,c=e.style,l=e.tooltipText,s=e.messageVariant,u={variant:l?"tooltip":"popover",tooltipProps:Et(Et({},l&&{content:a().createElement("div",null,l)}),{},{messageVariant:s})},p=l?{}:{cursor:"pointer"};return a().createElement("span",{style:Et(Et({},c),{},{display:"inline-block"})},n&&a().createElement(wt,u,a().createElement("span",{style:p,className:"pf-u-mr-xs"},a().createElement(bt.ZP,{color:"var(--pf-global--warning-color--100)"}))),t,i&&a().createElement(wt,u,a().createElement("span",{style:p,className:"pf-u-ml-xs"},a().createElement(Ye.ZP,{className:"grey-icon"}))))};Pt.propTypes={showWarningIcon:p().bool,showHelpIcon:p().bool,style:p().object,tooltipText:p().string,children:p().node,variant:p().string,messageVariant:p().string,showPopupHeader:p().bool};const jt=Pt;var Zt=function(e){var t=e.children;return a().createElement(m.Text,{component:"h2",style:{color:"var(--pf-global--Color--200)",lineHeight:"2rem"}},t)};Zt.propTypes={children:p().node};const Ct=Zt;var St=r(56085);const Rt=function(){return a().createElement(m.Bullseye,null,a().createElement(m.EmptyState,{variant:m.EmptyStateVariant.full},a().createElement(m.Title,{headingLevel:"h2",size:"lg",style:{fontWeight:"bold"}},"No systems on this policy"),a().createElement(m.EmptyStateBody,null,a().createElement(m.TextContent,null,a().createElement(m.Text,{component:m.TextVariants.p},"Add systems to this policy from the systems page"),a().createElement(m.Text,{style:{color:"var(--pf-global--warning-color--100)"}},a().createElement(bt.ZP,null)," ",Oe.V)))))};var kt=r(74560),It=r(86104),Nt=["children","className"],Vt=function(e){var t=e.children,r=e.className,n=void 0===r?"":r,o=(0,J.Z)(e,Nt);return a().createElement(m.Modal,(0,V.Z)({className:"compliance".concat(n?" ".concat(n):"")},o),t)};Vt.propTypes={children:p().node,className:p().string};const Ft=Vt;var Lt=function(e){var t=e.compact;return a().createElement(m.Tooltip,{position:"right",content:"A policy of this type is already in use. Only one policy per policy type can be created for a major release of RHEL."},a().createElement(m.Label,{color:"orange",style:{lineHeight:"1.5em",marginRight:"16px"},compact:t},"In use"))};Lt.propTypes={compact:p().boolean};const Dt=Lt;var _t=r(83600),Ht=r(36081),Bt=["to","children"],At=function(e){return e.children};At.propTypes={children:p().node};var Mt=function(e){var t=e.to,r=e.children,n=(0,J.Z)(e,Bt),o=(0,Ht.Z)(t),i=o.hasAccess,c=!o.isLoading&&i,l=c?At:m.Tooltip;return a().createElement(l,{content:a().createElement("div",null,"You do not have permissions to perform this action")},a().createElement(le.Link,(0,V.Z)({to:t},n,{isDisabled:!c}),r))};Mt.propTypes={to:p().oneOfType([p().string,p().object]),children:p().node};const qt=function(e){var t=(0,De.ZP)("rbac")?Mt:le.Link;return a().createElement(t,e)};var Kt=["navigate","children","to"],Ut=function(e){var t=e.navigate,r=e.children,n=e.to,o=(0,J.Z)(e,Kt);return a().createElement(m.Button,(0,V.Z)({onClick:function(){return t(n)}},o),r)};Ut.propTypes={navigate:p().func,children:p().node,to:p().oneOfType([p().string,p().object])};const zt=Ut},52710:(e,t,r)=>{"use strict";r.d(t,{C3:()=>h,Wb:()=>y,ZP:()=>v}),r(87462);r(45987);var n=r(4942),o=r(92950),a=r.n(o),i=r(45697),c=r.n(i),l=r(96620),s=(r(55140),r(85836)),u=r(7648);r(60076);function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d=function(e){var t=e.component,r=e.modal,n=e.path,i=e.props,c=void 0===i?{}:i,p=e.title,d=e.requiredPermissions,f=(0,l.useLocation)(),h=(0,u.Z)(),y=!!(0,l.matchPath)(f.pathname,{path:n,exact:!0}),v=p.includes("$entityTitle"),b={exact:!0,key:"".concat(r?"modal":"fullpage","-route-").concat(n.replace("/","-")),path:n},g=m(m({},c),{},{route:m(m({},e),{},{isCurrent:y,setTitle:h})});return(0,o.useEffect)((function(){y&&!v&&h(p)})),a().createElement(l.Route,b,d?a().createElement(s.zf,{requiredPermissions:d},a().createElement(t,g)):a().createElement(t,g))};d.propTypes={component:c().node,modal:c().bool,path:c().string,props:c().object,title:c().string,requiredPermissions:c().array};var f=function(e){var t,r=e.routes,n=(0,l.useLocation)(),i=null==n||null===(t=n.state)||void 0===t?void 0:t.background,c=n.pathname,s=r.filter((function(e){return!e.modal})),u=r.filter((function(e){return e.modal})),p=r.map((function(e){return e.path}));return a().createElement(o.Suspense,{fallback:o.Fragment},a().createElement(l.Switch,{location:i||n},s.map(d),a().createElement(l.Route,{render:function(){return p.some((function(e){return e===c}))?null:a().createElement(l.Redirect,{to:"/reports"})}})),u.map(d))};f.propTypes={routes:c().array};c().object,c().string,c().array,c().node;var h=function(e){var t=(0,l.useLocation)(),r=(0,l.useHistory)();return function(n){var o,a=null==t||null===(o=t.state)||void 0===o?void 0:o.background;r.push(m({pathname:a?a.pathname:e,hash:a?a.hash:void 0},n))}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,l.useLocation)();return((t.hash&&t.hash.length>0?t.hash:void 0)||e).replace("#","")};const v=f},77346:(e,t,r)=>{"use strict";r.d(t,{Br:()=>s,ZP:()=>u});var n=r(92950),o=r(58061),a=r(96620),i="insights:compliance",c=function(e){var t=o.R2[e];return!!localStorage.getItem("".concat(i,":").concat(e))||t},l=function(e,t){var r="enable"===e||"true"===e,n=c("debugFeatures");r?(n&&console.log("Setting feature value for ".concat(t," to ").concat(r)),localStorage.setItem("".concat(i,":").concat(t),r)):(n&&console.log("Removing feature setting of ".concat(t)),localStorage.removeItem("".concat(i,":").concat(t)))},s=function(){var e=(0,a.useLocation)(),t=e.search,r=e.pathName,n=(0,a.useHistory)();t&&(new URLSearchParams(t).forEach(l),n.push(r))};const u=function(e){var t=(0,n.useMemo)((function(){return c("debugFeatures")}),[]),r=(0,n.useMemo)((function(){return c(e)}),[e]);return(0,n.useEffect)((function(){t&&console.log("Feature ".concat(e," is set to ").concat(r))}),[e,r,t]),e?r:void 0}},53883:(e,t,r)=>{"use strict";r.r(t);var n=r(92950),o=r.n(n),a=r(12181),i=r.n(a),c=r(45697),l=r.n(c),s=r(86174),u=r(36689),p=r(73980),m=r(48830),d=r(76309),f=r(96620),h=r(28216),y=r(35240),v=r(30319),b=r(60076),g=r(51344),E=r(371),O=r(77346),T={reports:function(e){insights.chrome.appNavClick({id:"reports",redirect:e})},scappolicies:function(e){insights.chrome.appNavClick({id:"scappolicies",redirect:e})},systems:function(e){insights.chrome.appNavClick({id:"systems",redirect:e})}},x=function(e){var t=(0,f.useLocation)();return(0,O.Br)(),(0,n.useEffect)((function(){var r,n;insights.chrome.init(),null===(r=insights.chrome)||void 0===r||null===(n=r.hideGlobalFilter)||void 0===n||n.call(r),insights.chrome.identifyApp("compliance");var o=t.pathname.split("/")[1]||"reports",a=insights.chrome.on("APP_NAVIGATION",(function(t){t.domEvent&&(e.history.push("/".concat(t.navId)),T[o](!0))}));return function(){return a()}}),[]),o().createElement(E.r,{appName:"compliance"},o().createElement(g.ZP,null),o().createElement(b.Z5,{childProps:e}))};x.propTypes={location:l().object,history:l().object};const w=x;var P=r(58061),j=new p.fe({link:new m.u({credentials:"include",uri:P.dT+"/graphql"}),cache:new d.h4}),Z=function(e){var t=e.logger;return o().createElement(h.zt,{store:(0,v.S1)(t).getStore()},o().createElement(s.Z,{locale:navigator.language},o().createElement(f.BrowserRouter,{basename:(0,y.eb)(window.location.pathname)},o().createElement(u.e,{client:j},o().createElement(w,null)))))};Z.propTypes={logger:l().any};const C=Z;i().render(o().createElement(C,null),document.getElementById("root"))},58061:(e,t,r)=>{"use strict";r.d(t,{IJ:()=>f,R2:()=>P,RM:()=>b,dT:()=>h,i2:()=>d,iK:()=>y,iz:()=>E,n3:()=>T,qo:()=>v,rN:()=>x,um:()=>j,yi:()=>w,z7:()=>Z});var n=r(4147),o=r(83237),a=r(65811),i=r(89734),c=r.n(i),l=r(92950),s=r.n(l),u=r(43047),p=r(69957),m=r(73479),d="Compliance | Red Hat Insights",f=" - ".concat(d),h="/api/compliance",y=(n.i8,"https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/con-compl-assess-overview_compl-assess-overview#con-compl-assess-supported-configurations_compl-assess-overview"),v=(s().Fragment,u.ZP,s().Fragment,p.ZP,s().Fragment,s().Fragment,m.ZP,[{type:o.Y.text,label:"Name",filterString:function(e){return"name ~ ".concat(e)}}]),b=function(e){return[{type:o.Y.checkbox,label:"Policy",filterString:function(e){return"policy_id = ".concat(e)},items:e.map((function(e){return{label:e.name,value:e.id}}))}]},g=function(e){return Array.from(new Set(e.map((function(e){return e.osMajorVersion}))))},E=function(e){return[{type:o.Y.checkbox,label:"Operating system",filterString:function(e){return"os_major_version = ".concat(e)},items:g(e).map((function(e){return{label:"RHEL ".concat(e),value:e}}))}]},O={value:"",isDisabled:!0,items:[{value:"",label:s().createElement("div",{className:"ins-c-osfilter__no-os"},"No OS versions available"),isDisabled:!0,items:[],className:"ins-c-osfilter__os-filter-button"}]},T=function(e){var t=c()(Object.keys(e).map(Number)).reverse(),r=t.length>0?t.map(function(e){return function(t){return{label:"RHEL ".concat(t),value:t,groupSelectable:!0,items:c()(e[t]).reverse().map((function(e){return{label:"RHEL ".concat(t,".").concat(e),value:e}}))}}}(e)):[O];return[{type:o.Y.group,label:"Operating system",filterString:function(e){return[Object.keys(e).flatMap((function(t){return Object.keys(e[t]).map((function(r){return e[t][r]&&"(os_major_version = ".concat(t," AND os_minor_version = ").concat(r,")")}))})).filter((function(e){return!!e})).join(" OR ")]},items:r}]},x=[{type:o.Y.checkbox,label:"Compliance",filterString:function(e){return"".concat(e)},items:[{label:"Compliant",value:"compliant = true AND supported_ssg = true"},{label:"Non-compliant",value:"compliant = false AND supported_ssg = true"},{label:"Not supported",value:"supported_ssg = false"},{label:"Never reported",value:"reported = false"}]},{type:o.Y.checkbox,label:"Compliance score",filterString:function(e){var t=e.split("-");return"(compliance_score >= ".concat(t[0]," and compliance_score < ").concat(t[1],")")},items:[{label:"90 - 100%",value:"90-101"},{label:"70 - 89%",value:"70-90"},{label:"50 - 69%",value:"50-70"},{label:"Less than 50%",value:"0-50"}]}],w={exportable:{onStart:function(){(0,a.q)({variant:"info",title:"Preparing export",description:"Once complete, your download will start automatically."})},onComplete:function(){(0,a.q)({variant:"success",title:"Downloading export"})}},manageColumns:!0},P={pdfReport:!0,manageColumns:!0,systemsNotReporting:!0,rbac:!0,ruleGroups:!1},j={black300:"#D2D2D2",black200:"#F0F0F0",blue200:"#73BCF7",blue300:"#2B9AF3",blue400:"#0066CC",gold300:"#F4C145"},Z={light300:"#f0f0f0"}},3674:(e,t,r)=>{var n=r(14636),o=r(280),a=r(98612);e.exports=function(e){return a(e)?n(e):o(e)}}}]);
//# sourceMappingURL=../sourcemaps/938.fe38ec3db523f16bc132f697c4531621.js.map