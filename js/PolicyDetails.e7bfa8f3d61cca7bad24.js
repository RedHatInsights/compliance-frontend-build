(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[705],{77388:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PolicyDetails:()=>x,QUERY:()=>q,default:()=>B});var i=n(32465),l=n(92950),r=n.n(l),a=n(45697),o=n.n(a),s=n(33121),c=n(334),d=n(46829),m=n(55600),u=n(48716),p=n(39173),y=n(86350),E=n(6023),h=n(59722),f=n(52710),b=n(7648),v=n(2707),g=function(e){var t=e.policy,n=(0,f.Wb)();return r().createElement(m.ToolbarItem,null,r().createElement(h.mR,{to:"/scappolicies/".concat(t.id,"/edit"),state:{policy:t},hash:n,backgroundLocation:{hash:n}},r().createElement(m.Button,{variant:"primary",ouiaId:"EditRulesButton"},"Edit rules")))};g.propTypes={policy:o().object.isRequired};const I=g;var T=function(e){var t=e.loading,n=e.policy;return r().createElement(r().Fragment,null,r().createElement(m.Alert,{isInline:!0,ouiaId:"RuleEditingAvailableAlert",variant:"info",title:"Rule editing is now available."},'SCAP policies created before April 19th, 2021 with rule editing will use the full default set of rules for the policy with the most accurate benchmark for systems within the policy. Click the "Edit rules" or "Edit policy" button to edit rules.'),r().createElement(m.PageSection,{variant:m.PageSectionVariants.light},r().createElement(m.Text,{component:m.TextVariants.p},r().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",n.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),r().createElement(v.ZP,{remediationsEnabled:!1,columns:(0,v.eo)(["Name","Severity","Ansible"]),loading:t,profileRules:[{profile:{refId:n.refId,name:n.name},rules:n.rules}],toolbarItems:r().createElement(I,{policy:n})}))};T.propTypes={loading:o().bool,policy:o().shape({name:o().string,refId:o().string,rules:o().array,benchmark:o().object})};const P=T;var S=n(69030),V=n(27803),w=n(31499),R=function(e){var t,n=e.policy;return r().createElement(S.e_,{columns:[w.Zw({showLink:!0}),w.hN,w.U5],showOsMinorVersionFilter:[n.majorOsVersion],query:V.Ep,policyId:n.id,defaultFilter:"policy_id = ".concat(n.id),showActions:!1,remediationsEnabled:!1,noSystemsTable:0===(null==n||null===(t=n.hosts)||void 0===t?void 0:t.length)&&r().createElement(h.JS,null),complianceThreshold:n.complianceThreshold})};R.propTypes={policy:o().shape({id:o().string.isRequired,complianceThreshold:o().number.isRequired,majorOsVersion:o().string.isRequired,hosts:o().array.isRequired}),systemTableProps:o().object};const k=R;var j=n(99030),M=n(79886),A=n(94263),C=function(e){var t=e.policy,n=t.hosts,i=t.policy.profiles.filter((function(e){return!!e.osMinorVersion})),l=(0,j.UP)(n),a=i.sort((0,M.Sj)("osMinorVersion","desc")).map((function(e){var t;return{profile:e,systemCount:(null===(t=l[e.osMinorVersion])||void 0===t?void 0:t.count)||0}}));return r().createElement(r().Fragment,null,r().createElement(m.PageSection,{variant:m.PageSectionVariants.light},r().createElement(h.Hv,{tabsData:a,columns:[A.VG,A.zb,A.PS],level:1,toolbarItems:r().createElement(I,{policy:t})})))};C.propTypes={policy:o().object.isRequired};const K=C;var Z,q=(0,s.ZP)(Z||(Z=(0,i.Z)(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                benchmark {\n                    id\n                    title\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n            osMinorVersion\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n        rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n    }\n}\n"]))),x=function(e){var t,n,i=e.route,a="details",o=(0,c.useParams)().policy_id,s=(0,c.useLocation)(),v=(0,f.Wb)(),g=(0,d.useQuery)(q,{variables:{policyId:o}}),I=g.data,T=g.error,S=g.loading,V=g.refetch,w=!0;return I&&!S&&(w=!!(n=I.profile).policy.profiles.find((function(e){return!!e.osMinorVersion}))),(0,l.useEffect)((function(){V()}),[s,V]),(0,b.a)(i,null===(t=n)||void 0===t?void 0:t.name),r().createElement(h.tC,{stateValues:{error:T,data:I,loading:S}},r().createElement(h.K7,{stateKey:"loading"},r().createElement(u.Z,null,r().createElement(h.PL,null)),r().createElement(y.Z,null,r().createElement(E.Z,null))),r().createElement(h.K7,{stateKey:"data"},n&&r().createElement(l.Fragment,null,r().createElement(u.Z,{className:"page-header-tabs"},r().createElement(m.Breadcrumb,{ouiaId:"PolicyDetailsPathBreadcrumb"},r().createElement(h.MU,{to:"/"},"Compliance"),r().createElement(h.MU,{to:"/scappolicies"},"SCAP policies"),r().createElement(m.BreadcrumbItem,{isActive:!0},n.name)),r().createElement(m.Grid,{gutter:"lg"},r().createElement(m.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},r().createElement(p.Z,{title:n.name})),r().createElement(m.GridItem,{className:"policy-details-button",xl2:1,xl:2,lg:2,md:3,sm:3},r().createElement(h.mR,{to:"/scappolicies/".concat(n.id,"/edit"),state:{policy:n},hash:v,backgroundLocation:{hash:"details"}},r().createElement(m.Button,{variant:"secondary",ouiaId:"EditPolicyButton"},"Edit policy")))),r().createElement(h.tn,{"aria-label":"Policy Tabs",ouiaId:"PolicyDetailsTabs",defaultTab:a},r().createElement(m.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),r().createElement(m.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),r().createElement(m.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),r().createElement(y.Z,null,r().createElement(h.Jm,{defaultTab:a},r().createElement(h.X8,{eventKey:"details"},r().createElement(h.NP,{policy:n})),r().createElement(h.X8,{eventKey:"rules"},w?r().createElement(K,{policy:n}):r().createElement(P,{policy:n})),r().createElement(h.X8,{eventKey:"systems"},r().createElement(k,{policy:n})))))))};x.propTypes={route:o().object};const B=x}}]);
//# sourceMappingURL=../sourcemaps/PolicyDetails.1c2661569448be794dd2.js.map