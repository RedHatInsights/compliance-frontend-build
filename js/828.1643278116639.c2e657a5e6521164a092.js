(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[828],{19949:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var r,o=n(30168),i=n(92950),l=n.n(i),a=n(45697),c=n.n(a),s=n(73980),u=n(48830),p=n(76309),f=n(65832),m=n(7162),d=n(67521),h=n(90570),v=n(6023),y=n(69888),b=(0,d.ZP)(r||(r=(0,o.Z)(['\n  {\n    profiles(search: "external = false and canonical = false") {\n      totalCount\n    }\n  }\n']))),g=function(e){var t=e.title,n=e.mainButton,r=e.client,o=(0,h.a)(b,{fetchPolicy:"network-only",client:r}),i=o.data,a=o.error;if(o.loading)return l().createElement(v.Z,null);if(a){var c="Oops! Error loading System data: ".concat(a);return l().createElement(y._U,{message:c})}var s=i.profiles.totalCount,u=s>1?"policies":"policy",p=s>1?"have":"has";return l().createElement(f.Bullseye,null,l().createElement(f.EmptyState,null,l().createElement(f.EmptyStateIcon,{style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"},size:"xl",title:"Compliance",icon:m.ZP}),l().createElement(f.Title,{headingLevel:"h1",size:"lg"},t),l().createElement("br",null),l().createElement(f.EmptyStateBody,null,s>0&&l().createElement(f.TextContent,null,l().createElement("a",{href:"insights/compliance/scappolicies"},s," ",u)," ",p," been created but ",p," no reports."),l().createElement(f.TextContent,null,"The Compliance service uses SCAP policies to track your organization's adherence to compliance requirements."),l().createElement(f.TextContent,null,"Get started by adding a policy, or read documentation about how to connect OpenSCAP to the Compliance service.")),l().createElement(f.EmptyStatePrimary,null,n),l().createElement(f.EmptyStateSecondaryActions,null,l().createElement(f.Button,{variant:"link",component:"a",target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2021/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/index"},"Learn about OpenSCAP and Compliance"))))};g.propTypes={title:c().string,mainButton:c().object,client:c().object},g.defaultProps={title:"No policies",mainButton:l().createElement(f.Button,{variant:"primary",component:"a",href:"/insights/compliance/scappolicies"},"Create new policy"),client:new s.fe({link:new u.u({uri:"/api/compliance/graphql",credentials:"include"}),cache:new p.h4})};const E=g},76450:(e,t,n)=>{"use strict";n.d(t,{Z:()=>x});var r=n(15861),o=n(15671),i=n(43144),l=n(97326),a=n(60136),c=n(82963),s=n(61120),u=n(4942),p=n(87757),f=n.n(p),m=n(92950),d=n.n(m),h=n(45697),v=n.n(h),y=n(65832),b=n(98132),g=n(85564),E=n.n(g),O=n(28216),P=n(83215);var w=function(){return d().createElement(y.Button,{variant:"primary",isDisabled:!0},"Remediate")},j=function(e){(0,a.Z)(m,e);var t,n,p=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,s.Z)(t);if(n){var o=(0,s.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function m(){var e;(0,o.Z)(this,m);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=p.call.apply(p,[this].concat(n)),(0,u.Z)((0,l.Z)(e),"formatRule",(function(e,t,n,r){var o=e.title,i=e.refId;return{id:"ssg:rhel".concat(r,"|").concat(t.split("xccdf_org.ssgproject.content_profile_")[1],"|").concat(i),description:o,systems:[n]}})),(0,u.Z)((0,l.Z)(e),"uniqIssuesBySystem",(function(e){var t=e.map((function(e){return e.id}));return e.filter((function(n,r){var o=t.indexOf(n.id);return o===r||(e[o].systems=Array.from(new Set(e[o].systems.concat(n.systems))))&&!1}))})),(0,u.Z)((0,l.Z)(e),"ruleProfile",(function(e,t){var n=t.profiles.find((function(t){return t.rules.find((function(t){return e.refId===t.refId}))}));if(n)return n;console.log("No profile",e,t)})),(0,u.Z)((0,l.Z)(e),"rulesWithRemediations",(function(t,n){return t.filter((function(t){var r;return t.remediationAvailable&&(null===(r=e.ruleProfile(t,n))||void 0===r?void 0:r.supported)&&!1===t.compliant})).map((function(t){var r=e.ruleProfile(t,n);return e.formatRule(t,r.refId,n.id,r.majorOsVersion)}))})),(0,u.Z)((0,l.Z)(e),"dataProvider",(function(){var t=e.props,n=t.allSystems,o=t.selectedRules,i={systems:[],issues:[]};return n.filter((function(e){return e.supported})).forEach(function(){var t=(0,r.Z)(f().mark((function t(n){return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.systems.push(n.id),0!==o.length?i.issues.push(e.rulesWithRemediations(o,n)):i.issues.push(e.rulesWithRemediations(n.ruleObjectsFailed,n));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Promise.all(i.issues).then((function(t){return i.issues=e.uniqIssuesBySystem(E()(t)),i}))})),(0,u.Z)((0,l.Z)(e),"notEmptyData",(0,r.Z)(f().mark((function t(){var n;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.dataProvider();case 2:return n=t.sent,t.abrupt("return",n.issues.length>0&&n.systems.length>0);case 4:case"end":return t.stop()}}),t)})))),(0,u.Z)((0,l.Z)(e),"remediationAvailable",(function(){var t=e.props,n=t.allSystems,r=t.selectedRules;return(r.length?r:n.flatMap((function(e){return e.ruleObjectsFailed}))).some((function(t){var r;return t.remediationAvailable&&((null===(r=t.profiles)||void 0===r?void 0:r.some((function(e){return e.supported})))||n.some((function(n){var r;return null===(r=e.ruleProfile(t,n))||void 0===r?void 0:r.supported})))&&!1===t.compliant}))})),e}return(0,i.Z)(m,[{key:"render",value:function(){var e=this.props.addNotification;return d().createElement(d().Fragment,null,d().createElement(b.Z,{isDisabled:!(this.remediationAvailable()&&this.notEmptyData()),onRemediationCreated:function(t){return e(t.getNotification())},dataProvider:this.dataProvider,buttonProps:{ouiaId:"RemediateButton"},fallback:d().createElement(w,null)},"Remediate"))}}]),m}(d().Component);j.propTypes={selectedRules:v().array,allSystems:v().arrayOf(v().shape({id:v().string,name:v().string,supported:v().bool.isRequired,profiles:v().arrayOf(v().shape({refId:v().string,name:v().string,rules:v().arrayOf(v().shape({title:v().string,severity:v().string,rationale:v().string,refId:v().string,description:v().string,compliant:v().bool,identifier:v().string,references:v().string}))}))})),addNotification:v().func},j.defaultProps={allSystems:[]};const x=(0,O.$j)((function(){return{}}),(function(e){return{addNotification:function(t){return e((0,P.wN)(t))}}}))(j)},74726:(e,t,n)=>{"use strict";n.d(t,{_:()=>a,d:()=>c});var r=n(87462),o=n(92950),i=n.n(o),l=n(65832),a=function(e){return i().createElement(l.TextInput,(0,r.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))},c=function(e){return i().createElement(l.TextArea,(0,r.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))}},49269:(e,t,n)=>{"use strict";n.d(t,{Jr:()=>E,KH:()=>j,GC:()=>y,pT:()=>x,$9:()=>v,zb:()=>w});var r=n(92950),o=n.n(r),i=n(45697),l=n.n(i),a=n(65832),c=n(68778),s=n(43047),u=n(69957),p=n(73479),f=n(16712),m=function(e){var t=e.hasPlaybook,n=void 0!==t&&t;return o().createElement(o().Fragment,null,n&&o().createElement(f.ZP,null),n?" Playbook":" Manual")};m.propTypes={hasPlaybook:l().bool};const d=m;var h={title:l().string,identifier:l().object,profile:l().object,compliant:l().bool,remediationAvailable:l().bool,severity:l().string},v=function(e){var t=e.title,n=e.identifier;return o().createElement(a.TextContent,null,t,n?o().createElement(a.Text,{component:a.TextVariants.small},n.label):"")};v.propTypes=h;var y=function(e){return e.profile.name};y.propTypes=h;var b=function(){return o().createElement("span",null,o().createElement(s.ZP,{className:"ins-u-failed"})," High")},g=function(){return o().createElement("span",null,o().createElement(u.ZP,{className:"ins-u-warning"})," Medium")},E=function(){return o().createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 18 18",role:"img",style:{verticalAlign:"-0.125em"},xmlns:"http://www.w3.org/2000/svg"},o().createElement("path",{d:"M2 0h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm6.67 10.46a1.67 1.67 0 1 0 0 3.338 1.67 1.67 0 0 0 0-3.338zm-1.586-6l.27 4.935a.435.435 0 0 0 .434.411H9.55c.232 0 .422-.18.435-.411l.27-4.936A.435.435 0 0 0 9.818 4h-2.3c-.25 0-.448.21-.435.46z",fill:"#3A9CA6",fillRule:"evenodd"}))},O=function(){return o().createElement("span",null,o().createElement(E,null)," Low")},P=function(){return o().createElement("span",null,o().createElement(p.ZP,null)," Unknown")},w=function(e){var t=e.severity;return{high:o().createElement(b,null),medium:o().createElement(g,null),low:o().createElement(O,null)}[null==t?void 0:t.toLowerCase()]||o().createElement(P,null)};w.propTypes=h;var j=function(e){return e.compliant?o().createElement(c.ZP,{className:"ins-u-passed"}):o().createElement(s.ZP,{className:"ins-u-failed"})};j.propTypes=h;var x=function(e){var t=e.remediationAvailable;return o().createElement(d,{hasPlaybook:t})};x.propTypes=h},94263:(e,t,n)=>{"use strict";n.d(t,{VG:()=>l,zb:()=>c,uH:()=>u,ZP:()=>p});var r=n(89091),o=n(79886),i=n(49269),l={title:"Name",sortByProp:"title",renderExport:function(e){var t=e.title,n=e.identifier;return"".concat(t).concat(n?" - ".concat(n.label):"")},renderFunc:(0,o.SO)(i.$9)},a={title:"Policy",sortByFunction:function(e){var t;return null==e||null===(t=e.profile)||void 0===t?void 0:t.name},renderExport:function(e){var t;return null==e||null===(t=e.profile)||void 0===t?void 0:t.name},renderFunc:(0,o.SO)(i.GC)},c={title:"Severity",sortByProp:"severity",exportKey:"severity",sortByArray:["high","medium","low","unknown"],renderFunc:(0,o.SO)(i.zb)},s={title:"Passed",sortByProp:"compliant",renderExport:function(e){return null!=e&&e.compliant?"Yes":"No"},renderFunc:(0,o.SO)(i.KH)},u={title:"Remediation",transforms:[r.nowrap],sortByFunction:function(e){return null==e?void 0:e.remediationAvailable},renderExport:function(e){return null!=e&&e.remediationAvailable?"Playbook":"Manual"},renderFunc:(0,o.SO)(i.pT)};const p=[l,a,c,s,u]},91989:(e,t,n)=>{"use strict";n.d(t,{Z:()=>_});var r=n(87462),o=n(4942),i=n(70885),l=n(45987),a=n(92950),c=n.n(a),s=n(45697),u=n.n(s),p=n(72971),f=n(76450),m=n(158),d=n(77346),h=n(82176),v=n(65832),y=n(69888),b=function(e){var t=e.rule,n=t.refId,r=t.description,o=t.identifier,i=t.references,l=t.rationale,a="rule-child-row-".concat(n);return c().createElement("div",{key:a,style:{marginTop:"var(--pf-global--spacer--lg)"}},c().createElement(v.Stack,{id:"rule-description-".concat(a),className:"margin-bottom-lg"},c().createElement(v.StackItem,{style:{marginBottom:"var(--pf-global--spacer--sm)"}},c().createElement(v.Text,{className:"pf-c-form__label",component:v.TextVariants.h5},c().createElement("b",null,"Description"))),c().createElement(v.StackItem,{isFilled:!0},r)),c().createElement(v.Stack,{id:"rule-identifiers-references-".concat(a),className:"margin-bottom-lg"},c().createElement(v.Grid,null,o&&o.length>0&&c().createElement(v.GridItem,{span:2},c().createElement(v.Text,{className:"pf-c-form__label",component:v.TextVariants.h5},c().createElement("b",null,"Identifier")),c().createElement(v.Text,null,o.map((function(e,t){return c().createElement(y.MT,{href:e.system,target:"_blank",key:"".concat(n,"-identifier-").concat(t)},e.label)})).reduce((function(e,t){return[e,", ",t]})))),i&&i.length>0&&c().createElement(v.GridItem,{span:10},c().createElement(v.Text,{className:"pf-c-form__label",component:v.TextVariants.h5},c().createElement("b",null,"References")),c().createElement(v.Text,null,i.map((function(e,t){return c().createElement(y.MT,{href:e.href,target:"_blank",key:"".concat(n,"-reference-").concat(t)},e.label)})).reduce((function(e,t){return[e,", ",t]})))))),l&&c().createElement(v.Stack,{id:"rule-rationale-".concat(a),style:{marginBottom:"var(--pf-global--spacer--lg)"}},c().createElement(v.StackItem,{style:{marginBottom:"var(--pf-global--spacer--sm)"}},c().createElement(v.Text,{className:"pf-c-form__label",component:v.TextVariants.h5},c().createElement("b",null,"Rationale"))),c().createElement(v.StackItem,{isFilled:!0},l)))};b.propTypes={rule:u().object};const g=b;var E=n(92223);const O=function(e){return[{cells:[{title:c().createElement(E.Z,null,c().createElement(v.Bullseye,null,c().createElement(v.EmptyState,{variant:v.EmptyStateVariant.full},c().createElement(v.Title,{headingLevel:"h5",size:"lg"},"No matching rules found"),c().createElement(v.EmptyStateBody,null,"This filter criteria matches no rules. ",c().createElement("br",null)," Try changing your filter settings.")))),props:{colSpan:e.length}}]}]};var P=n(43047),w=n(69957),j=n(73479),x=n(49269),T=c().createElement("span",null,c().createElement(P.ZP,{className:"ins-u-failed"})," High"),C=c().createElement("span",null,c().createElement(w.ZP,{className:"ins-u-warning"})," Medium"),Z=c().createElement("span",null,c().createElement(x.Jr,null)," Low"),S=c().createElement("span",null,c().createElement(j.ZP,null)," Unknown"),k=n(44612),F=function(e,t,n){return e.filter((function(e){return t.map((function(t){return n(e,t)})).filter((function(e){return!!e})).length>0}))},V=function(e,t,n){var r=[];return e.forEach((function(e){t.map((function(t){return n(e,t)})).filter((function(e){return!!e})).length>0&&r.push(e)})),r},I=[{type:k.Y.text,label:"Name",filter:function(e,t){return F(e,[t],(function(e,t){return e.title.toLowerCase().includes(t.toLowerCase())||e.identifier&&e.identifier.label.toLowerCase().includes(t.toLowerCase())||e.references.filter((function(e){return e.label.toLowerCase().includes(t.toLowerCase())})).length>0}))}},{type:k.Y.checkbox,label:"Severity",items:[{label:T,value:"high"},{label:C,value:"medium"},{label:Z,value:"low"},{label:S,value:"unknown"}],filter:function(e,t){return V(e,t,(function(e,t){return e.severity===t}))}}],R={type:k.Y.checkbox,label:"Passed",items:[{label:"Passed rules",value:"passed"},{label:"Failed rules",value:"failed"}],filter:function(e,t){return V(e,t,(function(e,t){return e.compliant===("passed"===t)}))}},D={type:k.Y.checkbox,label:"Remediation available",items:[{label:"Remediation available",value:"true"}],filter:function(e,t){return e.filter((function(e){return"true"!==t[0]||!0===e.remediationAvailable}))}};const B=function(e){var t=e.showPassFailFilter,n=e.policies,r=e.remediationAvailableFilter,o=[].concat(I);return t&&o.push(R),n&&n.length>1&&o.push(function(e){return{type:k.Y.checkbox,label:"Policy",items:e.map((function(e){return{label:e.name,value:e.id}})),filter:function(e,t){return F(e,t,(function(e,t){return e.profile.id===t}))}}}(n)),r&&o.push(D),o};var L=n(94263),N=["system","profileRules","columns","remediationsEnabled","remediationAvailableFilter","selectedFilter","handleSelect","selectedRules","hidePassed","options","activeFilters"];function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var H=function(e){var t=e.system,n=e.profileRules,o=e.columns,s=void 0===o?L.ZP:o,u=e.remediationsEnabled,v=void 0===u||u,y=e.remediationAvailableFilter,b=void 0!==y&&y,E=e.selectedFilter,P=void 0!==E&&E,w=e.handleSelect,j=e.selectedRules,x=void 0===j?[]:j,T=e.hidePassed,C=void 0!==T&&T,Z=e.options,S=e.activeFilters,k=(0,l.Z)(e,N),F=(0,d.ZP)("manageColumns"),V=w?[x,w]:(0,a.useState)([]),I=(0,i.Z)(V,2),R=I[0],D=I[1],A=(0,h.uJ)(n),H=function(e){return(e||[]).filter((function(e){return e.remediationAvailable}))},_=s.filter((function(e){return"Passed"===e.title})).length>0,Y=n.filter((function(e){return!!e.profile})).map((function(e){var t=e.profile;return{id:t.id,name:t.name}}));return c().createElement(m.v,(0,r.Z)({"aria-label":"Rules Table",items:A,columns:s,isStickyHeader:!0,filters:M({filterConfig:B({showPassFailFilter:_,policies:Y,remediationAvailableFilter:b})},C&&{activeFilters:function(e){return M(M({},e),{},{passed:e.passed?e.passed:["failed"]},S)}}),options:M(M(M(M({},p.yi),Z),{},{identifier:function(e){return"".concat(e.profile.id,"|").concat(e.refId)},onSelect:(w||v)&&D,preselected:R,detailsComponent:g,emptyRows:O(s),selectedFilter:P},v?{dedicatedAction:function(e){var n=e.selected;return c().createElement(f.Z,{allSystems:[{id:t.id,profiles:t.testResultProfiles,ruleObjectsFailed:[],supported:t.supported}],selectedRules:H(n)})}}:{}),{},{manageColumns:F})},k))};H.propTypes={profileRules:u().array,loading:u().bool,hidePassed:u().bool,system:u().object,remediationsEnabled:u().bool,remediationAvailableFilter:u().bool,selectedRules:u().array,selectedFilter:u().bool,handleSelect:u().func,columns:u().array,options:u().object,activeFilters:u().object};const _=H},10530:(e,t,n)=>{"use strict";n.d(t,{Hv:()=>L,uU:()=>V,TB:()=>k,b4:()=>F});var r=n(42982),o=n(45987),i=n(92950),l=n.n(i),a=n(45697),c=n.n(a),s=n(65832),u=n(69888),p=n(87462),f=n(30168),m=n(90570),d=n(67521),h=n(91290),v=n(11443);const y=function(e){var t=e.profile,n=e.newOsMinorVersion;return"RHEL".concat(" ",t.osMajorVersion,".").concat(t.osMinorVersion||n)};var b,g=function(e){var t=e.count,n=void 0===t?0:t;return l().createElement(s.Badge,{isRead:!0},"".concat(n," ").concat((0,v._6)(n,"system")))};g.propTypes={profile:c().object,count:c().number};var E=function(e){var t=e.profile,n=e.newOsMinorVersion;return l().createElement(s.Text,{component:s.TextVariants.p},"SSG version: ",t.ssgVersion," ",l().createElement(s.Popover,{position:"right",bodyContent:l().createElement(O,{profile:t,newOsMinorVersion:n}),footerContent:l().createElement(u.bL,null)},l().createElement("span",{style:{cursor:"pointer"}},l().createElement(h.ZP,{className:"grey-icon"}))))};E.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var O=function(e){var t=e.profile,n=e.newOsMinorVersion;return l().createElement(s.TextContent,{style:{fontSize:"var(--pf-c-popover--FontSize)"}},l().createElement(s.Text,null,"This is the latest supported version of the SCAP Security Guide (SSG) for"," ",l().createElement(y,{profile:t,newOsMinorVersion:n})),l().createElement(s.Text,null,l().createElement(y,{profile:t,newOsMinorVersion:n})," systems assigned to this policy will report using this rule list."))};O.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var P=(0,d.ZP)(b||(b=(0,f.Z)(["\n  query benchmarkQuery($id: String!) {\n    benchmark(id: $id) {\n      id\n      osMajorVersion\n      rules {\n        id\n        title\n        severity\n        rationale\n        refId\n        description\n        remediationAvailable\n        identifier\n      }\n    }\n  }\n"]))),w=function(e){var t,n,r=e.profile,o=e.columns,i=e.handleSelect,a=e.systemCount,c=e.selectedRuleRefIds,f=e.rulesTableProps,d=e.newOsMinorVersion,h=(0,m.a)(P,{variables:{id:r.benchmark.id},skip:!i||!(null!==(t=r.benchmark)&&void 0!==t&&t.id)}),v=h.data,b=h.error,O=h.loading,w=i?null==v||null===(n=v.benchmark)||void 0===n?void 0:n.rules:null==r?void 0:r.rules;return l().createElement(l().Fragment,null,l().createElement(s.Grid,null,l().createElement(s.TextContent,{className:"pf-u-mt-md"},l().createElement(s.Text,{component:s.TextVariants.h3},l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(y,{profile:r,newOsMinorVersion:d})),l().createElement(g,{count:a})),l().createElement(E,{profile:r,newOsMinorVersion:d}))),l().createElement(u.tC,{stateValues:{error:b,loading:O,rules:w}},l().createElement(u.K7,{stateKey:"loading"},l().createElement(s.Spinner,null)),l().createElement(u.K7,{stateKey:"rules"},l().createElement(u.iK,(0,p.Z)({remediationAvailableFilter:!0,remediationsEnabled:!1,columns:o,profileRules:[{profile:r,rules:w||[]}],selectedRules:c.map((function(e){return"".concat(r.id,"|").concat(e)})),handleSelect:i&&function(e){return i(r,d,e.map((function(e){return e.split("|")[1]})))}},f)))))};w.propTypes={profile:c().object,newOsMinorVersion:c().string,columns:c().array,handleSelect:c().func,systemCount:c().object,selectedRuleRefIds:c().array,rulesTableProps:c().object};const j=w;var x=n(4942);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(e,t,n){return e.id===t.id&&e.osMinorVersion===(n||t.osMinorVersion)},S=function(e,t,n){var r=(e||[]).find((function(e){return Z(e,t,n)}));return(null==r?void 0:r.ruleRefIds)||[]},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.only,i=e.map((function(e){var n,r=t.find((function(t){return Z(t,e)}));return r?o?r:void 0:(e.rules||console.error("Profile ".concat(e.id," is missing rules for selection!")),e.osMinorVersion||console.error("Profile ".concat(e.id," is missing osMinorVersion for selection!")),{id:e.id,osMinorVersion:e.osMinorVersion,ruleRefIds:(null===(n=e.rules)||void 0===n?void 0:n.map((function(e){return e.refId})))||[]})})).filter((function(e){return!!e}));return o?i:[].concat((0,r.Z)(t),(0,r.Z)(i))},F=function(e){var t={};return e.forEach((function(e){var n=e.profile,o=e.newOsMinorVersion;if(null!=n&&n.id){var i=o||n.osMinorVersion;t[n.id]=[].concat((0,r.Z)(t[n.id]||[]),[i])}})),t},V=function(e,t){return e.flatMap((function(e){return(t[e.id]||[void 0]).map((function(t){return C(C({},e),{},{osMinorVersion:t})}))}))},I=["tabsData","defaultTab","selectedRuleRefIds","setSelectedRuleRefIds","columns","level","ouiaId"],R=function(e,t){var n=e.id,r=e.osMinorVersion;return"rules-".concat(n,"-").concat(r||t)},D=function(e,t){if(e&&0!==e.length){if(!t){var n=e[0];t={id:n.profile.id,osMinorVersion:n.profile.osMinorVersion||n.newOsMinorVersion}}return R(t)}},B=function(e){var t=e.tabsData,n=e.defaultTab,i=e.selectedRuleRefIds,a=e.setSelectedRuleRefIds,c=e.columns,p=e.level,f=void 0===p?0:p,m=e.ouiaId,d=(0,o.Z)(e,I),h=function(e,t,n){var o=(i||[]).filter((function(n){return!Z(n,e,t)})),l={id:e.id,osMinorVersion:t||e.osMinorVersion,ruleRefIds:n};a([l].concat((0,r.Z)(o)))};return l().createElement(u.tn,{ouiaId:m,level:f,defaultTab:D(t,n)},null==t?void 0:t.map((function(e){var t=e.profile,n=e.newOsMinorVersion,r=e.systemCount;return l().createElement(s.Tab,{key:R(t,n),eventKey:R(t,n),title:l().createElement("span",null,l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(y,{profile:t,newOsMinorVersion:n})),l().createElement(s.Badge,{isRead:!0},r)),ouiaId:"RHEL ".concat(t.osMajorVersion,".").concat(t.osMinorVersion||n)},l().createElement(j,{profile:t,newOsMinorVersion:n,columns:c,rulesTableProps:d,systemCount:r,selectedRuleRefIds:S(i,t,n),handleSelect:a?h:void 0}))})))};B.propTypes={tabsData:c().arrayOf(c().shape({profile:c().object.isRequired,selectedRuleRefIds:c().arrayOf(c().string),newOsMinorVersion:c().string,systemCount:c().number})).isRequired,selectedRuleRefIds:c().arrayOf(c().shape({id:c().string,ruleRefIds:c().arrayOf(c().string)})),setSelectedRuleRefIds:c().func,columns:c().arrayOf(c().object),defaultTab:c().shape({id:c().string,osMinorVersion:c().string}),level:c().number,ouiaId:c().string};const L=B},69888:(e,t,n)=>{"use strict";n.d(t,{mR:()=>Ae,MU:()=>qe,C:()=>un,OF:()=>W,C$:()=>_t,MT:()=>an,X8:()=>ye,_U:()=>B,mf:()=>I,AY:()=>N,Ir:()=>x,JS:()=>nn,V_:()=>St,xB:()=>Et,PL:()=>Q,NP:()=>re,o$:()=>bt,w8:()=>gt,_z:()=>Mt,yL:()=>q,ko:()=>de,Tq:()=>X,vu:()=>pe,vm:()=>ht,Ek:()=>mt,Jm:()=>Oe,tn:()=>Pe,iK:()=>rn.Z,Se:()=>xe,K7:()=>we,tC:()=>Te,Zr:()=>en,bL:()=>qt,UN:()=>ke,Hv:()=>tn.Hv,cT:()=>Qt,Vs:()=>Ce,fz:()=>Ie,Oq:()=>J,fQ:()=>wt});var r={};n.r(r),n.d(r,{nameFilter:()=>jt});var o=n(42982),i=n(92950),l=n.n(i),a=n(89091),c=n(96541),s=n(45697),u=n.n(s),p=n(65832),f=n(334),m=n(79886),d=function(e){var t=e.id,n=e.policy,r=e.policyType;return l().createElement(p.TextContent,null,l().createElement(f.Link,{to:"/scappolicies/"+t},n.name),l().createElement(N,null,r))};d.propTypes={id:u().string,policy:u().object,policyType:u().string};var h={title:"Name",props:{width:45},sortByProp:"name",renderExport:function(e){return e.name},renderFunc:(0,m.SO)(d)},v=function(e){return"RHEL ".concat(e.majorOsVersion)},y={title:"Operating system",transforms:[a.fitContent],props:{width:15},sortByProp:"majorOsVersion",renderExport:v,renderFunc:function(e,t,n){return v(n)}},b={title:"Systems",props:{width:15},sortByProp:"totalHostCount",renderExport:function(e){return e.totalHostCount},renderFunc:function(e,t,n){return n.totalHostCount>0?n.totalHostCount:l().createElement(ke,{count:n.totalHostCount,variant:"count"})}},g=function(e){return e.businessObjective&&e.businessObjective.title||"--"},E={title:"Business objective",sortByFunction:function(e){var t;return null==e||null===(t=e.businessObjective)||void 0===t?void 0:t.title},renderExport:g,renderFunc:function(e,t,n){return g(n)}},O=function(e){return"".concat(e.complianceThreshold,"%")},P={title:"Compliance threshold",sortByProp:"complianceThreshold",renderExport:O,renderFunc:function(e,t,n){return O(n)}},w=[h,{title:"Policy Type",renderExport:function(e){return e.policyType}},y,b,E,P];const j=[h,y,b,E,P],x=function(){return l().createElement(a.Table,{"aria-label":"policies-table",ouiaId:"PoliciesTable",cells:j,rows:(0,o.Z)(Array(5)).map((function(){return{cells:[{title:l().createElement(c.Z,null),colSpan:5}]}}))},l().createElement(a.TableHeader,null),l().createElement(a.TableBody,null))};var T=n(87462),C=n(45987),Z=n(43047),S=n(98446),k=n(27839),F=["error"],V=function(e){var t=e.error,n=(0,C.Z)(e,F);return t.networkError&&401===t.networkError.statusCode?(window.insights.chrome.auth.logout(!0),!1):t.networkError&&403===t.networkError.statusCode?l().createElement(k.Z,{serviceName:"Compliance"}):t.networkError&&404===t.networkError.statusCode?l().createElement(S.Z,null):l().createElement("section",(0,T.Z)({},n,{className:"pf-l-page__main-section pf-c-page__main-section ins-c-component_invalid-componet"}),l().createElement(Z.ZP,{size:"xl",style:{color:"var(--pf-global--danger-color--100)"}}),l().createElement(p.Title,{headingLevel:"h1"},"There was an error"),l().createElement(p.Text,null,"If you need to contact Red Hat Support about this, this is the exact error:",l().createElement(p.Text,null,t.message)),l().createElement(p.Button,{variant:"link",ouiaId:"ErrorPageGoBackButton",onClick:history.goBack},"Go back"))};V.propTypes={error:u().object};const I=V;var R=n(93929),D=function(e){var t=e.errorMsg;return l().createElement(p.Card,{className:"ins-error-card"},l().createElement(p.CardHeader,null,l().createElement(R.ZP,null)),l().createElement(p.CardBody,null,l().createElement("div",null,t)))};D.propTypes={errorMsg:u().string};const B=D;var L=function(e){var t=e.children;return l().createElement(p.Text,{style:{color:"var(--pf-global--Color--200)"},component:p.TextVariants.small},t)};L.propTypes={children:u().node};const N=L;var A=n(6455),M=function(e){var t=e.input,n=e.options,r=t.name,i=t.onChange,a=t.value;return l().createElement(l().Fragment,null,n.map((function(e,t){var n=e.label,c=e.value,s=e.defaultChecked;return l().createElement(p.Checkbox,{key:c,id:c,label:n,name:"".concat(r,"[").concat(t,"]"),value:c,isChecked:""===a?s:a.includes(c),onChange:function(e){return function(e,t){var n=(0,o.Z)(new Set(a));return e?n.push(t):n.splice(n.indexOf(t),1),i(n)}(e,c)}})})))};M.propTypes={input:u().shape({name:u().string.isRequired,onChange:u().func,value:u().string}),options:u().arrayOf(u().shape({label:u().string.isRequired,value:u().string.isRequired,defaultChecked:u().bool})).isRequired};u().arrayOf(u().shape({label:u().string.isRequired,value:u().string.isRequired,defaultChecked:u().bool})).isRequired;var H=n(67585),_=function(){return l().createElement(p.Tooltip,{position:"right",content:"A policy of this type is already in use. Only one policy per policy type can be created for a major release of RHEL."},l().createElement(p.Label,{color:"orange",style:{lineHeight:"1.5em"}},"In use"))},Y=function(e){var t=e.profiles,n=e.onChange,r=e.selectedProfile;return l().createElement(l().Fragment,null,0===(null==t?void 0:t.length)&&l().createElement(p.TextContent,{style:{color:"var(--pf-c-content--blockquote--Color)"}},l().createElement(p.Text,null,"Select an operating system to view policy types.")),l().createElement(p.Grid,{hasGutter:!0},t.map((function(e){var t=e.description,o=e.name,i=e.id,a=e.disabled;return l().createElement(l().Fragment,{key:"profile-select-".concat(i)},l().createElement(p.GridItem,{span:8,rowSpan:2},l().createElement(p.Radio,{id:"profile-select-text-".concat(i),label:l().createElement(l().Fragment,null," ".concat(o," "),a&&l().createElement(_,null)),isDisabled:a,description:l().createElement(H.Z,{inline:!0,key:"profile-select-text-".concat(i),length:190,text:t}),isChecked:r===JSON.stringify(e),onChange:function(e,t){var r;return n(null===(r=t.currentTarget)||void 0===r?void 0:r.value)},value:JSON.stringify(e)})))}))))};Y.propTypes={profiles:u().array,onChange:u().func,selectedProfile:u().object},Y.defaultProps={profiles:[],onClick:function(){return{}}};const q=Y;var G=n(73479),K=n(68778),z=n(11443),U=function(e){return e.rulesPassed+e.rulesFailed===0?l().createElement(G.ZP,{color:"var(--pf-global--disabled-color--100)"}):e.compliant?l().createElement(K.ZP,{color:"var(--pf-global--success-color--200)"}):l().createElement(Z.ZP,{color:"var(--pf-global--danger-color--100)"})},J=function(e){return!1===e.supported?" Unsupported":e.rulesPassed+e.rulesFailed===0?" N/A":" "+(0,z.P0)(e.score)};const W=function(e){return l().createElement(p.Text,null,e.supported?l().createElement(p.Tooltip,{content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},l().createElement(U,(0,T.Z)({key:"system-compliance-icon-".concat(e.id)},e)),J(e)):J(e))};var $=n(24561);const Q=function(){return l().createElement($.ZP,{speed:2,width:1e3,height:400,viewBox:"0 0 1000 400",backgroundcolor:"#f3f3f3",foregroundcolor:"#ecebeb"},l().createElement("rect",{x:"-3",y:"7",rx:"3",ry:"3",width:"760",height:"19"}),l().createElement("rect",{x:"823",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"910",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"6",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"68",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"133",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"3",y:"110",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"1",y:"149",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"1",y:"185",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-1",y:"224",rx:"0",ry:"0",width:"187",height:"16"}),l().createElement("rect",{x:"-4",y:"267",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-6",y:"306",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"-6",y:"342",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-8",y:"381",rx:"0",ry:"0",width:"187",height:"16"}))},X=function(){return l().createElement($.ZP,{height:320,width:1550,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},l().createElement("rect",{x:"18",y:"50",rx:"4",ry:"4",width:"478",height:"15"}),l().createElement("rect",{x:"19",y:"18",rx:"3",ry:"3",width:"220",height:"9"}),l().createElement("circle",{cx:"118",cy:"156",r:"73"}),l().createElement("rect",{x:"1002",y:"40",rx:"0",ry:"0",width:"69",height:"23"}),l().createElement("rect",{x:"47",y:"77",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"36",y:"77",rx:"0",ry:"0",width:"16",height:"0"}),l().createElement("rect",{x:"409",y:"149",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"214",y:"145",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"216",y:"119",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"526",y:"100",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"122",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"146",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"170",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"194",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"218",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"529",y:"275",rx:"0",ry:"0",width:"231",height:"7"}))};var ee=n(56163),te=n.n(ee),ne=function(e){var t=e.policy;return l().createElement(p.Card,{ouiaId:"PolicyDetailsCard"},l().createElement(p.CardHeader,null,l().createElement(p.Text,{style:{fontSize:20}},l().createElement("b",null,"Policy details"))),l().createElement(p.CardBody,null,l().createElement(p.TextContent,null,l().createElement(p.Text,{component:p.TextVariants.h5},"Compliance threshold",l().createElement(gt,null)),l().createElement(p.Text,{className:"threshold-tooltip",component:p.TextVariants.p},(0,z.P0)(t.complianceThreshold,1)),l().createElement(p.Text,{component:p.TextVariants.h5},"Business objective",l().createElement(Et,null)),l().createElement(p.Text,{component:p.TextVariants.p},t.businessObjective&&t.businessObjective.title||"-"),l().createElement(p.Text,{component:p.TextVariants.h5},"Policy description"),l().createElement(p.Text,{component:p.TextVariants.p},l().createElement(H.Z,{text:te()(t.description||""),length:380,inline:!0})),l().createElement(p.Text,{component:p.TextVariants.h5},"Operating system"),l().createElement(p.Text,{component:p.TextVariants.p},"RHEL ",t.majorOsVersion),l().createElement(p.Text,{component:p.TextVariants.h5},"Policy type "),l().createElement(p.Text,{component:p.TextVariants.p},t.policyType),l().createElement(p.Text,{component:p.TextVariants.h5},"Reference ID"),l().createElement(p.Text,{component:p.TextVariants.p},t.refId))))};ne.propTypes={policy:u().object};const re=ne;var oe=["children"],ie=["children"],le={children:u().node},ae=function(e){var t=e.children,n=(0,C.Z)(e,oe);return l().createElement(p.TextListItem,(0,T.Z)({},n,{component:p.TextListItemVariants.dt}),t)};ae.propTypes=le;var ce=function(e){var t=e.children,n=(0,C.Z)(e,ie);return l().createElement(p.TextListItem,(0,T.Z)({},n,{component:p.TextListItemVariants.dd}),t)};ce.propTypes=le;var se=function(e){var t=e.profile;return l().createElement(l().Fragment,null,l().createElement(p.TextList,{component:p.TextListVariants.dl},l().createElement(ae,null,l().createElement(p.Text,{className:"ins-c-non-bold-h2"},"Policy details")),l().createElement(ae,null,"Operating system"),l().createElement(ce,null,"RHEL ",t.majorOsVersion),l().createElement(ae,null,"Compliance threshold"),l().createElement(ce,null,(0,z.P0)(t.complianceThreshold,1)),l().createElement(ae,null,"Business objective"),l().createElement(ce,null,t.businessObjective?t.businessObjective.title:"--")),l().createElement(f.Link,{to:"/scappolicies/"+t.policy.id},"View policy"))};se.propTypes={profile:u().shape({id:u().string,complianceThreshold:u().number,businessObjective:u().object,majorOsVersion:u().string,policy:u().shape({id:u().string}),benchmark:u().shape({version:u().string})})};var ue=function(e){var t=e.profile;return l().createElement(p.TextContent,{className:"policy-details"},l().createElement(se,{profile:t}))};ue.propTypes={profile:u().object};const pe=ue;var fe=n(48273),me=function(e){var t,n,r=e.percent,o=e.failed;return 100===r?(n="Success",t=fe.ProgressVariant.success):o?(n="Error",t=fe.ProgressVariant.danger):(n="Progress",t=fe.ProgressVariant.info),l().createElement(fe.Progress,{id:"finished-create-policy",value:r,title:n,variant:t,className:"wizard-progress-bar"})};me.propTypes={percent:u().number,failed:u().bool};const de=me;var he=n(52710),ve=["children","defaultTab","level","ouiaId"],ye=function(e){return e.children},be=function(e,t){return e.find((function(e){return e.props.eventKey===t}))},ge=function(e,t){var n=(0,he.Wb)(e).split("|");return{levels:n,currentAnchor:n[t]||e}},Ee=function(e){var t=e.children,n=e.activeKey,r=e.defaultTab,o=be(t,n);return o?[o]:[r?be(t,r):t[0]]};Ee.propTypes={activeTab:u().number,children:u().node};var Oe=function(e){var t=e.children,n=e.defaultTab,r=e.level,o=ge(n,r).currentAnchor;return l().createElement(Ee,{activeKey:o},t)};Oe.propTypes={children:u().node,defaultTab:u().string,level:u().number},Oe.defaultProps={level:0};var Pe=function(e){var t=e.children,n=e.defaultTab,r=e.level,o=e.ouiaId,i=(0,C.Z)(e,ve),a=(0,f.useHistory)().push,c=(0,f.useLocation)(),s=c.pathname,u=c.state,m=ge(n,r),d=m.currentAnchor,h=m.levels,v=t.map((function(e){return e.props.eventKey})).find((function(e){return e===d}));return l().createElement(p.Tabs,(0,T.Z)({},i,{ouiaId:o,onSelect:function(e,t){e.preventDefault();var n=t.replace("#",""),o=h;o[r]=n,a({state:u,to:s,hash:o.slice(0,r+1).join("|")})},activeKey:v?d:n}),t)};Pe.defaultProps={level:0},Pe.propTypes={children:u().node,defaultTab:u().string,level:u().number,ouiaId:u().string};var we=function(e){return e.children},je={stateValues:u().object,children:u().node},xe=function(e){var t=e.stateValues;return e.children.flatMap((function(e){return e})).filter((function(e){return t[e.props.stateKey]}))};xe.propTypes=je;var Te=function(e){var t=e.stateValues,n=e.children;return l().createElement(xe,{stateValues:t},l().createElement(we,{key:"error-state",stateKey:"error"},l().createElement(I,{error:t.error})),n)};Te.propTypes=je;var Ce="Policies without systems will not have reports.",Ze=function(e){var t=e.showTooltip,n=e.children;return t?l().createElement(p.Tooltip,{position:p.TooltipPosition.bottom,content:Ce},n):n};Ze.propTypes={showTooltip:u().bool,children:u().node};var Se=function(e){var t,n=e.count,r=e.variant;switch(r){default:t=n;break;case"compact":t="No Systems";break;case"full":t=Ce}return l().createElement(Ze,{showTooltip:"count"===r||"compact"===r},l().createElement(Ie,null,t))};Se.defaultProps={variant:"compact"},Se.propTypes={count:u().number.isRequired,variant:u().string};const ke=Se;var Fe=n(69957),Ve=function(e){var t=e.children;return l().createElement(l().Fragment,null,l().createElement(Fe.ZP,{className:"ins-u-warning"}),l().createElement(p.Text,{component:"span",className:"ins-c-warning-text"}," ",t))};Ve.propTypes={children:u().node};const Ie=Ve;var Re=n(4942),De=["to","hash","children","state","backgroundLocation"];function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,Re.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(e){var t=e.to,n=e.hash,r=e.children,o=e.state,i=e.backgroundLocation,a=(0,C.Z)(e,De),c=Le(Le({},(0,f.useLocation)()),i),s=Le(Le({},o),{},{background:c});return l().createElement(f.Link,(0,T.Z)({to:{pathname:t,state:s,hash:n}},a),r)};Ne.propTypes={backgroundLocation:u().object,children:u().node,hash:u().string,state:u().object,to:u().string.isRequired};const Ae=Ne;var Me=["href"],He=["children"],_e=function(e){var t=e.href,n=(0,C.Z)(e,Me);return l().createElement(f.Link,(0,T.Z)({},n,{to:t}))};_e.propTypes={href:u().string};var Ye=function(e){var t=e.children,n=(0,C.Z)(e,He);return l().createElement(p.BreadcrumbItem,(0,T.Z)({},n,{component:_e}),t)};Ye.propTypes={children:u().node};const qe=Ye;var Ge=n(72971),Ke=n(158),ze=n(77346),Ue=n(53983),Je=function(e){var t;return l().createElement(p.TextContent,null,l().createElement(f.Link,{to:"/reports/"+e.id,style:{marginRight:".5rem"}},null===(t=e.policy)||void 0===t?void 0:t.name),l().createElement(l().Fragment,null,l().createElement(bt,{profile:e,position:"right"}),l().createElement(N,null,e.policyType)))};Je.propTypes={profile:u().object};var We=function(e){var t=e.majorOsVersion,n=e.ssgVersion,r=e.unsupportedHostCount,o=e.policy,i=0===r;return n="SSG: "+n,l().createElement(l().Fragment,null,"RHEL ",t,null===o&&n&&l().createElement(p.Text,null,l().createElement(N,null,i?n:l().createElement(Qt,null,n))))};We.propTypes={majorOsVersion:u().string,ssgVersion:u().string,unsupportedHostCount:u().number,policy:u().object};var $e=function(e){var t=e.testResultHostCount,n=void 0===t?0:t,r=e.compliantHostCount,o=void 0===r?0:r,i=e.unsupportedHostCount,a=void 0===i?0:i;return l().createElement(l().Fragment,null,l().createElement(p.Progress,{"aria-label":"Compliant systems",measureLocation:"outside",value:n?100/n*o:0}),l().createElement(N,null,"".concat(o," of ").concat(n," systems "),a>0&&l().createElement(Qt,{tooltipText:"Insights cannot provide a compliance score for systems running an unsupported version of the SSG at the time this report was created, as the SSG version was not supported by RHEL.",style:{marginLeft:".5em"}},l().createElement("strong",{className:"ins-c-warning-text"},a," unsupported"))))};$e.propTypes={testResultHostCount:u().number,compliantHostCount:u().number,unsupportedHostCount:u().number};var Qe={title:"Policy",sortByProp:"name",props:{width:60},exportKey:"name",renderFunc:(0,m.SO)(Je)},Xe={title:"Operating system",transforms:[a.fitContent],sortByProp:"majorOsVersion",props:{width:20},renderExport:function(e){var t=e.majorOsVersion;return"RHEL ".concat(t," ")},renderFunc:(0,m.SO)(We)},et={title:"Systems meeting compliance",transforms:[a.fitContent],sortByFunction:function(e){return 100/e.testResultHostCount*e.compliantHostCount},props:{width:20},renderExport:function(e){var t=e.testResultHostCount,n=void 0===t?0:t,r=e.compliantHostCount,o=void 0===r?0:r,i=e.unsupportedHostCount,l=void 0===i?0:i;return"".concat(o," of ").concat(n," systems").concat(l>0?" | ".concat(l," unsupported"):"")},renderFunc:(0,m.SO)($e)},tt={title:"",renderFunc:(0,m.SO)((function(e){return l().createElement(Ae,{to:"/reports/".concat(e.id,"/pdf")},l().createElement(p.Button,{ouiaId:"ReportsDownloadReportPDFLink",variant:"plain",className:"pf-u-mr-md"},l().createElement(Ue.ZP,null)))})),managable:!1},nt=[Qe,{title:"Policy Type",renderExport:function(e){return e.policyType}},Xe,et];const rt=[Qe,Xe,et];var ot=n(70885),it=n(44612),lt=[{type:it.Y.text,label:"Policy name",filter:function(e,t){var n=t.toLowerCase();return e.filter((function(e){return[e.name,e.policy.name].join().toLowerCase().includes(n)}))}}],at=function(e){return[{type:it.Y.checkbox,label:"Policy type",filter:function(e,t){return e.filter((function(e){var n=e.policyType;return t.includes(n)}))},items:e.map((function(e){return{label:e,value:e}}))}]},ct=function(e){return[{type:it.Y.checkbox,label:"Operating system",filter:function(e,t){return e.filter((function(e){var n=e.majorOsVersion;return t.includes(n)}))},items:e.map((function(e){return{label:"RHEL ".concat(e),value:e}}))}]},st=[{type:it.Y.checkbox,label:"Systems meeting compliance",filter:function(e,t){return e.filter((function(e){var n=e.testResultHostCount,r=e.compliantHostCount,o=Math.round(100/n*r);return t.map((function(e){var t=e.split("-"),n=(0,ot.Z)(t,2),r=n[0],i=n[1];return o>=r&&o<=i})).filter((function(e){return!!e})).length>0}))},items:[{label:"90 - 100%",value:"90-100"},{label:"70 - 89%",value:"70-89"},{label:"50 - 69%",value:"50-69"},{label:"Less than 50%",value:"0-49"}]}];function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){(0,Re.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ft=function(e){var t=e.profiles,n=(0,ze.ZP)("manageColumns"),r=(0,ze.ZP)("pdfReport"),i=(0,m.jj)(t.map((function(e){return e.policyType})).filter((function(e){return!!e}))),a=(0,m.jj)(t.map((function(e){return e.majorOsVersion})).filter((function(e){return!!e})));return l().createElement(Ke.v,{"aria-label":"Reports",ouiaId:"ReportsTable",columns:[].concat((0,o.Z)(rt),(0,o.Z)(r&&[tt]||[])),items:t,emptyRows:wt,isStickyHeader:!0,filters:{filterConfig:[].concat((0,o.Z)(lt),(0,o.Z)(i.length>0&&at(i)||[]),(0,o.Z)(a.length>0&&ct(a)||[]),(0,o.Z)(st))},options:pt(pt({},Ge.yi),{},{exportable:pt(pt({},Ge.yi.exportable),{},{columns:nt}),manageColumns:n})})};ft.propTypes={profiles:u().array};const mt=ft;var dt=n(19949);const ht=function(){return l().createElement(dt.Z,{title:"No policies are reporting",mainButton:l().createElement(Ae,{to:"/scappolicies/new"},l().createElement(p.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))})};var vt=n(91290),yt=function(e){var t=e.profile,n=e.position,r=void 0===n?"top":n,o=t.policy,i=t.policyType,a=t.complianceThreshold,c=t.majorOsVersion,s=t.businessObjective;return l().createElement(p.Popover,{position:r,headerContent:l().createElement(p.TextContent,null,null==o?void 0:o.name,l().createElement(p.Text,{component:p.TextVariants.small},i)),footerContent:l().createElement(f.Link,{to:"/scappolicies/"+(null==o?void 0:o.id)},"View policy"),bodyContent:l().createElement(p.TextContent,{className:"policy-details"},l().createElement(p.TextList,{component:p.TextListVariants.dl},l().createElement(p.TextListItem,{component:p.TextListItemVariants.dt},"Operating system"),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dd},"RHEL ",c),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dt},"Compliance threshold"),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dd},(0,z.P0)(a,1)),s&&l().createElement(l().Fragment,null,l().createElement(p.TextListItem,{component:p.TextListItemVariants.dt},"Business objective"),l().createElement(p.TextListItem,{component:p.TextListItemVariants.dd},s.title))))},l().createElement(p.Button,{variant:"link",ouiaId:"PopoverViewPolicyLink",isInline:!0},l().createElement(vt.ZP,{className:"grey-icon"})))};yt.propTypes={profile:u().object,position:u().string};const bt=yt,gt=function(){return l().createElement(p.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,'The compliance threshold defines what percentage of rules must be met in order for a system to be determined "compliant".')},l().createElement("span",null," ",l().createElement(vt.ZP,{className:"grey-icon"})))},Et=function(){return l().createElement(p.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,"This is an optional field that can be used to label policies that are related to specific business objectives.")},l().createElement("span",null," ",l().createElement(vt.ZP,{className:"grey-icon"})))};var Ot=n(92223),Pt=function(){return l().createElement(Ot.Z,null,l().createElement(p.Bullseye,null,l().createElement(p.EmptyState,{variant:p.EmptyStateVariant.full},l().createElement(p.Title,{headingLevel:"h5",size:"lg"},"No matching policies found"),l().createElement(p.EmptyStateBody,null,"This filter criteria matches no policies. ",l().createElement("br",null)," Try changing your filter settings."))))},wt=[{cells:[{title:function(){return l().createElement(Pt,null)},props:{colSpan:3}}]}],jt={type:it.Y.text,label:"Name",filter:function(e,t){return e.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())}))}};function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){(0,Re.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ct=function(){return l().createElement("div",null,l().createElement(Ae,{to:"/scappolicies/new"},l().createElement(p.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy")))},Zt=function(e){var t=e.policies,n=e.location,o=e.history,i=(0,ze.ZP)("manageColumns"),a=Object.values(r);return l().createElement(Ke.v,{"aria-label":"Policies",ouiaId:"PoliciesTable",className:"compliance-policies-table",columns:j,items:t,emptyRows:wt,isStickyHeader:!0,filters:{filterConfig:a},options:Tt(Tt({},Ge.yi),{},{dedicatedAction:Ct,exportable:Tt(Tt({},Ge.yi.exportable),{},{columns:w}),manageColumns:i}),actionResolver:function(){return[{title:"Delete policy",onClick:function(e,r,i){var l=i.itemId,a=t.find((function(e){return e.id===l}));o.push("/scappolicies/".concat(l,"/delete"),{policy:a,background:n})}},{title:"Edit policy",onClick:function(e,r,i){var l=i.itemId,a=t.find((function(e){return e.id===l}));o.push("/scappolicies/".concat(l,"/edit"),{policy:a,background:n,state:{policy:a}})}}]}})};Zt.propTypes={policies:u().array.isRequired,history:u().object.isRequired,location:u().object.isRequired},Zt.defaultProps={policies:[]};const St=(0,f.withRouter)(Zt);var kt=n(15671),Ft=n(43144),Vt=n(97326),It=n(60136),Rt=n(82963),Dt=n(61120),Bt=n(46314),Lt=n(74726),Nt=n(70597);var At=function(e){(0,It.Z)(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,Dt.Z)(t);if(n){var o=(0,Dt.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,Rt.Z)(this,e)});function o(){var e;(0,kt.Z)(this,o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=r.call.apply(r,[this].concat(n)),(0,Re.Z)((0,Vt.Z)(e),"state",{validThreshold:(0,Nt.KJ)(e.props.previousThreshold),threshold:e.props.previousThreshold}),(0,Re.Z)((0,Vt.Z)(e),"handleThresholdChange",(function(t){e.setState({validThreshold:(0,Nt.KJ)(t),threshold:t})})),e}return(0,Ft.Z)(o,[{key:"render",value:function(){var e=this.state,t=e.threshold,n=e.validThreshold;return l().createElement(l().Fragment,null,l().createElement(p.FormGroup,{fieldId:"policy-threshold",validated:n?"default":"error",helperTextInvalid:l().createElement(_t,{threshold:t}),helperText:"A value of 95% or higher is recommended",labelIcon:l().createElement(gt,null),label:"Compliance threshold (%)"},l().createElement(A.Z,{name:"complianceThreshold",id:"complianceThreshold",isRequired:!0,onChange:this.handleThresholdChange,validated:n?"default":"error",defaultValue:t,"aria-label":"compliance threshold",component:Lt._,type:"number",style:{width:"60%",display:"block"}})))}}]),o}(l().Component);At.propTypes={previousThreshold:u().number};const Mt=(0,Bt.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0})(At);var Ht=function(e){var t=e.threshold,n=parseFloat(t);return l().createElement(l().Fragment,null,l().createElement(p.HelperText,null,(n<0||n>100||isNaN(n))&&l().createElement(p.HelperTextItem,{variant:"error"},"Threshold has to be a number between 0 and 100"),!(0,Nt.$X)(n,1)&&l().createElement(p.HelperTextItem,{variant:"error"},"Threshold values can have a maximum of one decimal place")))};Ht.propTypes={threshold:u().string};const _t=Ht;var Yt=n(15265);const qt=function(){return l().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:Ge.iK},"Supported SSG versions ",l().createElement(Yt.ZP,null))};function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){(0,Re.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt=l().createElement(l().Fragment,null,l().createElement(p.Text,{variant:"p",style:{marginBottom:"1rem"}},"These systems are running unsupported versions of the SCAP Security Guide (SSG) for the version of RHEL installed on them. Assessment of rules failed/passed on these systems is a best-guess effort and may not be accurate."),l().createElement(p.Text,{variant:"p"},"The policy's compliance score excludes these systems.")),Ut=function(e){var t=e.children,n=e.variant,r=void 0===n?"plural":n;return l().createElement(p.Popover,{id:"unsupported-popover",maxWidth:"25rem",headerContent:"Unsupported SSG versions",bodyContent:"plural"===r?zt:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:l().createElement(qt,null)},t)};Ut.propTypes={children:u().node,variant:u().oneOf(["singular","plural"])};var Jt=function(e){var t=e.children,n=e.content;return l().createElement(p.Tooltip,{content:n,position:"bottom"},t)};Jt.propTypes={content:u().string,children:u().node};var Wt=function(e){var t=e.variant,n=e.children,r=e.tooltipProps,o={tooltip:{Component:Jt,componentProps:r},popover:{Component:Ut,componentProps:{showHeader:r.showPopupHeader,variant:r.messageVariant}}}[t],i=o.Component,a=o.componentProps;return l().createElement(i,a,n)};Wt.propTypes={children:u().node,variant:u().oneOf(["tooltip","popover"]),tooltipProps:u().object};var $t=function(e){var t=e.children,n=e.showWarningIcon,r=void 0===n||n,o=e.showHelpIcon,i=void 0!==o&&o,a=e.style,c=e.tooltipText,s=e.messageVariant,u={variant:c?"tooltip":"popover",tooltipProps:Kt(Kt({},c&&{content:l().createElement("div",null,c)}),{},{messageVariant:s})},p=c?{}:{cursor:"pointer"};return l().createElement("span",{style:Kt(Kt({},a),{},{display:"inline-block"})},r&&l().createElement(Wt,u,l().createElement("span",{style:p,className:"pf-u-mr-xs"},l().createElement(Fe.ZP,{color:"var(--pf-global--warning-color--100)"}))),t,i&&l().createElement(Wt,u,l().createElement("span",{style:p,className:"pf-u-ml-xs"},l().createElement(vt.ZP,null))))};$t.propTypes={showWarningIcon:u().bool,showHelpIcon:u().bool,style:u().object,tooltipText:u().string,children:u().node,variant:u().string,messageVariant:u().string,showPopupHeader:u().bool};const Qt=$t;var Xt=function(e){var t=e.children;return l().createElement(p.Text,{component:"h2",style:{color:"var(--pf-global--Color--200)",lineHeight:"2rem"}},t)};Xt.propTypes={children:u().node};const en=Xt;var tn=n(10530);const nn=function(){return l().createElement(p.Bullseye,null,l().createElement(p.EmptyState,{variant:p.EmptyStateVariant.full},l().createElement(p.Title,{headingLevel:"h2",size:"lg",style:{fontWeight:"bold"}},"No systems on this policy"),l().createElement(p.EmptyStateBody,null,l().createElement(p.TextContent,null,l().createElement(p.Text,{component:p.TextVariants.p},"Add systems to this policy from the systems page"),l().createElement(p.Text,{style:{color:"var(--pf-global--warning-color--100)"}},l().createElement(Fe.ZP,null)," ",Ce)))))};var rn=n(91989),on=["children","href"],ln=function(e){var t=e.children,n=e.href,r=(0,C.Z)(e,on);return n&&l().createElement("a",(0,T.Z)({href:n},r),t)||t||""};ln.propTypes={children:u().node,href:u().string};const an=ln;var cn=["children","className"],sn=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,o=(0,C.Z)(e,cn);return l().createElement(p.Modal,(0,T.Z)({className:"compliance".concat(r?" ".concat(r):"")},o),t)};sn.propTypes={children:u().node,className:u().string};const un=sn},70597:(e,t,n)=>{"use strict";n.d(t,{$H:()=>r,$X:()=>o,KJ:()=>i,Ay:()=>l,hT:()=>a,Qy:()=>c});var r=function(e,t,n){return!!(e&&t&&n)},o=function(e,t){return new RegExp("^[-]?\\d+(\\.\\d{1".concat(t>1?","+t:"","})?$"),"g").test(e.toString())},i=function(e){var t=parseFloat(e);return t<=100&&t>=0&&o(t,1)},l=function(e,t,n){return!!(e&&t&&n&&i(n))},a=function(e){return(null==e?void 0:e.length)>0},c=function(e){return!!e&&e.length>0}},11443:(e,t,n)=>{"use strict";n.d(t,{P0:()=>r,_6:()=>o});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=null==e?void 0:e.toFixed(t);return r?r+(n?"%":""):"N/A"},o=function(e,t,n){return n||(n=t+"s"),e>1||0===e?n:t}},79886:(e,t,n)=>{"use strict";n.d(t,{jj:()=>c,Sj:()=>s,SO:()=>u,dY:()=>f,qk:()=>m,$s:()=>d,eV:()=>h});var r=n(87462),o=n(42982),i=n(92950),l=n.n(i),a=n(64640),c=function(e){return(0,o.Z)(new Set(e))},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(n,r){var o="asc"!=t,i=n&&n[e]||"",l=r&&r[e]||"";return(0,a.Z)({desc:o})(i,l)}},u=function(e,t){return function(n,o,i){return l().createElement(e,(0,r.Z)({},i,t))}},p=function(e,t){return"function"==typeof e?e(t):t[e]},f=function(e,t,n){return t.sort((function(t,r){return"asc"===n?String(p(e,t)).localeCompare(String(p(e,r))):-String(p(e,t)).localeCompare(String(p(e,r)))}))},m=function(e,t,n,r){var o=n.flatMap((function(n){return e.filter((function(e){return e[t]===n}))}));return"asc"!==r?o.reverse():o},d=function e(t,n,r){var o=n.split("."),i=o.shift();return void 0!==t[i]?o.length>0?e(t[i],o.join("."),r):t[i]:r},h=function(e){return e.split(/[-_\W]+/g).map((function(e){return e.trim()})).map((function(e){return e[0].toUpperCase()+e.substring(1)})).join("")}},158:(e,t,n)=>{"use strict";n.d(t,{v:()=>ce});var r=n(42982),o=n(4942),i=n(37948),l=n(70885),a=n(92950),c=n.n(a),s=n(89091),u=n(79886);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(e){return e.map((function(e){return f(f({},e),function(e){return e.sortByProp||e.sortByFunction}(e)?{transforms:(0,u.jj)([].concat((0,r.Z)((null==e?void 0:e.transforms)||[]),[s.sortable]))}:{})}))},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return("function"==typeof e.onSelect)+(void 0!==e.detailsComponent)},h=function(e,t,n){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,a.useState)(t.sortBy||{index:0,direction:"asc"}),r=(0,l.Z)(n,2),o=r[0],i=r[1],c=function(e,t,n){return i({index:t,direction:n})},s=e[o.index-d(t)],p=function(e){return null!=s&&s.sortByArray?(0,u.qk)(e,null==s?void 0:s.sortByProp,null==s?void 0:s.sortByArray,o.direction):(0,u.dY)((null==s?void 0:s.sortByProp)||(null==s?void 0:s.sortByFunction),e,o.direction)};return{sorter:p,tableProps:{onSort:c,sortBy:o,cells:m(e)}}}(t,n),o=r.tableProps,i=r.sorter;return{tableProps:f(f({},o),{},{sortBy:e.length>0?o.sortBy:void 0}),sorter:i}};function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.perPage,n=void 0===t?10:t,r=!1!==(null==e?void 0:e.pagination),o=(0,a.useState)({perPage:n,page:1}),i=(0,l.Z)(o,2),c=i[0],s=i[1],u=function(e){return s(y(y({},c),e))},p=function(e,t){return u(y(y({},c),{},{page:t}))},f=function(e,t){return u({page:1,perPage:t})},m=function(e){var t=c.page,n=c.perPage,r=(t-1)*n,o=r+n;return e.slice(r,o)},d=function(e){var t=e<0?c.page+e:e;u({page:t>0?t:1})};return r?{paginator:m,setPage:d,toolbarProps:{pagination:y(y({},c),{},{onSetPage:p,onPerPageSelect:f})}}:{}};var g=n(45697),E=n.n(g),O=n(65832),P=n(92223),w=function(e){var t=e.kind,n=void 0===t?"results":t;return c().createElement(P.Z,null,c().createElement(O.Bullseye,null,c().createElement(O.EmptyState,{variant:O.EmptyStateVariant.full},c().createElement(O.Title,{headingLevel:"h5",size:"lg"},"No matching ",n," found"),c().createElement(O.EmptyStateBody,null,"This filter criteria matches no ",n,".",c().createElement("br",null),"Try changing your filter settings."))))};w.propTypes={kind:E().string};var j=[{cells:[{title:function(){return c().createElement(w,null)},props:{colSpan:3}}]}];function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(e){var t,n;return e.key||(null===(t=e.original)||void 0===t?void 0:t.toLowerCase())||(null===(n=e.title)||void 0===n?void 0:n.toLowerCase())},Z=function(e,t){var n=e;return t.forEach((function(e){e&&(n=e(n))})),n},S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map((function(e){return Z(e,t)}))},k=function(e,t,n,r){return n.flatMap((function(n){var o=function(e,t){return T(T({},e.rowProps),{},{itemId:e.itemId,cells:t.map((function(t){return{title:t.renderFunc?t.renderFunc(void 0,void 0,e):e[C(t)]}}))})}(e,t);return n?n(o,e,t,r):o}))};const F=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.transformer,o=void 0===r?[]:r,i=n.rowTransformer,l=void 0===i?[]:i,a=n.emptyRows||j,c=o?S(e,o):e,s=null!=n&&n.filter?n.filter(c):c,u=null!=n&&n.sorter?n.sorter(s):s,p=null!=n&&n.paginator?null==n?void 0:n.paginator(u):u,f=p.length>0?p.flatMap((function(e,n){return k(e,t,l,n)})).filter((function(e){return!!e})):a,m=null!=n&&n.pagination?T(T({},n.pagination),{},{itemCount:s.length}):void 0;return{tableProps:{rows:f},toolbarProps:{pagination:m}}};var V=n(65115);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id";return e[t]},B=function(e,t){return R(R({},e),{},"string"==typeof t?{itemId:D(e,t)}:{itemId:t(e)})};const L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(null==t?void 0:t.identifier)||D;return e.map((function(e){return B(e,n)}))};function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e,t,n){return void 0!==(null==n?void 0:n.detailsComponent)&&function(e,t,n){return{parent:2*t,fullWidth:!0,cells:[{title:c().createElement(n,{rule:e,key:"item-"+e.rowId})}]}}(e,t,n.detailsComponent)};const H=function(e){var t=!!e.detailsComponent,n=(0,a.useState)([]),o=(0,l.Z)(n,2),i=o[0],c=o[1];return t?{transformer:function(t,n,r,o){var l=i.includes(n.itemId);return[A(A({},t),{},{isOpen:l}),M(n,o,e)]},tableProps:{onCollapse:function(e,t,n,o){i.includes(o.itemId)?c(i.filter((function(e){return e!==o.itemId}))):c([].concat((0,r.Z)(i),[o.itemId]))}}}:{}},_=function(e){var t=!!e.dedicatedAction,n=e.dedicatedAction,r=e.AdditionalDedicatedActions,o=e.selected;return t?{toolbarProps:{dedicatedAction:c().createElement("div",null,n&&c().createElement(n,o&&{selected:o}),r&&c().createElement(r,o&&{selected:o}))}}:{}},Y=function(e){var t,n=e.actions;return{toolbarProps:{actionsConfig:{actions:(t=void 0===n?[]:n,[void 0].concat((0,r.Z)(t)))}}}};var q=function(e){var t=e.column,n=e.onChange,r=e.isSelected,o=e.isDisabled,i=e.id;return c().createElement(O.DataListItem,null,c().createElement(O.DataListItemRow,null,c().createElement(O.DataListControl,null,c().createElement(O.DataListCheck,{checked:r,onChange:n,otherControls:!0,isDisabled:o,id:"".concat(i,"-id"),name:"".concat(i,"-id")})),c().createElement(O.DataListItemCells,{dataListCells:[c().createElement(O.DataListCell,{key:"".concat(i,"-cell")},c().createElement("label",{htmlFor:"".concat(i,"-id")},t.title))]})))};q.propTypes={id:E().string,column:E().object,onChange:E().func,isSelected:E().bool,isDisabled:E().bool};const G=q;var K=function(e){var t=e.isOpen,n=e.columns,o=e.onSave,i=e.onClose,s=e.selectedColumns,u=void 0===s?[]:s,p=(0,a.useState)(u),f=(0,l.Z)(p,2),m=f[0],d=f[1],h=function(e){var t=e.title;return m.includes(t)},v=function(){d(u),i&&i()},y=c().createElement(O.TextContent,null,c().createElement(O.Text,{component:O.TextVariants.p},"Selected categories will be displayed in the table."),c().createElement(O.Button,{isInline:!0,onClick:function(){d(n.map((function(e){return e.title})))},variant:"link"},"Select all"));return c().createElement(O.Modal,{title:"Manage columns",isOpen:t,variant:"small",onClose:v,description:y,actions:[c().createElement(O.Button,{key:"save",variant:"primary",onClick:function(){o&&o(m)}},"Save"),c().createElement(O.Button,{key:"cancel",variant:"secondary",onClick:v},"Cancel")]},c().createElement(O.DataList,{"aria-label":"Table column management",id:"table-column-management",isCompact:!0},n.map((function(e,t){return c().createElement(G,{key:"column-".concat(t),id:"column-".concat(t),column:e,isSelected:h(e),onChange:function(){!function(e){h(e)?d(m.filter((function(t){return t!==e.title}))):d([].concat((0,r.Z)(m),[e.title]))}(e)},isDisabled:0===t})}))))};K.propTypes={columns:E().array,selectedColumns:E().array,isOpen:E().bool,onSave:E().func,onClose:E().func};const z=K;function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=function(e,t){return e.filter((function(e){return t.includes(e.title)}))};const $=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.map((function(e){return void 0===(null==e?void 0:e.managable)?J(J({},e),{},{managable:!0}):e})).filter((function(e){return!0===e.managable})),r=(0,a.useState)(e.map((function(e){return e.title}))),o=(0,l.Z)(r,2),i=o[0],s=o[1],u=(0,a.useState)(!1),p=(0,l.Z)(u,2),f=p[0],m=p[1],d=t.manageColumns,h=function(){m(!0)},v=function(e){s(e),m(!1)};return d?{columns:W(e,i),columnManagerAction:{label:"Manage columns",onClick:h},ColumnManager:function(){return c().createElement(z,{columns:n,isOpen:f,onClose:function(){return m(!1)},selectedColumns:i,onSave:v})}}:{columns:e}};var Q=n(76316);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=n(87462),ne=n(45987),re=n(49629),oe=n(32875),ie=["items","columns","filters","options","toolbarProps"];function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ae=function(e){var t=e.items,n=void 0===t?[]:t,l=e.columns,a=void 0===l?[]:l,u=e.filters,p=void 0===u?[]:u,f=e.options,m=void 0===f?{}:f,d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.toolbarProps,l=n.tableProps,a=L(e,n),c=$(t,n),s=c.columnManagerAction,u=c.ColumnManager,p=c.columns,f=Y(ee(ee({},n),{},{actions:[].concat((0,r.Z)((null==n?void 0:n.actions)||[]),(0,r.Z)(s&&[s]||[]))})).toolbarProps,m=b(n),d=m.toolbarProps,v=m.setPage,y=m.paginator,g=(0,i.Z)(ee(ee({},n),{},{setPage:v})),E=g.toolbarProps,O=g.filter,P=g.selectedFilterToolbarProps,w=H(n),j=w.transformer,x=w.tableProps,T=h(e,p,n),C=T.tableProps,Z=T.sorter,S=(0,V.n)(ee(ee({},n),{},{items:Z(a),filter:O,paginator:y,setPage:v})),k=S.transformer,I=S.toolbarProps,R=S.tableProps,D=S.selectedItems,B=_(ee(ee({},n),{},{selected:D,additionalDedicatedActions:null==P?void 0:P.dedicatedAction})).toolbarProps,N=function(e,t,n){var r=t?t(e):e;return n?n(r):r},A=(0,Q.E9)(N((null==D?void 0:D.length)>0?D:e,O,Z),p,n).toolbarProps,M=F(a,C.cells,{emptyRows:n.emptyRows,transformer:[k],rowTransformer:[j],pagination:null==d?void 0:d.pagination,paginator:y,filter:O,sorter:Z}),q=M.toolbarProps,G=M.tableProps,K=ee(ee(ee(ee(ee(ee(ee(ee(ee({},d),I),E),P),B),q),o),A),f),z=ee(ee(ee(ee(ee({cells:p},G),C),R),x),l);return{toolbarProps:K,tableProps:z,ColumnManager:u}}(n,a,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({filters:p,toolbarProps:e.toolbarProps,tableProps:(0,ne.Z)(e,ie)},m)),v=d.toolbarProps,y=d.tableProps,g=d.ColumnManager;return c().createElement(c().Fragment,null,c().createElement(re.Z,v),c().createElement(s.Table,y,c().createElement(s.TableHeader,null),c().createElement(s.TableBody,null)),c().createElement(oe.Z,{isFooter:!0},c().createElement(O.Pagination,(0,te.Z)({variant:O.PaginationVariant.bottom},v.pagination))),g&&c().createElement(g,null))};ae.propTypes={items:E().array.isRequired,columns:E().arrayOf(E().shape({title:E().node,transforms:E().array,sortByProperty:E().string,sortByArray:E().array,sortByFunction:E().func,renderFunc:E().func})).isRequired,filters:E().object,options:E().object,toolbarProps:E().object};const ce=ae},65115:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b,n:()=>E});var r=n(45987),o=n(4942),i=n(15861),l=n(70885),a=n(42982),c=n(87757),s=n.n(c),u=n(92950),p=(n(79886),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e.itemId)}))}),f=["selectNone","selectedIds"];function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){return e?"Unselect":"Select"},v=function(e){return e.map((function(e){return e.itemId}))},y=function(e,t){return Array.from(new Set([].concat((0,a.Z)(e),(0,a.Z)(t))))},b=function(e){var t,n,r,o=e.total,a=e.onSelect,c=e.preselected,p=e.itemIdsInTable,f=e.itemIdsOnPage,m=e.identifier,d=void 0===m?"id":m,v=!!a,b=(0,u.useState)(c),g=(0,l.Z)(b,2),E=g[0],O=g[1],P=(E||[]).length,w=f().length,j=P===o,x=0===P,T=(t=f(),0!==(n=E||[]).length&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e)})).length===e.length}(t,n)),C=0===o,Z=0!==(r=P)&&(r===o||null),S=function(e,t){return"".concat(e," selected")}(P),k=function(){var e=(0,i.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:n=e.sent,O(n),a&&a(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(e){return y(E,e)},V=function(e){return E.filter((function(t){return!e.includes(t)}))},I=function(){return[]},R=function(){return k(I)},D=function(){return k((function(){var e=f();return y(E,e).length===E.length?V(e):F(e)}))};return(0,u.useEffect)((function(){O(c)}),[c]),v?{selectedIds:E,selectNone:R,tableProps:{onSelect:o>0?function(e,t,n,r){return k((function(){return t?F([r[d]]):V([r[d]])}))}:void 0,canSelectAll:!1},toolbarProps:{bulkSelect:{toggleProps:{children:[S]},isDisabled:C,items:[{title:"Select none",onClick:R,props:{isDisabled:x}},{title:"".concat(h(T)," page (").concat(w," items)"),onClick:D},{title:"".concat(h(j)," all (").concat(o," items)"),onClick:function(){return k((0,i.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!j){e.next=4;break}e.t0=[],e.next=9;break;case 4:return e.t1=F,e.next=7,p();case 7:e.t2=e.sent,e.t0=(0,e.t1)(e.t2);case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)}))))}}],checked:Z,onSelect:C?void 0:D}}}:{}},g=function(e,t){return d(d({},e),{},{rowProps:{selected:(t||[]).includes(e.itemId)}})},E=function(e){var t=e.onSelect,n=e.items,o=e.filter,i=e.paginator,l=e.preselected,a=e.setPage,c=!!t,s=n.map((function(e){return g(e,l)})),m=s.length,h=o?o(s):s,y=h.length,E=y!==m,O=i?i(h):h,P=O.length,w=E?y:m,j=(0,u.useMemo)((function(){return a}),[]);(0,u.useEffect)((function(){0===P&&j(-1)}),[P,j]);var x=b({total:w,onSelect:t,preselected:l,itemIdsInTable:function(){return v(E?h:s)},itemIdsOnPage:function(){return v(O)},identifier:"itemId"}),T=x.selectNone,C=x.selectedIds,Z=(0,r.Z)(x,f);return c?d({transformer:function(e){return g(e,C)},selectedItems:p(s,C),selected:C,clearSelection:T},Z):{}}},76316:(e,t,n)=>{"use strict";n.d(t,{E9:()=>b,ZP:()=>g});var r=n(71002),o=n(15861),i=n(42982),l=n(87757),a=n.n(l),c=n(79886),s={csv:"text/csv",json:"application/json"},u=function(e){return"compliance-export-"+(new Date).toISOString()+"."+e},p=function(e){return"data:".concat(s[e],";charset=utf-8")},f=function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()},m=function(e,t){var n=t.exportKey,r=t.renderExport,o=n?(0,c.$s)(e,n):e;return r?r(o):o},d=function(e){var t=e.items,n=e.columns,r=[n.map((function(e){return e.original||e.title})).join(",")].concat((0,i.Z)(t.map((function(e){return n.map((function(t){return'"'.concat(m(e,t),'"')})).join(",")}))));return encodeURI("".concat(p("csv"),",").concat(r.join("\n")))},h=function(e){var t=e.items,n=e.columns,r=t.map((function(e){return n.reduce((function(t,n){var r=(0,c.eV)(n.original||n.title),o=m(e,n);return t[r]=o,t}),{})}));return encodeURI("".concat(p("json"),",").concat(JSON.stringify(r)))},v=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e&&e.apply(void 0,n)},y=function(e){var t=e.exporter,n=e.columns,r=void 0===n?[]:n,i=e.isDisabled,l=void 0!==i&&i,c=e.onStart,s=e.onComplete,p=e.onError,m=r.filter((function(e){return!1!==e.export&&(e.exportKey||e.renderExport)})),y=function(){var e=(0,o.Z)(a().mark((function e(n){var r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(c),e.next=3,t().then((function(e){return v(s,e),e})).catch((function(e){return v(p,e)}));case 3:if(r=e.sent,o="csv"===n?d:h,!r){e.next=9;break}return e.abrupt("return",f(o({items:r,columns:m}),u(n)));case 9:return console.info("No items returned for export"),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{toolbarProps:{exportConfig:{isDisabled:l,onSelect:function(e,t){return y(t)}}}}},b=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=null==n?void 0:n.exportable,i="object"===(0,r.Z)(n.exportable)?n.exportable:{},l=i.columns,a=i.onStart,c=i.onComplete,s=(l||t).filter((function(e){return t.includes(e)})),u=y({exporter:function(){return Promise.resolve(e)},columns:s,isDisabled:0===e.length,onStart:a,onComplete:c});return o?u:{}};const g=y},37948:(e,t,n)=>{"use strict";n.d(t,{Z:()=>R});var r=n(42982),o=n(15861),i=n(4942),l=n(70885),a=n(71002),c=n(87757),s=n.n(c),u=n(92950),p=n.n(u),f=n(45987),m=n(15671),d=n(44612),h=function(e){return e.split(" ").join("").toLowerCase()};const v=function e(t){var n=this;(0,m.Z)(this,e),(0,i.Z)(this,"buildFilterFilterString",(function(e,t){var n=e.type,r=e.filterString;if("hidden"!==n&&!t)return[];switch(n){case d.Y.text:return[r(t)];case d.Y.checkbox:return t.map((function(e){return r(e)}));case d.Y.group:return r(t);case"hidden":return r();default:return[]}})),(0,i.Z)(this,"combineFilterStrings",(function(e){var t=e.map((function(e){return e.length})).filter((function(e){return e>0})).length>=2;return e.map((function(e){return e.join(" or ")})).join(t?" and ":"")})),(0,i.Z)(this,"buildFilterString",(function(e){var t=n.config.map((function(t){return n.buildFilterFilterString(t,e[h(t.label)])})).filter((function(e){return e.length>0}));return n.combineFilterStrings(t)})),this.filterConfig=t,this.config=this.filterConfig.config};var y=function(e){return function(t){return String(t.value)===String(e)}};const b=function e(t){var n=this;(0,m.Z)(this,e),(0,i.Z)(this,"textFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:t}]}:null})),(0,i.Z)(this,"checkboxFilterChip",(function(e,t){return t&&t.length>0?{category:e,chips:t.map((function(t){return{name:n.filterConfig.labelForValue(t,e)}}))}:null})),(0,i.Z)(this,"radioFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:n.filterConfig.labelForValue(t,e)}]}:null})),(0,i.Z)(this,"groupFilterChip",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=Object.keys(t).flatMap((function(e){var o=n.items.find(y(e));return Object.keys(t[e]).map((function(n){return t[e][n]?[].concat((0,r.Z)(o.groupSelectable?[{label:o.label,value:o.value}]:[]),(0,r.Z)((null==o?void 0:o.items)||[])).find(y(n)):null}))})).filter((function(e){return!!e}));return t&&o.length>0?{category:e,chips:o.map((function(e){return{name:e.label}}))}:null})),(0,i.Z)(this,"chipFor",(function(e,t){var r=n.filterConfig.getCategoryForLabel(e),o=r||{label:e,type:null},i=o.label;switch(o.type){case d.Y.text:return n.textFilterChip(i,t);case d.Y.checkbox:return n.checkboxFilterChip(i,t);case d.Y.radio:return n.radioFilterChip(i,t);case d.Y.group:return n.groupFilterChip(i,t,r);default:return null}})),(0,i.Z)(this,"chipsFor",(function(e){return Object.keys(e).map((function(t){return n.chipFor(t,e[t])})).filter((function(e){return!!e}))})),this.filterConfig=t,this.config=this.filterConfig.config};function g(e){var t=function(e,t){if("object"!==(0,a.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==(0,a.Z)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"===(0,a.Z)(t)?t:String(t)}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){return"Filter by ".concat(e.toLowerCase())};var w=n(65832),j=n(45697),x=n.n(j),T=function(e){var t=e.isChecked,n=e.setActiveFilter;return p().createElement(w.Switch,{label:"Selected only",isChecked:t,onChange:function(){return n("selected",!t)}})};T.propTypes={isChecked:x().bool,setActiveFilter:x().func};const C=T,Z=function(e){var t=e.setActiveFilter,n=e.activeFilters,r=!!e.selectedFilter,o={type:"hidden",label:"selectFilter",key:"selected",default:!0,filter:function(e,t){return e.filter((function(e){var n;return(null==e||null===(n=e.rowProps)||void 0===n?void 0:n.selected)===t}))}},i=!0===n.selected;return r?{filterItem:o,toolbarProps:{dedicatedAction:p().createElement(C,{setActiveFilter:t,isChecked:i})}}:{}};function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){return Object.values(e).filter((function(e){return(0,a.Z)(e)===Object?Object.values(e).length>0:(0,a.Z)(e)===Array?e.length>0:!!e}))},V=new function e(t){var n=this;(0,m.Z)(this,e),(0,i.Z)(this,"chipBuilder",null),(0,i.Z)(this,"filterBuilder",null),(0,i.Z)(this,"addConfigItem",(function(e){return n.config=n.config.filter((function(t){return t.label!==e.label})).concat(e)})),(0,i.Z)(this,"getChipBuilder",(function(e){return e&&(n.config=e),n.chipBuilder=n.chipBuilder?n.chipBuilder:new b(n)})),(0,i.Z)(this,"getFilterBuilder",(function(e){return e&&(n.config=e),n.filterBuilder=n.filterBuilder?n.filterBuilder:new v(n)})),(0,i.Z)(this,"toTextFilterConfig",(function(e,t,n){return{type:d.Y.text,label:e.label,placeholder:P(e.label),id:h(e.label),filterValues:(0,i.Z)({value:n},e.event||"onChange",(function(n,r){t(h(e.label),r)}))}})),(0,i.Z)(this,"toCheckboxFilterConfig",(function(e,t,n){return{type:d.Y.checkbox,label:e.label,placeholder:P(e.label),id:h(e.label),filterValues:{value:n,items:e.items,onChange:function(n,r){t(h(e.label),r)}}}})),(0,i.Z)(this,"toRadioFilterConfig",(function(e,t,n){return{type:d.Y.radio,label:e.label,placeholder:P(e.label),id:h(e.label),filterValues:{value:n,items:e.items,onChange:function(n,r){t(h(e.label),r)}}}})),(0,i.Z)(this,"toGroupedFilterConfig",(function(e,t,n){return{type:d.Y.group,label:e.label,id:h(e.label),className:e.className,filterValues:{selected:n,onChange:function(n,r){t(h(e.label),r)},groups:e.items.map((function(e){return O(O({},e),{},{type:"checkbox",items:e.items.map((function(e){return O(O({},e),{},{type:"checkbox"})}))})}))}}})),(0,i.Z)(this,"toFilterConfigItem",(function(e,t,r){switch(e.type){case d.Y.text:return n.toTextFilterConfig(e,t,r);case d.Y.checkbox:return n.toCheckboxFilterConfig(e,t,r);case d.Y.radio:return n.toRadioFilterConfig(e,t,r);case d.Y.group:return n.toGroupedFilterConfig(e,t,r);default:return null}})),(0,i.Z)(this,"buildConfiguration",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;return O(O({},r),{},{items:(o||n.config).map((function(r){return n.toFilterConfigItem(r,e,t[h(r.label)])})).filter((function(e){return!!e}))})})),(0,i.Z)(this,"defaultValueForFilter",(function(e){switch(e.type){case d.Y.text:return"";case d.Y.checkbox:return[];case"hidden":return e.default||!1;default:return}})),(0,i.Z)(this,"initialDefaultState",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(t||n.config).reduce((function(t,r){var o=h(r.key||r.label),i=e[o]||n.defaultValueForFilter(r);return t[o]=i||void 0,t}),{})})),(0,i.Z)(this,"categoryLabelForValue",(function(e){var t=n.config.filter((function(t){return!!t.items&&t.items.map((function(e){return e.value})).includes(e)}))[0];return t?t.label:e})),(0,i.Z)(this,"getCategoryForLabel",(function(e){return n.config.filter((function(t){return h(t.key||t.label)===h(e)}))[0]||{}})),(0,i.Z)(this,"getItemByLabelOrValue",(function(e,t){var r=n.getCategoryForLabel(t),o=((r.type!==d.Y.group?r.items:r.items.flatMap((function(e){return e.items.map((function(t){return O(O({},t),{},{parentValue:e.value})}))})))||[]).filter((function(t){return t.value===e||t.label===e}));return 1===o.length?o[0]:o.length>1?(console.info("Multiple items found for ".concat(e," in ").concat(t,"! Returning first one.")),o[0]):void console.info("No item found for "+e+" in ",t)})),(0,i.Z)(this,"labelForValue",(function(e,t){var r=n.getItemByLabelOrValue(e,t);return r?r.label:e})),(0,i.Z)(this,"valueForLabel",(function(e,t){var r=n.getItemByLabelOrValue(e,t);return r?r.value:e})),(0,i.Z)(this,"applyFilterToObjectArray",(function(e,t){var o=(0,r.Z)(e);return Object.keys(t).forEach((function(e){var r=n.getCategoryForLabel(e),i=t[e];r&&i&&(i.length>0||"hidden"===r.type&&"boolean"==typeof i)&&(o=r.filter(o,i))})),o})),(0,i.Z)(this,"removeFilterFromFilterState",(function(e,t){return"string"==typeof e?"":e.filter((function(e){return e!==t}))})),(0,i.Z)(this,"removeFilterFromGroupFilterState",(function(e,t,n){var r=e[n.parentValue],o=n.value,l=(r[o],(0,f.Z)(r,[o].map(g)));return O(O({},e),{},(0,i.Z)({},n.parentValue,l))})),(0,i.Z)(this,"removeFilterWithChip",(function(e,t){var r=e.category,o=e.chips[0].name,l=n.getItemByLabelOrValue(o,r),a=l?l.value:o,c=h(r),s=t[c],u=(n.getCategoryForLabel(r).type===d.Y.group?n.removeFilterFromGroupFilterState:n.removeFilterFromFilterState)(s,a,l);return O(O({},t),{},(0,i.Z)({},c,u))})),this.config=t}([]),I=function(e,t){return"function"==typeof e?e(t):e};const R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filters,n=e.setPage,a=e.selectedFilter,c=e.onDeleteFilter,p=!!t,f=t||{},m=f.filterConfig,d=void 0===m?[]:m,h=f.activeFilters,v=(0,u.useState)({}),y=(0,l.Z)(v,2),b=y[0],g=y[1],E=I(h,b),O=function(e,t){g((function(n){return k(k({},n),{},(0,i.Z)({},e,t))})),n&&n(1)},P=function(e){V.addConfigItem(e),g(V.initialDefaultState(b))},w=function(){return g(V.initialDefaultState())},j=function(e){return g(V.removeFilterWithChip(e,b))},x=function(){var e=(0,o.Z)(s().mark((function e(t,n){var r,o=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]&&o[2],e.next=3,r;case 3:if(!e.sent){e.next=7;break}w(),e.next=8;break;case 7:j(n[0]);case 8:c&&c(n,r);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),T=function(e){return V.applyFilterToObjectArray(e,b)},C=Z({activeFilters:b,setActiveFilter:O,selectedFilter:a}),S=C.toolbarProps,R=C.filterItem,D=(0,u.useMemo)((function(){return F(b)}),[b]),B=[].concat((0,r.Z)(d),(0,r.Z)(R?[R]:[]));return(0,u.useEffect)((function(){return V.config=[],B.filter((function(e){return!!e})).forEach(P),g(V.initialDefaultState(E||[]),d),function(){V.config=[]}}),[JSON.stringify(E)]),p?{filter:T,selectedFilterToolbarProps:S,toolbarProps:{filterConfig:V.buildConfiguration(O,b,{},B),activeFiltersConfig:{filters:V.getChipBuilder(B).chipsFor(b),onDelete:x}},setActiveFilter:O,activeFilters:b,activeFilterValues:D,addConfigItem:P,filterConfigBuilder:V,filterString:function(){return V.getFilterBuilder(B).buildFilterString(b)}}:{}}},82176:(e,t,n)=>{"use strict";n.d(t,{C4:()=>l,T4:()=>a,qN:()=>p,uJ:()=>f,RT:()=>m});var r=n(4942);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l="Never",a=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return!e.compliant}))}))},c=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return e.compliant}))}))},s=function(e){return e.testResultProfiles?a(e.testResultProfiles):[]},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.reduce((function(e,t){return e&&!!t.supported}),!0)},p=function(e){return e.map((function(e){return i(i({},e),{},{ruleObjectsFailed:s(e),supported:u(e.testResultProfiles),profiles:e.testResultProfiles})}))},f=function(e){return e.flatMap((function(e){return e.rules.map((function(t){var n=t.identifier&&JSON.parse(t.identifier);return i(i({},t),{},{references:t.references?JSON.parse(t.references):[],identifier:n&&n.label?n:null,profile:e.profile})}))}))},m=function(e){var t=e.reduce((function(e,t){return e+t.score}),0),n=c(e).length,r=a(e).length,o=e.reduce((function(e,t){return c([t]).length+a([t]).length>0?e+1:e}),0);return{score:o?t/o:0,rulesPassed:n,rulesFailed:r,compliant:e.every((function(e){return e.lastScanned===l||!0===e.compliant})),supported:u(e)}}},65088:()=>{},37739:()=>{},87234:()=>{},75347:()=>{},31777:()=>{},34017:()=>{},59905:()=>{},64604:()=>{}}]);
//# sourceMappingURL=../sourcemaps/828.25e07dd37c7ebf71fd33c43b8af7317e.js.map