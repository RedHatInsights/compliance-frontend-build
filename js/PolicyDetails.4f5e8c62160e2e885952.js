(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[705],{77388:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PolicyDetails:()=>G,QUERY:()=>q,default:()=>N});var r=n(32465),i=n(92950),o=n.n(i),a=n(557),l=n(45697),s=n.n(l),c=n(44119),d=n.n(c),p=n(334),m=n(46829),u=n(32413),y=n(48716),f=n(39173),b=n(86350),h=n(6023),v=n(34171),E=n(52710),g=n(7648),S=(n(90129),n(2707)),O=function(e){var t=e.policy,n=(0,E.Wb)();return o().createElement(u.ToolbarItem,null,o().createElement(v.mR,{to:"/scappolicies/".concat(t.id,"/edit"),state:{policy:t},hash:n,backgroundLocation:{hash:n}},o().createElement(u.Button,{variant:"primary"},"Edit rules")))};O.propTypes={policy:s().object.isRequired};const V=O;var P=function(e){var t=e.loading,n=e.policy;return o().createElement(o().Fragment,null,o().createElement(u.Alert,{isInline:!0,variant:"info",title:"Rule editing is now available."},'Edit rules by clicking the "Edit rules" button in the toolbar. Rule can now be edited for each minor version of the RHEL OS associated with this policy and will be displayed in the policy after the "Edit rules" modal has been opened and saved.'),o().createElement(u.PageSection,{variant:u.PageSectionVariants.light},o().createElement(u.Text,{component:u.TextVariants.p},o().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",n.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),o().createElement(S.ZP,{remediationsEnabled:!1,columns:(0,S.eo)(["Name","Severity","Ansible"]),loading:t,profileRules:[{profile:{refId:n.refId,name:n.name},rules:n.rules}],toolbarItems:o().createElement(V,{policy:n})}))};P.propTypes={loading:s().bool,policy:s().shape({name:s().string,refId:s().string,rules:s().array,benchmark:s().object})};const T=P;var j=n(96156),I=n(85061),w=n(58820),k=n(27803),M=n(83324),R=n(77346);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,j.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t=e.policy,n=(0,R.ZP)("newInventory"),r=(0,R.ZP)("showSsgVersions"),i=n?w.e_:w.r0;return o().createElement(i,{showOsMinorVersionFilter:[t.majorOsVersion],query:k.Ep,policyId:t.id,defaultFilter:"policy_id = ".concat(t.id),showActions:!1,remediationsEnabled:!1,columns:[C({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},n&&{key:"display_name",renderFunc:function(e,t){return o().createElement(p.Link,{to:{pathname:"/systems/".concat(t)}}," ",e," ")}})].concat((0,I.Z)(r?[{key:"ssgVersion",title:"SSG version",renderFunc:function(e){var t,n,r=e;return"string"==typeof e&&(r=arguments.length<=2?void 0:arguments[2]),r&&o().createElement(M.n1.SSGVersion,{supported:r.supported,ssgVersion:(null===(t=r)||void 0===t?void 0:t.ssg_version)||(null===(n=r)||void 0===n?void 0:n.ssgVersion)})}}]:[]),[{key:"osMinorVersion",title:"Operating system",renderFunc:function(e,t,n){var r=n.osMajorVersion;return"RHEL ".concat(r,".").concat(e)}}]),complianceThreshold:t.complianceThreshold})};K.propTypes={policy:s().shape({id:s().string.isRequired,complianceThreshold:s().number.isRequired,majorOsVersion:s().number.isRequired}),systemTableProps:s().object};const x=K;var L=n(99030),_=n(79886),A=function(e){var t=e.policy,n=t.hosts,r=t.policy.profiles.filter((function(e){return!!e.osMinorVersion})),i=(0,L.UP)(n),a=r.sort((0,_.S)("osMinorVersion","desc")).map((function(e){var t;return{profile:e,systemCount:(null===(t=i[e.osMinorVersion])||void 0===t?void 0:t.count)||0}}));return o().createElement(o().Fragment,null,o().createElement(u.PageSection,{variant:u.PageSectionVariants.light},o().createElement(v.Hv,{tabsData:a,columns:(0,S.eo)(["Name","Severity","Ansible"]),level:1,toolbarItems:o().createElement(V,{policy:t})})))};A.propTypes={policy:s().object.isRequired};const D=A;n(23266);var F,q=d()(F||(F=(0,r.Z)(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                benchmark {\n                    id\n                    title\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n            osMinorVersion\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n        rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n    }\n}\n"]))),G=function(e){var t,n,r=e.route,l="details",s=(0,p.useParams)().policy_id,c=(0,p.useLocation)(),d=(0,E.Wb)(),S=(0,a.useDispatch)(),O=(0,m.useQuery)(q,{variables:{policyId:s}}),V=O.data,P=O.error,j=O.loading,I=O.refetch,w=!0;return V&&!j&&(w=!!(n=V.profile).policy.profiles.find((function(e){return!!e.osMinorVersion}))),(0,i.useEffect)((function(){I()}),[c,I]),(0,i.useLayoutEffect)((function(){S({type:"SELECT_ENTITIES",payload:{ids:[]}})}),[]),(0,g.a)(r,null===(t=n)||void 0===t?void 0:t.name),o().createElement(v.tC,{stateValues:{error:P,data:V,loading:j}},o().createElement(v.K7,{stateKey:"loading"},o().createElement(y.Z,null,o().createElement(v.PL,null)),o().createElement(b.Z,null,o().createElement(h.Z,null))),o().createElement(v.K7,{stateKey:"data"},n&&o().createElement(i.Fragment,null,o().createElement(y.Z,{className:"page-header-tabs"},o().createElement(u.Breadcrumb,null,o().createElement(v.MU,{to:"/"},"Compliance"),o().createElement(v.MU,{to:"/scappolicies"},"SCAP policies"),o().createElement(u.BreadcrumbItem,{isActive:!0},n.name)),o().createElement(u.Grid,{gutter:"lg"},o().createElement(u.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},o().createElement(f.Z,{title:n.name})),o().createElement(u.GridItem,{className:"policy-details-button",xl2:1,xl:2,lg:2,md:3,sm:3},o().createElement(v.mR,{to:"/scappolicies/".concat(n.id,"/edit"),state:{policy:n},hash:d,backgroundLocation:{hash:"details"}},o().createElement(u.Button,{variant:"secondary"},"Edit policy")))),o().createElement(v.tn,{"aria-label":"Policy Tabs",defaultTab:l},o().createElement(u.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),o().createElement(u.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),o().createElement(u.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),o().createElement(b.Z,null,o().createElement(v.Jm,{defaultTab:l},o().createElement(v.X8,{eventKey:"details"},o().createElement(v.NP,{policy:n})),o().createElement(v.X8,{eventKey:"rules"},w?o().createElement(D,{policy:n}):o().createElement(T,{policy:n})),o().createElement(v.X8,{eventKey:"systems"},o().createElement(x,{policy:n})))))))};G.propTypes={route:s().object};const N=G},87601:(e,t,n)=>{(t=n(23645)(!1)).push([e.id,".threshold-tooltip{margin-bottom:var(--pf-global--spacer--md)}.grey-icon{color:var(--pf-global--Color--200)}.policy-description{padding-top:10px}\n",""]),e.exports=t},23266:(e,t,n)=>{"use strict";var r=n(93379),i=n.n(r),o=n(87601),a=n.n(o),l=i()(a(),{insert:"head",singleton:!1});if(!a().locals||e.hot.invalidate){var s=a().locals;e.hot.accept(87601,(t=>{o=n(87601),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(s,(a=n.n(o))().locals)?(s=a().locals,l(a())):e.hot.invalidate()}))}e.hot.dispose((function(){l()})),a().locals}}]);