"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[402],{44434:(e,t,n)=>{n.r(t),n.d(t,{ComplianceSystems:()=>h,default:()=>v});var r,o=n(30168),i=n(92950),s=n.n(i),a=n(27450),c=n(90570),l=n(48716),u=n(39173),p=n(86350),d=n(29008),f=n(50323),m=n(27803),y=n(31499),b=(0,a.ZP)(r||(r=(0,o.Z)(['\n  {\n    profiles(search: "external = false and canonical = false") {\n      edges {\n        node {\n          id\n          name\n          refId\n          majorOsVersion\n        }\n      }\n    }\n  }\n']))),h=function(){var e,t=(0,c.a)(b),n=t.data,r=t.error,o=t.loading,i=null==n||null===(e=n.profiles)||void 0===e?void 0:e.edges.map((function(e){return e.node}));return s().createElement(s().Fragment,null,s().createElement(l.Z,{className:"page-header"},s().createElement(u.Z,{title:"Systems"})),s().createElement(p.Z,null,s().createElement(d.tC,{stateValues:{error:r,data:n,loading:o}},s().createElement(d.K7,{stateKey:"data"},i&&s().createElement(f.e_,{columns:[y.Zw({showLink:!0,showOsInfo:!0}),y.MO("tags"),y.rE,y.MO("updated",{isStatic:!0})],query:m.Ep,defaultFilter:"has_test_results = true or has_policy = true",systemProps:{isFullView:!0},showOsMinorVersionFilter:i.map((function(e){return e.majorOsVersion})),showComplianceSystemsInfo:!0,enableEditPolicy:!1,remediationsEnabled:!1,policies:i})))))};const v=h},69284:(e,t,n)=>{n.r(t),n.d(t,{CreatePolicy:()=>Oe,default:()=>je});var r,o=n(4942),i=n(29439),s=n(92950),a=n.n(s),c=n(334),l=n(33766),u=n(557),p=n(45697),d=n.n(p),f=n(95995),m=n(30168),y=n(91290),b=n(29008),h=n(27450),v=n(90570),g=n(28873),O=n(15113),E=n(46314),j=n(35592);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=(0,h.ZP)(r||(r=(0,m.Z)(['\n  query benchmarksAndProfiles {\n    latestBenchmarks {\n      id\n      title\n      refId\n      version\n      osMajorVersion\n      profiles {\n        id\n        name\n        refId\n        description\n        complianceThreshold\n      }\n    }\n    profiles(search: "external = false and canonical = false") {\n      edges {\n        node {\n          id\n          refId\n          benchmark {\n            refId\n          }\n        }\n      }\n    }\n  }\n']))),I=function(){return a().createElement(f.Tooltip,{position:"right",content:"Policy types are OpenSCAP policies that are supported by RHEL. For each major version of RHEL, users can create one policy of each type."},a().createElement(y.ZP,{className:"grey-icon"}))},T=function(e){var t=e.change,n=e.selectedBenchmarkId,r=e.selectedProfile,o=(0,v.a)(w,{fetchPolicy:"no-cache"}),i=o.data,s=o.error,c=o.loading;if(s)return s;if(c)return a().createElement(g.Z,null);var l,u,p,d,m=i.latestBenchmarks;if(n){l=m.find((function(e){return e.id===n}));var y=(p=i.profiles.edges,d=l,p.filter((function(e){return d.refId===e.node.benchmark.refId})).map((function(e){return e.node.refId})));u=l.profiles.map((function(e){return S(S({},e),{},{disabled:y.includes(e.refId)})}))}return a().createElement(a().Fragment,null,a().createElement(f.TextContent,null,a().createElement(f.Text,{component:f.TextVariants.h1,className:"pf-u-mb-md"},"Create SCAP policy"),a().createElement(f.Text,{className:"pf-u-mb-md"},"Select the operating system and policy type for this policy.")),a().createElement(f.Form,null,a().createElement(f.FormGroup,{label:"Operating system",isRequired:!0,fieldId:"benchmark"},m&&m.sort((function(e,t){return e.refId.localeCompare(t.refId)})).map((function(e){var r=e.id,o=e.osMajorVersion;return a().createElement(f.Tile,{key:r,className:"pf-u-mr-md",title:"RHEL ".concat(o),onClick:function(){return function(e){var n,r=e.id,o=e.osMajorVersion;(null===(n=l)||void 0===n?void 0:n.osMajorVersion)!==o&&t("systems",[]),t("benchmark",r),t("osMajorVersion",o)}(e)},isSelected:n===r,isStacked:!0})}))),a().createElement(f.FormGroup,{isRequired:!0,labelIcon:a().createElement(I,null),label:"Policy type",fieldId:"policy-type"},a().createElement(b.yL,{profiles:l&&u,onChange:function(e){t("selectedRuleRefIds",void 0),t("profile",e)},selectedProfile:r}))))};T.propTypes={selectedBenchmarkId:d().string,change:O.ZP.change,selectedProfile:d().object};var V=(0,l.Z)("policyForm");const R=(0,j.compose)((0,u.connect)((function(e){return{selectedBenchmarkId:V(e,"benchmark"),selectedProfile:V(e,"profile")}})),(0,E.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(T);var x,Z,k=n(92223),M=n(10530),C=n(94263);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=(0,h.ZP)(x||(x=(0,m.Z)(["\n  query Profiles($filter: String!) {\n    profiles(search: $filter) {\n      edges {\n        node {\n          id\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          policy {\n            id\n          }\n          policyType\n          benchmark {\n            id\n            refId\n            latestSupportedOsMinorVersions\n            osMajorVersion\n          }\n          ssgVersion\n          rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n          }\n        }\n      }\n    }\n  }\n"]))),B=(0,h.ZP)(Z||(Z=(0,m.Z)(["\n  query Benchmarks($filter: String!) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        latestSupportedOsMinorVersions\n        profiles {\n          id\n          refId\n          osMajorVersion\n          ssgVersion\n        }\n      }\n    }\n  }\n"]))),N=function(e){var t,n=e.policy,r=e.selectedRuleRefIds,o=e.change,i=e.osMajorVersion,c=e.osMinorVersionCounts,l=[C.VG,C.zb,C.PS],u=c.map((function(e){return e.osMinorVersion})).sort(),p="os_major_version = ".concat(i," ")+'and latest_supported_os_minor_version ^ "'.concat(u.join(","),'"'),d=(0,v.a)(B,{variables:{filter:p},skip:0===u.length}),m=d.data,y=d.error,h=d.loading,O=null==m||null===(t=m.benchmarks)||void 0===t?void 0:t.nodes,E=c.map((function(e){var t,r=e.osMinorVersion,o=e.count;if(r="".concat(r),O){var i=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(O,r);i&&(t=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(i,n.refId),t&&(t=F(F({},t),{},{benchmark:i})))}return{profile:t,systemCount:o,newOsMinorVersion:r}}));E=E.filter((function(e){return!!e.profile}));var j=(0,M.b4)(E),P=Object.keys(j),S=P.map((function(e){return"id = ".concat(e)})).join(" OR "),w=h||0===S.length,I=(0,v.a)(L,{variables:{filter:S},skip:w}),T=I.data,V=I.error,R=I.loading,x=y||V,Z=(null==P?void 0:P.length)>0?T:void 0,D=!(!R&&!h)||void 0,N=!x&&!D&&0===(null==P?void 0:P.length),q=w?[]:null==T?void 0:T.profiles.edges.map((function(e){return e.node})),A=function(e){o("selectedRuleRefIds",e)};return(0,s.useLayoutEffect)((function(){if(!D){var e=(0,M.uU)(q,j),t=(0,M.TB)(e,r,{only:!0});A(t)}}),[q,D]),a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-pb-md"},a().createElement(f.Text,{component:f.TextVariants.h1},"Rules"),a().createElement(f.Text,null,"Customize your ",a().createElement("b",null,n.name)," SCAP policy by including and excluding rules."),a().createElement(f.Text,null,"Each release of RHEL is supported with a unique and specific version of the SCAP Security Guide (SSG). You must customize each version of SSG for each release of RHEL.")),a().createElement(b.tC,{stateValues:{error:x,data:Z,loading:D,noRuleSets:N}},a().createElement(b.K7,{stateKey:"noRuleSets"},a().createElement(f.EmptyState,null,a().createElement(f.Title,{headingLevel:"h1",size:"xl"},"No rules can be configured"),a().createElement(f.EmptyStateBody,null,"The policy type selected does not exist for the systems and OS versions selected in the previous steps."))),a().createElement(b.K7,{stateKey:"loading"},a().createElement(k.Z,null,a().createElement(g.Z,null))),a().createElement(b.K7,{stateKey:"data"},a().createElement(M.Hv,{tabsData:E,selectedRuleRefIds:r,columns:l,remediationsEnabled:!1,selectedFilter:!0,level:1,setSelectedRuleRefIds:A,ouiaId:"RHELVersions"}))))};N.propTypes={policy:d().object,change:O.ZP.change,osMajorVersion:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number})),selectedRuleRefIds:d().array};var q=(0,l.Z)("policyForm");const A=(0,j.compose)((0,u.connect)((function(e){return{policy:JSON.parse(q(e,"profile")),osMajorVersion:q(e,"osMajorVersion"),osMinorVersionCounts:q(e,"osMinorVersionCounts"),selectedRuleRefIds:q(e,"selectedRuleRefIds")}})),(0,E.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(N);var $=n(50323),_=n(27803),U=n(99030),K=n(31499);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=function(e){var t=e.osMajorVersion;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"You do not have any ",a().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.",a().createElement("br",null),"Policies must be created with at least one system.")),a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"Choose a different operating system, or connect"," ",a().createElement("b",null,"RHEL ",t)," systems to Insights.")),a().createElement(f.WizardContextConsumer,null,(function(e){var t=e.goToStepById;return a().createElement(f.Button,{onClick:function(){return t(1)}},"Choose a different operating system")})))};z.propTypes={osMajorVersion:d().string};var W=function(e){var t=e.osMajorVersion;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"Select which of your ",a().createElement("b",null,"RHEL ",t)," systems should be included in this policy.",a().createElement("br",null),"Systems can be added or removed at any time.")))};W.propTypes={osMajorVersion:d().string};var J=function(e){var t=e.change,n=e.osMajorVersion,r=e.selectedSystems;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,{component:f.TextVariants.h1},"Systems")),a().createElement(f.Form,null,a().createElement(f.FormGroup,null,a().createElement($.e_,{showOsMinorVersionFilter:[n],prependComponent:a().createElement(W,{osMajorVersion:n}),emptyStateComponent:a().createElement(z,{osMajorVersion:n}),columns:[G(G({},K.VG),{},{props:{width:40},sortBy:["name"]}),K.MO("tags"),G(G({},K.U5),{},{props:{},sortBy:["osMajorVersion","osMinorVersion"]})],remediationsEnabled:!1,compact:!0,showActions:!1,query:_.Y0,defaultFilter:n&&"os_major_version = ".concat(n),enableExport:!1,preselectedSystems:r,onSelect:function(e){t("systems",e),t("osMinorVersionCounts",(0,U.Nw)(e))}}))))};J.propTypes={osMajorVersion:d().string,selectedSystems:d().array,change:O.ZP.change},J.defaultProps={selectedSystems:[]};var Y=(0,l.Z)("policyForm");const Q=(0,j.compose)((0,u.connect)((function(e){return{osMajorVersion:Y(e,"osMajorVersion"),selectedSystems:Y(e,"systems")}})),(0,E.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(J);var X=n(6455),ee=n(74726),te=function(e){var t=e.change,n=e.policy,r=e.refId;return(0,s.useEffect)((function(){n&&n.refId!==r&&(t("name","".concat(n.name)),t("refId","".concat(n.refId)),t("description","".concat(n.description)))}),[n]),a().createElement(a().Fragment,null,a().createElement(f.TextContent,null,a().createElement(f.Text,{component:f.TextVariants.h1},"Details")),a().createElement("br",null),a().createElement(f.Form,{id:"editpolicydetails"},a().createElement(f.FormGroup,{label:"Policy name",isRequired:!0,fieldId:"name"},a().createElement(X.Z,{component:ee._c,type:"text",isRequired:!0,id:"name",name:"name","aria-describedby":"name"})),a().createElement(f.FormGroup,{label:"Reference ID",isRequired:!0,fieldId:"refId"},a().createElement(X.Z,{type:"text",component:ee._c,isDisabled:!0,id:"refId",name:"refId","aria-describedby":"refId"})),a().createElement(f.FormGroup,{label:"Description",fieldId:"description"},a().createElement(X.Z,{type:"text",component:ee.do,id:"description",name:"description","aria-describedby":"description"})),a().createElement(f.FormGroup,{label:"Business objective",labelIcon:a().createElement(b.xB,null),fieldId:"businessObjective"},a().createElement(X.Z,{type:"text",component:ee._c,id:"businessObjective",name:"businessObjective","aria-describedby":"businessObjective",defaultValue:n.businessObjective})),a().createElement(b._z,{previousThreshold:n.complianceThreshold})))},ne=(0,l.Z)("policyForm");te.propTypes={policy:d().object,refId:d().string,change:O.ZP.change};const re=(0,j.compose)((0,u.connect)((function(e){var t=JSON.parse(ne(e,"profile"));return{policy:t,refId:ne(e,"refId"),initialValues:{name:"".concat(t.name),refId:"".concat(t.refId),description:"".concat(t.description),benchmark:ne(e,"benchmark"),osMajorVersion:ne(e,"osMajorVersion"),profile:ne(e,"profile")}}})),(0,E.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(te);var oe,ie=(0,h.ZP)(oe||(oe=(0,m.Z)(["\n  query review($benchmarkId: String!) {\n    benchmark(id: $benchmarkId) {\n      id\n      osMajorVersion\n    }\n  }\n"]))),se=function(e){var t=e.benchmarkId,n=e.name,r=e.businessObjective,o=e.complianceThreshold,i=e.parentProfileName,s=e.osMinorVersionCounts,c=(0,v.a)(ie,{variables:{benchmarkId:t}}),l=c.data,u=c.error,p=c.loading;if(u)return u;if(p)return a().createElement(g.Z,null);var d=l.benchmark.osMajorVersion;return a().createElement(f.TextContent,null,a().createElement(f.Text,{component:f.TextVariants.h1},"Review"),a().createElement(f.Text,null,"Review your SCAP policy before finishing."),a().createElement(f.Text,{component:f.TextVariants.h3,style:{marginTop:0}},n),a().createElement(f.TextList,{component:f.TextListVariants.dl},a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Policy type"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},i),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Compliance threshold"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},o,"%"),r&&a().createElement(a().Fragment,null,a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Business objective"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},r)),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Systems"),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},a().createElement(f.TextList,{component:f.TextListVariants.dl},s.map((function(e){var t=e.osMinorVersion,n=e.count;return a().createElement(a().Fragment,{key:t},a().createElement(f.TextListItem,{component:f.TextListItemVariants.dt,style:{fontWeight:"normal"}},"RHEL ",d,".",t),a().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},n," ",n>1?"systems":"system"))}))))))};se.propTypes={benchmarkId:d().string,refId:d().string,name:d().string,businessObjective:d().string,complianceThreshold:d().number,parentProfileName:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number}))};var ae=(0,l.Z)("policyForm");const ce=(0,u.connect)((function(e){return{benchmarkId:ae(e,"benchmark"),refId:ae(e,"refId"),name:ae(e,"name"),businessObjective:ae(e,"businessObjective"),osMinorVersionCounts:ae(e,"osMinorVersionCounts"),complianceThreshold:parseFloat(ae(e,"complianceThreshold"))||100,parentProfileName:JSON.parse(ae(e,"profile")).name,rulesCount:ae(e,"selectedRuleRefIds").length}}))(se);var le=n(5913),ue=n(19398),pe=n(84351),de=n(65811),fe=function(e){var t=e.errors;return t&&Array.isArray(t)&&t.length>0?a().createElement(f.EmptyStateBody,{className:"wizard-failed-errors"},a().createElement(f.List,null,t.map((function(e){return a().createElement(f.ListItem,{key:e},e)})))):null};fe.propTypes={errors:d().array};var me=function(e){var t=e.onWizardFinish,n=e.cloneFromProfileId,r=e.description,o=e.name,l=e.complianceThreshold,u=e.businessObjective,p=e.refId,d=e.benchmarkId,m=e.systems,y=e.selectedRuleRefIds,h=(0,s.useState)(0),v=(0,i.Z)(h,2),g=v[0],O=v[1],E=(0,s.useState)("This usually takes a minute or two."),j=(0,i.Z)(E,2),P=j[0],S=j[1],w=(0,s.useState)(null),I=(0,i.Z)(w,2),T=I[0],V=I[1],R=(0,s.useState)(!1),x=(0,i.Z)(R,2),Z=x[0],k=x[1],M=(0,pe.a7)(),C=function(e){O(100*e)};return(0,s.useEffect)((function(){M(null,{cloneFromProfileId:n,description:r,name:o,complianceThreshold:l,businessObjective:{title:u},refId:p,benchmarkId:d,hosts:m,selectedRuleRefIds:y},C).then((function(e){var t=e.id;O(100),S(),(0,de.q)({variant:"success",title:'Created policy "'.concat(o,'"'),autoDismiss:!0,description:a().createElement("span",null,"From the ",a().createElement("strong",null,"SCAP Policies")," list, open"," ",a().createElement(c.Link,{to:"/scappolicies/".concat(t)},o),".")})})).catch((function(e){var t,n,r;S(null===(t=e.networkError)||void 0===t?void 0:t.message),V(null===(n=e.networkError)||void 0===n||null===(r=n.result)||void 0===r?void 0:r.errors),k(!0),(0,de.q)({variant:"danger",title:"Error creating policy",description:e.message})}))}),[]),a().createElement(f.Bullseye,null,a().createElement(f.EmptyState,{variant:f.EmptyStateVariant.full},a().createElement(f.EmptyStateIcon,{icon:le.ZP}),a().createElement("br",null),a().createElement(f.Title,{headingLevel:"h1",size:"lg"},"Creating policy"),a().createElement(f.EmptyStateBody,null,a().createElement(b.ko,{percent:g,failed:Z})),a().createElement(f.EmptyStateBody,{className:Z&&"wizard-failed-message"},P),a().createElement(fe,{error:T}),a().createElement(f.EmptyStateSecondaryActions,null,(100===g||Z)&&a().createElement(f.Button,{variant:"primary",ouiaId:"ReturnToAppButton",onClick:function(){t()}},Z?"Back":"Return to application"))))};me.propTypes={benchmarkId:d().string.isRequired,businessObjective:d().object,cloneFromProfileId:d().string.isRequired,refId:d().string.isRequired,name:d().string.isRequired,description:d().string,systems:d().array,complianceThreshold:d().number,onWizardFinish:d().func,selectedRuleRefIds:d().arrayOf(d().string).isRequired};var ye=(0,l.Z)("policyForm");const be=(0,j.compose)((0,u.connect)((function(e){return{benchmarkId:ye(e,"benchmark"),businessObjective:ye(e,"businessObjective"),cloneFromProfileId:JSON.parse(ye(e,"profile")).id,refId:ye(e,"refId"),name:ye(e,"name"),description:ye(e,"description"),complianceThreshold:parseFloat(ye(e,"complianceThreshold"))||100,systems:ye(e,"systems"),selectedRuleRefIds:ye(e,"selectedRuleRefIds")}})),(0,E.Z)({form:"policyForm",destroyOnUnmount:!0,forceUnregisterOnUnmount:!0}),ue.C)(me);var he=n(70597);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=function(e){var t=e.benchmark,n=e.osMajorVersion,r=e.complianceThreshold,o=e.name,l=e.profile,u=e.refId,p=e.selectedRuleRefIds,d=e.systemIds,m=(0,c.useHistory)(),y=(0,s.useState)(1),b=(0,i.Z)(y,2),h=b[0],v=b[1],g=function(){var e=m.location;e.hash&&m.push(ge(ge({},e),{},{hash:""}))},O=function(){m.push("/scappolicies")},E=[{id:1,name:"Create SCAP policy",component:a().createElement(R,null),enableNext:(0,he.$H)(t,n,l)},{id:2,name:"Details",component:a().createElement(re,null),canJumpTo:h>=2,enableNext:(0,he.Ay)(o,u,r)},{id:3,name:"Systems",component:a().createElement(Q,null),canJumpTo:h>=3,enableNext:(0,he.Qy)(d)},{id:4,name:"Rules",component:a().createElement(A,null),canJumpTo:(null==d?void 0:d.length)>0&&h>=4,enableNext:(0,he.hT)(p)},{id:5,name:"Review",component:a().createElement(ce,null),nextButtonText:"Finish",canJumpTo:(0,he.hT)(p)&&(null==d?void 0:d.length)>0&&h>=5},{id:6,name:"Finished",component:a().createElement(be,{onWizardFinish:O}),isFinishedStep:!0,canJumpTo:(null==d?void 0:d.length)>0&&h>=6}];return a().createElement(a().Fragment,null,a().createElement(f.Wizard,{className:"compliance",isOpen:!0,onNext:function(e){var t=e.id;v(h<t?t:h),g()},onGoToStep:g,onBack:g,onClose:O,title:"Create SCAP policy",description:"Create a new policy for managing SCAP compliance",steps:E}))};Oe.propTypes={benchmark:d().string,osMajorVersion:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number})),complianceThreshold:d().string,businessObjective:d().object,dispatch:d().func,isOpen:d().bool,name:d().string,onWizardFinish:d().func,profile:d().string,refId:d().string,selectedRuleRefIds:d().arrayOf(d().string),systemIds:d().arrayOf(d().string)},Oe.defaultProps={isOpen:!1};var Ee=(0,l.Z)("policyForm");const je=(0,u.connect)((function(e){return{benchmark:Ee(e,"benchmark"),osMajorVersion:Ee(e,"osMajorVersion"),osMinorVersionCounts:Ee(e,"osMinorVersionCounts"),businessObjective:Ee(e,"businessObjective"),complianceThreshold:Ee(e,"complianceThreshold")||"100.0",name:Ee(e,"name"),profile:Ee(e,"profile"),refId:Ee(e,"refId"),selectedRuleRefIds:Ee(e,"selectedRuleRefIds"),systemIds:Ee(e,"systems")}}))(Oe)},38879:(e,t,n)=>{n.r(t),n.d(t,{EditPolicy:()=>re,MULTIVERSION_QUERY:()=>ne,default:()=>oe});var r=n(4942),o=n(29439),i=n(30168),s=n(92950),a=n.n(s),c=n(45697),l=n.n(c),u=n(334),p=n(27450),d=n(90570),f=n(95995),m=n(7648),y=n(29008),b=n(70597);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e){var t,n=e.policy,r=e.setUpdatedPolicy,i=function(){var e=(0,s.useState)(!0),t=(0,o.Z)(e,2),n=t[0],r=t[1];return[n,function(e){var t=(0,b.KJ)(e);return r(t),t}]}(),c=(0,o.Z)(i,2),l=c[0],u=c[1];return a().createElement("div",{className:"pf-c-form"},a().createElement(f.FormGroup,{label:"Policy description",isRequired:!0,fieldId:"description"},a().createElement(f.TextArea,{style:{width:800,height:110},isRequired:!0,type:"text",id:"description",name:"description","aria-describedby":"description",defaultValue:n.description,onChange:function(e){r((function(t){return v(v({},t),{},{description:e})}))}})),a().createElement(f.FormGroup,{label:"Business objective",labelIcon:a().createElement(y.xB,null),fieldId:"business-objective"},a().createElement(f.TextInput,{type:"text",style:{width:300},id:"business-objective",name:"business-objective","aria-describedby":"business-objective",defaultValue:null==n||null===(t=n.businessObjective)||void 0===t?void 0:t.title,onChange:function(e){r((function(t){return v(v({},t),{},{businessObjective:v(v({},t.businessObjective),{},{title:e})})}))}})),a().createElement(f.FormGroup,{validated:l?"default":"error",label:"Compliance threshold (%)",labelIcon:a().createElement(y.w8,null),fieldId:"policy-threshold",helperTextInvalid:"Threshold has to be a number between 0 and 100",helperText:"A value of 95% or higher is recommended"},a().createElement(f.TextInput,{type:"number",style:{width:150},name:"compliance-threshold",id:"compliance-threshold",defaultValue:n.complianceThreshold,"aria-describedby":"policy-threshold",onChange:function(e){r((function(t){return v(v({},t),{},{complianceThreshold:e,complianceThresholdValid:u(e)})}))}})))};g.propTypes={policy:l().shape({description:l().string,businessObjective:l().object,complianceThreshold:l().oneOfType([l().string,l().number])}),setUpdatedPolicy:l().func};const O=g;var E,j,P=n(92223),S=n(28873),w=n(10530),I=n(79886),T=n(94263);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=(0,p.ZP)(E||(E=(0,i.Z)(["\n  query Profiles($filter: String!) {\n    profiles(search: $filter) {\n      edges {\n        node {\n          id\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          policy {\n            id\n          }\n          policyType\n          benchmark {\n            id\n            refId\n            latestSupportedOsMinorVersions\n            osMajorVersion\n          }\n          ssgVersion\n          rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n          }\n        }\n      }\n    }\n  }\n"]))),Z=(0,p.ZP)(j||(j=(0,i.Z)(["\n  query Benchmarks($filter: String!) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        latestSupportedOsMinorVersions\n        profiles {\n          id\n          refId\n          ssgVersion\n        }\n      }\n    }\n  }\n"]))),k=function(){return a().createElement(f.EmptyState,null,a().createElement(f.Title,{headingLevel:"h5",size:"lg"},"No rules can be configured"),a().createElement(f.EmptyStateBody,null,"This policy has no associated systems, and therefore no rules can be configured."),a().createElement(f.EmptyStateBody,null,"Add at least one system to configure rules for this policy."))},M=function(e){var t,n=e.policy,r=e.selectedRuleRefIds,o=e.setSelectedRuleRefIds,i=e.osMinorVersionCounts,c=e.setNewRuleTabs,l=null==n?void 0:n.osMajorVersion,u=Object.keys(i).sort(),p="os_major_version = ".concat(l," ")+'and latest_supported_os_minor_version ^ "'.concat(u.join(","),'"'),m=(0,d.a)(Z,{variables:{filter:p},skip:0===u.length}),b=m.data,h=m.error,v=m.loading,g=null==b||null===(t=b.benchmarks)||void 0===t?void 0:t.nodes,O=function(e,t,n){return Object.values(t).sort((0,I.Sj)("osMinorVersion","desc")).map((function(t){var r=t.osMinorVersion,o=t.count;r="".concat(r);var i=e.policy.profiles.find((function(e){return e.osMinorVersion===r})),s=e.osMajorVersion;if(!i&&n){var a=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(n,r);if(a){var c=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(a,e.refId);c&&(i=e.policy.profiles.find((function(e){return e.parentProfileId===c.id&&e.osMinorVersion===r})),i=R(R({},c),{},{benchmark:a,osMajorVersion:s},i))}}return{profile:i,systemCount:o,newOsMinorVersion:r}})).filter((function(e){var t=e.profile,n=e.newOsMinorVersion;return!!t&&n}))}(n,i,g),E=(0,w.b4)(O),j=Object.keys(E).map((function(e){return"id = ".concat(e)})).join(" OR "),V=(0,d.a)(x,{variables:{filter:j},skip:0===j.length}),M=V.data,C=V.error,D=!(!V.loading&&!v)||void 0,F=!D&&(null==O?void 0:O.length)>0?M:void 0;D||c(!!O.find((function(e){return n.policy.profiles.find((function(t){return t.osMinorVersion!==e.newOsMinorVersion}))}))),(0,s.useLayoutEffect)((function(){if(M){var e=(null==M?void 0:M.profiles.edges.map((function(e){return e.node})))||[],t=(0,w.uU)(e,E);o((function(e){return(0,w.TB)(t,e)}))}}),[M]);var L=h||C;return a().createElement(y.tC,{stateValues:{error:L,data:!L&&F,loading:D,empty:!D&&!F&&!L}},a().createElement(y.K7,{stateKey:"loading"},a().createElement(P.Z,null,a().createElement(S.Z,null))),a().createElement(y.K7,{stateKey:"data"},a().createElement(f.TextContent,null,a().createElement(f.Text,null,"Different release versions of RHEL are associated with different versions of the SCAP Security Guide (SSG), therefore each release must be customized independently.")),a().createElement(w.Hv,{columns:[T.VG,T.zb,T.PS],tabsData:O,selectedRuleRefIds:r,setSelectedRuleRefIds:o,remediationsEnabled:!1,selectedFilter:!0,level:1,ouiaId:"RHELVersions"})),a().createElement(y.K7,{stateKey:"empty"},a().createElement(k,null)))};M.propTypes={setNewRuleTabs:l().func,policy:l().object,osMinorVersionCounts:l().shape({osMinorVersion:l().shape({osMinorVersion:l().number,count:l().number})}),selectedRuleRefIds:l().array,setSelectedRuleRefIds:l().func};const C=M;var D=n(50323),F=n(27803),L=n(31499);function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t=e.osMajorVersion;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"You do not have any ",a().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.")),a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"Connect RHEL ",t," systems to Insights.")))};q.propTypes={osMajorVersion:l().string};var A=function(e){var t=e.osMajorVersion;return a().createElement(a().Fragment,null,a().createElement(f.TextContent,{className:"pf-u-mb-md"},a().createElement(f.Text,null,"Select which of your ",a().createElement("b",null,"RHEL ",t)," systems should be included in this policy.")))};A.propTypes={osMajorVersion:l().string};var $=function(e){var t=e.policy,n=t.id,r=t.osMajorVersion,o=e.newRuleTabs,i=e.onSystemSelect,s=e.selectedSystems,c=(0,u.useHistory)(),l=c.push,p=c.location;return a().createElement(a().Fragment,null,a().createElement(D.e_,{columns:[L.VG,L.MO("tags"),L.U5],showOsMinorVersionFilter:[r],prependComponent:a().createElement(A,{osMajorVersion:r}),emptyStateComponent:a().createElement(q,{osMajorVersion:r}),compact:!0,showActions:!1,query:F.Y0,defaultFilter:r&&"os_major_version = ".concat(r," or policy_id = ").concat(n),enableExport:!1,remediationsEnabled:!1,preselectedSystems:s,onSelect:i}),o&&a().createElement(f.Alert,{variant:"info",isInline:!0,title:"You selected a system that has a release version previously not included in this policy.",actionLinks:a().createElement(f.AlertActionLink,{onClick:function(){return l(N(N({},p),{},{hash:"#rules"}))}},"Open rule editing")},a().createElement("p",null,"If you have edited any rules for this policy, you will need to do so for this release version as well.")))};$.propTypes={policy:l().object,newRuleTabs:l().bool,onSystemSelect:l().func,selectedSystems:l().array};const _=$;var U=n(99030);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(e){var t,n=e.policy,r=e.setUpdatedPolicy,i=e.selectedRuleRefIds,c=e.setSelectedRuleRefIds,l=e.selectedSystems,u=e.setSelectedSystems,p=(null==n||null===(t=n.policy)||void 0===t?void 0:t.profiles)||[],d=(0,s.useState)({}),m=(0,o.Z)(d,2),b=m[0],h=m[1],v=(0,s.useState)(!1),g=(0,o.Z)(v,2),E=g[0],j=g[1],P=function(e){var t;u(e),h((t=e,(p||[]).reduce((function(e,t){var n;return""!==t.osMinorVersion&&(e[n=t.osMinorVersion]||(e[n]={osMinorVersion:t.osMinorVersion,count:0})),e}),(0,U.UP)(t||[]))))};return(0,s.useEffect)((function(){if(n){var e=n.complianceThreshold<101&&n.complianceThreshold>0;r(H(H({},n),{},{complianceThresholdValid:e})),function(){if(n){var e=p.filter((function(e){return!!e.osMinorVersion}));c((0,w.TB)(e))}}(),P(n.hosts)}}),[n]),a().createElement(f.Form,null,a().createElement(y.tn,{ouiaId:"EditPolicy",defaultTab:"details"},a().createElement(f.Tab,{eventKey:"details",ouiaId:"Details",title:a().createElement(f.TabTitleText,null,"Details")},a().createElement(O,{policy:n,setUpdatedPolicy:r})),a().createElement(f.Tab,{eventKey:"rules",ouiaId:"Rules",title:a().createElement(f.TabTitleText,null,"Rules")},a().createElement(C,{policy:n,setNewRuleTabs:j,setSelectedRuleRefIds:c,selectedRuleRefIds:i,osMinorVersionCounts:b})),a().createElement(f.Tab,{eventKey:"systems",ouiaId:"Systems",title:a().createElement(f.TabTitleText,null,"Systems")},a().createElement(_,{policy:n,newRuleTabs:E,selectedSystems:l,onSystemSelect:P}))))};G.propTypes={policy:l().object,setUpdatedPolicy:l().func,selectedRuleRefIds:l().arrayOf(l().object),setSelectedRuleRefIds:l().func,setSelectedSystems:l().func,selectedSystems:l().array};const z=G;var W,J=n(84351),Y=n(52710),Q=n(65811),X=function(){var e=(0,Y.Wb)(),t=(0,Y.C3)("/scappolicies");return function(){t({hash:e})}};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=(0,p.ZP)(W||(W=(0,i.Z)(["\n  query Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      external\n      description\n      totalHostCount\n      compliantHostCount\n      complianceThreshold\n      majorOsVersion\n      osMajorVersion\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        refId\n        profiles {\n          id\n          ssgVersion\n          parentProfileId\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          benchmark {\n            id\n            title\n            latestSupportedOsMinorVersions\n            osMajorVersion\n          }\n          rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n      hosts {\n        id\n        osMinorVersion\n        osMajorVersion\n      }\n    }\n  }\n"]))),re=function(e){var t=e.route,n=(0,u.useParams)().policy_id,r=(0,d.a)(ne,{variables:{policyId:n}}),i=r.data,c=r.loading,l=r.error,p=null==i?void 0:i.profile,b=X(),h=(0,s.useState)(null),v=(0,o.Z)(h,2),g=v[0],O=v[1],E=(0,s.useState)([]),j=(0,o.Z)(E,2),P=j[0],S=j[1],w=(0,s.useState)([]),I=(0,o.Z)(w,2),T=I[0],V=I[1],R=g&&!g.complianceThresholdValid,x=function(e,t){var n=(0,J.a7)(),r=X(),i=(0,s.useState)(!1),a=(0,o.Z)(i,2),c=a[0],l=a[1];return[c,function(){if(c)return Promise.resolve({});l(!0),n(e,t).then((function(){l(!1),(0,Q.q)({variant:"success",title:"Policy updated",autoDismiss:!0}),r()})).catch((function(e){l(!1),(0,Q.q)({variant:"danger",title:"Error updating policy",description:e.message}),r()}))}]}(p,te(te({},g),{},{selectedRuleRefIds:P,hosts:T})),Z=(0,o.Z)(x,2),k=Z[0],M=Z[1],C=[a().createElement(f.Button,{isDisabled:R,key:"save",ouiaId:"EditPolicySaveButton",variant:"primary",spinnerAriaValueText:"Saving",isLoading:k,onClick:M},"Save"),a().createElement(f.Button,{key:"cancel",ouiaId:"EditPolicyCancelButton",variant:"link",onClick:function(){return b()}},"Cancel")];return(0,m.a)(t,null==p?void 0:p.name),a().createElement(y.C,{isOpen:!0,position:"top",style:{minHeight:"350px"},variant:"large",ouiaId:"EditPolicyModal",title:"Edit ".concat(p?p.name:""),onClose:function(){return b()},actions:C},a().createElement(y.tC,{stateValues:{policy:p,loading:c,error:l}},a().createElement(y.K7,{stateKey:"loading"},a().createElement(f.Spinner,null)),a().createElement(y.K7,{stateKey:"policy"},a().createElement(z,{policy:p,updatedPolicy:g,setUpdatedPolicy:O,selectedRuleRefIds:P,setSelectedRuleRefIds:S,selectedSystems:T,setSelectedSystems:V}))))};re.propTypes={route:l().object};const oe=re},31499:(e,t,n)=>{n.d(t,{OF:()=>N,ll:()=>B,Hc:()=>q,VG:()=>C,U5:()=>A,rE:()=>L,hN:()=>F,Zw:()=>D,MO:()=>$});var r=n(4942),o=n(45987),i=n(34168),s=n(29008),a=n(82176),c=n(79886),l=n(87462),u=n(92950),p=n.n(u),d=n(45697),f=n.n(d),m=n(334),y=n(95995),b=n(62410),h=n(67585),v=function(e){var t=e.id,n=e.children;return p().createElement(m.Link,{to:{pathname:"/systems/".concat(t)}},n)};v.propTypes={id:f().string,children:f().node};var g=function(e){var t=e.id,n=e.name,r=e.osMajorVersion,o=e.osMinorVersion,i=e.showOsInfo,s=void 0!==i&&i,a=e.showLink,c=void 0!==a&&a;return p().createElement(y.TextContent,null,c?p().createElement(v,{id:t},n):n,function(e,t){return!!e&&!!t&&s}(r,o)&&p().createElement(y.Text,{component:y.TextVariants.small},"RHEL ",r,".",o))};g.propTypes={id:f().string,name:f().string,osMajorVersion:f().string,osMinorVersion:f().string,showOsInfo:f().bool,showLink:f().bool};var O=function(e){var t=e.ssgVersion,n=void 0===t?"Not available":t;return e.supported?n:p().createElement(s.cT,{messageVariant:"singular"},n)};O.propTypes={supported:f().bool,ssgVersion:f().string};var E=function(e){var t=e.testResultProfiles,n=void 0===t?[]:t;return 0!==n.length?n.map((function(e){return p().createElement(O,(0,l.Z)({key:"ssgversion-".concat(e.id)},e))})):"Not available"};E.propTypes={testResultProfiles:f().array};var j=function(e){var t=e.id,n=e.testResultProfiles;return(void 0===n?[]:n).length>0?p().createElement(v,{id:t},"View Report"):""};j.propTypes={id:f().string,testResultProfiles:f().array};var P=function(e){var t=e.policies;return(t||[]).length>0&&p().createElement(h.Z,{inline:!0,text:t.map((function(e){return e.name})).join(", "),length:215})};P.propTypes={policies:f().array};var S=function(e){var t=e.id,n=e.testResultProfiles,r=(0,a.T4)(n).length;return p().createElement(v,{id:t},r)};S.propTypes={id:f().string,testResultProfiles:f().array};var w=function(e){var t=e.testResultProfiles;return(0,s.OF)((0,a.RT)(t))};w.propTypes={testResultProfiles:f().array};var I=function(e){var t=e.map((function(e){return new Date(e.lastScanned)})),n=new Date(Math.max.apply(null,t.filter((function(e){return isFinite(e)}))));return n instanceof Date&&isFinite(n)?n:a.C4},T=function(e){var t=e.testResultProfiles,n=I(t||[]);return n instanceof Date?p().createElement(b.Z,{date:Date.parse(n),type:"relative"}):n};T.propTypes={testResultProfiles:f().array};var V=function(e){var t=e.osMinorVersion,n=e.osMajorVersion;return"RHEL ".concat(n,".").concat(t)},R=["cell"];function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k={isStatic:!0},M=function(e){var t=e.cell,n=(0,o.Z)(e,R);return Z(Z({},n),{},{renderFunc:(0,c.SO)(t,n.props)})},C=M({key:"name",title:"Name",props:Z({width:40},k),renderExport:function(e){return"".concat(e.name," (").concat(V(e),")")},cell:g}),D=function(e){return Z(Z({},C),{},{props:Z(Z({},C.props),e),renderFunc:(0,c.SO)(g,e)})},F={title:"SSG version",transforms:[i.nowrap],exportKey:"testResultProfiles",props:k,renderExport:function(e){return e.map((function(e){var t=e.supported,n=e.ssgVersion;return"".concat(t?"":"!").concat(n)})).join(", ")},renderFunc:(0,c.SO)(E)},L={title:"Policies",transforms:[i.nowrap],exportKey:"policies",renderExport:function(e){return e.map((function(e){return e.name})).join(", ")},props:Z({width:40},k),renderFunc:(0,c.SO)(P)},B=(Z({width:20},k),(0,c.SO)(j),{title:"Failed rules",exportKey:"testResultProfiles",transforms:[i.nowrap],props:Z({width:5},k),renderExport:function(e){return(0,a.T4)(e).length},renderFunc:(0,c.SO)(S)}),N={title:"Compliance score",exportKey:"testResultProfiles",transforms:[i.nowrap],props:Z({width:5},k),renderExport:function(e){return(0,s.Oq)((0,a.RT)(e)).trim()},renderFunc:(0,c.SO)(w)},q={title:"Last scanned",transforms:[i.nowrap],exportKey:"testResultProfiles",props:Z({width:10},k),renderExport:function(e){return I(e)},renderFunc:(0,c.SO)(T)},A=M({title:"Operating system",key:"operatingSystem",transforms:[i.nowrap],props:k,renderExport:function(e){return V(e)},cell:function(e){return V(e)}}),$=function(e,t){return{key:e,props:t}}},27803:(e,t,n)=>{n.d(t,{Ep:()=>y,Y0:()=>b,D3:()=>h,B1:()=>v,UD:()=>g,F4:()=>O,B4:()=>E});var r,o,i,s,a=n(4942),c=n(93433),l=n(30168),u=n(27450),p=(n(35937),n(72971)),d=n(67336),f=n(99030);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var y=(0,u.ZP)(r||(r=(0,l.Z)(["\n  query getSystems(\n    $filter: String!\n    $policyId: ID\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n          osMinorVersion\n          culledTimestamp\n          staleWarningTimestamp\n          staleTimestamp\n          insightsId\n          lastScanned\n          testResultProfiles(policyId: $policyId) {\n            id\n            name\n            refId\n            lastScanned\n            compliant\n            external\n            score\n            supported\n            ssgVersion\n            majorOsVersion\n            rules {\n              refId\n              title\n              compliant\n              remediationAvailable\n            }\n          }\n          policies(policyId: $policyId) {\n            id\n            name\n          }\n          tags {\n            namespace\n            key\n            value\n          }\n        }\n      }\n    }\n  }\n"]))),b=(0,u.ZP)(o||(o=(0,l.Z)(["\n  query getSystems(\n    $filter: String!\n    $policyId: ID\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n          osMinorVersion\n          culledTimestamp\n          staleWarningTimestamp\n          staleTimestamp\n          insightsId\n          lastScanned\n          testResultProfiles(policyId: $policyId) {\n            id\n            name\n            lastScanned\n            external\n            compliant\n            score\n            supported\n            ssgVersion\n            policy {\n              id\n            }\n          }\n          policies(policyId: $policyId) {\n            id\n            name\n          }\n          tags {\n            namespace\n            key\n            value\n          }\n        }\n      }\n    }\n  }\n"]))),h=(0,u.ZP)(i||(i=(0,l.Z)(["\n  query getSystems(\n    $filter: String!\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n          osMinorVersion\n          culledTimestamp\n          staleWarningTimestamp\n          staleTimestamp\n          insightsId\n          lastScanned\n        }\n      }\n    }\n  }\n"]))),v=(0,u.ZP)(s||(s=(0,l.Z)(["\n  query getSystems($filter: String!, $limit: Int) {\n    systems(search: $filter, limit: $limit) {\n      tags {\n        namespace\n        key\n        value\n      }\n    }\n  }\n"]))),g=function(e,t){return[].concat((0,c.Z)((0,p.RM)(e)),(0,c.Z)(t?(0,p.iz)(e):[]))},O=function(){return p.n3.apply(void 0,arguments)},E=function(e){return function(t){var n=t.INVENTORY_ACTION_TYPES,r=t.mergeWithEntities;return(0,d.JH)().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r((0,f.zw)(n,e))))}}},50323:(e,t,n)=>{n.d(t,{Ey:()=>O,e_:()=>pe}),n(44434);var r,o=n(4942),i=n(15671),s=n(43144),a=n(60136),c=n(82963),l=n(61120),u=n(92950),p=n.n(u),d=n(45697),f=n.n(d),m=n(56455),y=n(67336),b=n(38775),h=n(6363);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var g=(0,y.gu)()(r=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(t);if(n){var o=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,c.Z)(this,e)});function u(e){return(0,i.Z)(this,u),r.call(this,e)}return(0,s.Z)(u,[{key:"render",value:function(){var e=this;return p().createElement(b.Z,{onLoad:function(t){var n=t.mergeWithDetail;return e.getRegistry().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n()))}},p().createElement(h.Z,{fallback:p().createElement(m.Z,{size:m.i.md}),hideBack:!0}))}}]),u}(p().Component))||r;g.propTypes={entity:f().object};const O=function(e){return p().createElement(g,e)};n(69284),n(57481),n(38879),n(89671);var E=n(87462),j=n(93433),P=n(29439),S=n(95995),w=n(34168),I=n(76450),T=n(72971),V=n(29008),R=n(37948),x=n(33739),Z=n(27803),k=n(15861),M=n(45987),C=n(87757),D=n.n(C),F=n(26075),L=n(557),B=n(48623),N=n(73277),q=n(82176),A=n(79886),$={csv:"text/csv",json:"application/json"},_=function(e){return"compliance-export-"+(new Date).toISOString()+"."+e},U=function(e){return"data:".concat($[e],";charset=utf-8")},K=function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()},H=function(e,t){var n=t.exportKey,r=t.renderExport,o=n?(0,A.$s)(e,n):e;return r?r(o):o},G=function(e){var t=e.items,n=e.columns,r=[n.map((function(e){return e.title})).join(",")].concat((0,j.Z)(t.map((function(e){return n.map((function(t){return'"'.concat(H(e,t),'"')})).join(",")}))));return encodeURI("".concat(U("csv"),",").concat(r.join("\n")))},z=function(e){var t=e.items,n=e.columns,r=t.map((function(e){return n.reduce((function(t,n){var r=(0,A.eV)(n.title),o=H(e,n);return t[r]=o,t}),{})}));return encodeURI("".concat(U("json"),",").concat(JSON.stringify(r)))};var W=n(65115),J=n(65811),Y=["culledTimestamp","staleWarningTimestamp","staleTimestamp","insightsId","lastScanned"],Q=["tagFilters"];function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(e){var t=e.culledTimestamp,n=e.staleWarningTimestamp,r=e.staleTimestamp,o=e.insightsId,i=e.lastScanned;return ee(ee({},(0,M.Z)(e,Y)),{},{updated:i,culled_timestamp:t,stale_warning_timestamp:n,stale_timestamp:r,insights_id:o})},ne=function(e){var t=e.query,n=e.onComplete,r=e.variables,o=void 0===r?{}:r,i=e.onError,s=(0,F.x)();return function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.query({query:t,fetchResults:!0,fetchPolicy:"no-cache",variables:ee(ee({perPage:e,page:r},o),a)}).then((function(e){var t,r,o,i=e.data,s=(null==i||null===(t=i.systems)||void 0===t||null===(r=t.edges)||void 0===r?void 0:r.map((function(e){return e.node})))||[],c={entities:(0,q.qN)(s).map(te),meta:ee(ee({},a.tags&&{tags:a.tags}),{},{totalCount:(null==i||null===(o=i.systems)||void 0===o?void 0:o.totalCount)||0})};return n&&n(c),c})).catch((function(e){if(i)return i(e),{entities:[],meta:{totalCount:0}};throw e}))}},re=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,o=Math.ceil(t/r)||1;return Promise.all((0,j.Z)(new Array(o)).map((function(t,o){return e(r,o+1,n)})))},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tagFilters,n=(0,M.Z)(e,Q),r=t?{tags:t.flatMap((function(e){return e.values.map((function(t){return"".concat(encodeURIComponent(e.key),"/").concat(encodeURIComponent(t.tagKey),"=").concat(encodeURIComponent(t.value))}))}))}:{};return ee(ee({},n),r)},ie=function(e){return(null==e?void 0:e.length)>0?"id ^ (".concat(e.join(","),")"):void 0},se=function(e,t){return t.filter((function(t){return!e&&""!==e||-1!==(null==t?void 0:t.key.indexOf(e))}))},ae=n(77346);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=function(e){var t,n,r=e.columns,o=e.showAllSystems,i=e.policyId,s=e.query,a=e.showActions,c=e.enableExport,l=e.compliantFilter,d=e.policies,f=e.showOnlySystemsWithTestResults,m=e.showOsFilter,y=e.error,b=e.showComplianceSystemsInfo,h=e.compact,v=e.remediationsEnabled,g=e.systemProps,O=e.defaultFilter,M=e.emptyStateComponent,C=e.prependComponent,q=e.showOsMinorVersionFilter,A=e.preselectedSystems,$=e.onSelect,U=e.noSystemsTable,H=(0,ae.ZP)("tags"),Y=(0,u.useRef)(null),Q=(0,u.useState)(!1),X=(0,P.Z)(Q,2),te=X[0],ce=X[1],ue=(0,u.useState)(!1),pe=(0,P.Z)(ue,2),de=pe[0],fe=pe[1],me=(0,u.useState)([]),ye=(0,P.Z)(me,2),be=ye[0],he=ye[1],ve=(0,u.useState)(0),ge=(0,P.Z)(ve,2),Oe=ge[0],Ee=ge[1],je=(t=q,n=(0,N.Z)("supported_ssgs",{type:"supportedSsg",skip:!t}).data,t?(0,Z.F4)(function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=function(t){return!(e.length>0)||e.map(String).includes(String(t))};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,n){return t(n.osMajorVersion)&&(e[String(n.osMajorVersion)]=(0,j.Z)(new Set([].concat((0,j.Z)(e[n.osMajorVersion]||[]),[n.osMinorVersion])))),e}),[])}(null==n?void 0:n.collection,t)):[]),Pe=(0,R.Z)({filters:{filterConfig:[].concat((0,j.Z)(T.qo),(0,j.Z)(l?T.rN:[]),(0,j.Z)((null==d?void 0:d.length)>0?(0,Z.UD)(d,m):[]),(0,j.Z)(je))}}),Se=Pe.toolbarProps,we=Pe.filterString,Ie=Pe.activeFilterValues,Te=function(e,t,n){var r=[].concat((0,j.Z)(t?["has_test_results = true"]:[]),(0,j.Z)((null==e?void 0:e.length)>0?[e]:[])).join(" and ");return n?"(".concat(n,")")+(r?" and (".concat(r,")"):""):r}(we(),f,O),Ve=function(e,t){var n,r=(0,u.useState)(),o=(0,P.Z)(r,2),i=o[0],s=o[1],a=(n=(0,F.x)(),function(){var e=(0,k.Z)(D().mark((function e(t,r,o,i){var s,a,c;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.query(ee({query:Z.B1},i)).then((function(e){var t=e.data.systems.tags;return se(o,t).map((function(e){return{tag:e}}))}));case 2:return s=e.sent,c=(a=r*t-r)+r,e.abrupt("return",{total:s.length,results:s.slice(a,c)});case 6:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}()),c=function(){var e=(0,k.Z)(D().mark((function e(n,r){var o,i,s,c,l,u;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.pagination||{perPage:10,page:1},i=o.page,s=o.perPage,e.next=3,a(i,s,n,t);case 3:return c=e.sent,l=c.total,u=c.results,e.abrupt("return",{page:i,per_page:s,total:l,results:u});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return e?{props:{hideFilters:{name:!0,tags:!1,registeredWith:!0,stale:!0},showTags:!0},currentTags:i,setCurrentTags:s,getTags:c}:{props:{hideFilters:{name:!0,tags:!0,registeredWith:!0,stale:!0}}}}(H,{variables:le({filter:Te},i&&{policyId:i})}),Re=Ve.props,xe=Ve.currentTags,Ze=Ve.setCurrentTags,ke=Ve.getTags,Me={query:s,variables:le({tags:xe,filter:Te},i&&{policyId:i})},Ce=function(e){var t=e.total,n=e.onSelect,r=e.preselected,o=e.fetchArguments,i=e.currentPageIds,s=e.systemsCache,a=void 0===s?[]:s,c=(0,u.useState)([]),l=(0,P.Z)(c,2),p=l[0],d=l[1],f=ne(ee(ee({},o),{},{query:Z.D3,onError:function(e){(0,J.q)({variant:"danger",title:"Error selecting systems",description:e.message})}})),m=function(){var e=(0,k.Z)(D().mark((function e(t){var n,r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return n=ie(t),e.next=5,re(f,t.length,ee({},n&&{filter:n}));case 5:return r=e.sent,e.abrupt("return",r.flatMap((function(e){return e.entities})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=(0,k.Z)(D().mark((function e(t){var n,r,o,i;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.filter((function(e){var n=e.id;return t.includes(n)})),r=n.map((function(e){return e.id})),o=t.filter((function(e){return!r.includes(e)})),e.next=5,m(o);case 5:return i=e.sent,e.abrupt("return",[].concat((0,j.Z)(n),(0,j.Z)(i)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,k.Z)(D().mark((function e(t){var r;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:r=e.sent,d(r),n&&n(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=(0,k.Z)(D().mark((function e(){var n;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re(f,t);case 2:return n=e.sent,e.abrupt("return",n.flatMap((function(e){return e.entities.map((function(e){return e.id}))})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return ee({selectedSystems:p},(0,W.Z)({total:t,onSelect:b,preselected:r,itemIdsInTable:h,itemIdsOnPage:function(){return i}}))}({total:Oe,onSelect:$,preselected:(0,u.useMemo)((function(){return A.map((function(e){return e.id}))}),[A]),fetchArguments:Me,currentPageIds:be.map((function(e){return e.id})),systemsCache:be}),De=Ce.selectedIds,Fe=Ce.selectedSystems,Le=Ce.tableProps,Be=Ce.toolbarProps;!function(e,t,n){var r=(0,L.useDispatch)();(0,u.useLayoutEffect)((function(){r({type:"INVENTORY_INIT"})}),[]),(0,u.useEffect)((function(){r({type:"SELECT_ENTITIES",payload:{selected:t}})}),[t]);var o=(0,B.Z)((function(){Promise.resolve(r({type:"RESET_PAGE"})).then((function(){var t;return null==e||null===(t=e.current)||void 0===t?void 0:t.onRefreshData()}))}),50);(0,u.useEffect)((function(){o()}),[n])}(Y,De,Ie);var Ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.selected,r=t.columns,o=function(e,t){return e.map((function(e){return"".concat(e,":").concat(t)}))},i=function(e){return(r||[]).find((function(t){return t.key===e}))};return function(){var t=(0,k.Z)(D().mark((function t(r,s){var a,c,l,u,p,d,f,m,y,b,h,v,g;return D().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.page,c=void 0===a?1:a,l=s.per_page,u=s.orderBy,p=s.orderDirection,d=s.filters,f=i(u),m=f&&f.sortBy?o(f.sortBy,p):void 0,y=oe(d),t.next=6,e(l,c,ee(ee({},y),{},{sortBy:m}));case 6:return b=t.sent,v=(h=b||{}).entities,g=h.meta.totalCount,t.abrupt("return",{results:v.map((function(e){return ee(ee({},e),{},{selected:(n||[]).map((function(e){return e})).includes(e.id)})})),orderBy:u,orderDirection:p,total:g});case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(ne(le(le({},Me),{},{onComplete:function(e){var t,n;Ee(e.meta.totalCount),he(e.entities),fe(!0),Ze&&Ze(e.meta.tags),M&&0===e.meta.totalCount&&0===Ie.length&&0===(null==e||null===(t=e.meta)||void 0===t||null===(n=t.tags)||void 0===n?void 0:n.length)&&ce(!0)}})),{selected:De,columns:r}),qe=function(e){var t=e.columns,n=e.selected,r=e.total,o=e.fetchArguments,i=n?ie(n):void 0,s=ne({query:o.query,variables:ee(ee(ee({},o.variables),o.tags&&{tags:o.tags}),{},{filter:i?"".concat(o.variables.filter," and (").concat(i,")"):o.variables.filter}),onError:function(){(0,J.q)({variant:"danger",title:"Couldn’t download export",description:"Reinitiate this export to try again."})},onComplete:function(){(0,J.q)({variant:"success",title:"Downloading export"})}}),a=function(){var e=(0,k.Z)(D().mark((function e(){var t;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,J.q)({variant:"info",title:"Preparing export",description:"Once complete, your download will start automatically."}),e.next=3,re(s,r,(null==n?void 0:n.length)>0?ie(n):void 0);case 3:return t=e.sent,e.abrupt("return",t.flatMap((function(e){return e.entities})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return function(e){var t=e.exporter,n=e.columns,r=void 0===n?[]:n,o=e.isDisabled,i=void 0!==o&&o,s=r.filter((function(e){return!1!==e.export&&(e.exportKey||e.renderExport)})),a=function(){var e=(0,k.Z)(D().mark((function e(n){var r,o;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:if(r=e.sent,o="csv"===n?G:z,!r){e.next=8;break}return e.abrupt("return",K(o({items:r,columns:s}),_(n)));case 8:return console.info("No items returned for export"),e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{toolbarProps:{exportConfig:{isDisabled:i,onSelect:function(e,t){return a(t)}}}}}({exporter:a,columns:t,isDisabled:0===r}).toolbarProps.exportConfig}({columns:r,filter:Te,selected:De,total:Oe,fetchArguments:le({tags:xe},Me)});return p().createElement(V.Se,{stateValues:{error:y,noError:void 0===y&&!te,empty:te}},p().createElement(V.K7,{stateKey:"error"},!!C&&C,p().createElement(V.mf,{error:y})),p().createElement(V.K7,{stateKey:"empty"},M),p().createElement(V.K7,{stateKey:"noError"},!!C&&de&&C,b&&p().createElement(S.Alert,{isInline:!0,variant:"info",ouiaId:"SystemsListIsDifferentAlert",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems currently associated with or reporting against compliance policies are displayed."}),p().createElement(x.Z,(0,E.Z)({},g,Re,{disableDefaultColumns:!0,columns:function(e){return r.map((function(t){var n="string"==typeof t,r=n?t:t.key,o=e.find((function(e){return e.key===r}));return le(le(le({},o),n?{key:t}:t),{},{props:le(le({},null==o?void 0:o.props),null==t?void 0:t.props)})}))},noSystemsTable:U,ref:Y,getEntities:Ne,getTags:ke,onLoad:(0,Z.B4)(r),tableProps:le(le({},Le),{},{isStickyHeader:!0}),fallback:p().createElement(S.Spinner,null),variant:h?w.TableVariant.compact:""},Be,!o&&le(le({},Se),v&&{dedicatedAction:p().createElement(I.Z,{allSystems:Fe,selectedRules:[]})}),c&&{exportConfig:qe},a&&{actions:[{title:"View in inventory",onClick:function(e,t,n){var r=n.id,o="beta"===window.location.pathname.split("/")[1];window.location.href="".concat(window.location.origin).concat(o?"/beta":"","/insights/inventory/").concat(r)}}]}))))};ue.propTypes={columns:f().arrayOf(f().oneOfType([f().shape({}),f().string])),policies:f().arrayOf(f().shape({})),showAllSystems:f().bool,policyId:f().string,query:f().oneOfType([f().string,f().object]),showActions:f().bool,enableExport:f().bool,compliantFilter:f().bool,showOnlySystemsWithTestResults:f().bool,showOsFilter:f().bool,showComplianceSystemsInfo:f().bool,error:f().object,compact:f().bool,remediationsEnabled:f().bool,defaultFilter:f().string,systemProps:f().shape({isFullView:f().bool}),emptyStateComponent:f().node,prependComponent:f().node,showOsMinorVersionFilter:f().oneOfType([f().bool,f().arrayOf(f().string)]),preselectedSystems:f().array,onSelect:f().func,noSystemsTable:f().node},ue.defaultProps={policyId:"",showActions:!0,enableExport:!0,compliantFilter:!1,showOnlySystemsWithTestResults:!1,showComplianceSystemsInfo:!1,compact:!1,remediationsEnabled:!0,preselectedSystems:[]};const pe=ue},73277:(e,t,n)=>{n.d(t,{Z:()=>w});var r=n(93433),o=n(15861),i=n(29439),s=n(4942),a=n(87757),c=n.n(a),l=n(92950),u=n(72971),p=n(41800),d=n.n(p),f=n(15671),m=n(43144);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,f.Z)(this,e),(0,s.Z)(this,"DEFAULT_API_HEADERS",{"Content-Type":"application/vnd.api+json",Accept:"application/json"}),this.apiBase=t.apiBase||"/api",this.path=t.path||"",this.authenticate=t.authenticate||function(){return Promise.resolve({})},this.onUnauthorised=t.onUnauthorised||function(){return Promise.resolve({})},this.defaultHeaders=t.headers||this.DEFAULT_API_HEADERS}var t;return(0,m.Z)(e,[{key:"request",value:(t=(0,o.Z)(c().mark((function e(t,n,r){var o,i=this,s=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>3&&void 0!==s[3]?s[3]:{},e.next=3,this.callAuthenticate().then((function(){return i.fetch(t,n,r,o)})).then(this.checkForEmptyResponse).then((function(e){return i.checkForErrors(e,o)})).then((function(e){return e.json()})).catch(this.finalCatch);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"finalCatch",value:function(e){return void 0===e.errors?Promise.reject({title:"Error parsing"}):Promise.reject(b({},e))}},{key:"fetch",value:function(e){function t(t,n,r,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r){var o={method:n||"get",headers:this.defaultHeaders,credentials:"include"},i="".concat(this.apiBase).concat(this.path?this.path:"").concat(e||""),s=new URL(i,window.location.origin);if(r.params){var a=Object.keys(r.params).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r.params[e])})).join("&");s.search=new URLSearchParams(a)}return t&&(o.body=JSON.stringify(t)),fetch(s,o)}))},{key:"checkForEmptyResponse",value:function(e){return 204===e.status?{json:function(){return{}}}:e}},{key:"checkForErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(404===e.status&&t.ignore404)return{json:function(){return{}}};if(401===e.status)return this.onUnauthorised();var n=e.clone?e.clone().json():e;return 422===e.status?n.then((function(e){return Promise.reject(b(b({},e),{},{title:"Validation error"}))})):e.status>=400&&e.status<=600?n.then((function(e){return Promise.reject(e.errors[0])})):e}},{key:"callAuthenticate",value:function(){return Promise.resolve(this.authenticate()||!0)}},{key:"create",value:function(e,t){return this.request(e,t,"post")}},{key:"update",value:function(e,t){return this.request(e,t,"put")}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,null,"get",t)}},{key:"destroy",value:function(e){return this.request(e,null,"delete")}}]),e}();function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const g=function(e){var t=new h(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e));return t};function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){return e&&function(e,t){var n=e[t],r=e;return delete r[t],E(E({},r),n)}(e,"attributes")},P=function(e,t){var n,r=d()(e);return null===(n=Object.values(r[t]||{}))||void 0===n?void 0:n.map((function(e){return function(e,t){var n={};return Object.entries((null==e?void 0:e.relationships)||[]).forEach((function(e){var r=(0,i.Z)(e,2),o=r[0],s=r[1];n[o]=null==s?void 0:s.data.map((function(e){var n;return j(null==t||null===(n=t[e.type])||void 0===n?void 0:n[e.id])})).filter((function(e){return!!e}))})),delete e.relationships,E(E({},e),n)}(j(e),r)}))},S=function(){var e=(0,o.Z)(c().mark((function e(t,n){var r,o,i,s,a=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},o=a.length>3&&void 0!==a[3]?a[3]:{},e.next=4,t.get("/".concat(n),{params:r});case 4:return i=e.sent,e.next=7,P(i,(null==o?void 0:o.type)||n);case 7:return s=e.sent,e.abrupt("return",{collection:s,meta:i.meta,total:i.meta.total,json:i});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();const w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=(0,l.useState)({data:void 0,loading:!1,error:void 0}),s=(0,i.Z)(o,2),a=s[0],c=s[1],p=g({apiBase:u.dT}),d=E(E({},(null==t?void 0:t.params)||{}),{},{include:(null==t?void 0:t.include)||[]});return(0,l.useEffect)((function(){null!=t&&t.skip||(c({data:void 0,loading:!0,error:void 0}),S(p,e,d,t).then((function(e){c({data:e,loading:!1,error:void 0})})))}),[].concat((0,r.Z)(n),[null==t?void 0:t.skip])),a}},99030:(e,t,n)=>{n.d(t,{zw:()=>l,UP:()=>u,Nw:()=>p});var r=n(4942),o=n(18546),i=n(79886);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=function(e,t){return e.map((function(e){return a(a({},e),{},{selected:t.includes(e.id)})}))},l=function(){var e;return(0,o.Gg)((e={},(0,r.Z)(e,"INVENTORY_INIT",(function(){return{rows:[],total:0}})),(0,r.Z)(e,"RESET_PAGE",(function(e){return a(a({},e),{},{page:1})})),(0,r.Z)(e,"SELECT_ENTITIES",(function(e,t){var n=t.payload.selected;return a(a({},e),{},{rows:c(e.rows,n)})})),e))},u=function(e){return e?e.reduce((function(e,t){var n=t.osMinorVersion;return null!=n&&(e[n]=e[n]||{osMinorVersion:n,count:0}).count++,e}),{}):{}},p=function(e){return Object.values(u(e)).sort((0,i.Sj)("osMinorVersion","desc"))}}}]);