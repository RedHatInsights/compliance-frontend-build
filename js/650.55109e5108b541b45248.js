(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[650,953,164],{44434:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComplianceSystems:()=>b,default:()=>v});var r,o=n(30168),i=n(92950),s=n.n(i),a=n(67521),l=n(90570),c=n(46818),u=n(89376),p=n(39173),d=n(85836),f=n(6084),m=n(31499),y=(0,a.ZP)(r||(r=(0,o.Z)(['\n  {\n    profiles(search: "external = false and canonical = false") {\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n        }\n      }\n    }\n  }\n']))),b=function(){var e,t=(0,l.a)(y),n=t.data,r=t.error,o=t.loading,i=null==n||null===(e=n.profiles)||void 0===e?void 0:e.edges.map((function(e){return e.node}));return s().createElement(s().Fragment,null,s().createElement(u.Z,{className:"page-header"},s().createElement(p.Z,{title:"Compliance systems"})),s().createElement("section",{className:"pf-c-page__main-section"},s().createElement(d.tC,{stateValues:{error:r,data:n,loading:o}},s().createElement(d.K7,{stateKey:"data"},i&&s().createElement(f.r0,{columns:[m.Zw({showLink:!0}),m.MO("tags"),m.OS,m.rE,m.MO("updated",{props:{isStatic:!0},transforms:[c.P8]})],defaultFilter:"has_test_results = true or has_policy = true",systemProps:{isFullView:!0},showOsMinorVersionFilter:i.map((function(e){return e.osMajorVersion})),showComplianceSystemsInfo:!0,enableEditPolicy:!1,remediationsEnabled:!1,policies:i})))))};const v=b},32369:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CreatePolicyForm:()=>ke,default:()=>xe});var r=n(4942),o=n(70885),i=n(92950),s=n.n(i),a=n(96620),l=n(46314),c=n(33766),u=n(28216),p=n(45697),d=n.n(p),f=n(65115),m=n(30168),y=n(67521),b=n(90570),v=n(97481),g=n(15113),h=n(97779),O=n(85836),E=n(46818),j=n(86379),P=n(41304),S=n(79886),I=n(83237),T=function(e){var t=e.item.description,n=e.key;return s().createElement(f.Text,{key:n,style:{margin:"var(--pf-global--spacer--lg) 0"}},t)};T.propTypes={item:d().object,key:d().string};const V=T;var w=n(41532);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e){var t=e.name,n=e.disabled;return s().createElement(s().Fragment,null,n&&s().createElement(O.Nj,{compact:!0}),t)};k.propTypes={name:d().string,disabled:d().boolean};var Z=function(e){var t=e.profiles,n=e.onChange,r=e.selectedProfile,o=[{title:"Policy name",key:"name",transforms:[(0,j.u)({tooltip:"In use policies have already been used and therefore can not be applied to another SCAP Policy under the selected OS."})],sortByProp:"name",renderFunc:(0,S.SO)(k)},{title:"Supported OS versions",transforms:[E.E0],sortByProp:"supportedOsVersions",renderFunc:function(e,t,n){return n.supportedOsVersions.join(", ")}}];return s().createElement(P.v,{items:t.map((function(e){return C(C({},e),{},{rowProps:{selected:e.id===(null==r?void 0:r.id),disableSelection:e.disabled}})})),filters:{filterConfig:[{type:I.Y.text,label:"Policy Name",filter:function(e,t){return e.filter((function(e){return null==e?void 0:e.name.toLowerCase().includes(t.toLowerCase())}))}}]},columns:o,options:{detailsComponent:V,onRadioSelect:function(e,r,o,i){var s=i.itemId;return n&&n(t.find((function(e){return e.id===s})))},sortBy:{index:2,direction:"asc",property:"name"},emptyRows:(0,w.fQ)("policy types",o.length)},variant:"compact"})};Z.propTypes={profiles:d().array,onChange:d().func,selectedProfile:d().string};const M=Z;var x=n(91290);const D=function(){return s().createElement(f.Tooltip,{position:"right",content:"Policy types are OpenSCAP policies that are supported by RHEL. For each major version of RHEL, users can create one policy of each type."},s().createElement(x.ZP,{className:"grey-icon"}))};var F;function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=(0,y.ZP)(F||(F=(0,m.Z)(['\n  query supportedProfilesByOSMajor {\n    osMajorVersions {\n      edges {\n        node {\n          osMajorVersion\n          profiles {\n            id\n            name\n            refId\n            description\n            supportedOsVersions\n            benchmark {\n              id\n              refId\n            }\n          }\n        }\n      }\n    }\n    profiles(search: "external = false and canonical = false") {\n      edges {\n        node {\n          id\n          refId\n          benchmark {\n            refId\n          }\n        }\n      }\n    }\n  }\n']))),$=function(e){var t,n=e.change,r=e.selectedProfile,o=e.selectedOsMajorVersion,i=(0,b.a)(N,{fetchPolicy:"no-cache"}),a=i.data,l=i.error,c=i.loading,u=null==a||null===(t=a.osMajorVersions)||void 0===t?void 0:t.edges.map((function(e){return e.node})),p=null==u?void 0:u.find((function(e){return e.osMajorVersion===o})),d=null==p?void 0:p.profiles.map((function(e){return B(B({},e),{},{disabled:(t=e.refId,n=e.benchmark.refId,!(null==a||null===(r=a.profiles)||void 0===r||!r.edges.map((function(e){return e.node})).find((function(e){return e.refId===t&&n===e.benchmark.refId}))))});var t,n,r}));return s().createElement(O.tC,{stateValues:{error:l,data:a,loading:c}},s().createElement(O.K7,{stateKey:"loading"},s().createElement(v.Z,null)),s().createElement(O.K7,{stateKey:"data"},s().createElement(f.TextContent,null,s().createElement(f.Text,{component:f.TextVariants.h1,className:"pf-u-mb-md"},"Create SCAP policy"),s().createElement(f.Text,{className:"pf-u-mb-md"},"Select the operating system and policy type for this policy.")),s().createElement(f.Form,null,s().createElement(f.FormGroup,{label:"Operating system",isRequired:!0,fieldId:"benchmark"},u&&u.map((function(e){var t=e.osMajorVersion;return s().createElement(f.Tile,{key:"rhel".concat(t,"-select"),className:"pf-u-mr-md",title:"RHEL ".concat(t),onClick:function(){n("osMajorVersion",t)},isSelected:o===t,isStacked:!0})}))),o&&s().createElement(f.FormGroup,{isRequired:!0,labelIcon:s().createElement(D,null),label:"Policy type",fieldId:"policy-type"},s().createElement(M,{"aria-label":"PolicyTypeTable",profiles:d,onChange:function(e){n("profile",e),n("benchmark",e.benchmark.id),n("selectedRuleRefIds",void 0),n("systems",[])},selectedProfile:r})))))};$.propTypes={change:g.ZP.change,selectedProfile:d().object,selectedOsMajorVersion:d().string};var _=(0,c.Z)("policyForm");const A=(0,h.qC)((0,u.$j)((function(e){return{selectedProfile:_(e,"profile"),selectedOsMajorVersion:_(e,"osMajorVersion")}})),(0,l.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))($);var q,K,H=n(58247),U=n(56085),G=n(94263),z=n(77346);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=(0,y.ZP)(q||(q=(0,m.Z)(["\n  query Profiles($filter: String!, $enableRuleTree: Boolean = false) {\n    profiles(search: $filter) {\n      edges {\n        node {\n          id\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          benchmark {\n            id\n            latestSupportedOsMinorVersions\n            ruleTree @include(if: $enableRuleTree)\n            valueDefinitions {\n              defaultValue\n              description\n              id\n              refId\n              title\n              valueType\n            }\n          }\n          rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n          }\n          values\n        }\n      }\n    }\n  }\n"]))),Q=(0,y.ZP)(K||(K=(0,m.Z)(["\n  query Benchmarks($filter: String!, $enableRuleTree: Boolean = false) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        latestSupportedOsMinorVersions\n        ruleTree @include(if: $enableRuleTree)\n        valueDefinitions {\n          defaultValue\n          description\n          id\n          refId\n          title\n          valueType\n        }\n        profiles {\n          id\n          refId\n          osMajorVersion\n        }\n        version\n      }\n    }\n  }\n"]))),X=function(e){var t,n=e.policy,o=e.selectedRuleRefIds,a=e.change,l=e.osMajorVersion,c=e.osMinorVersionCounts,u=e.ruleValues,p=(0,z.ZP)("ruleGroups"),d=[G.VG,G.zb,G.uH],m=c.map((function(e){return e.osMinorVersion})).sort(),y="os_major_version = ".concat(l," ")+'and latest_supported_os_minor_version ^ "'.concat(m.join(","),'"'),g=(0,b.a)(Q,{variables:{filter:y,enableRuleTree:p},skip:0===m.length}),h=g.data,E=g.error,j=g.loading,P=null==h||null===(t=h.benchmarks)||void 0===t?void 0:t.nodes,S=c.map((function(e){var t,r=e.osMinorVersion,o=e.count;if(r="".concat(r),P){var i=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(P,r);i&&(t=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(i,n.refId),t&&(t=Y(Y({},t),{},{benchmark:i})))}return{profile:t,systemCount:o,newOsMinorVersion:r}}));S=S.filter((function(e){return!!e.profile}));var I=(0,U.b4)(S),T=Object.keys(I),V=T.map((function(e){return"id = ".concat(e)})).join(" OR "),w=j||0===V.length,R=(0,b.a)(J,{variables:{filter:V,enableRuleTree:p},skip:w}),C=R.data,k=R.error,Z=R.loading,M=E||k,x=(null==T?void 0:T.length)>0?C:void 0,D=!(!Z&&!j)||void 0,F=!M&&!D&&0===(null==T?void 0:T.length),L=w?[]:null==C?void 0:C.profiles.edges.map((function(e){return e.node})),B=function(e){a("selectedRuleRefIds",e)};return(0,i.useLayoutEffect)((function(){if(!D){var e=(0,U.uU)(L,I),t=(0,U.TB)(e,o,{only:!0});B(t)}}),[JSON.stringify(L),D]),s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-pb-md"},s().createElement(f.Text,{component:f.TextVariants.h1},"Rules"),s().createElement(f.Text,null,"Customize your ",s().createElement("b",null,n.name)," SCAP policy by including and excluding rules."),s().createElement(f.Text,null,"Each release of RHEL is supported with a unique and specific version of the SCAP Security Guide (SSG). You must customize each version of SSG for each release of RHEL.")),s().createElement(O.tC,{stateValues:{error:M,data:x,loading:D,noRuleSets:F}},s().createElement(O.K7,{stateKey:"noRuleSets"},s().createElement(f.EmptyState,null,s().createElement(f.Title,{headingLevel:"h1",size:"xl"},"No rules can be configured"),s().createElement(f.EmptyStateBody,null,"The policy type selected does not exist for the systems and OS versions selected in the previous steps."))),s().createElement(O.K7,{stateKey:"loading"},s().createElement(H.Z,null,s().createElement(v.Z,null))),s().createElement(O.K7,{stateKey:"data"},s().createElement(U.Hv,{tabsData:S,selectedRuleRefIds:o,setRuleValues:function(e,t,n){var o=Y(Y({},u||{}),{},(0,r.Z)({},e,Y(Y({},(u||{})[e]),{},(0,r.Z)({},t.refId,n))));a("ruleValues",o)},ruleValues:u,columns:d,remediationsEnabled:!1,selectedFilter:!0,level:1,setSelectedRuleRefIds:B,ouiaId:"RHELVersions",resetLink:!0,rulesPageLink:!0}))))};X.propTypes={policy:d().object,change:g.ZP.change,osMajorVersion:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number})),selectedRuleRefIds:d().array,ruleValues:d().array};var ee=(0,c.Z)("policyForm");const te=(0,h.qC)((0,u.$j)((function(e){return{policy:ee(e,"profile"),osMajorVersion:ee(e,"osMajorVersion"),osMinorVersionCounts:ee(e,"osMinorVersionCounts"),selectedRuleRefIds:ee(e,"selectedRuleRefIds"),ruleValues:ee(e,"ruleValues")}})),(0,l.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(X);var ne=n(6084),re=n(99030),oe=n(31499);function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=e.osMajorVersion;return s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,null,"You do not have any ",s().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.",s().createElement("br",null),"Policies must be created with at least one system.")),s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,null,"Choose a different operating system, or connect"," ",s().createElement("b",null,"RHEL ",t)," systems to Insights.")),s().createElement(f.WizardContextConsumer,null,(function(e){var t=e.goToStepById;return s().createElement(f.Button,{onClick:function(){return t(1)}},"Choose a different operating system")})))};ae.propTypes={osMajorVersion:d().string};var le=function(e){var t=e.osMajorVersion;return s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,null,"Select which of your ",s().createElement("b",null,"RHEL ",t)," systems should be included in this policy.",s().createElement("br",null),"Systems can be added or removed at any time.")))};le.propTypes={osMajorVersion:d().string};var ce=function(e){var t=e.policy,n=e.change,r=e.osMajorVersion,o=e.selectedSystems,i=t.supportedOsVersions.map((function(e){return e.split(".")[1]}));return s().createElement(s().Fragment,null,s().createElement(f.TextContent,{className:"pf-u-mb-md"},s().createElement(f.Text,{component:f.TextVariants.h1},"Systems")),s().createElement(f.Form,null,s().createElement(f.FormGroup,null,s().createElement(ne.r0,{showOsMinorVersionFilter:[r],prependComponent:s().createElement(le,{osMajorVersion:r}),emptyStateComponent:s().createElement(ae,{osMajorVersion:r}),columns:[se(se({},oe.VG),{},{props:{width:40},sortBy:["name"]}),oe.MO("tags"),oe.U5],remediationsEnabled:!1,compact:!0,showActions:!1,defaultFilter:r&&"os_major_version = ".concat(r," AND os_minor_version ^ (").concat(i.join(","),")"),enableExport:!1,preselectedSystems:o,onSelect:function(e){n("systems",e),n("osMinorVersionCounts",(0,re.Nw)(e))}}))))};ce.propTypes={osMajorVersion:d().string,policy:d().object,selectedSystems:d().array,change:g.ZP.change},ce.defaultProps={selectedSystems:[]};var ue=(0,c.Z)("policyForm");const pe=(0,h.qC)((0,u.$j)((function(e){return{policy:ue(e,"profile"),osMajorVersion:ue(e,"osMajorVersion"),selectedSystems:ue(e,"systems")}})),(0,l.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(ce);var de=n(6455),fe=n(74726),me=function(e){var t=e.change,n=e.policy,r=e.refId;return(0,i.useEffect)((function(){n&&n.refId!==r&&(t("name","".concat(n.name)),t("refId","".concat(n.refId)),t("description","".concat(n.description)))}),[n]),s().createElement(s().Fragment,null,s().createElement(f.TextContent,null,s().createElement(f.Text,{component:f.TextVariants.h1},"Details")),s().createElement("br",null),s().createElement(f.Form,{id:"editpolicydetails"},s().createElement(f.FormGroup,{label:"Policy name",isRequired:!0,fieldId:"name"},s().createElement(de.Z,{component:fe._,type:"text",isRequired:!0,id:"name",name:"name","aria-describedby":"name"})),s().createElement(f.FormGroup,{label:"Reference ID",isRequired:!0,fieldId:"refId"},s().createElement(de.Z,{type:"text",component:fe._,isDisabled:!0,id:"refId",name:"refId","aria-describedby":"refId"})),s().createElement(f.FormGroup,{label:"Description",fieldId:"description"},s().createElement(de.Z,{type:"text",component:fe.d,id:"description",name:"description","aria-describedby":"description"})),s().createElement(f.FormGroup,{label:"Business objective",labelIcon:s().createElement(O.xB,null),fieldId:"businessObjective"},s().createElement(de.Z,{type:"text",component:fe._,id:"businessObjective",name:"businessObjective","aria-describedby":"businessObjective",defaultValue:n.businessObjective})),s().createElement(O._z,{previousThreshold:100})))},ye=(0,c.Z)("policyForm");me.propTypes={policy:d().object,refId:d().string,change:g.ZP.change};const be=(0,h.qC)((0,u.$j)((function(e){var t=ye(e,"profile");return{policy:t,refId:ye(e,"refId"),initialValues:{name:"".concat(t.name),refId:"".concat(t.refId),description:"".concat(t.description),benchmark:ye(e,"benchmark"),osMajorVersion:ye(e,"osMajorVersion"),profile:ye(e,"profile")}}})),(0,l.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0}))(me);var ve=function(e){var t=e.name,n=e.businessObjective,r=e.complianceThreshold,o=e.parentProfileName,i=e.osMinorVersionCounts,a=e.osMajorVersion;return s().createElement(f.TextContent,null,s().createElement(f.Text,{component:f.TextVariants.h1},"Review"),s().createElement(f.Text,null,"Review your SCAP policy before finishing."),s().createElement(f.Text,{component:f.TextVariants.h3,style:{marginTop:0}},t),s().createElement(f.TextList,{component:f.TextListVariants.dl},s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Policy type"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},o),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Compliance threshold"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},r,"%"),n&&s().createElement(s().Fragment,null,s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Business objective"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},n)),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt},"Systems"),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},s().createElement(f.TextList,{component:f.TextListVariants.dl},i.map((function(e){var t=e.osMinorVersion,n=e.count;return s().createElement(s().Fragment,{key:t},s().createElement(f.TextListItem,{component:f.TextListItemVariants.dt,style:{fontWeight:"normal"}},"RHEL ",a,".",t),s().createElement(f.TextListItem,{component:f.TextListItemVariants.dd},s().createElement(f.Label,{color:"grey",isCompact:!0},n," ",n>1?"systems":"system")))}))))))};ve.propTypes={benchmarkId:d().string,refId:d().string,name:d().string,businessObjective:d().string,complianceThreshold:d().number,parentProfileName:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number})),osMajorVersion:d().string.isRequired};var ge=(0,c.Z)("policyForm");const he=(0,u.$j)((function(e){return{benchmarkId:ge(e,"benchmark"),refId:ge(e,"refId"),name:ge(e,"name"),businessObjective:ge(e,"businessObjective"),osMinorVersionCounts:ge(e,"osMinorVersionCounts"),complianceThreshold:parseFloat(ge(e,"complianceThreshold"))||100,parentProfileName:ge(e,"profile").name,rulesCount:ge(e,"selectedRuleRefIds").length}}))(ve);var Oe=n(5913),Ee=n(19398),je=n(4992),Pe=n(65811),Se=function(e){var t=e.errors;return t&&Array.isArray(t)&&t.length>0?s().createElement(f.EmptyStateBody,{className:"wizard-failed-errors"},s().createElement(f.List,null,t.map((function(e){return s().createElement(f.ListItem,{key:e},e)})))):null};Se.propTypes={errors:d().array};var Ie=function(e){var t=e.onWizardFinish,n=e.cloneFromProfileId,r=e.description,a=e.name,l=e.complianceThreshold,c=e.businessObjective,u=e.refId,p=e.benchmarkId,d=e.systems,m=e.selectedRuleRefIds,y=e.ruleValues,b=(0,i.useState)(0),v=(0,o.Z)(b,2),g=v[0],h=v[1],E=(0,i.useState)("This usually takes a minute or two."),j=(0,o.Z)(E,2),P=j[0],S=j[1],I=(0,i.useState)(null),T=(0,o.Z)(I,2),V=T[0],w=T[1],R=(0,i.useState)(!1),C=(0,o.Z)(R,2),k=C[0],Z=C[1],M=(0,je.a7)(),x=function(e){h(100*e)};return(0,i.useEffect)((function(){M(null,{cloneFromProfileId:n,description:r,name:a,complianceThreshold:l,businessObjective:{title:c},refId:u,benchmarkId:p,hosts:d,selectedRuleRefIds:m,values:y},x).then((function(e){var t=e.id;h(100),S(),(0,Pe.q)({variant:"success",title:'Created policy "'.concat(a,'"'),autoDismiss:!0,description:s().createElement("span",null,"From the ",s().createElement("strong",null,"SCAP Policies")," list, open"," ",s().createElement(O.nv,{to:"/scappolicies/".concat(t)},a),".")})})).catch((function(e){var t,n,r;S(null===(t=e.networkError)||void 0===t?void 0:t.message),w(null===(n=e.networkError)||void 0===n||null===(r=n.result)||void 0===r?void 0:r.errors),Z(!0),(0,Pe.q)({variant:"danger",title:"Error creating policy",description:e.message})}))}),[]),s().createElement(f.Bullseye,null,s().createElement(f.EmptyState,{variant:f.EmptyStateVariant.full},s().createElement(f.EmptyStateIcon,{icon:Oe.ZP}),s().createElement("br",null),s().createElement(f.Title,{headingLevel:"h1",size:"lg"},"Creating policy"),s().createElement(f.EmptyStateBody,null,s().createElement(O.ko,{percent:g,failed:k})),s().createElement(f.EmptyStateBody,{className:k&&"wizard-failed-message"},P),s().createElement(Se,{error:V}),s().createElement(f.EmptyStateSecondaryActions,null,(100===g||k)&&s().createElement(f.Button,{variant:"primary",ouiaId:"ReturnToAppButton",onClick:function(){t()}},k?"Back":"Return to application"))))};Ie.propTypes={benchmarkId:d().string.isRequired,businessObjective:d().object,cloneFromProfileId:d().string.isRequired,refId:d().string.isRequired,name:d().string.isRequired,description:d().string,systems:d().array,complianceThreshold:d().number,onWizardFinish:d().func,selectedRuleRefIds:d().arrayOf(d().string).isRequired,ruleValues:d().object};var Te=(0,c.Z)("policyForm");const Ve=(0,h.qC)((0,u.$j)((function(e){return{benchmarkId:Te(e,"benchmark"),businessObjective:Te(e,"businessObjective"),cloneFromProfileId:Te(e,"profile").id,refId:Te(e,"refId"),name:Te(e,"name"),description:Te(e,"description"),complianceThreshold:parseFloat(Te(e,"complianceThreshold"))||100,systems:Te(e,"systems"),selectedRuleRefIds:Te(e,"selectedRuleRefIds"),ruleValues:Te(e,"ruleValues")}})),(0,l.Z)({form:"policyForm",destroyOnUnmount:!0,forceUnregisterOnUnmount:!0}),Ee.C)(Ie);var we=n(70597);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke=function(e){var t=e.benchmark,n=e.osMajorVersion,r=e.complianceThreshold,l=e.name,c=e.profile,u=e.refId,p=e.selectedRuleRefIds,d=e.systemIds,m=e.reset,y=(0,a.useHistory)(),b=(0,i.useState)(1),v=(0,o.Z)(b,2),g=v[0],h=v[1],O=function(){var e=y.location;e.hash&&y.push(Ce(Ce({},e),{},{hash:""}))},E=function(){m(),y.push("/scappolicies")},j=[{id:1,name:"Create SCAP policy",component:s().createElement(A,null),enableNext:(0,we.$H)(t,n,c)},{id:2,name:"Details",component:s().createElement(be,null),canJumpTo:g>=2,enableNext:(0,we.Ay)(l,u,r)},{id:3,name:"Systems",component:s().createElement(pe,null),canJumpTo:g>=3,enableNext:(0,we.Qy)(d)},{id:4,name:"Rules",component:s().createElement(te,null),canJumpTo:(null==d?void 0:d.length)>0&&g>=4,enableNext:(0,we.hT)(p)},{id:5,name:"Review",component:s().createElement(he,{osMajorVersion:n}),nextButtonText:"Finish",canJumpTo:(0,we.hT)(p)&&(null==d?void 0:d.length)>0&&g>=5},{id:6,name:"Finished",component:s().createElement(Ve,{onWizardFinish:E}),isFinishedStep:!0,canJumpTo:(null==d?void 0:d.length)>0&&g>=6}];return s().createElement(s().Fragment,null,s().createElement(f.Wizard,{width:1220,className:"compliance",isOpen:!0,onNext:function(e){var t=e.id;h(g<t?t:g),O()},onGoToStep:O,onBack:O,onClose:E,title:"Create SCAP policy",description:"Create a new policy for managing SCAP compliance",steps:j}))};ke.propTypes={benchmark:d().string,osMajorVersion:d().string,osMinorVersionCounts:d().arrayOf(d().shape({osMinorVersion:d().number,count:d().number})),complianceThreshold:d().string,businessObjective:d().object,dispatch:d().func,isOpen:d().bool,name:d().string,onWizardFinish:d().func,profile:d().string,refId:d().string,selectedRuleRefIds:d().arrayOf(d().string),systemIds:d().arrayOf(d().string),reset:d().func},ke.defaultProps={isOpen:!1};var Ze=(0,l.Z)({form:"policyForm"})(ke),Me=(0,c.Z)("policyForm");const xe=(0,u.$j)((function(e){return{benchmark:Me(e,"benchmark"),osMajorVersion:Me(e,"osMajorVersion"),osMinorVersionCounts:Me(e,"osMinorVersionCounts"),businessObjective:Me(e,"businessObjective"),complianceThreshold:Me(e,"complianceThreshold")||100,name:Me(e,"name"),profile:Me(e,"profile"),refId:Me(e,"refId"),selectedRuleRefIds:Me(e,"selectedRuleRefIds"),systemIds:Me(e,"systems")}}))(Ze)},89671:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var r=n(70885),o=n(65115),i=n(45697),s=n.n(i),a=n(92950),l=n.n(a),c=n(96620),u=n(61770),p=n(4992),d=n(83215),f=n(85836),m=n(65811),y=function(){var e=(0,a.useState)(!1),t=(0,r.Z)(e,2),n=t[0],i=t[1],s=(0,c.useLocation)(),y=(0,c.useHistory)(),b=s.state.policy,v=b.name,g=b.id,h=function(){y.push("/scappolicies")},O=(0,u.D)(p._v,{onCompleted:function(){(0,m.C)((0,d.wN)({variant:"success",title:'Deleted "'.concat(v,'" and its associated reports')})),h()},onError:function(e){(0,m.C)((0,d.wN)({variant:"danger",title:"Error removing policy",description:e.message})),h()}}),E=(0,r.Z)(O,1)[0];return l().createElement(f.C,{variant:o.ModalVariant.small,title:"Delete policy?",titleIconVariant:"warning",ouiaId:"DeletePolicyModal",isOpen:!0,onClose:h,actions:[l().createElement(o.Button,{key:"destroy",ouiaId:"DeletePolicyButton","aria-label":"delete",isDisabled:!n,variant:"danger",onClick:function(){return E({variables:{input:{id:g}}})}},"Delete policy and associated reports"),l().createElement(o.Button,{key:"cancel",ouiaId:"DeletePolicyCancelButton",variant:"secondary",onClick:h},"Cancel")]},l().createElement(o.Text,{className:"policy-delete-body-text"},"Deleting the policy ",l().createElement("b",null,v)," will also delete its associated reports."),l().createElement(o.Checkbox,{label:"I understand this will delete the policy and all associated reports",id:"deleting-policy-check-".concat(g),isChecked:n,onChange:i}))};y.propTypes={policy:s().object};const b=y},57481:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var r=n(70885),o=n(65115),i=n(45697),s=n.n(i),a=n(92950),l=n.n(a),c=n(96620),u=n(61770),p=n(4992),d=n(83215),f=n(85836),m=n(65811),y=function(){var e,t=(0,c.useHistory)(),n=(0,c.useLocation)(),i=(null===(e=n.state)||void 0===e?void 0:e.profile).id,s=function(){t.push(n.state.background)},a=(0,u.D)(p._M,{onCompleted:function(){(0,m.C)((0,d.wN)({variant:"success",title:"Report deleted",description:"Systems associated with this policy will upload reports on the next check-in."})),t.push("/reports")},onError:function(e){(0,m.C)((0,d.wN)({variant:"danger",title:"Error removing report",description:e.message})),s()}}),y=(0,r.Z)(a,1)[0];return l().createElement(f.C,{isOpen:!0,variant:o.ModalVariant.small,title:"Delete report?",titleIconVariant:"warning",ouiaId:"DeleteReportModal",onClose:s,actions:[l().createElement(o.Button,{key:"destroy",ouiaId:"DeleteReportButton","aria-label":"delete",variant:"danger",onClick:function(){return y({variables:{input:{profileId:i}}})}},"Delete report"),l().createElement(o.Button,{key:"cancel",ouiaId:"DeleteReportCancelButton",variant:"secondary",onClick:function(){return s()}},"Cancel")]},l().createElement(o.TextContent,null,"Deleting a report is permanent and cannot be undone."))};y.propTypes={onClose:s().func,isModalOpen:s().bool,onDelete:s().func,policyId:s().string},y.defaultProps={onDelete:function(){},onClose:function(){}};const b=y},722:(e,t,n)=>{"use strict";n.r(t),n.d(t,{EditPolicy:()=>ee,default:()=>te});var r,o,i,s,a=n(4942),l=n(70885),c=n(92950),u=n.n(c),p=n(45697),d=n.n(p),f=n(65115),m=n(7648),y=n(85836),b=n(90570),v=n(58247),g=n(97481),h=n(56085),O=n(79886),E=n(94263),j=n(30168),P=n(67521),S=((0,P.ZP)(r||(r=(0,j.Z)(["\n  query Profiles($filter: String!, $enableRuleTree: Boolean = false) {\n    profiles(search: $filter) {\n      edges {\n        node {\n          id\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          policy {\n            id\n          }\n          policyType\n          benchmark {\n            id\n            refId\n            latestSupportedOsMinorVersions\n            osMajorVersion\n            version\n            ruleTree @include(if: $enableRuleTree)\n            valueDefinitions {\n              defaultValue\n              description\n              id\n              refId\n              title\n              valueType\n            }\n          }\n          rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n          }\n          values\n        }\n      }\n    }\n  }\n"]))),(0,P.ZP)(o||(o=(0,j.Z)(["\n  query Benchmarks($filter: String!, $enableRuleTree: Boolean = false) {\n    benchmarks(search: $filter) {\n      nodes {\n        id\n        latestSupportedOsMinorVersions\n        ruleTree @include(if: $enableRuleTree)\n        valueDefinitions {\n          defaultValue\n          description\n          id\n          refId\n          title\n          valueType\n        }\n        profiles {\n          id\n          refId\n          ssgVersion\n        }\n      }\n    }\n  }\n"])))),I=(0,P.ZP)(i||(i=(0,j.Z)(["\n  query Profile($policyId: String!, $enableRuleTree: Boolean = false) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      external\n      description\n      totalHostCount\n      compliantHostCount\n      complianceThreshold\n      osMajorVersion\n      supportedOsVersions\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        refId\n        profiles {\n          id\n          parentProfileId\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          values\n          benchmark {\n            id\n            title\n            latestSupportedOsMinorVersions\n            osMajorVersion\n            version\n            ruleTree @include(if: $enableRuleTree)\n          }\n          rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n            values\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n      hosts {\n        id\n        osMinorVersion\n        osMajorVersion\n      }\n    }\n  }\n"]))),T=(0,P.ZP)(s||(s=(0,j.Z)(["\n  query Profile($policyId: String!, $enableRuleTree: Boolean = false) {\n    profile(id: $policyId) {\n      id\n      policy {\n        id\n        refId\n        profiles {\n          id\n          parentProfileId\n          refId\n          benchmark {\n            id\n            ruleTree @include(if: $enableRuleTree)\n            valueDefinitions {\n              defaultValue\n              description\n              id\n              refId\n              title\n              valueType\n            }\n          }\n        }\n      }\n    }\n  }\n"])));function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=function(){return u().createElement(f.EmptyState,null,u().createElement(f.Title,{headingLevel:"h5",size:"lg"},"No rules can be configured"),u().createElement(f.EmptyStateBody,null,"This policy has no associated systems, and therefore no rules can be configured."),u().createElement(f.EmptyStateBody,null,"Add at least one system to configure rules for this policy."))},C=function(e){var t,n=e.policy,r=e.selectedRuleRefIds,o=e.setSelectedRuleRefIds,i=e.osMinorVersionCounts,s=e.setRuleValues,a=e.ruleValues,l=null==n?void 0:n.osMajorVersion,p=Object.keys(i).sort(),d="os_major_version = ".concat(l," ")+'and latest_supported_os_minor_version ^ "'.concat(p.join(","),'"'),m=(0,b.a)(S,{variables:{filter:d},skip:0===p.length}),j=m.data,P=m.error,I=m.loading,T=null==j||null===(t=j.benchmarks)||void 0===t?void 0:t.nodes,V=function(e,t,n){return Object.values(t).sort((0,O.Sj)("osMinorVersion","desc")).map((function(t){var r=t.osMinorVersion,o=t.count;r="".concat(r);var i=e.policy.profiles.find((function(e){return e.osMinorVersion===r})),s=e.osMajorVersion;if(!i&&n){var a=function(e,t){return e.find((function(e){var n;return null===(n=e.latestSupportedOsMinorVersions)||void 0===n?void 0:n.includes(t)}))}(n,r);if(a){var l=function(e,t){return e.profiles.find((function(e){return e.refId===t}))}(a,e.refId);l&&(i=e.policy.profiles.find((function(e){return e.parentProfileId===l.id&&e.osMinorVersion===r})),i=w(w({},l),{},{benchmark:a,osMajorVersion:s},i))}}return{profile:i,systemCount:o,newOsMinorVersion:r}})).filter((function(e){var t=e.profile,n=e.newOsMinorVersion;return!!t&&n}))}(n,i,T),C=(0,h.b4)(V),k=!I&&(null==V?void 0:V.length)>0?V:void 0;return(0,c.useEffect)((function(){if(n.policy.profiles){var e=n.policy.profiles,t=(0,h.uU)(e,C);o((function(e){return(0,h.TB)(t,e)}))}}),[n.policy.profiles]),u().createElement(y.tC,{stateValues:{error:P,data:!P&&k,loading:I,empty:!I&&!k&&!P}},u().createElement(y.K7,{stateKey:"loading"},u().createElement(v.Z,null,u().createElement(g.Z,null))),u().createElement(y.K7,{stateKey:"data"},u().createElement(f.TextContent,null,u().createElement(f.Text,null,"Different release versions of RHEL are associated with different versions of the SCAP Security Guide (SSG), therefore each release must be customized independently.")),u().createElement(h.Hv,{resetLink:!0,rulesPageLink:!0,selectedFilter:!0,remediationsEnabled:!1,columns:[E.VG,E.zb,E.uH],tabsData:V,ruleValues:function(e){var t,n,r=function(e,t){return w(w({},t),(null==a?void 0:a[e])||{})};return Object.fromEntries((null==e||null===(t=e.policy)||void 0===t||null===(n=t.profiles)||void 0===n?void 0:n.map((function(e){var t=e.id,n=e.values;return e.benchmark.valueDefinitions,[t,r(t,n)]})))||[])}(n),selectedRuleRefIds:r,setSelectedRuleRefIds:o,setRuleValues:s,level:1,ouiaId:"RHELVersions"})),u().createElement(y.K7,{stateKey:"empty"},u().createElement(R,null)))};C.propTypes={setNewRuleTabs:d().func,policy:d().object,osMinorVersionCounts:d().shape({osMinorVersion:d().shape({osMinorVersion:d().number,count:d().number})}),selectedRuleRefIds:d().array,setSelectedRuleRefIds:d().func,setRuleValues:d().func,ruleValues:d().array};const k=C;var Z=n(6084),M=n(31499),x=function(e){var t=e.osMajorVersion;return u().createElement(u().Fragment,null,u().createElement(f.TextContent,{className:"pf-u-mb-md"},u().createElement(f.Text,null,"You do not have any ",u().createElement("b",null,"RHEL ",t)," systems connected to Insights and enabled for Compliance.")),u().createElement(f.TextContent,{className:"pf-u-mb-md"},u().createElement(f.Text,null,"Connect RHEL ",t," systems to Insights.")))};x.propTypes={osMajorVersion:d().string};var D=function(e){var t=e.osMajorVersion;return u().createElement(u().Fragment,null,u().createElement(f.TextContent,{className:"pf-u-mb-md"},u().createElement(f.Text,null,"Select which of your ",u().createElement("b",null,"RHEL ",t)," systems should be included in this policy.")))};D.propTypes={osMajorVersion:d().string};var F=function(e){var t=e.policy,n=e.onSystemSelect,r=e.selectedSystems,o=t.id,i=t.osMajorVersion,s=t.supportedOsVersions.map((function(e){return e.split(".")[1]})),a=i&&"os_major_version = ".concat(i," AND os_minor_version ^ (").concat(s.join(","),")"),l=a?"".concat(a," or policy_id = ").concat(o):"policy_id = ".concat(o);return u().createElement(u().Fragment,null,u().createElement(Z.r0,{columns:[M.VG,M.MO("tags"),M.U5],showOsMinorVersionFilter:[i],prependComponent:u().createElement(D,{osMajorVersion:i}),emptyStateComponent:u().createElement(x,{osMajorVersion:i}),compact:!0,showActions:!1,defaultFilter:l,enableExport:!1,remediationsEnabled:!1,preselectedSystems:r,onSelect:n}))};F.propTypes={policy:d().object,newRuleTabs:d().bool,onSystemSelect:d().func,selectedSystems:d().array};const L=F;var B=n(96620);function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const _=function(){var e=(0,B.useHistory)(),t=(0,B.useLocation)();return u().createElement(f.Alert,{variant:"info",isInline:!0,title:"You selected a system that has a release version previously not included in this policy.",actionLinks:u().createElement(f.AlertActionLink,{onClick:function(){return e.push($($({},t),{},{hash:"#rules"}))}},"Open rule editing")},u().createElement("p",null,"If you have edited any rules for this policy, you will need to do so for this release version as well."))};var A=n(99030),q=n(70597);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=function(e){var t,n=e.policy,r=e.setUpdatedPolicy,o=e.selectedRuleRefIds,i=e.setSelectedRuleRefIds,s=e.selectedSystems,a=e.setSelectedSystems,p=e.setRuleValues,d=e.ruleValues,m=(null==n||null===(t=n.policy)||void 0===t?void 0:t.profiles)||[],b=(0,c.useState)({}),v=(0,l.Z)(b,2),g=v[0],O=v[1],E=function(){return c.useState.apply(void 0,arguments)}(!1),j=(0,l.Z)(E,2),P=j[0],S=j[1],I=(0,c.useCallback)((function(e){var t,r=n.hosts.map((function(e){return e.osMinorVersion})),o=e.filter((function(e){var t=e.osMinorVersion;return!r.includes(t)})).length>0;a(e),S(o),O((t=e,(m||[]).reduce((function(e,t){var n;return""!==t.osMinorVersion&&(e[n=t.osMinorVersion]||(e[n]={osMinorVersion:t.osMinorVersion,count:0})),e}),(0,A.UP)(t||[]))))}),[m,o]);return(0,c.useEffect)((function(){if(n){var e=(0,q.KJ)(n.complianceThreshold),t=m.filter((function(e){return!!e.osMinorVersion}));r(H(H({},n),{},{complianceThresholdValid:e})),i((0,h.TB)(t)),I(n.hosts)}}),[n]),u().createElement(f.Form,null,u().createElement(y.tn,{ouiaId:"EditSystems",defaultTab:"systems",id:"policy-tabs"},u().createElement(f.Tab,{eventKey:"rules",ouiaId:"Rules",title:u().createElement(f.TabTitleText,null,"Rules")},u().createElement(k,{policy:n,setSelectedRuleRefIds:i,setRuleValues:p,ruleValues:d,selectedRuleRefIds:o,osMinorVersionCounts:g})),u().createElement(f.Tab,{eventKey:"systems",ouiaId:"Systems",title:u().createElement(f.TabTitleText,null,"Systems")},u().createElement(L,{policy:n,selectedSystems:s,onSystemSelect:I}),P&&u().createElement(_,null))))};U.propTypes={policy:d().object,updatedPolicy:d().object,setUpdatedPolicy:d().func,selectedRuleRefIds:d().arrayOf(d().object),setSelectedRuleRefIds:d().func,setSelectedSystems:d().func,selectedSystems:d().array,setRuleValues:d().func,ruleValues:d().array};const G=U;var z=n(88326);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const J=function(){var e=(0,B.useParams)().policy_id,t=(0,b.a)(I,{variables:{policyId:e}}),n=t.data,r=t.loading,o=t.error,i=(0,b.a)(T,{variables:{policyId:e}}),s=i.data,a=i.loading,l=i.error;return{policy:(0,c.useMemo)((function(){return null!=n&&n.profile&&null!=s&&s.profile?(e=n,o=function(e){return function(t){return Y(Y({},t),{},{benchmark:Y(Y({},t.benchmark),e.profile.policy.profiles.find((function(e){var n=e.id;return t.id===n})).benchmark)})}}(s),Y(Y({},null==e?void 0:e.profile),{},{policy:Y(Y({},e.profile.policy),{},{profiles:null===(t=e.profile.policy)||void 0===t||null===(r=t.profiles)||void 0===r?void 0:r.map(o)})})):void 0;var e,t,r,o}),[n,s]),loading:r&&a,error:o||l}};function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ee=function(e){var t=e.route,n=J(),r=n.policy,o=n.loading,i=n.error,s=(0,z.kq)(),p=(0,c.useState)(null),d=(0,l.Z)(p,2),b=d[0],v=d[1],g=(0,c.useState)([]),h=(0,l.Z)(g,2),O=h[0],E=h[1],j=(0,c.useState)([]),P=(0,l.Z)(j,2),S=P[0],I=P[1],T=(0,c.useState)({}),V=(0,l.Z)(T,2),w=V[0],R=V[1],C=b&&!b.complianceThresholdValid,k=X(X({},b),{},{selectedRuleRefIds:O,hosts:S,values:w}),Z=(0,z.f8)(r,k),M=(0,l.Z)(Z,2),x=M[0],D=M[1],F=[u().createElement(f.Button,{isDisabled:C,key:"save",ouiaId:"EditPolicySaveButton",variant:"primary",spinnerAriaValueText:"Saving",isLoading:x,onClick:D},"Save"),u().createElement(f.Button,{key:"cancel",ouiaId:"EditPolicyCancelButton",variant:"link",onClick:function(){return s()}},"Cancel")];return(0,m.a)(t,null==r?void 0:r.name),u().createElement(y.C,{isOpen:!0,position:"top",style:{minHeight:"350px"},variant:"large",ouiaId:"EditPolicyModal",title:"Edit ".concat(r?r.name:""),onClose:function(){return s()},actions:F},u().createElement(y.tC,{stateValues:{policy:r,loading:o,error:i}},u().createElement(y.K7,{stateKey:"loading"},u().createElement(f.Spinner,null)),u().createElement(y.K7,{stateKey:"policy"},u().createElement(G,{policy:r,updatedPolicy:b,setUpdatedPolicy:v,selectedRuleRefIds:O,setSelectedRuleRefIds:E,selectedSystems:S,setSelectedSystems:I,setRuleValues:function(e,t,n){var o=Object.fromEntries((null==r?void 0:r.policy.profiles.map((function(e){return[e.id,e.values]})))||[]);R((function(r){return X(X(X({},o),r),{},(0,a.Z)({},e,X(X(X({},o[e]),r[e]),{},(0,a.Z)({},t.id,n))))}))},ruleValues:w}))))};ee.propTypes={route:d().object};const te=ee},31499:(e,t,n)=>{"use strict";n.d(t,{OF:()=>N,ll:()=>B,Hc:()=>$,VG:()=>x,OS:()=>A,U5:()=>_,rE:()=>L,hN:()=>F,Zw:()=>D,MO:()=>q});var r=n(4942),o=n(45987),i=n(92950),s=n.n(i),a=n(46818),l=n(65115),c=n(85836),u=n(79886),p=n(45697),d=n.n(p),f=n(69957),m=n(62410),y=n(19535),b=n(82176),v=function(e){var t=e.id,n=e.children;return s().createElement(c.nv,{to:{pathname:"/systems/".concat(t)}},n)};v.propTypes={id:d().string,children:d().node};var g=function(e){var t=e.id,n=e.name,r=e.osMajorVersion,o=e.osMinorVersion,i=e.showOsInfo,a=void 0!==i&&i,c=e.showLink,u=void 0!==c&&c;return s().createElement(l.TextContent,null,u?s().createElement(v,{id:t},n):n,function(e,t){return!!e&&!!t&&a}(r,o)&&s().createElement(l.Text,{component:l.TextVariants.small},"RHEL ",r,".",o))};g.propTypes={id:d().string,name:d().string,osMajorVersion:d().string,osMinorVersion:d().string,showOsInfo:d().bool,showLink:d().bool};var h=function(e){var t=e.ssgVersion,n=void 0===t?"Not available":t;return e.supported?n:s().createElement(c.cT,{messageVariant:"singular"},n)};h.propTypes={supported:d().bool,ssgVersion:d().string};var O=function(e){var t=e.testResultProfiles,n=void 0===t?[]:t;return 0!==n.length?n.map((function(e){var t;return s().createElement(h,{key:"ssgversion-".concat(e.id),ssgVersion:null==e||null===(t=e.benchmark)||void 0===t?void 0:t.version,supported:null==e?void 0:e.supported})})):"Unknown"};O.propTypes={testResultProfiles:d().array};var E=function(e){var t=e.policies;return(t||[]).length>0&&s().createElement(y.Z,{inline:!0,text:t.map((function(e){return e.name})).join(", "),length:215})};E.propTypes={policies:d().array};var j=function(e){var t=e.id,n=e.testResultProfiles.reduce((function(e,t){var n=t.rulesFailed;return e+parseInt(n||0)}),0);return s().createElement(v,{id:t},n>0?n:"N/A")};j.propTypes={id:d().string,testResultProfiles:d().array};var P=function(e){var t=e.testResultProfiles,n=t[0]||{},r=n.score,o=n.supported,i=n.compliant;return t.length>0?s().createElement(c.OF,{score:r,supported:o,compliant:i}):"N/A"};P.propTypes={testResultProfiles:d().array};var S=function(){return s().createElement(l.Tooltip,{position:"right",content:s().createElement(i.Fragment,null,"This system has never returned a report for this policy. This may be because it is disconnected, or the insights-client on this system is not configured to use Compliance.")},s().createElement("div",null,s().createElement(f.ZP,{color:"var(--pf-global--warning-color--100)"})," "+b.C4))},I=function(e){var t=e.map((function(e){return new Date(e.lastScanned)})),n=new Date(Math.max.apply(null,t.filter((function(e){return isFinite(e)}))));return n instanceof Date&&isFinite(n)?n:s().createElement(S,null)},T=function(e){var t=e.testResultProfiles,n=I(t||[]);return n instanceof Date?s().createElement(m.Z,{date:Date.parse(n),type:"relative"}):n};T.propTypes={testResultProfiles:d().array};var V=function(e){var t=e.osMinorVersion,n=e.osMajorVersion;return"RHEL ".concat(n,".").concat(t)},w=function(e){return V(e)},R=["cell"];function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z={isStatic:!0},M=function(e){var t=e.cell,n=(0,o.Z)(e,R);return k(k({},n),{},{renderFunc:(0,u.SO)(t,n.props)})},x=M({key:"name",title:"Name",sortBy:["name"],props:{width:40},renderExport:function(e){return"".concat(e.name," (").concat(V(e),")")},cell:g}),D=function(e){return k(k({},x),{},{props:k(k({},x.props),e),renderFunc:(0,u.SO)(g,e)})},F={title:"SSG version",transforms:[a.P8],exportKey:"testResultProfiles",sortBy:["ssg_version"],key:"ssg_version",renderExport:function(e){return e.map((function(e){var t=e.supported,n=e.benchmark.version;return"".concat(t?"":"!").concat(n)})).join(", ")},renderFunc:(0,u.SO)(O)},L={title:"Policies",transforms:[a.P8],key:"policies",exportKey:"policies",renderExport:function(e){return e.map((function(e){return e.name})).join(", ")},props:k({width:40},Z),renderFunc:(0,u.SO)(E)},B={title:"Failed rules",key:"failedRules",exportKey:"profiles",transforms:[a.P8],props:k({width:5},Z),renderExport:function(e){return e.reduce((function(e,t){return e+t.rulesFailed}),0)},renderFunc:(0,u.SO)(j)},N={title:"Compliance score",key:"complianceScore",exportKey:"testResultProfiles",transforms:[a.P8],props:k({width:5},Z),renderExport:function(e){return(0,c.Oq)((0,b.RT)(e)).trim()},renderFunc:(0,u.SO)(P)},$={title:"Last scanned",key:"lastScanned",transforms:[a.P8],exportKey:"testResultProfiles",props:k({width:10},Z),renderExport:function(e){return I(e)},renderFunc:(0,u.SO)(T)},_=M({title:"Operating system",key:"operatingSystem",sortBy:["osMajorVersion","osMinorVersion"],transforms:[a.P8],renderExport:function(e){return V(e)},cell:w}),A=M({title:s().createElement(l.Tooltip,{content:s().createElement("span",null,"Operating System")},s().createElement("span",null,"OS")),original:"Operating System",key:"operatingSystem",dataLabel:"OS",transforms:[a.P8],sortBy:["osMajorVersion","osMinorVersion"],props:{width:10},renderExport:function(e){return V(e)},cell:w}),q=function(e,t){return k({key:e},t)}},6084:(e,t,n)=>{"use strict";n.d(t,{Ey:()=>O,r0:()=>Ie}),n(44434);var r,o=n(4942),i=n(15671),s=n(43144),a=n(60136),l=n(82963),c=n(61120),u=n(92950),p=n.n(u),d=n(45697),f=n.n(d),m=n(35664),y=n(67336),b=n(38775),v=n(53895);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var h=(0,y.gu)()(r=function(e){(0,a.Z)(u,e);var t,n,r=(t=u,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,c.Z)(t);if(n){var o=(0,c.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,l.Z)(this,e)});function u(e){return(0,i.Z)(this,u),r.call(this,e)}return(0,s.Z)(u,[{key:"render",value:function(){var e=this;return p().createElement(b.Z,{onLoad:function(t){var n=t.mergeWithDetail;return e.getRegistry().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n()))},inventoryId:this.props.inventoryId},p().createElement(v.Z,{fallback:p().createElement(m.Z,{size:m.i.md})}))}}]),u}(p().Component))||r;h.propTypes={entity:f().object,inventoryId:f().string};const O=function(e){return p().createElement(h,e)};n(32369),n(57481),n(722),n(89671);var E,j=n(87462),P=n(42982),S=n(70885),I=n(65115),T=n(75863),V=n(45987),w=n(65811),R=n(98132),C=n(15861),k=n(64687),Z=n.n(k),M=n(26075),x=n(95417),D=n(30168),F=n(67521),L=3,B=(0,F.Ps)(E||(E=(0,D.Z)(["\n  query getSystems(\n    $filter: String!\n    $policyId: ID\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          testResultProfiles(policyId: $policyId) {\n            id\n            refId\n            score\n            lastScanned\n            compliant\n            rulesFailed\n            rulesPassed\n            supported\n            osMajorVersion\n            rules {\n              id\n              refId\n              precedence\n              compliant\n              remediationAvailable\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),N=n(80976),$=n(55942),_=["rules","systems","policyId","onRemediationCreated"],A=function(e){e.rules;var t=e.systems,n=e.policyId,r=(e.onRemediationCreated,(0,V.Z)(e,_)),o=function(e,t,n){var r=(0,M.x)(),o=(0,x.Z)(3),i=o.isResolving,s=o.results,a=o.resolve,l=(0,u.useCallback)(function(){var t=(0,C.Z)(Z().mark((function t(o,i){var s;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=n.length>0?"id ^ (".concat(n.join(","),")"):void 0,t.next=3,r.query({query:B,fetchPolicy:"no-cache",variables:{perPage:o,page:i,filter:"(".concat(s,") AND policy_id = ").concat(e),policyId:e}});case 3:return t.abrupt("return",t.sent.data.systems);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),[n,e]),c=(0,u.useCallback)((0,C.Z)(Z().mark((function e(){var t,r,o,i=arguments;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:L,r=Math.ceil((null==n?void 0:n.length)/t)||1,e.next=4,a((0,P.Z)(new Array(r)).map((function(e,n){return function(){return l(t,n+1)}})));case 4:return o=e.sent,e.abrupt("return",o&&(0,N.k)(o));case 6:case"end":return e.stop()}}),e)}))),[n]);return{isLoading:i,data:s&&(0,N.k)(s),fetch:c}}(n,0,t),i=o.isLoading,s=o.fetch;return p().createElement(R.Z,(0,j.Z)({isDisabled:0===(null==t?void 0:t.length)||i,onRemediationCreated:function(e){(0,w.q)(e.getNotification())},dataProvider:s,buttonProps:{ouiaId:"RemediateButton",isLoading:i},fallback:p().createElement($.Z,null)},r),"Remediate")};A.propTypes={rules:f().array,systems:f().array,onRemediationCreated:f().func,policyId:f().string};const q=A;var K,H,U=n(58061),G=n(85836),z=n(37948),W=n(33739),Y=(n(35937),n(83237)),J=n(99030);function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(0,F.ZP)(K||(K=(0,D.Z)(["\n  query getSystems(\n    $filter: String!\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n          osMinorVersion\n          culledTimestamp\n          staleWarningTimestamp\n          staleTimestamp\n          insightsId\n          lastScanned\n          updated\n        }\n      }\n    }\n  }\n"])));var X=(0,F.ZP)(H||(H=(0,D.Z)(["\n  query getSystems($filter: String!) {\n    systems(search: $filter) {\n      osVersions\n    }\n  }\n"]))),ee=function(e,t){return[].concat((0,P.Z)((0,U.RM)(e)),(0,P.Z)(t?(0,U.iz)(e):[]))},te=function(){return U.n3.apply(void 0,arguments)},ne=function(e){return function(t){var n=t.INVENTORY_ACTION_TYPES,r=t.mergeWithEntities;return(0,y.JH)().register(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r((0,J.zw)(n,e))))}},re=function(e){return[{type:Y.Y.checkbox,label:"SSG Version",filterString:function(e){return"ssg_version = ".concat(e)},items:e.map((function(e){return{label:e,value:e}}))}]},oe=n(90570),ie=n(28216),se=n(43917),ae=n(82176),le=n(76316),ce=n(77592),ue=["culledTimestamp","staleWarningTimestamp","staleTimestamp","insightsId"],pe=["tagFilters"];function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(t,n){var r;return r=n.major,e.length>0&&!e.map(String).includes(String(r))||(t[String(n.major)]=(0,P.Z)(new Set([].concat((0,P.Z)(t[n.major]||[]),[n.minor])))),t}),[])},ye=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,oe.a)(X,fe({skip:!e},t)).data,r=((null==n?void 0:n.systems)||{}).osVersions;return e?te(me(r,e)):[]},be=function(e){var t=e.culledTimestamp,n=e.staleWarningTimestamp,r=e.staleTimestamp,o=e.insightsId;return fe(fe({},(0,V.Z)(e,ue)),{},{insights_id:o,culled_timestamp:t,stale_warning_timestamp:n,stale_timestamp:r})},ve=function(e){var t=e.query,n=e.onComplete,r=e.variables,o=void 0===r?{}:r,i=e.onError,s=(0,M.x)();return function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return s.query({query:t,fetchResults:!0,fetchPolicy:"no-cache",variables:fe(fe({perPage:e,page:r},o),a)}).then((function(e){var t,r,o,i=e.data,s=(null==i||null===(t=i.systems)||void 0===t||null===(r=t.edges)||void 0===r?void 0:r.map((function(e){return e.node})))||[],l={entities:(0,ae.qN)(s).map(be),meta:fe(fe({},a.tags&&{tags:a.tags}),{},{totalCount:(null==i||null===(o=i.systems)||void 0===o?void 0:o.totalCount)||0})};return n&&n(l),l})).catch((function(e){if(i)return i(e),{entities:[],meta:{totalCount:0}};throw e}))}},ge=function(){var e=(0,x.Z)(),t=e.isResolving,n=e.resolve;return{isLoading:t,fetchBatched:function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,i=Math.ceil(t/o)||1;return n((0,P.Z)(new Array(i)).map((function(t,n){return function(){return e(o,n+1,r)}})))}}},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tagFilters,n=(0,V.Z)(e,pe),r=t?{tags:t.flatMap((function(e){return e.values.map((function(t){return"".concat(encodeURIComponent(e.key),"/").concat(encodeURIComponent(t.tagKey),"=").concat(encodeURIComponent(t.value))}))}))}:{};return fe(fe({},n),r)},Oe=function(e){return(null==e?void 0:e.length)>0?"id ^ (".concat(e.join(","),")"):void 0},Ee=n(79886);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Se=function(e){var t=e.columns,n=e.showAllSystems,r=e.policyId,o=e.showActions,i=e.enableExport,s=e.compliantFilter,a=e.policies,l=e.showOnlySystemsWithTestResults,c=e.showOsFilter,d=e.error,f=e.showComplianceSystemsInfo,m=e.compact,y=e.remediationsEnabled,b=e.systemProps,v=e.defaultFilter,g=e.emptyStateComponent,h=e.prependComponent,O=e.showOsMinorVersionFilter,E=e.preselectedSystems,V=e.onSelect,R=e.noSystemsTable,k=e.tableProps,M=e.ssgVersions,x=e.dedicatedAction,D=(0,u.useRef)(null),F=(0,u.useState)(!1),L=(0,S.Z)(F,2),B=L[0],N=L[1],$=(0,u.useState)(!1),_=(0,S.Z)($,2),A=_[0],K=_[1],H=(0,u.useState)([]),Y=(0,S.Z)(H,2),J=Y[0],Q=Y[1],X=(0,u.useState)(0),te=(0,S.Z)(X,2),oe=te[0],ae=te[1],ue=(0,u.useState)(50),pe=(0,S.Z)(ue,2),de=pe[0],me=pe[1],be=(0,u.useState)([]),je=(0,S.Z)(be,2),Se=je[0],Ie=je[1],Te=ye(O,{variables:Pe({filter:v},r&&{policyId:r})}),Ve=(0,z.Z)({filters:{filterConfig:[].concat((0,P.Z)(U.qo),(0,P.Z)(s?U.rN:[]),(0,P.Z)((null==a?void 0:a.length)>0?ee(a,c):[]),(0,P.Z)(M?re(M):[]),(0,P.Z)(Te))}}),we=Ve.toolbarProps,Re=Ve.filterString,Ce=Ve.activeFilterValues,ke=function(e,t,n){var r=[].concat((0,P.Z)(t?["has_test_results = true"]:[]),(0,P.Z)((null==e?void 0:e.length)>0?[e]:[])).join(" and ");return n?"(".concat(n,")")+(r?" and (".concat(r,")"):""):r}(Re(),l,v),Ze=(0,u.useMemo)((function(){return(0,Ee.AZ)(t)}),[t]),Me=(0,u.useMemo)((function(){return{query:Ze.query,variables:Pe(Pe({},Ze.fragments),{},{tags:Se,filter:ke},r&&{policyId:r})}}),[Ze,Se,ke,r]),xe=function(e){var t=e.total,n=e.onSelect,r=e.preselected,o=e.fetchArguments,i=e.currentPageIds,s=ge(),a=s.isLoading,l=s.fetchBatched,c=(0,u.useState)([]),d=(0,S.Z)(c,2),f=d[0],m=d[1],y=ve(fe(fe({},o),{},{onError:function(e){(0,w.q)({variant:"danger",title:"Error selecting systems",description:e.message})}})),b=function(){var e=(0,C.Z)(Z().mark((function e(t){var n,r;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=2;break}return e.abrupt("return",[]);case 2:return n=Oe(t),e.next=5,l(y,t.length,fe({},n&&{filter:n}));case 5:return r=e.sent,e.abrupt("return",r.flatMap((function(e){return e.entities})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=(0,C.Z)(Z().mark((function e(t){var r;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t);case 2:r=e.sent,m(r),n&&n(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=(0,C.Z)(Z().mark((function e(){var n;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(y,t);case 2:return n=e.sent,e.abrupt("return",n.flatMap((function(e){return e.entities.map((function(e){return e.id}))})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=(0,ce.Z)({total:t,onSelect:v,preselected:r,itemIdsInTable:g,itemIdsOnPage:function(){return i}});return fe(fe({selectedSystems:f},h),{},{toolbarProps:fe(fe({},h.toolbarProps),{},{bulkSelect:fe(fe({},h.toolbarProps.bulkSelect),a?{isDisabled:!0,toggleProps:{children:[p().createElement(I.Spinner,{size:"md",key:"spinner"})]}}:{})})})}({total:oe,perPage:de,onSelect:V,preselected:(0,u.useMemo)((function(){return E.map((function(e){return e.id}))}),[E]),fetchArguments:Me,currentPageIds:J.map((function(e){return e.id}))}),De=xe.selectedIds,Fe=xe.tableProps,Le=xe.toolbarProps;!function(e,t,n){var r=(0,ie.I0)();(0,u.useLayoutEffect)((function(){r({type:"INVENTORY_INIT"})}),[]),(0,u.useEffect)((function(){r({type:"SELECT_ENTITIES",payload:{selected:t}})}),[t]);var o=(0,se.Z)((function(){Promise.resolve(r({type:"RESET_PAGE"})).then((function(){var t;return null==e||null===(t=e.current)||void 0===t?void 0:t.onRefreshData()}))}),50);(0,u.useEffect)((function(){o()}),[n])}(D,De,Ce);var Be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.selected,r=t.columns,o=function(e,t){return e.map((function(e){return"".concat(e,":").concat(t)}))},i=function(e){return(r||[]).find((function(t){return t.key===e}))};return function(){var t=(0,C.Z)(Z().mark((function t(r,s){var a,l,c,u,p,d,f,m,y,b,v,g,h;return Z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.page,l=void 0===a?1:a,c=s.per_page,u=s.orderBy,p=s.orderDirection,d=s.filters,f=i(u),m=f&&f.sortBy?o(f.sortBy,p):void 0,y=he(d),t.next=6,e(c,l,fe(fe({},y),{},{sortBy:m}));case 6:return b=t.sent,g=(v=b||{}).entities,h=v.meta.totalCount,t.abrupt("return",{results:g.map((function(e){return fe(fe({},e),{},{selected:(n||[]).map((function(e){return e})).includes(e.id)})})),orderBy:u,orderDirection:p,total:h});case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(ve(Pe(Pe({},Me),{},{onComplete:function(e){var t,n,r;ae(e.meta.totalCount),Q(e.entities),me(e.perPage),K(!0),Ie&&Ie(e.meta.tags),!g||0!==e.meta.totalCount||0!==Ce.length||void 0!==(null==e||null===(t=e.meta)||void 0===t?void 0:t.tags)&&0!==(null==e||null===(n=e.meta)||void 0===n||null===(r=n.tags)||void 0===r?void 0:r.length)||N(!0)}})),{selected:De,columns:t}),Ne=function(e){var t=e.columns,n=e.selected,r=e.total,o=e.fetchArguments,i=ge(),s=i.isLoading,a=i.fetchBatched,l=n?Oe(n):void 0,c=ve({query:o.query,variables:fe(fe(fe({},o.variables),o.tags&&{tags:o.tags}),{},{filter:l?"".concat(o.variables.filter," and (").concat(l,")"):o.variables.filter}),onError:function(){(0,w.q)({variant:"danger",title:"Couldnt download export",description:"Reinitiate this export to try again."})}}),u=function(){var e=(0,C.Z)(Z().mark((function e(){var t;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(c,r,(null==n?void 0:n.length)>0?Oe(n):void 0);case 2:return t=e.sent,e.abrupt("return",t.flatMap((function(e){return e.entities})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,le.ZP)({exporter:u,columns:t,isDisabled:0===r||s,onStart:function(){(0,w.q)({variant:"info",title:"Preparing export",description:"Once complete, your download will start automatically."})},onComplete:function(){(0,w.q)({variant:"success",title:"Downloading export"})}}).toolbarProps.exportConfig}({columns:t,filter:ke,selected:De,total:oe,fetchArguments:Pe({},Me)});return p().createElement(G.Se,{stateValues:{error:d,noError:void 0===d&&!B,empty:B}},p().createElement(G.K7,{stateKey:"error"},!!h&&h,p().createElement(G.mf,{error:d})),p().createElement(G.K7,{stateKey:"empty"},g),p().createElement(G.K7,{stateKey:"noError"},!!h&&A&&h,f&&p().createElement(I.Alert,{isInline:!0,variant:"info",ouiaId:"SystemsListIsDifferentAlert",title:"The list of systems in this view is different than those that appear in the Inventory. Only systems currently associated with or reporting against compliance policies are displayed."}),p().createElement(W.Z,(0,j.Z)({},b,{disableDefaultColumns:!0,columns:function(e){return t.map((function(t){var n="string"==typeof t,r=n?t:t.key,o=e.find((function(e){return e.key===r}));return Pe(Pe(Pe({},o),n?{key:t}:t),{},{props:Pe(Pe({},null==o?void 0:o.props),null==t?void 0:t.props)})}))},noSystemsTable:R,ref:D,getEntities:Be,hideFilters:{all:!0,tags:!1},showTags:!0,onLoad:ne(t),tableProps:Pe(Pe({},Fe),{},{isStickyHeader:!0},k),fallback:p().createElement(I.Spinner,null),variant:m?T.B.compact:""},Le,!n&&Pe(Pe({},we),y&&{dedicatedAction:p().createElement(q,{policyId:r,systems:De})}),x?{dedicatedAction:x}:{},i&&{exportConfig:Ne},o&&{actions:[{title:"View in inventory",onClick:function(e,t,n){var r=n.id;window.location.href="".concat(window.location.origin,"/insights/inventory/").concat(r)}}]}))))};Se.propTypes={columns:f().arrayOf(f().oneOfType([f().shape({}),f().string])),policies:f().arrayOf(f().shape({})),showAllSystems:f().bool,policyId:f().string,query:f().oneOfType([f().string,f().object]),showActions:f().bool,enableExport:f().bool,compliantFilter:f().bool,showOnlySystemsWithTestResults:f().bool,showOsFilter:f().bool,showComplianceSystemsInfo:f().bool,error:f().object,compact:f().bool,remediationsEnabled:f().bool,defaultFilter:f().string,systemProps:f().shape({isFullView:f().bool}),emptyStateComponent:f().node,prependComponent:f().node,showOsMinorVersionFilter:f().oneOfType([f().bool,f().arrayOf(f().string)]),preselectedSystems:f().array,onSelect:f().func,noSystemsTable:f().node,tableProps:f().object,ssgVersions:f().array,dedicatedAction:f().object},Se.defaultProps={policyId:"",showActions:!0,enableExport:!0,compliantFilter:!1,showOnlySystemsWithTestResults:!1,showComplianceSystemsInfo:!1,compact:!1,remediationsEnabled:!0,preselectedSystems:[]};const Ie=Se},95417:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(15861),o=n(70885),i=n(64687),s=n.n(i),a=n(92950),l=n(57609),c=2;const u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c,t=(0,a.useState)(!1),n=(0,o.Z)(t,2),i=n[0],u=n[1],p=(0,a.useState)(),d=(0,o.Z)(p,2),f=d[0],m=d[1],y=(0,a.useCallback)(function(){var t=(0,r.Z)(s().mark((function t(n){var r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m(void 0);case 2:return t.next=4,u(!0);case 4:return t.next=6,(0,l.Z)(n,{concurrency:e});case 6:return r=t.sent,t.next=9,u(!1);case 9:return t.next=11,m(r);case 11:return t.abrupt("return",r);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e]);return{isResolving:i,results:f,resolve:y}}},99030:(e,t,n)=>{"use strict";n.d(t,{Nw:()=>p,UP:()=>u,zw:()=>c});var r=n(4942),o=n(18546),i=n(79886);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e,t){return e.map((function(e){return a(a({},e),{},{selected:t.includes(e.id)})}))},c=function(){var e;return(0,o.Gg)((e={},(0,r.Z)(e,"INVENTORY_INIT",(function(){return{rows:[],total:0}})),(0,r.Z)(e,"RESET_PAGE",(function(e){return a(a({},e),{},{page:1})})),(0,r.Z)(e,"SELECT_ENTITIES",(function(e,t){var n=t.payload.selected;return a(a({},e),{},{rows:l(e.rows,n)})})),e))},u=function(e){return e?e.reduce((function(e,t){var n=t.osMinorVersion;return null!=n&&(e[n]=e[n]||{osMinorVersion:n,count:0}).count++,e}),{}):{}},p=function(e){return Object.values(u(e)).sort((0,i.Sj)("osMinorVersion","desc"))}},23663:()=>{}}]);
//# sourceMappingURL=../sourcemaps/650.d5d23a7c2205bf652014970f908f8534.js.map