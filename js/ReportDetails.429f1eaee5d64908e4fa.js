(self.webpackChunkcompliance=self.webpackChunkcompliance||[]).push([[72,402],{75803:(e,t,n)=>{"use strict";n.r(t),n.d(t,{QUERY:()=>C,ReportDetails:()=>x,default:()=>R});var r=n(42982),o=n(30168),i=n(92950),s=n.n(i),a=n(45697),c=n.n(a),l=n(62012),u=n(90570),p=n(67521),m=n(65115),d=n(89376),f=n(39173),y=n(58247),h=n(97481),v=n(44468),g=n(7648),b=n(60986),O=n(31499),E=n(55573),j=function(e){var t,n=e.row,r=e.children;return s().createElement(E.e,{style:0===(null===(t=n.testResultProfiles)||void 0===t?void 0:t.length)?{background:"#F0F0F0",borderLeft:"var(--pf-c-table--border-width--base) solid var(--pf-c-table--BorderColor)",borderRight:"var(--pf-c-table--border-width--base) solid var(--pf-c-table--BorderColor)"}:{}},r)};j.propTypes={row:c().node,children:c().node};const S=j;var P,w=n(93471),C=(0,p.ZP)(P||(P=(0,o.Z)(["\n  query RDWNRS_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      totalHostCount\n      testResultHostCount\n      compliantHostCount\n      unsupportedHostCount\n      complianceThreshold\n      osMajorVersion\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        profiles {\n          benchmark {\n            version\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n    }\n  }\n"]))),x=function(e){var t,n,o=e.route,i=(0,l.useParams)().report_id,a=(0,u.a)(C,{variables:{policyId:i},fetchPolicy:"no-cache"}),c=a.data,p=a.error,E=a.loading,j={},P=[];return!E&&c&&(t=(j=c.profile).policy.name,n="Report: ".concat(t),P=(0,r.Z)(new Set(j.policy.profiles.flatMap((function(e){return e.benchmark.version}))))),(0,g.a)(o,t),s().createElement(v.tC,{stateValues:{error:p,data:c,loading:E}},s().createElement(v.K7,{stateKey:"loading"},s().createElement(d.Z,null,s().createElement(v.Tq,null)),s().createElement("section",{className:"pf-c-page__main-section"},s().createElement(y.Z,null,s().createElement(h.Z,null)))),s().createElement(v.K7,{stateKey:"data"},s().createElement(d.Z,null,s().createElement(m.Breadcrumb,{ouiaId:"ReportDetailsPathBreadcrumb"},s().createElement(v.MU,{to:"/"},"Compliance"),s().createElement(v.MU,{to:"/reports"},"Reports"),s().createElement(m.BreadcrumbItem,{isActive:!0},n)),s().createElement(m.Grid,{hasGutter:!0},s().createElement(m.GridItem,{sm:9,md:9,lg:9,xl:9},s().createElement(f.Z,{title:n}),s().createElement(v.Zr,null,j.policyType)),s().createElement(m.GridItem,{className:"report-details-button",sm:3,md:3,lg:3,xl:3},s().createElement(v.nv,{state:{profile:j},to:"/reports/".concat(j.id,"/pdf"),className:"pf-u-mr-md",Component:v.Qj,componentProps:{variant:"primary",ouiaId:"ReportDetailsDownloadReportPDFLink"}},"Download PDF"),s().createElement(v.nv,{state:{profile:j},to:"/reports/".concat(j.id,"/delete"),Component:v.Qj,componentProps:{isInline:!0,variant:"link",ouiaId:"ReportDetailsDeleteReportLink"}},"Delete report"))),s().createElement(m.Grid,{hasGutter:!0},s().createElement(m.GridItem,{sm:12,md:12,lg:12,xl:6},s().createElement(w.Z,{profile:j,hasLegend:!0,chartClass:"report-details-chart-container"})),s().createElement(m.GridItem,{sm:12,md:12,lg:12,xl:6},s().createElement(v.vu,{profile:j})))),s().createElement("section",{className:"pf-c-page__main-section"},s().createElement(m.Grid,{hasGutter:!0},s().createElement(m.GridItem,{span:12},s().createElement(b.r0,{showOsMinorVersionFilter:[j.osMajorVersion],ssgVersions:P,columns:[O.Zw({showLink:!0,showOsInfo:!0}),O.MO("groups",{requiresDefault:!0}),O.MO("tags"),O.hN,O.ll,O.OF,O.Hc],compliantFilter:!0,defaultFilter:"policy_id = ".concat(j.id),policyId:j.id,tableProps:{rowWrapper:S},ruleSeverityFilter:!0,showGroupsFilter:!0}))))))};x.propTypes={route:c().object};const R=x},85217:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ReportDownload:()=>He,default:()=>Me});var r,o,i,s=n(92950),a=n.n(s),c=n(65115),l=n(62012),u=n(90570),p=n(58141),m=n(44468),d=n(98773),f=n(30168),y=n(67521),h={compliantSystems:!1,nonCompliantSystems:!0,unsupportedSystems:!0,nonReportingSystems:!0,topTenFailedRules:!0,userNotes:void 0},v=(0,y.ZP)(r||(r=(0,f.Z)(["\n  query PDF_Systems(\n    $filter: String!\n    $policyId: ID\n    $perPage: Int\n    $page: Int\n    $sortBy: [String!]\n    $tags: [String!]\n  ) {\n    systems(\n      search: $filter\n      limit: $perPage\n      offset: $page\n      sortBy: $sortBy\n      tags: $tags\n    ) {\n      totalCount\n      edges {\n        node {\n          id\n          name\n          osMajorVersion\n          osMinorVersion\n          insightsId\n          testResultProfiles(policyId: $policyId) {\n            lastScanned\n            compliant\n            score\n            supported\n            benchmark {\n              version\n            }\n            rulesFailed\n          }\n        }\n      }\n    }\n  }\n"]))),g=(0,y.ZP)(o||(o=(0,f.Z)(["\n  query PDF_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      testResultHostCount\n      compliantHostCount\n      unsupportedHostCount\n      complianceThreshold\n      osMajorVersion\n      lastScanned\n      policyType\n      totalHostCount\n      policy {\n        id\n        name\n      }\n      benchmark {\n        id\n      }\n      businessObjective {\n        id\n        title\n      }\n    }\n  }\n"]))),b=(0,y.ZP)(i||(i=(0,f.Z)(["\n  query PDF_Profiles($filter: String!, $policyId: ID!) {\n    profiles(search: $filter) {\n      totalCount\n      edges {\n        node {\n          topFailedRules(policyId: $policyId) {\n            refId\n            title\n            remediationAvailable\n            severity\n            identifier\n            failedCount\n          }\n        }\n      }\n    }\n  }\n"]))),O=n(45697),E=n.n(O),j=function(e){var t=e.policy,n=e.setExportSetting,r=e.exportSettings;return a().createElement(c.Form,null,a().createElement(c.FormGroup,{isInline:!0,fieldId:"simple-form-checkbox-group",label:"Policy"},a().createElement(c.Text,null,t.name)),a().createElement(c.FormGroup,{fieldId:"simple-form-checkbox-group",label:"System data to include"},a().createElement(c.Checkbox,{label:"Non-compliant systems",id:"non-compliant-systems-export-setting","aria-label":"Non-compliant systems",onChange:n("nonCompliantSystems"),isChecked:r.nonCompliantSystems}),a().createElement(c.Checkbox,{label:"Systems with unsupported configuration",id:"unsupported-systems-export-setting","aria-label":"Systems with unsupported configuration",onChange:n("unsupportedSystems"),isChecked:r.unsupportedSystems}),a().createElement(c.Checkbox,{label:"Systems with no reports",id:"nonreporting-systems-export-setting","aria-label":"Systems never reported",onChange:n("nonReportingSystems"),isChecked:r.nonReportingSystems}),a().createElement(c.Checkbox,{id:"compliant-systems-export-setting",onChange:n("compliantSystems"),isChecked:r.compliantSystems,label:"Compliant systems","aria-label":"Compliant systems"})),a().createElement(c.FormGroup,{label:"Rule data to include",fieldId:"checkbox01"},a().createElement(c.Checkbox,{id:"failed-rules-export-setting",label:"Top failed rules (Up to 10)","aria-label":"Rule data to include",onChange:n("topTenFailedRules"),isChecked:r.topTenFailedRules})),a().createElement(c.FormGroup,{label:"User notes (optional)",fieldId:"checkbox01"},a().createElement(c.TextArea,{"aria-label":"User notes (optional)",onChange:n("userNotes"),value:r.userNotes})))};j.propTypes={policy:E().object,exportSettings:E().object,setExportSetting:E().func};const S=j;var P=n(15861),w=n(64687),C=n.n(w),x=n(65811),R=n(42982),k=n(26075),D=n(4942);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){return(null==e?void 0:e.filter((function(e){return"Never"!=e.lastScanned})))||[]},T=function(e){var t=e.testResultProfiles;return F(t).length>0},N=function(e){return T(e)&&F(e.testResultProfiles).every((function(e){return e.supported}))},B=function(e){return e.filter((function(e){return N(e)&&function(e){var t=F(e.testResultProfiles).length>0,n=F(e.testResultProfiles).every((function(e){return e.compliant}));return t&&n}(e)}))},H=function(e){return e.filter((function(e){return N(e)&&function(e){var t=F(e.testResultProfiles).length>0,n=F(e.testResultProfiles).filter((function(e){return!e.compliant})).length>0;return t&&n}(e)}))},M=function(e){return e.filter((function(e){return function(e){return T(e)&&F(e.testResultProfiles).every((function(e){return!e.supported}))}(e)}))},G=function(e,t,n){var r=B(t),o=H(t),i=M(t),s=function(e){var t=[].concat((0,R.Z)(B(e)),(0,R.Z)(H(e)),(0,R.Z)(M(e))).map((function(e){return e.id}));return e.filter((function(e){return!t.includes(e.id)}))}(t);return I(I(I(I(I(I({totalHostCount:t.length,compliantSystemCount:r.length},e.compliantSystems&&{compliantSystems:r}),{},{nonCompliantSystemCount:o.length},e.nonCompliantSystems&&{nonCompliantSystems:o}),{},{unsupportedSystemCount:i.length},e.unsupportedSystems&&{unsupportedSystems:i}),e.topTenFailedRules&&{topTenFailedRules:n}),{},{nonReportingSystemCount:s.length},e.nonReportingSystems&&{nonReportingSystems:s}),e.userNotes&&{userNotes:e.userNotes})},V=n(95417);const $=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{onComplete:function(){},onError:function(){}},r=n.onComplete,o=n.onError,i=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.id,i=r.totalHostCount,s=(0,k.x)(),a=(t=(e=(0,V.Z)()).isResolving,n=e.resolve,{isLoading:t,fetchBatched:function(e,t,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,i=Math.ceil(t/o)||1;return n((0,R.Z)(new Array(i)).map((function(t,n){return function(){return e(o,n+1,r)}})))}}),c=a.fetchBatched,l=function(e,t){return s.query({query:v,fetchResults:!0,fetchPolicy:"no-cache",variables:{perPage:e,page:t,filter:"policy_id = ".concat(o),policyId:o}})};return(0,P.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(l,i);case 2:return e.abrupt("return",e.sent.flatMap((function(e){return e.data.systems.edges.map((function(e){return e.node}))})));case 3:case"end":return e.stop()}}),e)})))}(t),s=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).id,t=(0,k.x)(),n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.query({query:b,fetchResults:!0,fetchPolicy:"no-cache",variables:{perPage:n,page:r,filter:"policy_id = ".concat(e),policyId:e}})};return(0,P.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n();case 2:if(e.t1=t=e.sent.data.profiles,e.t0=null===e.t1,e.t0){e.next=6;break}e.t0=void 0===t;case 6:if(!e.t0){e.next=10;break}e.t2=void 0,e.next=11;break;case 10:e.t2=t.edges.flatMap((function(e){return e.node.topFailedRules}));case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e)})))}(t);return(0,P.Z)(C().mark((function t(){var n,a,c;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i();case 3:return n=t.sent,t.next=6,s();case 6:return a=t.sent,c=G(e,n,a),null==r||r(c),t.abrupt("return",c);case 12:if(t.prev=12,t.t0=t.catch(0),!o){t.next=19;break}return null==o||o(t.t0),t.abrupt("return",[]);case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,null,[[0,12]])})))};var A=n(50439),_=n(62410),q=n(11443);const U=A.mM.create({bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},metaTitle:{color:"#C9190B",marginBottom:"20px"},userNotes:{backgroundColor:"#F0F0F0",padding:"8px"},userNotesTitle:{marginBottom:"4px"},sectionTitle:{color:"#C9190B",fontWeight:"bold",fontSize:14},subSectionTitle:{color:"#C9190B",fontWeight:"bold",fontSize:10,marginBottom:"10pt"}});var L=function(e){var t=e.systems.map((function(e){return[e.name,"RHEL ".concat(e.osMajorVersion,".").concat(e.osMinorVersion),"".concat(e.testResultProfiles[0].rulesFailed||""),(0,q.P0)(e.testResultProfiles[0].score)]}));return a().createElement(p.iA,{withHeader:!0,rows:[["System name","OS","Failed rules","Compliance score"]].concat((0,R.Z)(t))})};L.propTypes={systems:E().array};const K=L;var W=function(e){var t=e.systems,n=e.ssgFinder,r=t.map((function(e){var t;return[e.name,"RHEL ".concat(e.osMajorVersion,".").concat(e.osMinorVersion),null===(t=e.testResultProfiles[0])||void 0===t?void 0:t.benchmark.version,n(e.osMajorVersion,e.osMinorVersion)]}));return a().createElement(p.iA,{withHeader:!0,rows:[["System name","OS","Running SSG version","Expected SSG version"]].concat((0,R.Z)(r))})};W.propTypes={systems:E().array,ssgFinder:E().func};const z=W;var Q=function(e){var t=e.systems.map((function(e){return[e.name,"RHEL ".concat(e.osMajorVersion,".").concat(e.osMinorVersion)]}));return a().createElement(p.iA,{withHeader:!0,rows:[["System name","OS"]].concat((0,R.Z)(t))})};Q.propTypes={systems:E().array,ssgFinder:E().func};const J=Q;var Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.charAt(0).toUpperCase()+e.slice(1)},X=function(e){var t=e.rules.slice(0,10).map((function(e){return[e.title,(t=e,(t.identifier||"{}").label||""),Y(null==e?void 0:e.severity),"".concat(e.failedCount)];var t}));return a().createElement(p.iA,{withHeader:!0,rows:[["Rule name","ID","Severity","Failed systems"]].concat((0,R.Z)(t))})};X.propTypes={rules:E().array};const ee=X;var te=function(e){var t=e.children,n=e.title;return a().createElement(A.G7,{style:{justifyContent:"space-evenly",width:"24%",paddingRight:"1%"}},a().createElement(A.G7,null,a().createElement(A.xv,{style:{color:"#C9190B",fontSize:20}},t)),a().createElement(A.xv,null,n))};te.propTypes={children:E().node,title:E().string};const ne=te;function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie=function(e){var t=e.children,n=e.metaTitle,r=e.title;return a().createElement(A.G7,{style:{marginBottom:"20pt"}},a().createElement(A.G7,{style:{justifyContent:"start"}},a().createElement(A.xv,{style:oe(oe({},U.subSectionTitle),{},{width:"70%"})},r),a().createElement(A.xv,null,n)),t)};ie.propTypes={children:E().node,metaTitle:E().string,title:E().string};const se=ie;var ae=n(72971),ce=function(e){var t=e.policy.percentCompliant,n=void 0===t?0:t,r=e.compliantSystemCount,o=e.nonCompliantSystemCount,i=e.unsupportedSystemCount,s=e.nonReportingSystemCount,c=[{x:"".concat(r," systems compliant"),y:r},{x:"".concat(o," systems non-compliant"),y:o}].concat((0,R.Z)(i>0?[{x:"".concat(i," systems not supported"),y:i,color:ae.um.gold300}]:[]),(0,R.Z)(s>0?[{x:"".concat(s," systems never reported"),y:s}]:[])),l=(0,q.P0)(n);return a().createElement(p.kL,{legendHeader:"",chartType:"donut",subTitle:"Compliant",colorSchema:"multi",title:l,data:c})};ce.propTypes={policy:E().object,compliantSystemCount:E().number,nonCompliantSystemCount:E().number,unsupportedSystemCount:E().number,nonReportingSystemCount:E().number};const le=ce;function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=function(e){var t,n=e.data,r=e.ssgFinder,o=n.totalHostCount,i=n.compliantSystems,c=n.compliantSystemCount,l=n.nonCompliantSystems,u=n.nonCompliantSystemCount,m=n.topTenFailedRules,d=n.unsupportedSystems,f=n.unsupportedSystemCount,y=n.nonReportingSystems,h=n.nonReportingSystemCount,v=n.userNotes,g=n.policy,b=g.testResultHostCount,O=void 0===b?0:b,E=g.compliantHostCount,j=void 0===E?0:E,S=0!=O?(0,q.P0)(Math.floor(j/o*100)):0;return a().createElement(s.Fragment,null,a().createElement(A.xv,{style:U.subSectionTitle},"Report prepared ".concat((0,_.Z)({date:new Date,type:"exact"}).props.children)),v&&a().createElement(A.G7,{style:U.userNotes},a().createElement(A.G7,{style:U.userNotesTitle},a().createElement(A.xv,null,"User notes")),a().createElement(A.G7,null,a().createElement(A.xv,null,v))),a().createElement(p.$0,{title:"Policy Details",titleProps:{style:U.sectionTitle}},a().createElement(p.sg,{style:{width:"150px"}},a().createElement(p.iA,{rows:[["Policy type",g.policyType],["Operating system","RHEL ".concat(g.osMajorVersion)],["Compliance threshold","".concat(g.complianceThreshold,"%")],["Business Objective",(null===(t=g.businessObjective)||void 0===t?void 0:t.title)||"--"]]})),a().createElement(p.sg,null,a().createElement(le,{policy:pe(pe({},g),{},{percentCompliant:S}),compliantSystemCount:c,nonCompliantSystemCount:u,unsupportedSystemCount:f,nonReportingSystemCount:h}))),a().createElement(p.$0,{title:"Systems",withColumn:!1,titleProps:{style:U.sectionTitle}},a().createElement(p.s_,{withColumn:!1,style:{marginBottom:"20px"}},a().createElement(ne,{title:"Non-compliant systems"},u),f?a().createElement(ne,{title:"Systems with unsupported configuration"},f):null,h?a().createElement(ne,{title:"Systems never reported"},h):null,a().createElement(ne,{title:"Compliant systems"},c)),l&&u?a().createElement(se,{title:"Non-compliant systems"},a().createElement(K,{systems:l})):null,d&&f?a().createElement(se,{title:"Systems with unsupported configuration"},a().createElement(z,{systems:d,ssgFinder:r})):null,y&&h?a().createElement(se,{title:"Systems never reported"},a().createElement(J,{systems:y})):null,i&&c?a().createElement(se,{title:"Compliant systems"},a().createElement(K,{systems:i})):null),m?a().createElement(p.$0,{title:"Rules",withColumn:!1,titleProps:{style:U.sectionTitle}},a().createElement(se,{title:"Top failed rules"},a().createElement(ee,{rules:m}))):null)};me.propTypes={data:E().object,ssgFinder:E().func};const de=me;function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=n(70885),ve=n(41800),ge=n.n(ve),be=n(15671),Oe=n(43144);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,be.Z)(this,e),(0,D.Z)(this,"DEFAULT_API_HEADERS",{"Content-Type":"application/vnd.api+json",Accept:"application/json"}),this.apiBase=t.apiBase||"/api",this.path=t.path||"",this.authenticate=t.authenticate||function(){return Promise.resolve({})},this.onUnauthorised=t.onUnauthorised||function(){return Promise.resolve({})},this.defaultHeaders=t.headers||this.DEFAULT_API_HEADERS}var t;return(0,Oe.Z)(e,[{key:"request",value:(t=(0,P.Z)(C().mark((function e(t,n,r){var o,i=this,s=arguments;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>3&&void 0!==s[3]?s[3]:{},e.next=3,this.callAuthenticate().then((function(){return i.fetch(t,n,r,o)})).then(this.checkForEmptyResponse).then((function(e){return i.checkForErrors(e,o)})).then((function(e){return e.json()})).catch(this.finalCatch);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"finalCatch",value:function(e){return void 0===e.errors?Promise.reject({title:"Error parsing"}):Promise.reject(je({},e))}},{key:"fetch",value:function(e){function t(t,n,r,o){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,r){var o={method:n||"get",headers:this.defaultHeaders,credentials:"include"},i="".concat(this.apiBase).concat(this.path?this.path:"").concat(e||""),s=new URL(i,window.location.origin);if(r.params){var a=Object.keys(r.params).map((function(e){return encodeURIComponent(e)+"="+encodeURIComponent(r.params[e])})).join("&");s.search=new URLSearchParams(a)}return t&&(o.body=JSON.stringify(t)),fetch(s,o)}))},{key:"checkForEmptyResponse",value:function(e){return 204===e.status?{json:function(){return{}}}:e}},{key:"checkForErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(404===e.status&&t.ignore404)return{json:function(){return{}}};if(401===e.status)return this.onUnauthorised();var n=e.clone?e.clone().json():e;return 422===e.status?n.then((function(e){return Promise.reject(je(je({},e),{},{title:"Validation error"}))})):e.status>=400&&e.status<=600?n.then((function(e){return Promise.reject(e.errors[0])})):e}},{key:"callAuthenticate",value:function(){return Promise.resolve(this.authenticate()||!0)}},{key:"create",value:function(e,t){return this.request(e,t,"post")}},{key:"update",value:function(e,t){return this.request(e,t,"put")}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request(e,null,"get",t)}},{key:"destroy",value:function(e){return this.request(e,null,"delete")}}]),e}();function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var xe=function(e){return e&&function(e,t){var n=e[t],r=e;return delete r[t],Ce(Ce({},r),n)}(e,"attributes")},Re=function(e,t){var n,r=ge()(e);return null===(n=Object.values(r[t]||{}))||void 0===n?void 0:n.map((function(e){return function(e,t){var n={};return Object.entries((null==e?void 0:e.relationships)||[]).forEach((function(e){var r=(0,he.Z)(e,2),o=r[0],i=r[1];n[o]=null==i?void 0:i.data.map((function(e){var n;return xe(null==t||null===(n=t[e.type])||void 0===n?void 0:n[e.id])})).filter((function(e){return!!e}))})),delete e.relationships,Ce(Ce({},e),n)}(xe(e),r)}))},ke=function(){var e=(0,P.Z)(C().mark((function e(t,n){var r,o,i,s,a=arguments;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>2&&void 0!==a[2]?a[2]:{},o=a.length>3&&void 0!==a[3]?a[3]:{},e.next=4,t.get("/".concat(n),{params:r});case 4:return i=e.sent,e.next=7,Re(i,(null==o?void 0:o.type)||n);case 7:return s=e.sent,e.abrupt("return",{collection:s,meta:i.meta,total:i.meta.total,json:i});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();const De=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=(0,s.useState)({data:void 0,loading:!1,error:void 0}),o=(0,he.Z)(r,2),i=o[0],a=o[1],c=function(e){var t=new Se(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e));return t}({apiBase:ae.dT}),l=Ce(Ce({},(null==t?void 0:t.params)||{}),{},{include:(null==t?void 0:t.include)||[]});return(0,s.useEffect)((function(){null!=t&&t.skip||(a({data:void 0,loading:!0,error:void 0}),ke(c,e,l,t).then((function(e){a({data:e,loading:!1,error:void 0})})))}),[].concat((0,R.Z)(n),[null==t?void 0:t.skip])),i};var Ze=function(e,t){return parseInt(e)===parseInt(t)};const Ie=function(e,t){var n,r,o=(r=De("supported_ssgs",{type:"supportedSsg",skip:n}).data,function(e,t){var n,o=null===(n=(r||{}).collection)||void 0===n?void 0:n.find((function(n){return Ze(n.osMajorVersion,e)&&Ze(n.osMinorVersion,t)}));return(null==o?void 0:o.version)||"N/A"}),i=$(e,t,{onError:function(){(0,x.q)({variant:"danger",title:"Couldn’t download export",description:"Reinitiate this export to try again."})},onComplete:function(){(0,x.q)({variant:"success",title:"Downloading export"})}}),s=function(e){return function(){var t=(0,P.Z)(C().mark((function t(n,r){return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[a().createElement(de,{key:"pdf-page-1",data:ye(ye({},n),{},{policy:e}),ssgFinder:r})]);case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}(t),c=function(){var e=(0,P.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,x.q)({variant:"info",title:"Preparing export",description:"Once complete, your download will start automatically."}),e.next=3,i();case 3:return t=e.sent,e.next=6,s(t,o);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return c};var Fe=n(35937),Te=n.n(Fe);function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(Object(n),!0).forEach((function(t){(0,D.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(){var e=(0,l.useParams)().report_id,t=(0,d.Z)(),n=(0,u.a)(g,{variables:{policyId:e}}),r=n.data,o=n.loading,i=n.error,f=null==r?void 0:r.profile,y=function(){var e=(0,s.useState)(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Te()(h,(function(t,n){return!("nonReportingSystems"===n&&!e)}))}()),t=(0,he.Z)(e,2),n=t[0],r=t[1];return{exportSettings:n,setExportSetting:function(e){return function(t){return r(Be(Be({},n),{},(0,D.Z)({},e,t)))}},isValid:Object.keys(n).some((function(e){return 1==("userNotes"!==e&&!!n[e])}))}}(),v=y.exportSettings,b=y.setExportSetting,O=y.isValid,E=Ie(v,f),j="compliance-report--".concat((new Date).toISOString().split("T")[0]),P="Export report",w={ouiaId:"ExportReportButton",variant:"primary",isDisabled:!O},C=function(){return a().createElement(c.Button,w,P)},x=[a().createElement(p.o6,{groupName:"Red Hat Insights",key:"export",label:P,reportName:"Compliance:",type:f&&f.name,fileName:j,asyncFunction:E,buttonProps:w,fallback:a().createElement(C,null),className:"pf-u-mr-sm",onSuccess:function(){return t(-1)}}),a().createElement(c.Button,{variant:"secondary",key:"cancel",ouiaId:"ExportReportCancelButton",onClick:function(){t(-1)}},"Cancel")];return a().createElement(m.C,{isOpen:!0,width:"440px",ouiaId:"DownloadReportModal",title:"Compliance report",onClose:function(){return t(-1)},actions:x},a().createElement(m.tC,{stateValues:{error:i,data:r,loading:o}},a().createElement(m.K7,{stateKey:"loading"},a().createElement(c.Spinner,null)),a().createElement(m.K7,{stateKey:"data"},a().createElement(S,{policy:f,setExportSetting:b,exportSettings:v}))))};const Me=He},19527:()=>{},69331:()=>{},52361:()=>{},94616:()=>{}}]);
//# sourceMappingURL=../sourcemaps/ReportDetails.652c643136a9472837c3671dd4248b17.js.map