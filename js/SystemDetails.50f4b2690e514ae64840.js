(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[539],{44954:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SystemDetails:()=>pe,default:()=>de});var r=n(32465),l=n(92950),a=n.n(l),o=n(45697),s=n.n(o),i=n(33121),c=n(46829),m=n(334),u=n(48716),p=n(56455),d=n(86350),y=n(80708),f=n(81253),h=n(96156),E=n(85061),g=n(6610),v=n(5991),P=n(10379),b=n(46070),Z=n(77608),S=n(22122),T=n(63349),C=n(68778),I=n(43047),x=n(62410),w=n(67585),O=n(91290),R=n(99373),B=function(e){var t=e.ssgVersion,n=e.style,r=a().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:R.iK},"Supported SSG versions");return a().createElement(y.Alert,{variant:"warning",isInline:!0,style:n,title:a().createElement(a().Fragment,null,"Unsupported SSG version (",t,")",a().createElement(y.Popover,{position:"right",bodyContent:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:r},a().createElement(O.ZP,{style:{marginLeft:".5em",cursor:"pointer",color:"var(--pf-global--Color--200)"}})))})};B.propTypes={ssgVersion:s().string,style:s().object};const j=B;var k=function(e){(0,P.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,Z.Z)(t);if(n){var l=(0,Z.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,b.Z)(this,e)});function l(){var e;(0,g.Z)(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=r.call.apply(r,[this].concat(n)),(0,h.Z)((0,T.Z)(e),"complianceIcon",(function(e){return e?a().createElement("div",{className:"ins-c-policy-card ins-m-compliant"},a().createElement(C.ZP,null)," Compliant"):a().createElement("div",{className:"ins-c-policy-card ins-m-noncompliant"},a().createElement(I.ZP,null)," Not compliant")})),(0,h.Z)((0,T.Z)(e),"fixedPercentage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.toFixed(t)+(n?"%":"")})),e}return(0,v.Z)(l,[{key:"render",value:function(){var e=this.props,t=e.policy,n=e.style,r=t.rulesFailed,l=t.compliant,o=t.lastScanned,s=t.score,i=t.ssgVersion,c=t.supported,m=t.name,u=t.policyType,p=this.fixedPercentage(s),d={expandOnMouseOver:!0,hideExpandText:!0};return a().createElement(y.Card,{style:n},a().createElement(y.CardBody,null,a().createElement(y.TextContent,{className:"margin-bottom-md"},a().createElement(y.Text,{className:"margin-bottom-top-none",component:y.TextVariants.h4},a().createElement(w.Z,(0,S.Z)({text:m,length:110},d))),a().createElement(y.Text,{style:{color:"var(--pf-global--Color--200)"},component:y.TextVariants.small},a().createElement(w.Z,(0,S.Z)({text:u,length:110},d)))),a().createElement("div",{className:"margin-bottom-md"},c&&this.complianceIcon(l),a().createElement(y.Text,{component:y.TextVariants.small},r," rule",1===r?"":"s"," failed"," ",a().createElement(y.Tooltip,{position:"bottom",maxWidth:"22em",content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},a().createElement("span",null,"(Score: ",p,")")))),a().createElement(y.Text,{className:"margin-bottom-none",component:y.TextVariants.small},a().createElement(y.Text,null,"SSG version: ",i),a().createElement(y.Text,null,"Last scanned:"," ","Never"!==o?a().createElement(x.Z,{date:Date.parse(o),type:"relative"}):o))),!c&&a().createElement(y.CardFooter,{style:{padding:"0"}},a().createElement(j,{ssgVersion:i,style:{paddingTop:"var(--pf-c-alert--PaddingTop)",paddingRight:"var(--pf-c-card--child--PaddingRight)",paddingLeft:"var(--pf-c-card--child--PaddingLeft)",paddingBottom:"var(--pf-c-alert--PaddingBottom)"}})))}}]),l}(a().Component);k.propTypes={policy:s().shape({rulesPassed:s().number,rulesFailed:s().number,score:s().number,lastScanned:s().string,refId:s().string,name:s().string,policyType:s().string,compliant:s().bool,ssgVersion:s().string,supported:s().bool}),style:s().object};const F=k;var V=n(24561);var N=function(e){(0,P.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,Z.Z)(t);if(n){var l=(0,Z.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,b.Z)(this,e)});function l(){return(0,g.Z)(this,l),r.apply(this,arguments)}return(0,v.Z)(l,[{key:"systemPolicyCards",value:function(){return this.props.policies.filter((function(e){return e.rulesFailed+e.rulesPassed>0})).map((function(e,t){return a().createElement(y.GridItem,{sm:12,md:12,lg:6,xl:4,key:t},a().createElement(F,{policy:e,style:{height:"100%"}}))}))}},{key:"render",value:function(){var e=this.props.loading;return a().createElement(a().Fragment,null,a().createElement(y.Grid,{hasGutter:!0},this.systemPolicyCards(),e&&(0,E.Z)(Array(3)).map((function(e,t){return a().createElement(y.GridItem,{span:4,key:t},a().createElement(y.Card,null,a().createElement(y.CardBody,null,a().createElement(V.mr,null))))}))))}}]),l}(a().Component);N.propTypes={policies:s().array,loading:s().bool},N.defaultProps={policies:[]};const A=N;var G=n(91989),D=n(19949),L=n(11100),z=n(86624),K=n(12340),_=n(28873),$=n(54288),q=n(83069),M=n(7162),U=function(e){var t,n,r,l=e.system;return null==l||!l.hasPolicy||null!=l&&null!==(t=l.testResultProfiles)&&void 0!==t&&t.length?a().createElement(a().Fragment,null):a().createElement(y.Bullseye,null,a().createElement(y.EmptyState,null,a().createElement(y.EmptyStateIcon,{icon:M.ZP,title:"Compliance",size:"xl",style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"}}),a().createElement(y.Title,{headingLevel:"h1",size:"lg"},"No results reported"),a().createElement(y.EmptyStateBody,null,"This system is part of ",null==l||null===(n=l.policies)||void 0===n?void 0:n.length,(null==l||null===(r=l.policies)||void 0===r?void 0:r.length)>1?" policies":" policy",", but has not returned any results."),a().createElement(y.EmptyStateBody,null,"Reports are returned when the system checks into Insights. By default, systems check in every 24 hours.")))};U.propTypes={system:s().shape({hasPolicy:s().bool,testResultProfiles:s().array,policies:s().array})};const Q=U;var W=n(99577),H=n(7081),J=function(e){var t=e.system;return null!=t&&t.hasPolicy?a().createElement(a().Fragment,null):a().createElement(y.Bullseye,null,a().createElement(y.EmptyState,null,a().createElement(y.EmptyStateIcon,{icon:H.ZP}),a().createElement(y.Title,{headingLevel:"h1",size:"lg"},"This system is not part of any SCAP policies defined within Compliance."),a().createElement(y.EmptyStateBody,null,"To assess and monitor compliance against a SCAP policy for this system, add it to an existing policy or create a new policy."),a().createElement(y.EmptyStatePrimary,null,a().createElement(W.mR,{to:"/scappolicies/new"},a().createElement(y.Button,{variant:"primary",ouiaId:"CreateNewPolicyButton"},"Create new policy"))),a().createElement(y.EmptyStateSecondaryActions,null,a().createElement(y.Button,{variant:"link",component:"a",href:"/insights/compliance/scappolicies"},"View compliance policies"))))};J.propTypes={system:s().shape({hasPolicy:s().bool})};const X=J;var Y,ee=["customItnl","intlProps"];function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,h.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=(0,i.ZP)(Y||(Y=(0,r.Z)(["\n  query System($systemId: String!) {\n    system(id: $systemId) {\n      id\n      name\n      hasPolicy\n      policies {\n        id\n      }\n      testResultProfiles {\n        id\n        name\n        policyType\n        refId\n        compliant\n        rulesFailed\n        rulesPassed\n        lastScanned\n        score\n        supported\n        ssgVersion\n        majorOsVersion\n        policy {\n          id\n        }\n        rules {\n          title\n          severity\n          rationale\n          refId\n          description\n          compliant\n          remediationAvailable\n          references\n          identifier\n        }\n      }\n    }\n  }\n"]))),le=function(e){var t,n=e.data.system,r=e.loading,l=e.hidePassed;return a().createElement(a().Fragment,null,a().createElement(A,{policies:null==n?void 0:n.testResultProfiles,loading:r}),a().createElement(X,{system:n}),a().createElement(Q,{system:n}),a().createElement("br",null),null!=n&&null!==(t=n.testResultProfiles)&&void 0!==t&&t.length?a().createElement(G.Z,{remediationAvailableFilter:!0,handleSelect:function(){},hidePassed:l,system:ne(ne({},n),{},{supported:((null==n?void 0:n.testResultProfiles)||[]).filter((function(e){return e.supported})).length>0}),profileRules:null==n?void 0:n.testResultProfiles.map((function(e){return{system:n,profile:e,rules:e.rules}})),loading:r,options:{sortBy:{index:4,direction:"asc",property:"severity"}}}):void 0)};le.propTypes={data:s().shape({system:s().shape({hasPolicy:s().bool,policies:s().shape({id:s().string}),profiles:s().array,testResultProfiles:s().array})}),loading:s().bool,hidePassed:s().bool},le.defaultProps={loading:!0};var ae=function(e){var t,n=e.inventoryId,r=e.hidePassed,l=e.client,o=(0,c.useQuery)(re,{variables:{systemId:n},client:l,fetchPolicy:"no-cache"}),s=o.data,i=o.error,m=o.loading,u=404===(null==i||null===(t=i.networkError)||void 0===t?void 0:t.statusCode);if(m)return a().createElement(_.Z,null);if(i&&!u){var p="Oops! Error loading System data: ".concat(i);return a().createElement($.ErrorCard,{message:p})}return a().createElement("div",{className:"ins-c-compliance__scope"},null==s||!s.system||u?a().createElement(D.Z,{title:"No policies are reporting for this system"}):a().createElement(le,{hidePassed:r,data:s,loading:m}))};ae.propTypes={inventoryId:s().string,client:s().object,hidePassed:s().bool},ae.defaultProps={client:new L.fe({link:new z.u({uri:"/api/compliance/graphql",credentials:"include"}),cache:new K.h4})};var oe=function(e){var t=e.customItnl,n=e.intlProps,r=(0,f.Z)(e,ee),l=t?q.Z:a().Fragment;return a().createElement(l,t&&n,a().createElement(ae,r))};oe.propTypes={customItnl:s().bool,intlProps:s().any};const se=oe;var ie,ce=n(33179),me=n(7648),ue=(0,i.ZP)(ie||(ie=(0,r.Z)(["\n  query System($inventoryId: String!) {\n    system(id: $inventoryId) {\n      id\n      name\n    }\n  }\n"]))),pe=function(e){var t,n=e.route,r=(0,m.useParams)().inventoryId,l=(0,c.useQuery)(ue,{variables:{inventoryId:r}}),o=l.data,s=l.error,i=l.loading,f=null==o||null===(t=o.system)||void 0===t?void 0:t.name;return(0,me.a)(n,f),a().createElement(W.tC,{stateValues:{error:s,data:o,loading:i}},a().createElement(W.K7,{stateKey:"data"},a().createElement(u.Z,null,a().createElement(y.Breadcrumb,{ouiaId:"SystemDetailsPathBreadcrumb"},a().createElement(W.MU,{to:"/"},"Compliance"),a().createElement(W.MU,{to:"/systems"},"Systems"),a().createElement(y.BreadcrumbItem,{isActive:!0},f)),a().createElement(ce.Ey,null),a().createElement("br",null)),a().createElement(d.Z,null,a().createElement(se,{hidePassed:!0,inventoryId:r}))),a().createElement(W.K7,{stateKey:"loading"},a().createElement(u.Z,null,a().createElement(p.Z,{size:p.i.md}))))};pe.propTypes={route:s().object};const de=pe}}]);
//# sourceMappingURL=../sourcemaps/SystemDetails.4f36c0eba13c5d487805c3208cac2651.js.map