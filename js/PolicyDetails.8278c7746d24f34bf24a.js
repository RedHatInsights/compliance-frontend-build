"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[705,402],{48497:(e,t,n)=>{n.r(t),n.d(t,{PolicyDetails:()=>H,QUERY:()=>G,default:()=>x});var i=n(30168),r=n(92950),o=n.n(r),a=n(45697),l=n.n(a),s=n(67521),c=n(96620),u=n(90570),d=n(65115),p=n(89376),m=n(39173),f=n(97481),y=n(85836),v=n(7648),b=n(94263),h=n(52710),E=function(e){var t=e.policy,n=(0,h.Wb)();return o().createElement(d.ToolbarItem,null,o().createElement(y.mR,{to:"/scappolicies/".concat(t.id,"/edit"),hash:n,backgroundLocation:{hash:n},variant:"primary",ouiaId:"EditRulesButton",component:y.Qj},"Edit rules"))};E.propTypes={policy:l().object.isRequired};const g=E;var j=function(e){var t=e.loading,n=e.policy,i=n.policy.profiles.find((function(e){return e.refId===n.refId}));return o().createElement(o().Fragment,null,o().createElement(d.Alert,{isInline:!0,ouiaId:"RuleEditingAvailableAlert",variant:"info",title:"Rule editing is now available."},'SCAP policies created before April 19th, 2021 with rule editing will use the full default set of rules for the policy with the most accurate benchmark for systems within the policy. Click the "Edit rules" or "Edit policy" button to edit rules.'),o().createElement(d.PageSection,{variant:d.PageSectionVariants.light},o().createElement(d.Text,{component:d.TextVariants.p},o().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",null==i?void 0:i.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),o().createElement(y.iK,{remediationsEnabled:!1,columns:[b.VG,b.zb,b.uH],loading:t,profileRules:[{profile:{refId:n.refId,name:n.name},rules:(null==i?void 0:i.rules)||[]}],options:{dedicatedAction:function(){return o().createElement(g,{policy:n})}}}))};j.propTypes={loading:l().bool,policy:l().shape({name:l().string,refId:l().string,policy:l().shape({profiles:l().shape([{rules:l().array,benchmark:l().object}]).isRequired})})};const I=j;var P=n(6084),T=n(31499),O=function(e){var t=e.to,n=e.hash,i=e.backgroundLocation,r=e.variant,a=e.ouiaId;return o().createElement(d.ToolbarItem,null,o().createElement(y.mR,{to:t,hash:n,backgroundLocation:i,variant:r,ouiaId:a,component:y.Qj},"Edit systems"))};O.propTypes={to:l().string.required,state:l().object,hash:l().object,backgroundLocation:l().object,variant:l().string.required,ouiaId:l().string.required};const V=O;var R=function(e){var t,n=e.policy,i=(0,h.Wb)();return o().createElement(P.r0,{columns:[T.Zw({showLink:!0}),T.MO("tags"),T.OS,T.hN],showOsMinorVersionFilter:[n.osMajorVersion],policyId:n.id,defaultFilter:"policy_id = ".concat(n.id),showActions:!1,remediationsEnabled:!1,noSystemsTable:0===(null==n||null===(t=n.hosts)||void 0===t?void 0:t.length)&&o().createElement(y.JS,null),complianceThreshold:n.complianceThreshold,dedicatedAction:o().createElement(V,{to:"/scappolicies/".concat(n.id,"/edit"),hash:i,backgroundLocation:{hash:"details"},variant:"primary",ouiaId:"EditSystemsButton"})})};R.propTypes={policy:l().shape({id:l().string.isRequired,complianceThreshold:l().number.isRequired,osMajorVersion:l().string.isRequired,hosts:l().array.isRequired}),dedicatedAction:l().object,systemTableProps:l().object};const w=R;var S=n(99030),k=n(79886),M=function(e){var t=e.policy,n=e.saveToPolicy,i=e.onRuleValueReset,r=t.hosts,a=t.policy.profiles,l=a.filter((function(e){return!!e.osMinorVersion})),s=(0,S.UP)(r),c=l.sort((0,k.Sj)("osMinorVersion","desc")).map((function(e){var t;return{profile:e,systemCount:(null===(t=s[e.osMinorVersion])||void 0===t?void 0:t.count)||0}}));return o().createElement(o().Fragment,null,o().createElement(d.PageSection,{variant:d.PageSectionVariants.light},o().createElement(y.Hv,{tabsData:c,setRuleValues:n,onRuleValueReset:i,ruleValues:Object.fromEntries(a.map((function(e){return[e.id,e.values]}))),columns:[b.VG,b.zb,b.uH],level:1,options:{dedicatedAction:function(){return o().createElement(g,{policy:t})}},ouiaId:"RHELVersions"})))};M.propTypes={policy:l().object.isRequired,saveToPolicy:l().func,onRuleValueReset:l().func};const q=M;var A=n(4942),D=n(70885),C=n(67026),Z=n(65811);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,A.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _,G=(0,s.ZP)(_||(_=(0,i.Z)(["\n  query Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      external\n      description\n      totalHostCount\n      compliantHostCount\n      complianceThreshold\n      osMajorVersion\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        refId\n        profiles {\n          id\n          name\n          refId\n          osMinorVersion\n          osMajorVersion\n          values\n          benchmark {\n            id\n            title\n            latestSupportedOsMinorVersions\n            osMajorVersion\n            version\n            ruleTree\n            valueDefinitions {\n              defaultValue\n              description\n              id\n              refId\n              title\n              valueType\n            }\n          }\n          rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            references\n            identifier\n            precedence\n            values\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n      hosts {\n        id\n        osMinorVersion\n      }\n    }\n  }\n"]))),H=function(e){var t=e.route,n="details",i=(0,c.useParams)().policy_id,a=(0,c.useLocation)(),l=(0,u.a)(G,{variables:{policyId:i},fetchPolicy:"no-cache"}),s=l.data,b=l.error,h=l.loading,E=l.refetch,g=null==s?void 0:s.profile,j=!(null==g||!g.policy.profiles.find((function(e){return!!e.osMinorVersion}))),P=function(e,t){var n=(0,C.Z)(),i=(0,r.useCallback)((function(t){var n=e.policy.profiles.find((function(e){return e.id===t}));return Object.fromEntries(Object.entries((null==n?void 0:n.values)||{}).map((function(e){var t,i=(0,D.Z)(e,2),r=i[0],o=i[1];return[(null===(t=n.benchmark.valueDefinitions.find((function(e){return e.id===r})))||void 0===t?void 0:t.refId)||r,o]})))}),[e]);return(0,r.useCallback)((function(i,r,o){var a=e.policy.profiles.find((function(e){return e.id===i})),l=Object.fromEntries(Object.entries((null==a?void 0:a.values)||{}).map((function(e){var t,n=(0,D.Z)(e,2),i=n[0],r=n[1];return[(null===(t=a.benchmark.valueDefinitions.find((function(e){return e.id===i})))||void 0===t?void 0:t.refId)||i,r]})));return n(i,{values:L(L({},l),{},(0,A.Z)({},r.refId,o))}).then((function(){(0,Z.q)({variant:"success",title:"Rule value updated",autoDismiss:!0})})).catch((function(e){(0,Z.q)({variant:"danger",title:"Error updating rule value",description:e.message})})).finally((function(){return t()}))}),[i,e])}(g,(function(){E()}));return(0,r.useEffect)((function(){E()}),[a,E]),(0,v.a)(t,null==g?void 0:g.name),o().createElement(y.tC,{stateValues:{error:b,data:s,loading:h}},o().createElement(y.K7,{stateKey:"loading"},o().createElement(p.Z,null,o().createElement(y.PL,null)),o().createElement("section",{className:"pf-c-page__main-section"},o().createElement(f.Z,null))),o().createElement(y.K7,{stateKey:"data"},g&&o().createElement(r.Fragment,null,o().createElement(p.Z,{className:"page-header-tabs"},o().createElement(d.Breadcrumb,{ouiaId:"PolicyDetailsPathBreadcrumb"},o().createElement(y.MU,{to:"/"},"Compliance"),o().createElement(y.MU,{to:"/scappolicies"},"SCAP policies"),o().createElement(d.BreadcrumbItem,{isActive:!0},g.name)),o().createElement(d.Grid,{gutter:"lg"},o().createElement(d.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},o().createElement(m.Z,{title:g.name}))),o().createElement(y.tn,{"aria-label":"Policy Tabs",ouiaId:"PolicyDetailsTabs",defaultTab:n},o().createElement(d.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),o().createElement(d.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),o().createElement(d.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),o().createElement("section",{className:"pf-c-page__main-section"},o().createElement(y.Jm,{defaultTab:n},o().createElement(y.X8,{eventKey:"details"},o().createElement(y.NP,{policy:g})),o().createElement(y.X8,{eventKey:"rules"},j?o().createElement(q,{policy:g,saveToPolicy:P,onRuleValueReset:function(){return E()}}):o().createElement(I,{policy:g})),o().createElement(y.X8,{eventKey:"systems"},o().createElement(w,{policy:g})))))))};H.propTypes={route:l().object};const x=H}}]);
//# sourceMappingURL=../sourcemaps/PolicyDetails.6f7f04174b715c9e435b3c3af9fb90cf.js.map