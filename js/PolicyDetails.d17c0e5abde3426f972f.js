(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[705],{87601:(e,n,t)=>{(n=t(23645)(!1)).push([e.id,".threshold-tooltip{margin-bottom:var(--pf-global--spacer--md)}.grey-icon{color:var(--pf-global--Color--200)}.policy-description{padding-top:10px}\n",""]),e.exports=n},50207:(e,n,t)=>{"use strict";t.r(n),t.d(n,{MULTIVERSION_QUERY:()=>q,PolicyDetails:()=>H,QUERY:()=>F,default:()=>U});var r=t(91454),i=t(77865),l=t.n(i),a=t(61084),o=t(45697),s=t.n(o),c=t(44119),p=t.n(c),d=t(334),m=t(46829),u=t(36801),y=t(48716),f=t(39173),v=t(86350),E=t(6023),b=t(84307),h=t(50437),g=t(42564),T=t(52998),S=(t(90129),t(2707)),P=function(e){var n=e.loading,t=e.policy;return l().createElement(l().Fragment,null,l().createElement(u.Alert,{variant:"info",isInline:!0,title:"Rule editing coming soon"}),l().createElement(u.PageSection,{variant:u.PageSectionVariants.light},l().createElement(u.Text,{component:u.TextVariants.p},l().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",t.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),l().createElement(S.ZP,{remediationsEnabled:!1,columns:(0,S.eo)(["Name","Severity","Ansible"]),loading:n,profileRules:[{profile:{refId:t.refId,name:t.name},rules:t.rules}]}))};P.propTypes={loading:s().bool,policy:s().shape({name:s().string,refId:s().string,rules:s().array,benchmark:s().object})};const I=P;var O=t(94786),j=t(94949),w=t(67301),Z=t(93188),k=t(55186),V=t(21157);function x(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?x(Object(t),!0).forEach((function(n){(0,j.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var R=function(e){var n=e.policy,t=e.systemTableProps,r=(0,g.ZP)("newInventory"),i=(0,g.ZP)("showSsgVersions"),a=r?Z.e_:Z.r0;return l().createElement(a,(0,O.Z)({query:k.Ep,policyId:n.id,defaultFilter:"policy_id = ".concat(n.id),showActions:!1,remediationsEnabled:!1,columns:[C({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},r&&{key:"display_name",renderFunc:function(e,n){return l().createElement(d.Link,{to:{pathname:"/systems/".concat(n)}}," ",e," ")}})].concat((0,w.Z)(i?[{key:"ssgVersion",title:"SSG version",renderFunc:function(e){var n,t,r=e;return"string"==typeof e&&(r=arguments.length<=2?void 0:arguments[2]),r&&l().createElement(V.n1.SSGVersion,{supported:r.supported,ssgVersion:(null===(n=r)||void 0===n?void 0:n.ssg_version)||(null===(t=r)||void 0===t?void 0:t.ssgVersion)})}}]:[])),complianceThreshold:n.complianceThreshold},t))};R.propTypes={policy:s().shape({id:s().string.isRequired,complianceThreshold:s().number.isRequired}),systemTableProps:s().object};const A=R;var K=function(e){var n=e.profile,t=n.ssgVersion,r=n.rules,i=void 0===r?[]:r;return l().createElement(u.TabTitleText,null,l().createElement("span",null,"SSG ",t+" "),l().createElement(u.Label,{color:"blue"},i.length))};K.propTypes={profile:s().object.isRequired};var _=function(e){return e.map((function(e){return{profile:e,title:l().createElement(K,{profile:e}),rules:e.rules}}))},D=function(e){var n=e.policy.policy.profiles;return l().createElement(l().Fragment,null,l().createElement(u.Alert,{variant:"info",isInline:!0,title:"Rule editing coming soon"}),l().createElement(u.PageSection,{variant:u.PageSectionVariants.light},l().createElement(b.Hv,{tabsData:_(n),columns:["Name","Severity","Ansible"],level:1})))};D.propTypes={policy:s().object.isRequired};const G=D;t(23266);var L,N,q=p()(L||(L=(0,r.Z)(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                name\n                refId\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n    }\n}\n"]))),F=p()(N||(N=(0,r.Z)(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n        }\n        rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n    }\n}\n"]))),H=function(e){var n=e.route,t="details",r=(0,g.ZP)("multiversionTabs"),o=(0,d.useParams)().policy_id,s=(0,d.useLocation)(),c=(0,h.Wb)(),p=(0,a.useDispatch)(),S=(0,m.useQuery)(r?q:F,{variables:{policyId:o}}),P=S.data,O=S.error,j=S.loading,w=S.refetch,Z=P&&!j?P.profile:void 0;return Z&&Z.external&&(O={message:"This is an external SCAP policy."},P=void 0,j=void 0),(0,i.useEffect)((function(){w()}),[s,w]),(0,i.useLayoutEffect)((function(){p({type:"SELECT_ENTITIES",payload:{ids:[]}})}),[]),(0,T.a)(n,null==Z?void 0:Z.name),l().createElement(b.tC,{stateValues:{error:O,data:P,loading:j}},l().createElement(b.K7,{stateKey:"loading"},l().createElement(y.Z,null,l().createElement(b.PL,null)),l().createElement(v.Z,null,l().createElement(E.Z,null))),l().createElement(b.K7,{stateKey:"data"},Z&&l().createElement(i.Fragment,null,l().createElement(y.Z,{className:"page-header-tabs"},l().createElement(u.Breadcrumb,null,l().createElement(b.MU,{to:"/"},"Compliance"),l().createElement(b.MU,{to:"/scappolicies"},"SCAP policies"),l().createElement(u.BreadcrumbItem,{isActive:!0},Z.name)),l().createElement(u.Grid,{gutter:"lg"},l().createElement(u.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},l().createElement(f.Z,{title:Z.name})),l().createElement(u.GridItem,{className:"policy-details-button",xl2:1,xl:2,lg:2,md:3,sm:3},l().createElement(b.mR,{to:"/scappolicies/".concat(Z.id,"/edit"),state:{policy:Z},hash:c,backgroundLocation:{hash:"details"}},l().createElement(u.Button,{variant:"secondary"},"Edit policy")))),l().createElement(b.tn,{"aria-label":"Policy Tabs",defaultTab:t},l().createElement(u.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),l().createElement(u.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),l().createElement(u.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),l().createElement(v.Z,null,l().createElement(b.Jm,{defaultTab:t},l().createElement(b.X8,{eventKey:"details"},l().createElement(b.NP,{policy:Z})),l().createElement(b.X8,{eventKey:"rules"},r?l().createElement(G,{policy:Z}):l().createElement(I,{policy:Z})),l().createElement(b.X8,{eventKey:"systems"},l().createElement(A,{policy:Z})))))))};H.propTypes={route:s().object};const U=H},23266:(e,n,t)=>{"use strict";var r=t(93379),i=t.n(r),l=t(87601),a=t.n(l),o=i()(a(),{insert:"head",singleton:!1});if(!a().locals||e.hot.invalidate){var s=a().locals;e.hot.accept(87601,(n=>{l=t(87601),function(e,n,t){if(!e&&n||e&&!n)return!1;var r;for(r in e)if(e[r]!==n[r])return!1;for(r in n)if(!e[r])return!1;return!0}(s,(a=t.n(l))().locals)?(s=a().locals,o(a())):e.hot.invalidate()}))}e.hot.dispose((function(){o()})),a().locals}}]);
//# sourceMappingURL=PolicyDetails.d17c0e5abde3426f972f.js.map