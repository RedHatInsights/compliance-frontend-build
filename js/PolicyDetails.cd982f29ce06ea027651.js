(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[705],{87601:(e,t,n)=>{(t=n(23645)(!1)).push([e.id,".threshold-tooltip{margin-bottom:var(--pf-global--spacer--md)}.grey-icon{color:var(--pf-global--Color--200)}.policy-description{padding-top:10px}\n",""]),e.exports=t},50207:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MULTIVERSION_QUERY:()=>$,PolicyDetails:()=>M,QUERY:()=>B,default:()=>Q});var r=n(28655),i=n.n(r),l=n(77865),o=n.n(l),a=n(87016),s=n(45697),c=n.n(s),p=n(44119),d=n.n(p),m=n(47194),u=n(46829),y=n(55056),f=n(48716),b=n(39173),v=n(86350),E=n(6023),g=n(37311),h=n(50437),O=n(42564),P=n(52998),T=(n(90129),n(2707)),S=function(e){var t=e.loading,n=e.policy;return o().createElement(o().Fragment,null,o().createElement(y.Alert,{variant:"info",isInline:!0,title:"Rule editing coming soon"}),o().createElement(y.PageSection,{variant:y.PageSectionVariants.light},o().createElement(y.Text,{component:y.TextVariants.p},o().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",n.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),o().createElement(T.ZP,{remediationsEnabled:!1,columns:(0,T.eo)(["Rule","Severity","Ansible"]),loading:t,profileRules:[{profile:{refId:n.refId,name:n.name},rules:n.rules}]}))};S.propTypes={loading:c().bool,policy:c().shape({name:c().string,refId:c().string,rules:c().array,benchmark:c().object})};const j=S;var I=n(67154),w=n.n(I),k=n(59713),V=n.n(k),R=n(319),x=n.n(R),C=n(93188),D=n(55186),K=n(21157);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){V()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t=e.policy,n=e.systemTableProps,r=(0,O.ZP)("newInventory"),i=(0,O.ZP)("showSsgVersions"),l=r?C.e_:C.r0;return o().createElement(l,w()({query:D.Ep,policyId:t.id,defaultFilter:"policy_id = ".concat(t.id),showActions:!1,remediationsEnabled:!1,columns:[A({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},r&&{key:"display_name",renderFunc:function(e,t){return o().createElement(m.Link,{to:{pathname:"/systems/".concat(t)}}," ",e," ")}})].concat(x()(i?[{key:"facts.compliance",title:"SSG version",renderFunc:function(e){var t,n,r=e;return"string"==typeof e&&(r=arguments.length<=2?void 0:arguments[2]),r&&o().createElement(K.n1.SSGVersion,{supported:r.supported,ssgVersion:(null===(t=r)||void 0===t?void 0:t.ssg_version)||(null===(n=r)||void 0===n?void 0:n.ssgVersion)})}}]:[])),complianceThreshold:t.complianceThreshold},n))};_.propTypes={policy:c().shape({id:c().string.isRequired,complianceThreshold:c().number.isRequired}),systemTableProps:c().object};const G=_;function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){V()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e){var t=e.policy.policy.profiles;return o().createElement(o().Fragment,null,o().createElement(y.Alert,{variant:"info",isInline:!0,title:"Rule editing coming soon"}),o().createElement(y.PageSection,{variant:y.PageSectionVariants.light},o().createElement(g.tn,{level:1,defaultTab:t[0].ssgVersion},t.map((function(e){return o().createElement(y.Tab,{key:"ssgversion-tab-".concat(e.ssgVersion),title:o().createElement(y.TabTitleText,null,o().createElement("span",null,"SSG ",e.ssgVersion+" "),o().createElement(y.Label,{color:"blue"},e.rules.length)),eventKey:e.ssgVersion},o().createElement(T.ZP,{remediationsEnabled:!1,columns:(0,T.eo)(["Rule","Severity","Ansible"]),profileRules:[{profile:q({},e),rules:e.rules}]}))})))))};F.propTypes={policy:c().object.isRequired};const N=F;n(23266);var U,H,$=d()(U||(U=i()(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                ssgVersion\n                name\n                refId\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n    }\n}\n"]))),B=d()(H||(H=i()(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n        }\n        rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n    }\n}\n"]))),M=function(e){var t=e.route,n="details",r=(0,O.ZP)("multiversionTabs"),i=(0,m.useParams)().policy_id,s=(0,m.useLocation)(),c=(0,h.Wb)(),p=(0,a.useDispatch)(),d=(0,u.useQuery)(r?$:B,{variables:{policyId:i}}),T=d.data,S=d.error,I=d.loading,w=d.refetch,k=T&&!I?T.profile:void 0;return k&&k.external&&(S={message:"This is an external SCAP policy."},T=void 0,I=void 0),(0,l.useEffect)((function(){w()}),[s,w]),(0,l.useLayoutEffect)((function(){p({type:"SELECT_ENTITIES",payload:{ids:[]}})}),[]),(0,P.a)(t,null==k?void 0:k.name),o().createElement(g.tC,{stateValues:{error:S,data:T,loading:I}},o().createElement(g.K7,{stateKey:"loading"},o().createElement(f.Z,null,o().createElement(g.PL,null)),o().createElement(v.Z,null,o().createElement(E.Z,null))),o().createElement(g.K7,{stateKey:"data"},k&&o().createElement(l.Fragment,null,o().createElement(f.Z,{className:"page-header-tabs"},o().createElement(y.Breadcrumb,null,o().createElement(g.MU,{to:"/"},"Compliance"),o().createElement(g.MU,{to:"/scappolicies"},"SCAP policies"),o().createElement(y.BreadcrumbItem,{isActive:!0},k.name)),o().createElement(y.Grid,{gutter:"lg"},o().createElement(y.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},o().createElement(b.Z,{title:k.name})),o().createElement(y.GridItem,{className:"policy-details-button",xl2:1,xl:2,lg:2,md:3,sm:3},o().createElement(g.mR,{to:"/scappolicies/".concat(k.id,"/edit"),state:{policy:k},hash:c,backgroundLocation:{hash:"details"}},o().createElement(y.Button,{variant:"secondary"},"Edit policy")))),o().createElement(g.tn,{"aria-label":"Policy Tabs",defaultTab:n},o().createElement(y.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),o().createElement(y.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),o().createElement(y.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),o().createElement(v.Z,null,o().createElement(g.Jm,{defaultTab:n},o().createElement(g.X8,{eventKey:"details"},o().createElement(g.NP,{policy:k})),o().createElement(g.X8,{eventKey:"rules"},r?o().createElement(N,{policy:k}):o().createElement(j,{policy:k})),o().createElement(g.X8,{eventKey:"systems"},o().createElement(G,{policy:k})))))))};M.propTypes={route:c().object};const Q=M},23266:(e,t,n)=>{"use strict";var r=n(93379),i=n.n(r),l=n(87601),o=n.n(l),a=i()(o(),{insert:"head",singleton:!1});if(!o().locals||e.hot.invalidate){var s=o().locals;e.hot.accept(87601,(t=>{l=n(87601),function(e,t,n){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(s,(o=n.n(l))().locals)?(s=o().locals,a(o())):e.hot.invalidate()}))}e.hot.dispose((function(){a()})),o().locals}}]);
//# sourceMappingURL=PolicyDetails.cd982f29ce06ea027651.js.map