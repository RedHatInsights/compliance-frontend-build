(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[705],{87601:(e,n,t)=>{(n=t(23645)(!1)).push([e.id,".threshold-tooltip{margin-bottom:var(--pf-global--spacer--md)}.grey-icon{color:var(--pf-global--Color--200)}.policy-description{padding-top:10px}\n",""]),e.exports=n},50207:(e,n,t)=>{"use strict";t.r(n),t.d(n,{MULTIVERSION_QUERY:()=>Q,PolicyDetails:()=>$,QUERY:()=>U,default:()=>H});var r=t(28655),i=t.n(r),l=t(77865),o=t.n(l),a=t(45697),s=t.n(a),c=t(44119),p=t.n(c),m=t(47194),u=t(46829),d=t(98627),y=t(68433),f=t(44510),b=t(94480),v=t(37311),g=t(50437),E=t(42564),h=t(52998),O=(t(90129),t(99263)),P=function(e){var n=e.loading,t=e.policy;return o().createElement(o().Fragment,null,o().createElement(d.Alert,{variant:"info",isInline:!0,title:"Rule editing coming soon"}),o().createElement(d.PageSection,{variant:d.PageSectionVariants.light},o().createElement(d.Text,{component:d.TextVariants.p},o().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",t.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),o().createElement(O.QB,{remediationsEnabled:!1,columns:(0,O.re)(["Rule","Severity","Ansible"]),loading:n,profileRules:[{profile:{refId:t.refId,name:t.name},rules:t.rules}]}))};P.propTypes={loading:s().bool,policy:s().shape({name:s().string,refId:s().string,rules:s().array,benchmark:s().object})};const j=P;var S=t(67154),T=t.n(S),I=t(59713),w=t.n(I),k=t(319),V=t.n(k),R=t(93188),x=t(55186),C=t(21157);function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function A(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(Object(t),!0).forEach((function(n){w()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var D=function(e){var n=e.policy,t=e.systemTableProps,r=(0,E.Z)("newInventory"),i=(0,E.Z)("showSsgVersions"),l=r?R.e_:R.r0;return o().createElement(l,T()({query:x.Ep,policyId:n.id,defaultFilter:"policy_id = ".concat(n.id),showActions:!1,remediationsEnabled:!1,columns:[A({key:"facts.compliance.display_name",title:"Name",props:{width:40,isStatic:!0}},r&&{key:"display_name",renderFunc:function(e,n){return o().createElement(m.Link,{to:{pathname:"/systems/".concat(n)}}," ",e," ")}})].concat(V()(i?[{key:"facts.compliance",title:"SSG version",renderFunc:function(e){return o().createElement(C.n1.SSGVersion,{supported:e.supported,ssgVersion:e.ssg_version})}}]:[])),complianceThreshold:n.complianceThreshold},t))};D.propTypes={policy:s().shape({id:s().string.isRequired,complianceThreshold:s().number.isRequired}),systemTableProps:s().object};const _=D;function G(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?G(Object(t),!0).forEach((function(n){w()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):G(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var B=function(e){var n=e.policy.policy.profiles;return o().createElement(o().Fragment,null,o().createElement(d.Alert,{variant:"info",isInline:!0,title:"Rule editing coming soon"}),o().createElement(d.PageSection,{variant:d.PageSectionVariants.light},o().createElement(v.tn,{level:1,defaultTab:n[0].ssgVersion},n.map((function(e){return o().createElement(d.Tab,{key:"ssgversion-tab-".concat(e.ssgVersion),title:o().createElement(d.TabTitleText,null,o().createElement("span",null,"SSG ",e.ssgVersion+" "),o().createElement(d.Label,{color:"blue"},e.rules.length)),eventKey:e.ssgVersion},o().createElement(O.QB,{remediationsEnabled:!1,columns:(0,O.re)(["Rule","Severity","Ansible"]),profileRules:[{profile:q({},e),rules:e.rules}]}))})))))};B.propTypes={policy:s().object.isRequired};const F=B;function L(){var e=i()(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n        }\n        rules {\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n    }\n}\n"]);return L=function(){return e},e}function N(){var e=i()(["\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                ssgVersion\n                name\n                refId\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n        }\n        benchmark {\n            id\n            title\n            version\n        }\n    }\n}\n"]);return N=function(){return e},e}t(23266);var Q=p()(N()),U=p()(L()),$=function(e){var n=e.route,t="details",r=(0,E.Z)("multiversionTabs"),i=(0,m.useParams)().policy_id,a=(0,m.useLocation)(),s=(0,g.Wb)(),c=(0,u.useQuery)(r?Q:U,{variables:{policyId:i}}),p=c.data,O=c.error,P=c.loading,S=c.refetch,T=p&&!P?p.profile:void 0;return T&&T.external&&(O={message:"This is an external SCAP policy."},p=void 0,P=void 0),(0,l.useEffect)((function(){S()}),[a]),(0,h.a)(n,null==T?void 0:T.name),o().createElement(v.tC,{stateValues:{error:O,data:p,loading:P}},o().createElement(v.K7,{stateKey:"loading"},o().createElement(y.m,null,o().createElement(v.PL,null)),o().createElement(f.o,null,o().createElement(b.$,null))),o().createElement(v.K7,{stateKey:"data"},T&&o().createElement(l.Fragment,null,o().createElement(y.m,{className:"page-header-tabs"},o().createElement(d.Breadcrumb,null,o().createElement(v.MU,{to:"/"},"Compliance"),o().createElement(v.MU,{to:"/scappolicies"},"SCAP policies"),o().createElement(d.BreadcrumbItem,{isActive:!0},T.name)),o().createElement(d.Grid,{gutter:"lg"},o().createElement(d.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},o().createElement(y.B,{title:T.name})),o().createElement(d.GridItem,{className:"policy-details-button",xl2:1,xl:2,lg:2,md:3,sm:3},o().createElement(v.mR,{to:"/scappolicies/".concat(T.id,"/edit"),state:{policy:T},hash:s,backgroundLocation:{hash:"details"}},o().createElement(d.Button,{variant:"secondary"},"Edit policy")))),o().createElement(v.tn,{"aria-label":"Policy Tabs",defaultTab:t},o().createElement(d.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),o().createElement(d.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),o().createElement(d.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),o().createElement(f.o,null,o().createElement(v.Jm,{defaultTab:t},o().createElement(v.X8,{eventKey:"details"},o().createElement(v.NP,{policy:T})),o().createElement(v.X8,{eventKey:"rules"},r?o().createElement(F,{policy:T}):o().createElement(j,{policy:T})),o().createElement(v.X8,{eventKey:"systems"},o().createElement(_,{policy:T})))))))};$.propTypes={route:s().object};const H=$},23266:(e,n,t)=>{"use strict";var r=t(93379),i=t.n(r),l=t(87601),o=t.n(l),a=i()(o(),{insert:"head",singleton:!1});if(!o().locals||e.hot.invalidate){var s=o().locals;e.hot.accept(87601,(n=>{l=t(87601),function(e,n,t){if(!e&&n||e&&!n)return!1;var r;for(r in e)if(e[r]!==n[r])return!1;for(r in n)if(!e[r])return!1;return!0}(s,(o=t.n(l))().locals)?(s=o().locals,a(o())):e.hot.invalidate()}))}e.hot.dispose((function(){a()})),o().locals}}]);
//# sourceMappingURL=PolicyDetails.2e7b8622e894756e4495.js.map