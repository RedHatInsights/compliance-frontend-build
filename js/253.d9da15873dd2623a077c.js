"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[253],{7081:(e,t,n)=>{n.d(t,{ZP:()=>i,lb:()=>l,wl:()=>o});var r=n(40400);const l={name:"PlusCircleIcon",height:512,width:512,svgPath:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z",yOffset:0,xOffset:0},o=(0,r.IU)(l),i=o},59253:(e,t,n)=>{n.d(t,{Z:()=>oe});var r=n(87462),l=n(45987),o=n(4942),i=n(70885),a=n(30168),s=n(92950),c=n.n(s),u=n(45697),d=n.n(u),p=n(65115),m=n(42982),y=n(15671),f=n(43144),h=n(60136),v=n(82963),g=n(61120),E=n(97326),P=n(68778),b=n(43047),S=n(62410),C=n(19535),T=n(91290),Z=n(58061),x=["ssgVersion","style"],I=function(e){var t=e.ssgVersion,n=e.style,o=(0,l.Z)(e,x),i=c().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:Z.iK},"Supported SSG versions");return c().createElement(p.Alert,(0,r.Z)({variant:"warning",isInline:!0,style:n,title:c().createElement(c().Fragment,null,"Unsupported SSG version (",t,")",c().createElement(p.Popover,{position:"right",bodyContent:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:i},c().createElement(T.ZP,{style:{marginLeft:".5em",cursor:"pointer",color:"var(--pf-global--Color--200)"}})))},o))};I.propTypes={ssgVersion:d().string,style:d().object};const k=I;var O=function(e){(0,h.Z)(i,e);var t,n,l=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,g.Z)(t);if(n){var l=(0,g.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,v.Z)(this,e)});function i(){var e;(0,y.Z)(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=l.call.apply(l,[this].concat(n)),(0,o.Z)((0,E.Z)(e),"complianceIcon",(function(e){return e?c().createElement("div",{className:"ins-c-policy-card ins-m-compliant"},c().createElement(P.ZP,null)," Compliant"):c().createElement("div",{className:"ins-c-policy-card ins-m-noncompliant"},c().createElement(b.ZP,null)," Not compliant")})),(0,o.Z)((0,E.Z)(e),"fixedPercentage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.toFixed(t)+(n?"%":"")})),e}return(0,f.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.policy,n=e.style,l=e.onClick,o=e.isSelected,i=t.rulesFailed,a=t.compliant,s=t.lastScanned,u=t.score,d=t.benchmark.version,m=t.supported,y=t.name,f=t.policyType,h=this.fixedPercentage(u),v={expandOnMouseOver:!0,hideExpandText:!0};return c().createElement(p.Card,{ouiaId:"PolicyCard",onClick:function(e){e.stopPropagation(),l(t)},isSelected:o,style:n},c().createElement(p.CardBody,null,c().createElement(p.TextContent,{className:"margin-bottom-md"},c().createElement(p.Text,{ouiaId:"PolicyCardName",className:"margin-bottom-top-none",component:p.TextVariants.h4},c().createElement(C.Z,(0,r.Z)({text:y,length:110},v))),c().createElement(p.Text,{ouiaId:"PolicyCardType",style:{color:"var(--pf-global--Color--200)"},component:p.TextVariants.small},c().createElement(C.Z,(0,r.Z)({text:f,length:110},v)))),c().createElement("div",{className:"margin-bottom-md"},m&&this.complianceIcon(a),c().createElement(p.Text,{ouiaId:"PolicyCardFailedRulesScore",component:p.TextVariants.small},i," rule",1===i?"":"s"," failed"," ",c().createElement(p.Tooltip,{position:"bottom",maxWidth:"22em",content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},c().createElement("span",null,"(Score: ",m?h:"Unsupported",")")))),c().createElement(p.Text,{className:"margin-bottom-none",component:p.TextVariants.small},c().createElement(p.Text,{ouiaId:"PolicyCardSSGVersion"},"SSG version: ",d),c().createElement(p.Text,{ouiaId:"PolicyCardLastScanned"},"Last scanned:"," ","Never"!==s?c().createElement(S.Z,{date:Date.parse(s),type:"relative"}):s))),!m&&c().createElement(p.CardFooter,{style:{padding:"0"}},c().createElement(k,{ouiaId:"PolicyCardUnsupportedSSG",ssgVersion:d,style:{paddingTop:"var(--pf-c-alert--PaddingTop)",paddingRight:"var(--pf-c-card--child--PaddingRight)",paddingLeft:"var(--pf-c-card--child--PaddingLeft)",paddingBottom:"var(--pf-c-alert--PaddingBottom)"}})))}}]),i}(c().Component);O.propTypes={policy:d().shape({rulesPassed:d().number,rulesFailed:d().number,score:d().number,lastScanned:d().string,refId:d().string,name:d().string,policyType:d().string,compliant:d().bool,benchmark:d().string,supported:d().bool}),style:d().object,onClick:d().func,isSelected:d().bool};const w=O;var R=n(24561);var j=function(e){(0,h.Z)(l,e);var t,n,r=(t=l,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,g.Z)(t);if(n){var l=(0,g.Z)(this).constructor;e=Reflect.construct(r,arguments,l)}else e=r.apply(this,arguments);return(0,v.Z)(this,e)});function l(){return(0,y.Z)(this,l),r.apply(this,arguments)}return(0,f.Z)(l,[{key:"systemPolicyCards",value:function(){var e=this.props,t=e.policies,n=e.selectedPolicies,r=e.onCardClick;return t.filter((function(e){return e.rulesFailed+e.rulesPassed>0})).map((function(e,t){return c().createElement(p.GridItem,{sm:12,md:12,lg:6,xl:4,key:t},c().createElement(w,{policy:e,style:{height:"100%"},onClick:function(e){return r(e)},isSelected:null==n?void 0:n.find((function(t){return t===e.id}))}))}))}},{key:"render",value:function(){var e=this.props.loading;return c().createElement(c().Fragment,null,c().createElement(p.Grid,{hasGutter:!0},this.systemPolicyCards(),e&&(0,m.Z)(Array(3)).map((function(e,t){return c().createElement(p.GridItem,{span:4,key:t},c().createElement(p.Card,null,c().createElement(p.CardBody,null,c().createElement(R.mr,null))))}))))}}]),l}(c().Component);j.propTypes={policies:d().array,loading:d().bool,onCardClick:d().func,selectedPolicies:d().string},j.defaultProps={policies:[]};const B=j;var N=n(74560),F=n(6474),V=n(90570),_=n(67521),G=n(97481),L=n(85836),A=n(85893),z=n(10044),D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},D.apply(this,arguments)};const U=function(e){var t=e.titleText,n=void 0===t?"This system isnâ€™t connected to Insights yet":t,r=e.bodyText,l=void 0===r?"To get started, activate the Insights client for this system.":r,o=e.buttonText,i=void 0===o?"Learn how to activate the Insights client":o;return(0,A.jsxs)(p.EmptyState,{children:[(0,A.jsx)(p.EmptyStateIcon,{icon:z.DisconnectedIcon}),(0,A.jsx)(p.Title,D({headingLevel:"h5",size:"lg"},{children:n})),(0,A.jsx)(p.EmptyStateBody,{children:l}),(0,A.jsx)(p.Button,D({variant:"primary",component:"a",href:"http://access.redhat.com/products/cloud_management_services_for_rhel#getstarted",target:"_blank",rel:"noopener noreferrer",className:"pf-u-mt-lg"},{children:i}))]})};var K=n(7081),M=n(96620);const W=function(){return c().createElement(p.Bullseye,null,c().createElement(p.EmptyState,null,c().createElement(p.EmptyStateIcon,{icon:K.ZP}),c().createElement(p.Title,{headingLevel:"h1",size:"lg"},"This system is not part of any SCAP policies defined within Compliance."),c().createElement(p.EmptyStateBody,null,"To assess and monitor compliance against a SCAP policy for this system, add it to an existing policy or create a new policy."),c().createElement(p.EmptyStatePrimary,null,c().createElement(L.mR,{to:"/scappolicies/new",variant:"primary",ouiaId:"CreateNewPolicyButton",component:L.Qj},"Create new policy")),c().createElement(p.EmptyStateSecondaryActions,null,c().createElement(M.Link,{variant:"plain",to:"/scappolicies"},"View compliance policies"))))};var $=n(7162),q=function(e){var t,n,r=e.system;return c().createElement(p.Bullseye,null,c().createElement(p.EmptyState,null,c().createElement(p.EmptyStateIcon,{icon:$.ZP,title:"Compliance",size:"xl",style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"}}),c().createElement(p.Title,{headingLevel:"h1",size:"lg"},"No results reported"),c().createElement(p.EmptyStateBody,null,"This system is part of ",null==r||null===(t=r.policies)||void 0===t?void 0:t.length,(null==r||null===(n=r.policies)||void 0===n?void 0:n.length)>1?" policies":" policy",", but has not returned any results."),c().createElement(p.EmptyStateBody,null,"Reports are returned when the system checks into Insights. By default, systems check in every 24 hours.")))};q.propTypes={system:d().shape({policies:d().array})};const Q=q;var H=function(e){var t,n=e.system;return null!=n&&n.insightsId?null!=n&&n.hasPolicy?null!=n&&n.hasPolicy&&0===(null==n||null===(t=n.testResultProfiles)||void 0===t?void 0:t.length)?c().createElement(Q,{system:n}):void 0:c().createElement(W,{system:n}):c().createElement(U,null)};H.propTypes={system:d().object};const J=H;var X,Y=["inventoryId","hidePassed"];function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=(0,_.ZP)(X||(X=(0,a.Z)(["\n  query System($systemId: String!) {\n    system(id: $systemId) {\n      id\n      name\n      hasPolicy\n      insightsId\n      policies {\n        id\n      }\n      testResultProfiles {\n        id\n        name\n        policyType\n        refId\n        compliant\n        rulesFailed\n        rulesPassed\n        lastScanned\n        score\n        supported\n        osMajorVersion\n        benchmark {\n          version\n          ruleTree\n        }\n        policy {\n          id\n        }\n        rules {\n          id\n          title\n          severity\n          rationale\n          refId\n          description\n          compliant\n          remediationAvailable\n          references\n          identifier\n          precedence\n        }\n      }\n    }\n  }\n"]))),re=function(e){var t,n=e.data.system,r=e.loading,l=e.hidePassed,o=(0,s.useState)(null==n?void 0:n.testResultProfiles[0].id),a=(0,i.Z)(o,2),u=a[0],d=a[1],m=null==n?void 0:n.testResultProfiles;return c().createElement(c().Fragment,null,c().createElement(B,{policies:m,loading:r}),c().createElement("br",null),null!=n&&null!==(t=n.testResultProfiles)&&void 0!==t&&t.length?c().createElement(c().Fragment,null,n.testResultProfiles.length>1&&c().createElement(p.Tabs,{activeKey:u,style:{background:"var(--pf-global--BackgroundColor--100)"}},n.testResultProfiles.map((function(e,t){return c().createElement(p.Tab,{key:"policy-tab-"+t,eventKey:e.id,title:c().createElement(p.TabTitleText,null," ",e.name," "),onClick:function(){d(e.id)}})}))),c().createElement(N.Z,{ansibleSupportFilter:!0,hidePassed:l,showFailedCounts:!0,system:te(te({},n),{},{supported:((null==n?void 0:n.testResultProfiles)||[]).filter((function(e){return e.supported})).length>0}),profileRules:null==n?void 0:n.testResultProfiles.filter((function(e){return u===e.id})).map((function(e){return{system:n,profile:e,rules:e.rules}})),loading:r,options:{sortBy:{index:4,direction:"asc",property:"severity"}}})):c().createElement(J,{system:n}))};re.propTypes={data:d().shape({system:d().shape({hasPolicy:d().bool,policies:d().shape({id:d().string}),profiles:d().array,testResultProfiles:d().array})}),loading:d().bool,hidePassed:d().bool},re.defaultProps={loading:!0};var le=function(e){var t,n=e.inventoryId,o=e.hidePassed,i=(0,l.Z)(e,Y),a=(0,V.a)(ne,{variables:{systemId:n},fetchPolicy:"no-cache"}),s=a.data,u=a.error,d=a.loading,p=404===(null==u||null===(t=u.networkError)||void 0===t?void 0:t.statusCode);return d?c().createElement(G.Z,null):u&&!p?c().createElement(L._U,null):c().createElement("div",{className:"ins-c-compliance__scope"},null==s||!s.system||p?c().createElement(F.Z,{title:"No policies are reporting for this system"}):c().createElement(re,(0,r.Z)({},i,{hidePassed:o,data:s,loading:d})))};le.propTypes={inventoryId:d().string,hidePassed:d().bool};const oe=le}}]);
//# sourceMappingURL=../sourcemaps/253.1dd09533ca75a2902eb68d3368ff0055.js.map