"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[253],{7081:(e,t,n)=>{n.d(t,{ZP:()=>i,lb:()=>o,wl:()=>l});var r=n(40400);const o={name:"PlusCircleIcon",height:512,width:512,svgPath:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z",yOffset:0,xOffset:0},l=(0,r.IU)(o),i=l},59253:(e,t,n)=>{n.d(t,{Z:()=>le});var r=n(87462),o=n(45987),l=n(4942),i=n(42982),a=n(70885),s=n(30168),c=n(92950),d=n.n(c),u=n(45697),p=n.n(u),m=n(15671),y=n(43144),f=n(60136),h=n(82963),v=n(61120),g=n(76857),E=n(97326),P=n(68778),b=n(43047),S=n(62410),C=n(19535),Z=n(91290),T=n(72971),x=["ssgVersion","style"],I=function(e){var t=e.ssgVersion,n=e.style,l=(0,o.Z)(e,x),i=d().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:T.iK},"Supported SSG versions");return d().createElement(g.Alert,(0,r.Z)({variant:"warning",isInline:!0,style:n,title:d().createElement(d().Fragment,null,"Unsupported SSG version (",t,")",d().createElement(g.Popover,{position:"right",bodyContent:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:i},d().createElement(Z.ZP,{style:{marginLeft:".5em",cursor:"pointer",color:"var(--pf-global--Color--200)"}})))},l))};I.propTypes={ssgVersion:p().string,style:p().object};const O=I;var k=function(e){(0,f.Z)(i,e);var t,n,o=(t=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,v.Z)(t);if(n){var o=(0,v.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,h.Z)(this,e)});function i(){var e;(0,m.Z)(this,i);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=o.call.apply(o,[this].concat(n)),(0,l.Z)((0,E.Z)(e),"complianceIcon",(function(e){return e?d().createElement("div",{className:"ins-c-policy-card ins-m-compliant"},d().createElement(P.ZP,null)," Compliant"):d().createElement("div",{className:"ins-c-policy-card ins-m-noncompliant"},d().createElement(b.ZP,null)," Not compliant")})),(0,l.Z)((0,E.Z)(e),"fixedPercentage",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.toFixed(t)+(n?"%":"")})),e}return(0,y.Z)(i,[{key:"render",value:function(){var e=this.props,t=e.policy,n=e.style,o=e.onClick,l=e.isSelected,i=t.rulesFailed,a=t.compliant,s=t.lastScanned,c=t.score,u=t.benchmark.version,p=t.supported,m=t.name,y=t.policyType,f=this.fixedPercentage(c),h={expandOnMouseOver:!0,hideExpandText:!0};return d().createElement(g.Card,{ouiaId:"PolicyCard",onClick:function(e){e.stopPropagation(),o(t)},isSelectable:!0,isSelected:l,style:n},d().createElement(g.CardBody,null,d().createElement(g.TextContent,{className:"margin-bottom-md"},d().createElement(g.Text,{ouiaId:"PolicyCardName",className:"margin-bottom-top-none",component:g.TextVariants.h4},d().createElement(C.Z,(0,r.Z)({text:m,length:110},h))),d().createElement(g.Text,{ouiaId:"PolicyCardType",style:{color:"var(--pf-global--Color--200)"},component:g.TextVariants.small},d().createElement(C.Z,(0,r.Z)({text:y,length:110},h)))),d().createElement("div",{className:"margin-bottom-md"},p&&this.complianceIcon(a),d().createElement(g.Text,{ouiaId:"PolicyCardFailedRulesScore",component:g.TextVariants.small},i," rule",1===i?"":"s"," failed"," ",d().createElement(g.Tooltip,{position:"bottom",maxWidth:"22em",content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},d().createElement("span",null,"(Score: ",p?f:"Unsupported",")")))),d().createElement(g.Text,{className:"margin-bottom-none",component:g.TextVariants.small},d().createElement(g.Text,{ouiaId:"PolicyCardSSGVersion"},"SSG version: ",u),d().createElement(g.Text,{ouiaId:"PolicyCardLastScanned"},"Last scanned:"," ","Never"!==s?d().createElement(S.Z,{date:Date.parse(s),type:"relative"}):s))),!p&&d().createElement(g.CardFooter,{style:{padding:"0"}},d().createElement(O,{ouiaId:"PolicyCardUnsupportedSSG",ssgVersion:u,style:{paddingTop:"var(--pf-c-alert--PaddingTop)",paddingRight:"var(--pf-c-card--child--PaddingRight)",paddingLeft:"var(--pf-c-card--child--PaddingLeft)",paddingBottom:"var(--pf-c-alert--PaddingBottom)"}})))}}]),i}(d().Component);k.propTypes={policy:p().shape({rulesPassed:p().number,rulesFailed:p().number,score:p().number,lastScanned:p().string,refId:p().string,name:p().string,policyType:p().string,compliant:p().bool,benchmark:p().string,supported:p().bool}),style:p().object,onClick:p().func,isSelected:p().bool};const w=k;var j=n(24561);var R=function(e){(0,f.Z)(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,v.Z)(t);if(n){var o=(0,v.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,h.Z)(this,e)});function o(){return(0,m.Z)(this,o),r.apply(this,arguments)}return(0,y.Z)(o,[{key:"systemPolicyCards",value:function(){var e=this.props,t=e.policies,n=e.selectedPolicies,r=e.onCardClick;return t.filter((function(e){return e.rulesFailed+e.rulesPassed>0})).map((function(e,t){return d().createElement(g.GridItem,{sm:12,md:12,lg:6,xl:4,key:t},d().createElement(w,{policy:e,style:{height:"100%"},onClick:function(e){return r(e)},isSelected:null==n?void 0:n.find((function(t){return t===e.id}))}))}))}},{key:"render",value:function(){var e=this.props.loading;return d().createElement(d().Fragment,null,d().createElement(g.Grid,{hasGutter:!0},this.systemPolicyCards(),e&&(0,i.Z)(Array(3)).map((function(e,t){return d().createElement(g.GridItem,{span:4,key:t},d().createElement(g.Card,null,d().createElement(g.CardBody,null,d().createElement(j.mr,null))))}))))}}]),o}(d().Component);R.propTypes={policies:p().array,loading:p().bool,onCardClick:p().func,selectedPolicies:p().string},R.defaultProps={policies:[]};const B=R;var N=n(74560),F=n(6474),V=n(90570),_=n(67521),G=n(97481),L=n(85836),A=n(85893),z=n(22430),D=function(){return D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},D.apply(this,arguments)};const U=function(e){var t=e.titleText,n=void 0===t?"This system isnâ€™t connected to Insights yet":t,r=e.bodyText,o=void 0===r?"To get started, activate the Insights client for this system.":r,l=e.buttonText,i=void 0===l?"Learn how to activate the Insights client":l;return(0,A.jsxs)(g.EmptyState,{children:[(0,A.jsx)(g.EmptyStateIcon,{icon:z.DisconnectedIcon}),(0,A.jsx)(g.Title,D({headingLevel:"h5",size:"lg"},{children:n})),(0,A.jsx)(g.EmptyStateBody,{children:o}),(0,A.jsx)(g.Button,D({variant:"primary",component:"a",href:"http://access.redhat.com/products/cloud_management_services_for_rhel#getstarted",target:"_blank",rel:"noopener noreferrer",className:"pf-u-mt-lg"},{children:i}))]})};var M=n(7081),W=n(96620);const $=function(){return d().createElement(g.Bullseye,null,d().createElement(g.EmptyState,null,d().createElement(g.EmptyStateIcon,{icon:M.ZP}),d().createElement(g.Title,{headingLevel:"h1",size:"lg"},"This system is not part of any SCAP policies defined within Compliance."),d().createElement(g.EmptyStateBody,null,"To assess and monitor compliance against a SCAP policy for this system, add it to an existing policy or create a new policy."),d().createElement(g.EmptyStatePrimary,null,d().createElement(L.mR,{to:"/scappolicies/new",variant:"primary",ouiaId:"CreateNewPolicyButton",component:L.Qj},"Create new policy")),d().createElement(g.EmptyStateSecondaryActions,null,d().createElement(W.Link,{variant:"plain",to:"/scappolicies"},"View compliance policies"))))};var q=n(7162),K=function(e){var t,n,r=e.system;return d().createElement(g.Bullseye,null,d().createElement(g.EmptyState,null,d().createElement(g.EmptyStateIcon,{icon:q.ZP,title:"Compliance",size:"xl",style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"}}),d().createElement(g.Title,{headingLevel:"h1",size:"lg"},"No results reported"),d().createElement(g.EmptyStateBody,null,"This system is part of ",null==r||null===(t=r.policies)||void 0===t?void 0:t.length,(null==r||null===(n=r.policies)||void 0===n?void 0:n.length)>1?" policies":" policy",", but has not returned any results."),d().createElement(g.EmptyStateBody,null,"Reports are returned when the system checks into Insights. By default, systems check in every 24 hours.")))};K.propTypes={system:p().shape({policies:p().array})};const Q=K;var H=function(e){var t,n=e.system;return null!=n&&n.insightsId?null!=n&&n.hasPolicy?null!=n&&n.hasPolicy&&0===(null==n||null===(t=n.testResultProfiles)||void 0===t?void 0:t.length)?d().createElement(Q,{system:n}):void 0:d().createElement($,{system:n}):d().createElement(U,null)};H.propTypes={system:p().object};const J=H;var X,Y=["inventoryId","hidePassed"];function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,l.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=(0,_.ZP)(X||(X=(0,s.Z)(["\n  query System($systemId: String!) {\n    system(id: $systemId) {\n      id\n      name\n      hasPolicy\n      insightsId\n      policies {\n        id\n      }\n      testResultProfiles {\n        id\n        name\n        policyType\n        refId\n        compliant\n        rulesFailed\n        rulesPassed\n        lastScanned\n        score\n        supported\n        osMajorVersion\n        benchmark {\n          version\n        }\n        policy {\n          id\n        }\n        rules {\n          title\n          severity\n          rationale\n          refId\n          description\n          compliant\n          remediationAvailable\n          references\n          identifier\n          precedence\n        }\n      }\n    }\n  }\n"]))),re=function(e){var t,n=e.data.system,r=e.loading,o=e.hidePassed,l=(0,c.useState)(),s=(0,a.Z)(l,2),u=s[0],p=s[1],m=null==n?void 0:n.testResultProfiles,y=function(e){if(e)if(null==u?void 0:u.find((function(t){return(null==e?void 0:e.id)===t}))){var t=null==u?void 0:u.filter((function(t){return e.id!==t}));p(t.length>0?t:void 0)}else p([].concat((0,i.Z)(u||[]),[null==e?void 0:e.id]))};return d().createElement(d().Fragment,null,d().createElement(B,{policies:m,loading:r,selectedPolicies:u,onCardClick:function(e){y(e)}}),d().createElement("br",null),null!=n&&null!==(t=n.testResultProfiles)&&void 0!==t&&t.length?d().createElement(N.Z,{ansibleSupportFilter:!0,hidePassed:o,system:te(te({},n),{},{supported:((null==n?void 0:n.testResultProfiles)||[]).filter((function(e){return e.supported})).length>0}),profileRules:null==n?void 0:n.testResultProfiles.map((function(e){return{system:n,profile:e,rules:e.rules}})),loading:r,options:{sortBy:{index:4,direction:"asc",property:"severity"},onDeleteFilter:function(e,t){var n,r,o=null===(n=e.find((function(e){return"Policy"===e.category})))||void 0===n?void 0:n.chips.map((function(e){return e.name})),l=null===(r=m.find((function(e){var t=e.name;return null==o?void 0:o.includes(t)})))||void 0===r?void 0:r.id;l&&(t?p(void 0):y(l?{id:l}:{}))}},activeFilters:{policy:u}}):d().createElement(J,{system:n}))};re.propTypes={data:p().shape({system:p().shape({hasPolicy:p().bool,policies:p().shape({id:p().string}),profiles:p().array,testResultProfiles:p().array})}),loading:p().bool,hidePassed:p().bool},re.defaultProps={loading:!0};var oe=function(e){var t,n=e.inventoryId,l=e.hidePassed,i=(0,o.Z)(e,Y),a=(0,V.a)(ne,{variables:{systemId:n},fetchPolicy:"no-cache"}),s=a.data,c=a.error,u=a.loading,p=404===(null==c||null===(t=c.networkError)||void 0===t?void 0:t.statusCode);if(u)return d().createElement(G.Z,null);if(c&&!p){var m="Oops! Error loading System data: ".concat(c);return d().createElement(L._U,{message:m})}return d().createElement("div",{className:"ins-c-compliance__scope"},null==s||!s.system||p?d().createElement(F.Z,{title:"No policies are reporting for this system"}):d().createElement(re,(0,r.Z)({},i,{hidePassed:l,data:s,loading:u})))};oe.propTypes={inventoryId:p().string,hidePassed:p().bool};const le=oe}}]);
//# sourceMappingURL=../sourcemaps/253.b6d6e31f5b0e31d124c7db5f4c8c9ab7.js.map