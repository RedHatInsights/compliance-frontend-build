"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[72,402],{62114:(e,t,n)=>{n.r(t),n.d(t,{QUERY:()=>Z,ReportDetails:()=>j,default:()=>F});var r=n(30168),o=n(92950),a=n.n(o),l=n(45697),i=n.n(l),s=n(96620),c=n(90570),p=n(67521),m=n(65115),d=n(89376),u=n(39173),f=n(58247),y=n(97481),h=n(85836),b=n(7648),E=n(77346),g=n(55378),v=n(31499),w=n(42982),C=n(55573),R=function(e){var t,n=e.row,r=e.children;return a().createElement(C.e,{style:0===(null===(t=n.testResultProfiles)||void 0===t?void 0:t.length)?{background:"#F0F0F0",borderLeft:"var(--pf-c-table--border-width--base) solid var(--pf-c-table--BorderColor)",borderRight:"var(--pf-c-table--border-width--base) solid var(--pf-c-table--BorderColor)"}:{}},r)};R.propTypes={row:i().node,children:i().node};const I=R;var S,x=n(93471),k=(0,p.ZP)(S||(S=(0,r.Z)(["\n  query RDWNRS_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      totalHostCount\n      testResultHostCount\n      compliantHostCount\n      unsupportedHostCount\n      complianceThreshold\n      osMajorVersion\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n        profiles {\n          benchmark {\n            version\n          }\n        }\n      }\n      businessObjective {\n        id\n        title\n      }\n    }\n  }\n"]))),P=function(e){var t,n,r=e.route,o=(0,s.useParams)().report_id,l=(0,E.ZP)("pdfReport"),i=(0,c.a)(k,{variables:{policyId:o},fetchPolicy:"no-cache"}),p=i.data,C=i.error,R=i.loading,S={},P=[];return!R&&p&&(t=(S=p.profile).policy.name,n="Report: ".concat(t),P=(0,w.Z)(new Set(S.policy.profiles.flatMap((function(e){return e.benchmark.version}))))),(0,b.a)(r,t),a().createElement(h.tC,{stateValues:{error:C,data:p,loading:R}},a().createElement(h.K7,{stateKey:"loading"},a().createElement(d.Z,null,a().createElement(h.Tq,null)),a().createElement("section",{className:"pf-c-page__main-section"},a().createElement(f.Z,null,a().createElement(y.Z,null)))),a().createElement(h.K7,{stateKey:"data"},a().createElement(d.Z,null,a().createElement(m.Breadcrumb,{ouiaId:"ReportDetailsPathBreadcrumb"},a().createElement(h.MU,{to:"/"},"Compliance"),a().createElement(h.MU,{to:"/reports"},"Reports"),a().createElement(m.BreadcrumbItem,{isActive:!0},n)),a().createElement(m.Grid,{hasGutter:!0},a().createElement(m.GridItem,{sm:9,md:9,lg:9,xl:9},a().createElement(u.Z,{title:n}),a().createElement(h.Zr,null,S.policyType)),a().createElement(m.GridItem,{className:"report-details-button",sm:3,md:3,lg:3,xl:3},l&&a().createElement(h.mR,{state:{profile:S},to:"/reports/".concat(S.id,"/pdf"),component:h.Qj,ouiaId:"ReportDetailsDownloadReportPDFLink",variant:"primary",className:"pf-u-mr-md"},"Download PDF"),a().createElement(h.mR,{state:{profile:S},to:"/reports/".concat(S.id,"/delete"),component:h.Qj,variant:"link",ouiaId:"ReportDetailsDeleteReportLink",isInline:!0},"Delete report"))),a().createElement(m.Grid,{hasGutter:!0},a().createElement(m.GridItem,{sm:12,md:12,lg:12,xl:6},a().createElement(x.Z,{profile:S,hasLegend:!0,chartClass:"report-details-chart-container"})),a().createElement(m.GridItem,{sm:12,md:12,lg:12,xl:6},a().createElement(h.vu,{profile:S})))),a().createElement("section",{className:"pf-c-page__main-section"},a().createElement(m.Grid,{hasGutter:!0},a().createElement(m.GridItem,{span:12},a().createElement(g.r0,{showOsMinorVersionFilter:[S.osMajorVersion],ssgVersions:P,columns:[v.Zw({showLink:!0,showOsInfo:!0}),v.MO("tags"),v.hN,v.ll,v.OF,v.Hc],compliantFilter:!0,defaultFilter:"policy_id = ".concat(S.id),policyId:S.id,tableProps:{rowWrapper:I},ruleSeverityFilter:!0}))))))};P.propTypes={route:i().object};const O=P;var D,Z=(0,p.ZP)(D||(D=(0,r.Z)(["\n  query RD_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      testResultHostCount\n      compliantHostCount\n      unsupportedHostCount\n      complianceThreshold\n      osMajorVersion\n      lastScanned\n      policyType\n      policy {\n        id\n        name\n      }\n      businessObjective {\n        id\n        title\n      }\n    }\n  }\n"]))),j=function(e){var t,n,r=e.route,o=(0,s.useParams)().report_id,l=(0,E.ZP)("pdfReport"),i=(0,c.a)(Z,{variables:{policyId:o},fetchPolicy:"no-cache"}),p=i.data,w=i.error,C=i.loading,R={};return!C&&p&&(t=(R=p.profile).policy.name,n="Report: ".concat(t)),(0,b.a)(r,t),a().createElement(h.tC,{stateValues:{error:w,data:p,loading:C}},a().createElement(h.K7,{stateKey:"loading"},a().createElement(d.Z,null,a().createElement(h.Tq,null)),a().createElement("section",{className:"pf-c-page__main-section"},a().createElement(f.Z,null,a().createElement(y.Z,null)))),a().createElement(h.K7,{stateKey:"data"},a().createElement(d.Z,null,a().createElement(m.Breadcrumb,{ouiaId:"ReportDetailsPathBreadcrumb"},a().createElement(h.MU,{to:"/"},"Compliance"),a().createElement(h.MU,{to:"/reports"},"Reports"),a().createElement(m.BreadcrumbItem,{isActive:!0},n)),a().createElement(m.Grid,{hasGutter:!0},a().createElement(m.GridItem,{sm:9,md:9,lg:9,xl:9},a().createElement(u.Z,{title:n}),a().createElement(h.Zr,null,R.policyType)),a().createElement(m.GridItem,{className:"report-details-button",sm:3,md:3,lg:3,xl:3},l&&a().createElement(h.mR,{state:{profile:R},to:"/reports/".concat(R.id,"/pdf"),component:h.Qj,ouiaId:"ReportDetailsDownloadReportPDFLink",variant:"plain",className:"pf-u-mr-md"},"Download PDF"),a().createElement(h.mR,{state:{profile:R},to:"/reports/".concat(R.id,"/delete"),component:h.Qj,variant:"link",ouiaId:"ReportDetailsDeleteReportLink",isInline:!0},"Delete report"))),a().createElement(m.Grid,{hasGutter:!0},a().createElement(m.GridItem,{sm:12,md:12,lg:12,xl:6},a().createElement("div",{className:"chart-inline"},a().createElement("div",{className:"chart-container"},a().createElement(x.Z,{profile:R,hasLegend:!0,chartClass:"report-details-chart-container"})))),a().createElement(m.GridItem,{sm:12,md:12,lg:12,xl:6},a().createElement(h.vu,{profile:R})))),a().createElement("section",{className:"pf-c-page__main-section"},a().createElement(m.Grid,{hasGutter:!0},a().createElement(m.GridItem,{span:12},a().createElement(g.r0,{showOsMinorVersionFilter:[R.osMajorVersion],columns:[v.Zw({showLink:!0,showOsInfo:!0}),v.MO("tags"),v.hN,v.ll,v.OF,v.Hc],showOnlySystemsWithTestResults:!0,compliantFilter:!0,defaultFilter:"with_results_for_policy_id = ".concat(R.id),policyId:R.id}))))))};j.propTypes={route:i().object};const F=function(e){return(0,E.ZP)("systemsNotReporting")?a().createElement(O,e):a().createElement(j,e)}},80412:(e,t,n)=>{n.r(t),n.d(t,{ReportDownload:()=>F,default:()=>G});var r,o,a=n(87462),l=n(92950),i=n.n(l),s=n(65115),c=n(96620),p=n(90570),m=n(85836),d=n(52710),u=n(30168),f=n(67521),y={compliantSystems:!1,nonCompliantSystems:!0,unsupportedSystems:!0,nonReportingSystems:!0,topTenFailedRules:!0,userNotes:void 0},h=(0,f.ZP)(r||(r=(0,u.Z)(["\n  query PDF_Profile($policyId: String!) {\n    profile(id: $policyId) {\n      id\n      name\n      refId\n      testResultHostCount\n      compliantHostCount\n      unsupportedHostCount\n      complianceThreshold\n      osMajorVersion\n      lastScanned\n      policyType\n      totalHostCount\n      policy {\n        id\n        name\n      }\n      benchmark {\n        id\n      }\n      businessObjective {\n        id\n        title\n      }\n    }\n  }\n"]))),b=((0,f.ZP)(o||(o=(0,u.Z)(["\n  query PDF_Profiles($filter: String!, $policyId: ID!) {\n    profiles(search: $filter) {\n      totalCount\n      edges {\n        node {\n          topFailedRules(policyId: $policyId) {\n            refId\n            title\n            remediationAvailable\n            severity\n            identifier\n            failedCount\n          }\n        }\n      }\n    }\n  }\n"]))),n(45697)),E=n.n(b),g=n(77346),v=function(e){var t=e.policy,n=e.setExportSetting,r=e.exportSettings,o=(0,g.ZP)("systemsNotReporting");return i().createElement(s.Form,null,i().createElement(s.FormGroup,{isInline:!0,fieldId:"simple-form-checkbox-group",label:"Policy"},i().createElement(s.Text,null,t.name)),i().createElement(s.FormGroup,{fieldId:"simple-form-checkbox-group",label:"System data to include"},i().createElement(s.Checkbox,{label:"Non-compliant systems",id:"non-compliant-systems-export-setting","aria-label":"Non-compliant systems",onChange:n("nonCompliantSystems"),isChecked:r.nonCompliantSystems}),i().createElement(s.Checkbox,{label:"Systems with unsupported configuration",id:"unsupported-systems-export-setting","aria-label":"Systems with unsupported configuration",onChange:n("unsupportedSystems"),isChecked:r.unsupportedSystems}),o&&i().createElement(s.Checkbox,{label:"Systems with no reports",id:"nonreporting-systems-export-setting","aria-label":"Systems never reported",onChange:n("nonReportingSystems"),isChecked:r.nonReportingSystems}),i().createElement(s.Checkbox,{id:"compliant-systems-export-setting",onChange:n("compliantSystems"),isChecked:r.compliantSystems,label:"Compliant systems","aria-label":"Compliant systems"})),i().createElement(s.FormGroup,{label:"Rule data to include",fieldId:"checkbox01"},i().createElement(s.Checkbox,{id:"failed-rules-export-setting",label:"Top failed rules (Up to 10)","aria-label":"Rule data to include",onChange:n("topTenFailedRules"),isChecked:r.topTenFailedRules})),i().createElement(s.FormGroup,{label:"User notes (optional)",fieldId:"checkbox01"},i().createElement(s.TextArea,{"aria-label":"User notes (optional)",onChange:n("userNotes"),value:r.userNotes})))};v.propTypes={policy:E().object,exportSettings:E().object,setExportSetting:E().func};const w=v;var C=n(83215),R=new URL("/api/crc-pdf-generator/v1/generate",window.location.origin),I=function(e,t,n){return fetch(R,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({service:e,template:t,params:n})}).then((function(e){return e.blob()}))};const S=function(e,t){return function(n,r,o){return a=void 0,l=void 0,s=function(){return function(e,t){var n,r,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,r=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((o=(o=l.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){l.label=a[1];break}if(6===a[0]&&l.label<o[1]){l.label=o[1],o=a;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(a);break}o[2]&&l.ops.pop(),l.trys.pop();continue}a=t.call(e,l)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}(this,(function(a){switch(a.label){case 0:t((0,C.wN)({variant:"info",title:"Preparing export",description:"Once complete, your download will start automatically."})),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,I(e,n,o)];case 2:return function(e,t){void 0===t&&(t="new-report");var n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove()}(a.sent(),r),t((0,C.wN)({variant:"success",title:"Downloading export"})),[3,4];case 3:return a.sent(),t((0,C.wN)({variant:"danger",title:"Couldn’t download export",description:"Reinitiate this export to try again."})),[3,4];case 4:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function n(e){try{o(s.next(e))}catch(e){t(e)}}function r(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i((function(e){e(o)}))).then(n,r)}o((s=s.apply(a,l||[])).next())}));var a,l,i,s}};var x=n(4942),k=n(70885),P=n(35937),O=n.n(P);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=n(28216),F=function(){var e=(0,c.useParams)().report_id,t=(0,j.I0)(),n=(0,d.C3)("/reports/"+e),r=(0,p.a)(h,{variables:{policyId:e}}),o=r.data,u=r.loading,f=r.error,b=null==o?void 0:o.profile,E=function(){var e,t=(0,g.ZP)("systemsNotReporting"),n=(0,l.useState)((e=t,O()(y,(function(t,n){return!("nonReportingSystems"===n&&!e)})))),r=(0,k.Z)(n,2),o=r[0],a=r[1];return{exportSettings:o,setExportSetting:function(e){return function(t){return a(Z(Z({},o),{},(0,x.Z)({},e,t)))}},isValid:Object.keys(o).some((function(e){return 1==("userNotes"!==e&&!!o[e])}))}}(),v=E.exportSettings,C=E.setExportSetting,R=E.isValid,I=S("compliance",t),P={ouiaId:"ExportReportButton",variant:"primary",isDisabled:!R},D=[i().createElement(s.Button,(0,a.Z)({key:"export",onClick:function(){var e="compliance-report--".concat((new Date).toISOString().split("T")[0]);I("report",e,v)}},P,{className:"pf-u-mr-sm"}),"Export report"),i().createElement(s.Button,{variant:"secondary",key:"cancel",ouiaId:"ExportReportCancelButton",onClick:function(e){e.preventDefault(),window.history.back()}},"Cancel")];return i().createElement(m.C,{isOpen:!0,width:"440px",ouiaId:"DownloadReportModal",title:"Compliance report",onClose:function(){return n()},actions:D},i().createElement(m.tC,{stateValues:{error:f,data:o,loading:u}},i().createElement(m.K7,{stateKey:"loading"},i().createElement(s.Spinner,null)),i().createElement(m.K7,{stateKey:"data"},i().createElement(w,{policy:b,setExportSetting:C,exportSettings:v}))))};const G=F}}]);