"use strict";(self.webpackChunkcompliance_frontend=self.webpackChunkcompliance_frontend||[]).push([[705,402],{48497:(e,t,n)=>{n.r(t),n.d(t,{PolicyDetails:()=>M,default:()=>L});var r=n(92950),i=n.n(r),o=n(45697),a=n.n(o),l=n(96620),c=n(65115),s=n(89376),u=n(39173),d=n(97481),m=n(85836),p=n(7648),f=n(94263),y=n(52710),v=function(e){var t=e.policy,n=(0,y.Wb)();return i().createElement(c.ToolbarItem,null,i().createElement(m.mR,{to:"/scappolicies/".concat(t.id,"/edit"),hash:n,backgroundLocation:{hash:n},variant:"primary",ouiaId:"EditRulesButton",component:m.Qj},"Edit rules"))};v.propTypes={policy:a().object.isRequired};const b=v;var h=function(e){var t=e.loading,n=e.policy,r=n.policy.profiles.find((function(e){return e.refId===n.refId}));return i().createElement(i().Fragment,null,i().createElement(c.Alert,{isInline:!0,ouiaId:"RuleEditingAvailableAlert",variant:"info",title:"Rule editing is now available."},'SCAP policies created before April 19th, 2021 with rule editing will use the full default set of rules for the policy with the most accurate benchmark for systems within the policy. Click the "Edit rules" or "Edit policy" button to edit rules.'),i().createElement(c.PageSection,{variant:c.PageSectionVariants.light},i().createElement(c.Text,{component:c.TextVariants.p},i().createElement("strong",null,"What rules are shown on this list?Â "),"This view shows rules that are from the latest SSG version (",null==r?void 0:r.benchmark.version,"). If you are using a different version of SSG for systems in this policy, those rules will be different and can be viewed on the systems details page.")),i().createElement(m.iK,{remediationsEnabled:!1,columns:[f.VG,f.zb,f.uH],loading:t,profileRules:[{profile:{refId:n.refId,name:n.name},rules:(null==r?void 0:r.rules)||[]}],options:{dedicatedAction:function(){return i().createElement(b,{policy:n})}}}))};h.propTypes={loading:a().bool,policy:a().shape({name:a().string,refId:a().string,policy:a().shape({profiles:a().shape([{rules:a().array,benchmark:a().object}]).isRequired})})};const E=h;var g=n(6084),j=n(31499),P=function(e){var t=e.to,n=e.hash,r=e.backgroundLocation,o=e.variant,a=e.ouiaId;return i().createElement(c.ToolbarItem,null,i().createElement(m.mR,{to:t,hash:n,backgroundLocation:r,variant:o,ouiaId:a,component:m.Qj},"Edit systems"))};P.propTypes={to:a().string.required,state:a().object,hash:a().object,backgroundLocation:a().object,variant:a().string.required,ouiaId:a().string.required};const T=P;var I=function(e){var t,n=e.policy,r=(0,y.Wb)();return i().createElement(g.r0,{columns:[j.Zw({showLink:!0}),j.MO("tags"),j.OS,j.hN],showOsMinorVersionFilter:[n.osMajorVersion],policyId:n.id,defaultFilter:"policy_id = ".concat(n.id),showActions:!1,remediationsEnabled:!1,noSystemsTable:0===(null==n||null===(t=n.hosts)||void 0===t?void 0:t.length)&&i().createElement(m.JS,null),complianceThreshold:n.complianceThreshold,dedicatedAction:i().createElement(T,{to:"/scappolicies/".concat(n.id,"/edit"),hash:r,backgroundLocation:{hash:"details"},variant:"primary",ouiaId:"EditSystemsButton"})})};I.propTypes={policy:a().shape({id:a().string.isRequired,complianceThreshold:a().number.isRequired,osMajorVersion:a().string.isRequired,hosts:a().array.isRequired}),dedicatedAction:a().object,systemTableProps:a().object};const O=I;var R=n(99030),w=n(79886),V=function(e){var t=e.policy,n=e.saveToPolicy,r=e.onRuleValueReset,o=t.hosts,a=t.policy.profiles,l=a.filter((function(e){return!!e.osMinorVersion})),s=(0,R.UP)(o),u=l.sort((0,w.Sj)("osMinorVersion","desc")).map((function(e){var t;return{profile:e,systemCount:(null===(t=s[e.osMinorVersion])||void 0===t?void 0:t.count)||0}}));return i().createElement(i().Fragment,null,i().createElement(c.PageSection,{variant:c.PageSectionVariants.light},i().createElement(m.Hv,{tabsData:u,setRuleValues:n,onRuleValueReset:r,ruleValues:Object.fromEntries(a.map((function(e){return[e.id,e.values]}))),columns:[f.VG,f.zb,f.uH],level:1,options:{dedicatedAction:function(){return i().createElement(b,{policy:t})}},ouiaId:"RHELVersions"})))};V.propTypes={policy:a().object.isRequired,saveToPolicy:a().func,onRuleValueReset:a().func};const k=V;var S=n(4942),q=n(70885),A=n(67026),D=n(65811);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,S.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=n(79315),M=function(e){var t=e.route,n="details",o=(0,l.useParams)().policy_id,a=(0,C.Z)({policyId:o}),f=a.data,y=a.error,v=a.loading,b=a.refetch,h=(0,l.useLocation)(),g=null==f?void 0:f.profile,j=!(null==g||!g.policy.profiles.find((function(e){return!!e.osMinorVersion}))),P=function(e,t){var n=(0,A.Z)(),i=(0,r.useCallback)((function(t){var n=e.policy.profiles.find((function(e){return e.id===t}));return Object.fromEntries(Object.entries((null==n?void 0:n.values)||{}).map((function(e){var t,r=(0,q.Z)(e,2),i=r[0],o=r[1];return[(null===(t=n.benchmark.valueDefinitions.find((function(e){return e.id===i})))||void 0===t?void 0:t.refId)||i,o]})))}),[e]);return(0,r.useCallback)((function(r,i,o){var a=e.policy.profiles.find((function(e){return e.id===r})),l=Object.fromEntries(Object.entries((null==a?void 0:a.values)||{}).map((function(e){var t,n=(0,q.Z)(e,2),r=n[0],i=n[1];return[(null===(t=a.benchmark.valueDefinitions.find((function(e){return e.id===r})))||void 0===t?void 0:t.refId)||r,i]})));return n(r,{values:Z(Z({},l),{},(0,S.Z)({},i.refId,o))}).then((function(){(0,D.q)({variant:"success",title:"Rule value updated",autoDismiss:!0})})).catch((function(e){(0,D.q)({variant:"danger",title:"Error updating rule value",description:e.message})})).finally((function(){return t()}))}),[i,e])}(g,(function(){b()}));return(0,r.useEffect)((function(){b()}),[h,b]),(0,p.a)(t,null==g?void 0:g.name),i().createElement(m.tC,{stateValues:{error:y,data:f,loading:v}},i().createElement(m.K7,{stateKey:"loading"},i().createElement(s.Z,null,i().createElement(m.PL,null)),i().createElement("section",{className:"pf-c-page__main-section"},i().createElement(d.Z,null))),i().createElement(m.K7,{stateKey:"data"},g?i().createElement(r.Fragment,null,i().createElement(s.Z,{className:"page-header-tabs"},i().createElement(c.Breadcrumb,{ouiaId:"PolicyDetailsPathBreadcrumb"},i().createElement(m.MU,{to:"/"},"Compliance"),i().createElement(m.MU,{to:"/scappolicies"},"SCAP policies"),i().createElement(c.BreadcrumbItem,{isActive:!0},g.name)),i().createElement(c.Grid,{gutter:"lg"},i().createElement(c.GridItem,{xl2:11,xl:10,lg:12,md:12,sm:12},i().createElement(u.Z,{title:g.name}))),i().createElement(m.tn,{"aria-label":"Policy Tabs",ouiaId:"PolicyDetailsTabs",defaultTab:n},i().createElement(c.Tab,{title:"Details",id:"policy-details",eventKey:"details"}),i().createElement(c.Tab,{title:"Rules",id:"policy-rules",eventKey:"rules"}),i().createElement(c.Tab,{title:"Systems",id:"policy-systems",eventKey:"systems"}))),i().createElement("section",{className:"pf-c-page__main-section"},i().createElement(m.Jm,{defaultTab:n},i().createElement(m.X8,{eventKey:"details"},i().createElement(m.NP,{policy:g})),i().createElement(m.X8,{eventKey:"rules"},j?i().createElement(k,{policy:g,saveToPolicy:P,onRuleValueReset:function(){return b()}}):i().createElement(E,{policy:g})),i().createElement(m.X8,{eventKey:"systems"},i().createElement(O,{policy:g}))))):""))};M.propTypes={route:a().object};const L=M}}]);
//# sourceMappingURL=../sourcemaps/PolicyDetails.2a3b408b53d280e89b7a4da9ea902b34.js.map