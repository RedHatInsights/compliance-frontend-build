{"version":3,"sources":["webpack://compliance-frontend/./src/SmartComponents/ComplianceSystems/ComplianceSystems.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/CreateSCAPPolicy.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/EditPolicyProfilesRules.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/EditPolicyRules.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/EditPolicySystems.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/EditPolicyDetails.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/ReviewCreatedPolicy.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/FinishedCreatePolicy.js","webpack://compliance-frontend/./src/SmartComponents/CreatePolicy/CreatePolicy.js","webpack://compliance-frontend/./src/SmartComponents/EditPolicy/EditPolicyDetailsTab.js","webpack://compliance-frontend/./src/SmartComponents/EditPolicy/EditPolicyRulesTab.js","webpack://compliance-frontend/./src/SmartComponents/EditPolicy/EditPolicySystemsTab.js","webpack://compliance-frontend/./src/SmartComponents/EditPolicy/EditPolicy.js","webpack://compliance-frontend/./src/SmartComponents/EditPolicy/usePolicy.js","webpack://compliance-frontend/./src/SmartComponents/SystemsTable/Cells.js","webpack://compliance-frontend/./src/SmartComponents/SystemsTable/SystemsTable.js","webpack://compliance-frontend/./src/SmartComponents/SystemsTable/constants.js","webpack://compliance-frontend/./src/SmartComponents/InventoryDetails/InventoryDetails.js","webpack://compliance-frontend/./src/SmartComponents/SystemsTable/InventoryTable.js","webpack://compliance-frontend/./src/Utilities/Export.js","webpack://compliance-frontend/./src/Utilities/hooks/api/utils/ApiClient.js","webpack://compliance-frontend/./src/Utilities/hooks/api/useApi.js","webpack://compliance-frontend/./src/Utilities/hooks/api/useCollection.js","webpack://compliance-frontend/./src/Utilities/ruleHelpers.js","webpack://compliance-frontend/./src/store/ActionTypes.js","webpack://compliance-frontend/./src/store/Reducers/SystemStore.js"],"names":["QUERY","gql","ComplianceSystems","newInventory","useFeature","useQuery","data","error","loading","dispatch","useDispatch","columns","key","title","props","width","isStatic","renderFunc","systemName","policyNames","policiesCell","id","detailsLink","testResultProfiles","policies","profiles","edges","map","node","useLayoutEffect","type","payload","ids","InvComponent","InventoryTable","SystemsTable","className","stateValues","stateKey","query","GET_SYSTEMS","defaultFilter","systemProps","isFullView","showOsFilter","showComplianceSystemsInfo","enableEditPolicy","remediationsEnabled","BENCHMARKS_AND_PROFILES","CreateSCAPPolicy","change","selectedBenchmarkId","fetchPolicy","Spinner","selectedBenchmark","validProfiles","benchmark","benchmarks","latestBenchmarks","find","userProfileRefIds","filter","profile","refId","disabled","includes","TextContent","Text","component","TextVariants","Form","FormGroup","label","isRequired","fieldId","sort","a","b","localeCompare","osMajorVersion","Button","onClick","setBenchmark","variant","propTypes","reduxFormPropTypes","selector","formValueSelector","compose","connect","state","reduxForm","form","destroyOnUnmount","forceUnregisterOnUnmount","PROFILES_QUERY","EditPolicyProfilesRules","policy","selectedRuleRefIds","osMinorVersionCounts","selectRulesTableColumns","useCollection","include","params","search","i","osMinorVersion","join","benchmarksLoading","profileIds","tabsData","profileSelectedRuleRefIds","systemCount","count","latestSupportedOsMinorVersions","getBenchmarkBySupportedOsMinor","collection","profileRefId","benchmarkProfile","getBenchmarkProfile","rules","relationships","push","newOsMinorVersion","ruleRefIds","skipProfilesQuery","length","variables","skip","profilesData","dataState","undefined","loadingState","noRuleSets","p","rule","name","EmptyState","Title","headingLevel","size","EmptyStateBody","EmptyTable","selectedFilter","level","handleSelect","newSelectedRuleRefIds","newSelection","JSON","parse","EditPolicyRules","ruleIds","filteredRules","profileId","benchmarkId","multiversionRules","useState","defaultSelection","setDefaultSelection","profileRules","useEffect","ruleId","isInline","SystemRulesTable","tailoringEnabled","remediationAvailableFilter","selectedRefIds","EditPolicyRulesComponent","Component","EditPolicySystems","selectedSystemIds","displayName","_id","emptyStateComponent","WizardContextConsumer","goToStepById","prependComponent","InvCmp","compact","showActions","GET_SYSTEMS_WITHOUT_FAILED_RULES","enableExport","defaultProps","countOsMinorVersions","entities","selectedEntities","e","EditPolicyDetails","description","Field","ReduxFormTextInput","aria-describedby","isDisabled","ReduxFormTextArea","defaultValue","businessObjective","showTitle","previousThreshold","complianceThreshold","initialValues","REVIEW","ReviewCreatedPolicy","parentProfileName","TextList","TextListVariants","TextListItem","TextListItemVariants","style","parseFloat","rulesCount","FinishedCreatePolicy","listErrors","secondaryActions","onWizardFinish","cloneFromProfileId","systemIds","percent","setPercent","message","setMessage","errors","setErrors","failed","setFailed","updatePolicy","usePolicy","onProgress","progress","newPolicy","hosts","then","catch","networkError","result","Array","isArray","ListItem","Bullseye","EmptyStateVariant","EmptyStateIcon","icon","WrenchIcon","List","EmptyStateSecondaryActions","client","withApollo","CreatePolicy","history","useHistory","stepIdReached","setStepIdReached","resetAnchor","location","hash","onClose","steps","enableNext","validateBenchmarkPage","canJumpTo","validateDetailsPage","validateSystemsPage","validateRulesPage","nextButtonText","isFinishedStep","Wizard","isOpen","onNext","onGoToStep","onBack","EditPolicyDetailsTab","setUpdatedPolicy","validThreshold","setValidThreshold","threshold","valid","thresholdValid","useThresholdValidate","validateThreshold","TextArea","height","onChange","value","TextInput","validated","helperTextInvalid","helperText","complianceThresholdValid","EditPolicyRulesTab","benchmarkSearch","Object","keys","values","sortingByProp","parentProfileId","forEach","tab","refIds","EditPolicySystemsTab","policyOsMinorVersions","selectedSystemOsMinorVersions","useSelector","entity","systemOsMinorVersion","Alert","actionLinks","AlertActionLink","MULTIVERSION_QUERY","profilesToOsMinorMap","reduce","acc","mapCountOsMinorVersions","EditPolicy","route","policyId","useParams","policy_id","policyProfiles","anchor","useAnchor","updatedPolicy","setSelectedRuleRefIds","setOsMinorVersionCounts","linkToBackground","useLinkToBackground","isSaving","setIsSaving","saveEnabled","linkToBackgroundWithHash","actions","spinnerAriaValueText","isLoading","updateSelectedRuleRefIds","policyProfile","useTitleEntity","Modal","defaultTab","Tab","eventKey","TabTitleText","filteredSelection","selectedProfile","uniq","create","createBusinessObjective","useMutation","CREATE_BUSINESS_OBJECTIVE","newBusinessObjective","input","UPDATE_PROFILE","updateProfile","CREATE_PROFILE","createProfile","associateSystems","ASSOCIATE_SYSTEMS_TO_PROFILES","h","useAssociateSystems","associateRules","ASSOCIATE_RULES_TO_PROFILE","ruleInput","useAssociateRules","expectedUpdates","dispatchProgress","businessObjectiveId","policyInput","SSGVersion","supported","ssgVersion","messageVariant","initFilterState","filterConfig","initialDefaultState","initialState","page","policyFilter","osFilter","systemsPolicyFilterConfiguration","systemsOsFilterConfiguration","registry","React","FilterConfigBuilder","DEFAULT_SYSTEMS_FILTER_CONFIGURATION","compliantFilter","COMPLIANT_SYSTEMS_FILTER_CONFIGURATION","getChipBuilder","getFilterBuilder","perPage","totalCount","activeFilters","clearAll","preselectedSystems","Promise","resolve","selectEntities","updateSystems","prevProps","per_page","options","showAllSystems","inventory","current","setState","onRefreshData","showOnlySystemsWithTestResults","filterBuilder","buildFilterString","fetchResults","prevSystems","systems","s","fetchSystems","items","systemsCount","newSystems","stringify","updateRows","prevState","_","format","exportFromState","selectedValues","chips","removeFilterWithChip","_event","clearAllFilter","deleteFilter","selectAll","clearSelection","allSelectedOnPage","total","noError","this","selectedEntitiesIds","buildConfiguration","onFilterUpdate","hideLabel","filterChips","chipBuilder","chipsFor","exportConfig","isExportDisabled","onSelect","onExportSelect","inventoryTableProps","onRefresh","ref","tableProps","canSelectAll","bulkSelect","checked","onBulkSelect","_index","beta","window","pathname","split","href","origin","edge","activeFiltersConfig","filters","onDelete","onFilterDelete","TableVariant","rows","cells","hasItems","hasCheckbox","dedicatedAction","ComplianceRemediationButton","allSystems","systemsWithRuleObjectsFailed","selectedRules","fallback","SkeletonTable","colSize","rowSize","onLoad","INVENTORY_ACTION_TYPES","mergeWithEntities","getRegistry","register","entitiesReducer","clearInventoryFilter","ConnectedSystemsTable","memo","SystemsTableWithApollo","row","args","SELECT_ENTITY","InventoryDetails","registryDecorator","DetailWrapper","mergeWithDetail","InventoryDetail","Skeleton","SkeletonSize","hideBack","store","useStore","useRef","pagination","setPagination","isLoaded","setIsLoaded","isEmpty","setIsEmpty","useFilterConfig","conditionalFilter","system","shallowEqual","filterString","combindedFilter","debounceFetchSystems","useCallback","debounce","empty","systemsReducer","callback","every","selected","isSelected","getState","PropTypes","getNestedObject","nestedObj","path","obj","textCsvCell","cell","exportValue","content","csvRows","column","concat","noExport","encodeURI","csvFromState","object","jsonFromState","filename","link","document","createElement","setAttribute","dispatchEvent","MouseEvent","bubbles","cancelable","view","linkAndDownload","CSV_FILE_PREFIX","Date","toISOString","Accept","apiBase","authenticate","onUnauthorised","defaultHeaders","headers","DEFAULT_API_HEADERS","apiProps","method","callAuthenticate","fetch","checkForEmptyResponse","response","checkForErrors","json","finalCatch","promise","reject","credentials","fullPath","url","URL","encodeURIComponent","URLSearchParams","body","status","ignore404","responseCloneJson","clone","request","ApiClient","includeAttributes","prop","attributes","newEntity","includePropAndDelete","normalizeData","jsonNormalized","normalize","normalizedJson","entries","item","relationship","relationshipData","v","includeRelationship","fetchCollection","apiClient","get","normalized","meta","effects","collectionState","setCollectionState","useApi","COMPLIANCE_API_ROOT","profilesRulesFailed","flatMap","compliant","profilesRulesPassed","systemRulesFailed","ruleObjectsFailed","EXPORT","NEVER","lastScanned","dates","last","Math","max","apply","date","isFinite","score","scoreTotal","numScored","Tooltip","lines","Link","to","hasOsInfo","matchingSystem","displayNameCell","display_name","profilesSsgVersions","version","systemsToInventoryEntities","facts","rulesPassed","rulesFailed","account","bios_uuid","created","fqdn","insights_id","ip_addresses","mac_addresses","rhel_machine_id","satellite_id","subscription_manager_id","tags","updated","hostname","machine_id","release","compliance","details_link","rules_passed","rules_failed","hidePassed","rules_failed_text","compliance_score","complianceScore","compliance_score_text","complianceScoreString","last_scanned","last_scanned_text","ssg_version","systemsToRows","selectRowsByIds","rowsToSelect","deselectRowsByIds","selectAllRows","deselectAllRows","selectRow","deselectRow","INVENTORY_ACTION","applyReducerHash","loaded","LOAD_ENTITIES_PENDING","LOAD_ENTITIES_FULFILLED","newState"],"mappings":"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","file":"js/EditPolicy.3d2107336a34dbdeb25d.js","sourcesContent":["/* eslint-disable react/display-name */\nimport React, { useLayoutEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/react-hooks';\nimport PageHeader, { PageHeaderTitle } from '@redhat-cloud-services/frontend-components/PageHeader';\nimport Main from '@redhat-cloud-services/frontend-components/Main';\nimport { StateViewPart, StateViewWithError } from 'PresentationalComponents';\nimport { InventoryTable, SystemsTable } from 'SmartComponents';\nimport { GET_SYSTEMS } from '../SystemsTable/constants';\nimport { systemName, detailsLink, policiesCell } from 'Store/Reducers/SystemStore';\nimport useFeature from 'Utilities/hooks/useFeature';\n\nconst QUERY = gql`\n{\n    profiles(search: \"external = false and canonical = false\") {\n        edges {\n            node {\n                id\n                name\n                refId\n                majorOsVersion\n            }\n        }\n    }\n}\n`;\n\nconst DEFAULT_FILTER = 'has_test_results = true or has_policy = true';\n\nexport const ComplianceSystems = () => {\n    const newInventory = useFeature('newInventory');\n    const { data, error, loading } = useQuery(QUERY);\n    const dispatch = useDispatch();\n    const columns = [{\n        key: 'facts.compliance.display_name',\n        title: 'Name',\n        props: {\n            width: 40, isStatic: true\n        },\n        ...newInventory && {\n            key: 'display_name',\n            renderFunc: systemName\n        }\n    }, {\n        key: 'facts.compliance.policies',\n        title: 'Policies',\n        props: {\n            width: 40, isStatic: true\n        },\n        ...newInventory && {\n            key: 'policyNames',\n            renderFunc: (policyNames) => {\n                const { title } = policiesCell({ policyNames }) || { title: '' };\n                return title;\n            }\n        }\n    }, {\n        key: 'facts.compliance.details_link',\n        title: '',\n        props: {\n            width: 20, isStatic: true\n        },\n        ...newInventory && {\n            key: 'testResultProfiles',\n            renderFunc: (data, id) => {\n                const { title } = detailsLink({ testResultProfiles: data, id }) || { title: '' };\n                return title;\n            }\n        }\n    }];\n    const policies = data?.profiles?.edges.map(({ node }) => node);\n\n    useLayoutEffect(() => { dispatch({ type: 'SELECT_ENTITIES', payload: { ids: [] } }); }, []);\n\n    const InvComponent = newInventory ? InventoryTable : SystemsTable;\n\n    return (\n        <React.Fragment>\n            <PageHeader className='page-header'>\n                <PageHeaderTitle title=\"Systems\" />\n            </PageHeader>\n            <Main>\n                <StateViewWithError stateValues={ { error, data, loading } }>\n                    <StateViewPart stateKey=\"data\">\n                        { policies && <InvComponent\n                            query={GET_SYSTEMS}\n                            defaultFilter={ DEFAULT_FILTER }\n                            systemProps={{\n                                isFullView: true\n                            }}\n                            showOsFilter\n                            showComplianceSystemsInfo\n                            enableEditPolicy={ false }\n                            remediationsEnabled={ false }\n                            columns={ columns }\n                            policies={ policies } /> }\n                    </StateViewPart>\n                </StateViewWithError>\n            </Main>\n        </React.Fragment>\n    );\n};\n\nexport default ComplianceSystems;\n","import React from 'react';\nimport {\n    Button,\n    Form,\n    FormGroup,\n    Text,\n    TextContent,\n    TextVariants\n} from '@patternfly/react-core';\nimport { ProfileTypeSelect } from 'PresentationalComponents';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/react-hooks';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport { propTypes as reduxFormPropTypes, formValueSelector, reduxForm } from 'redux-form';\nimport { connect, useDispatch } from 'react-redux';\nimport { compose } from 'redux';\nimport propTypes from 'prop-types';\n\nconst BENCHMARKS_AND_PROFILES = gql`\nquery benchmarksAndProfiles {\n    latestBenchmarks {\n        id\n        title\n        refId\n        version\n        osMajorVersion\n        profiles {\n            id\n            name\n            refId\n            description\n            complianceThreshold\n        }\n    }\n    profiles(search: \"external = false and canonical = false\") {\n        edges {\n            node {\n                id\n                refId\n                benchmark {\n                    refId\n                }\n            }\n        }\n    }\n}\n`;\n\nconst CreateSCAPPolicy = ({ change, selectedBenchmarkId }) => {\n    const { data, error, loading } = useQuery(BENCHMARKS_AND_PROFILES, { fetchPolicy: 'no-cache' });\n\n    const inUseProfileRefIds = (profiles, benchmark) => (\n        profiles.filter(profile => benchmark.refId === profile.node.benchmark.refId).map(profile => profile.node.refId)\n    );\n\n    const dispatch = useDispatch();\n\n    if (error) { return error; }\n\n    if (loading) { return <Spinner/>; }\n\n    const benchmarks = data.latestBenchmarks;\n    let selectedBenchmark;\n    let validProfiles;\n    if (selectedBenchmarkId) {\n        selectedBenchmark = benchmarks.find(benchmark => benchmark.id === selectedBenchmarkId);\n        const userProfileRefIds = inUseProfileRefIds(data.profiles.edges, selectedBenchmark);\n        validProfiles = selectedBenchmark.profiles.map((profile) => ({\n            ...profile,\n            disabled: userProfileRefIds.includes(profile.refId)\n        }));\n    }\n\n    const setBenchmark = ({ id, osMajorVersion }) => {\n        if (selectedBenchmark?.osMajorVersion !== osMajorVersion) {\n            change('systems', []);\n            dispatch({\n                type: 'SELECT_ENTITIES',\n                payload: { ids: [] }\n            });\n        }\n\n        change('benchmark', id);\n        change('osMajorVersion', osMajorVersion);\n    };\n\n    return (\n        <React.Fragment>\n            <TextContent>\n                <Text component={TextVariants.h1} className=\"pf-u-mb-md\">\n                    Create SCAP policy\n                </Text>\n                <Text className=\"pf-u-mb-md\">\n                    Select the operating system and policy type for this policy.\n                </Text>\n            </TextContent>\n            <Form>\n                <FormGroup\n                    label=\"Operating system\"\n                    isRequired\n                    fieldId=\"benchmark\">\n                    { benchmarks && benchmarks.sort((a, b) => a.refId.localeCompare(b.refId)).map((benchmark) => {\n                        const { id, osMajorVersion } = benchmark;\n                        return (\n                            <Button key={id} onClick={ () => setBenchmark(benchmark) }\n                                className={`wizard-os-button ${selectedBenchmarkId === id ? 'active-wizard-os-button' : ''}`}\n                                variant=\"tertiary\">\n                                { `RHEL ${osMajorVersion}` }\n                            </Button>\n                        );\n                    })}\n                </FormGroup>\n                <FormGroup label=\"Policy type\" isRequired fieldId=\"policy-type\">\n                    <ProfileTypeSelect\n                        profiles={selectedBenchmark && validProfiles }\n                        onClick={ () => {\n                            change('selectedRuleRefIds', null);\n                        }}/>\n                </FormGroup>\n            </Form>\n        </React.Fragment>\n    );\n};\n\nCreateSCAPPolicy.propTypes = {\n    selectedBenchmarkId: propTypes.string,\n    change: reduxFormPropTypes.change\n};\n\nconst selector = formValueSelector('policyForm');\n\nexport default compose(\n    connect(\n        state => ({\n            selectedBenchmarkId: selector(state, 'benchmark')\n        })\n    ),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(CreateSCAPPolicy);\n","import React, { useLayoutEffect } from 'react';\nimport { propTypes as reduxFormPropTypes, formValueSelector, reduxForm } from 'redux-form';\nimport {\n    selectColumns as selectRulesTableColumns\n} from '@redhat-cloud-services/frontend-components-inventory-compliance/SystemRulesTable';\nimport EmptyTable from '@redhat-cloud-services/frontend-components/EmptyTable';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport {\n    Title, Text, TextContent, TextVariants,\n    EmptyState, EmptyStateBody\n} from '@patternfly/react-core';\nimport gql from 'graphql-tag';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport propTypes from 'prop-types';\nimport { useQuery } from '@apollo/react-hooks';\nimport { StateViewWithError, StateViewPart, TabbedRules } from 'PresentationalComponents';\nimport useCollection from 'Utilities/hooks/api/useCollection';\n\nconst PROFILES_QUERY = gql`\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n`;\n\nconst getBenchmarkProfile = (benchmark, profileRefId) => (\n    benchmark.profiles.find((benchmarkProfile) => (benchmarkProfile.refId === profileRefId))\n);\n\nconst getBenchmarkBySupportedOsMinor = (benchmarks, osMinorVersion) => (\n    benchmarks.find((benchmark) =>\n        benchmark.latestSupportedOsMinorVersions?.includes(osMinorVersion)\n    )\n);\n\nexport const EditPolicyProfilesRules = ({ policy, selectedRuleRefIds, change, osMajorVersion, osMinorVersionCounts }) => {\n    const columns = selectRulesTableColumns(['Name', 'Severity', 'Ansible']);\n    const handleSelectCallback = (profile, newSelectedRuleRefIds) => {\n        const newSelection = selectedRuleRefIds.map((profileSelectedRuleRefIds) => {\n            if (profileSelectedRuleRefIds.id === profile.id) {\n                return {\n                    id: profileSelectedRuleRefIds.id,\n                    ruleRefIds: newSelectedRuleRefIds\n                };\n            } else {\n                return profileSelectedRuleRefIds;\n            }\n        });\n\n        change('selectedRuleRefIds', newSelection);\n    };\n\n    const { data: benchmarks, loading: benchmarksLoading } = useCollection('benchmarks', {\n        type: 'benchmark',\n        include: ['profiles'],\n        params: {\n            search: `os_major_version = ${ osMajorVersion } ` +\n                    `and latest_supported_os_minor_version ^ (${ osMinorVersionCounts.map((i) => (i.osMinorVersion)).join(',') })`\n        }\n    });\n\n    let profileIds = [];\n    let tabsData = osMinorVersionCounts.map(({ osMinorVersion, count: systemCount }) => {\n        osMinorVersion = `${osMinorVersion}`;\n        let profile;\n        let profileSelectedRuleRefIds;\n        if (benchmarks) {\n            const benchmark = getBenchmarkBySupportedOsMinor(benchmarks.collection, osMinorVersion);\n            if (benchmark) {\n                profile = getBenchmarkProfile(benchmark, policy.refId);\n                if (profile) {\n                    profile = {\n                        ...profile,\n                        rules: profile.relationships?.rules?.data,\n                        benchmark: profile.relationships?.benchmark?.data\n                    };\n                    profileSelectedRuleRefIds = selectedRuleRefIds?.find(({ id }) => id === profile.id);\n                    profileIds.push(profile.id);\n                }\n            }\n        }\n\n        return {\n            profile,\n            systemCount,\n            newOsMinorVersion: osMinorVersion,\n            selectedRuleRefIds: profileSelectedRuleRefIds?.ruleRefIds\n        };\n    });\n    tabsData = tabsData.filter(({ profile }) => !!profile);\n\n    const filter = `${ (profileIds || []).map((i) => (`id = ${ i }`)).join(' OR ') }`;\n    const skipProfilesQuery = benchmarksLoading || filter.length === 0;\n    const { data: profilesData, error, loading } = useQuery(PROFILES_QUERY, {\n        variables: {\n            filter\n        },\n        skip: skipProfilesQuery\n    });\n    const dataState = ((profileIds?.length > 0) ? profilesData : undefined);\n    const loadingState = ((loading || benchmarksLoading) ? true : undefined);\n    const noRuleSets = !error && !loadingState && profileIds?.length === 0;\n    const profiles = skipProfilesQuery ? [] : profilesData?.profiles.edges.map((p) => (p.node));\n\n    useLayoutEffect(() => {\n        if (!loadingState) {\n            change('selectedRuleRefIds', profiles.map((profile) => ({\n                id: profile.id,\n                ruleRefIds: selectedRuleRefIds?.find(({ id }) => id === profile.id)?.ruleRefIds ||\n                            profile.rules.map((rule) => (rule.refId))\n            })));\n        }\n    }, [profiles, loadingState]);\n\n    return <React.Fragment>\n        <TextContent className='pf-u-pb-md'>\n            <Text component={TextVariants.h1}>\n                Rules\n            </Text>\n            <Text>\n                Customize your <b>{ policy.name }</b> SCAP policy by including and excluding rules.\n            </Text>\n            <Text>\n                Each release of RHEL is supported with a unique and specific version of the SCAP Security\n                Guide (SSG). You must customize each version of SSG for each release of RHEL.\n            </Text>\n        </TextContent>\n\n        <StateViewWithError stateValues={ { error, data: dataState, loading: loadingState, noRuleSets } }>\n            <StateViewPart stateKey=\"noRuleSets\">\n                <EmptyState>\n                    <Title headingLevel=\"h1\" size=\"xl\">\n                        No rules can be configured\n                    </Title>\n                    <EmptyStateBody>\n                        The policy type selected does not exist for the systems and\n                        OS versions selected in the previous steps.\n                    </EmptyStateBody>\n                </EmptyState>\n            </StateViewPart>\n            <StateViewPart stateKey=\"loading\">\n                <EmptyTable><Spinner/></EmptyTable>\n            </StateViewPart>\n            <StateViewPart stateKey=\"data\">\n                <TabbedRules\n                    tabsData={ tabsData }\n                    columns={ columns }\n                    remediationsEnabled={ false }\n                    selectedFilter\n                    level={ 1 }\n                    handleSelect={ handleSelectCallback } />\n            </StateViewPart>\n        </StateViewWithError>\n    </React.Fragment>;\n};\n\nEditPolicyProfilesRules.propTypes = {\n    policy: propTypes.object,\n    change: reduxFormPropTypes.change,\n    osMajorVersion: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    })),\n    selectedRuleRefIds: propTypes.array\n};\n\nconst selector = formValueSelector('policyForm');\n\nexport default compose(\n    connect(\n        state => ({\n            policy: JSON.parse(selector(state, 'profile')),\n            osMajorVersion: selector(state, 'osMajorVersion'),\n            osMinorVersionCounts: selector(state, 'osMinorVersionCounts'),\n            selectedRuleRefIds: selector(state, 'selectedRuleRefIds')\n        })\n    ),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(EditPolicyProfilesRules);\n","import React, { useEffect, useState } from 'react';\nimport { propTypes as reduxFormPropTypes, formValueSelector, reduxForm } from 'redux-form';\nimport SystemRulesTable, {\n    selectColumns as selectRulesTableColumns\n} from '@redhat-cloud-services/frontend-components-inventory-compliance/SystemRulesTable';\nimport EmptyTable from '@redhat-cloud-services/frontend-components/EmptyTable';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport { Button, Text, TextContent, TextVariants } from '@patternfly/react-core';\nimport gql from 'graphql-tag';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport propTypes from 'prop-types';\nimport { useQuery } from '@apollo/react-hooks';\nimport { StateViewWithError, StateViewPart } from 'PresentationalComponents';\nimport useFeature from 'Utilities/hooks/useFeature';\nimport EditPolicyProfilesRules from './EditPolicyProfilesRules';\n\nconst QUERY = gql`\nquery benchmarkAndProfile($benchmarkId: String!, $profileId: String!){\n    benchmark(id: $benchmarkId) {\n        id\n        rules {\n            id\n            title\n            severity\n            rationale\n            refId\n            description\n            remediationAvailable\n            identifier\n        }\n    }\n    profile(id: $profileId) {\n        id\n        name\n        refId\n        rules {\n            id\n            refId\n        }\n    }\n}\n`;\n\nexport const EditPolicyRules = ({ profileId, benchmarkId, osMajorVersion, osMinorVersionCounts, selectedRuleRefIds, change }) => {\n    const multiversionRules = useFeature('multiversionTabs');\n    const columns = selectRulesTableColumns(['Name', 'Severity', 'Ansible']);\n    const { data, error, loading } = useQuery(QUERY, { variables: { profileId, benchmarkId } });\n    const [defaultSelection, setDefaultSelection] = useState(null);\n    const profileRules = data && [{\n        profile: { refId: data.profile.refId, name: data.profile.name },\n        rules: data.benchmark.rules\n    }];\n    const resetToDefaultSelection = () => (\n        change('selectedRuleRefIds', defaultSelection)\n    );\n    const isDefaultSelection = (ruleIds) => {\n        const filteredRules = ruleIds?.filter((ruleId) => (defaultSelection?.includes(ruleId)));\n        return ruleIds && defaultSelection && filteredRules.length === defaultSelection.length;\n    };\n\n    useEffect(() => {\n        if (data) {\n            const ruleIds = data.profile.rules.map((rule) => rule.refId);\n            setDefaultSelection(ruleIds);\n            if (!selectedRuleRefIds) {\n                change('selectedRuleRefIds', ruleIds);\n            }\n        }\n    }, [data, change, selectedRuleRefIds]);\n\n    return <StateViewWithError stateValues={ { error, data, loading } }>\n        <StateViewPart stateKey=\"loading\">\n            <EmptyTable><Spinner/></EmptyTable>\n        </StateViewPart>\n        <StateViewPart stateKey=\"data\">\n            <TextContent>\n                <Text component={TextVariants.h1}>\n                    Rules\n                </Text>\n            </TextContent>\n            <TextContent>\n                <Text>\n                    Edit your policy by including and excluding rules.\n                </Text>\n                <Text>\n                    Selected policy type <strong>{ data?.profile.name }</strong> has { defaultSelection?.length } rules.&ensp;\n                    { selectedRuleRefIds && !isDefaultSelection(selectedRuleRefIds) &&\n                        <Button variant=\"link\" isInline onClick={ () => resetToDefaultSelection() }>\n                          Reset to default selection\n                        </Button>\n                    }\n                </Text>\n                { multiversionRules && osMinorVersionCounts && osMinorVersionCounts.length > 0 &&\n                    <Text>\n                        Tailoring for{' '}\n                        { osMinorVersionCounts.map(({ osMinorVersion, count }) =>\n                            `RHEL ${osMajorVersion}.${osMinorVersion} (${count} systems)`).join(', ') }\n                    </Text>\n                }\n            </TextContent>\n            <SystemRulesTable\n                remediationsEnabled={ false }\n                tailoringEnabled\n                selectedFilter\n                remediationAvailableFilter\n                columns={ columns }\n                loading={ loading }\n                handleSelect={ (selectedRuleRefIds) => change('selectedRuleRefIds', selectedRuleRefIds) }\n                profileRules={ profileRules }\n                selectedRefIds={ selectedRuleRefIds || [] }\n            />\n        </StateViewPart>\n    </StateViewWithError>;\n};\n\nEditPolicyRules.propTypes = {\n    profileId: propTypes.string,\n    benchmarkId: propTypes.string,\n    change: reduxFormPropTypes.change,\n    osMajorVersion: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    })),\n    selectedRuleRefIds: propTypes.array\n};\n\nconst selector = formValueSelector('policyForm');\n\nconst EditPolicyRulesComponent = compose(\n    connect(\n        state => ({\n            benchmarkId: selector(state, 'benchmark'),\n            profile: JSON.parse(selector(state, 'profile')),\n            profileId: JSON.parse(selector(state, 'profile')).id,\n            osMajorVersion: selector(state, 'osMajorVersion'),\n            osMinorVersionCounts: selector(state, 'osMinorVersionCounts'),\n            selectedRuleRefIds: selector(state, 'selectedRuleRefIds')\n        })\n    ),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(EditPolicyRules);\n\nconst FeatureWrapper = (...props) => {\n    const multiversionRules = useFeature('multiversionTabs');\n    const Component = multiversionRules ? EditPolicyProfilesRules : EditPolicyRulesComponent;\n\n    return <Component { ...props } />;\n};\n\nexport default FeatureWrapper;\n","import React, { useEffect } from 'react';\nimport { propTypes as reduxFormPropTypes, reduxForm, formValueSelector } from 'redux-form';\nimport { Button, Form, FormGroup, Text, TextContent, TextVariants, WizardContextConsumer } from '@patternfly/react-core';\nimport { InventoryTable, SystemsTable } from 'SmartComponents';\nimport { GET_SYSTEMS_WITHOUT_FAILED_RULES } from '../SystemsTable/constants';\nimport { compose } from 'redux';\nimport propTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport useFeature from 'Utilities/hooks/useFeature';\nimport { countOsMinorVersions } from 'Store/Reducers/SystemStore';\n\nconst EditPolicySystems = ({ change, osMajorVersion, osMinorVersionCounts, selectedSystemIds }) => {\n    const newInventory = useFeature('newInventory');\n    const multiversionRules = useFeature('multiversionTabs');\n\n    const columns = [{\n        key: 'facts.compliance.display_name',\n        title: 'Name',\n        props: {\n            width: 40, isStatic: true\n        },\n        ...newInventory && {\n            key: 'display_name',\n            renderFunc: (displayName, _id, { name }) => (displayName || name)\n        }\n    }, {\n        key: 'facts.compliance.osMinorVersion',\n        title: 'Operating system',\n        props: {\n            width: 40, isStatic: true\n        },\n        ...newInventory && {\n            key: 'osMinorVersion',\n            renderFunc: (osMinorVersion, _id, { osMajorVersion }) => `RHEL ${osMajorVersion}.${osMinorVersion}`\n        }\n    }];\n\n    useEffect(() => {\n        if (selectedSystemIds) {\n            change('systems', selectedSystemIds);\n        }\n\n        if (osMinorVersionCounts) {\n            change('osMinorVersionCounts', osMinorVersionCounts);\n        }\n    }, [selectedSystemIds, osMinorVersionCounts, change]);\n\n    const emptyStateComponent = (<React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                You do not have any <b>RHEL { osMajorVersion }</b> systems connected to Insights and enabled for Compliance.<br/>\n                Policies must be created with at least one system.\n            </Text>\n        </TextContent>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Choose a different operating system, or connect <b>RHEL { osMajorVersion }</b> systems to Insights.\n            </Text>\n        </TextContent>\n        <WizardContextConsumer>\n            { ({ goToStepById }) => <Button onClick={() => goToStepById(1)}>Choose a different operating system</Button> }\n        </WizardContextConsumer>\n    </React.Fragment>);\n\n    const prependComponent = (<React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Select which of your <b>RHEL { osMajorVersion }</b> systems should be included\n                in this policy.<br />\n                Systems can be added or removed at any time.\n            </Text>\n        </TextContent>\n    </React.Fragment>);\n\n    const InvCmp = newInventory ? InventoryTable : SystemsTable;\n\n    return (\n        <React.Fragment>\n            <TextContent className=\"pf-u-mb-md\">\n                <Text component={TextVariants.h1}>\n                    Systems\n                </Text>\n            </TextContent>\n            <Form>\n                <FormGroup>\n                    <InvCmp\n                        prependComponent={prependComponent}\n                        emptyStateComponent={multiversionRules ? emptyStateComponent : undefined}\n                        columns={columns}\n                        remediationsEnabled={false}\n                        compact\n                        showActions={ false }\n                        query={ GET_SYSTEMS_WITHOUT_FAILED_RULES }\n                        defaultFilter={ osMajorVersion && `os_major_version = ${osMajorVersion}` }\n                        enableExport={ false }/>\n                </FormGroup>\n            </Form>\n        </React.Fragment>\n    );\n};\n\nEditPolicySystems.propTypes = {\n    osMajorVersion: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    })),\n    selectedSystemIds: propTypes.array,\n    change: reduxFormPropTypes.change\n};\n\nEditPolicySystems.defaultProps = {\n    selectedSystemIds: [],\n    osMinorVersionCounts: []\n};\n\nconst selector = formValueSelector('policyForm');\nconst mapStateToProps = (state) => ({\n    osMajorVersion: selector(state, 'osMajorVersion'),\n    osMinorVersionCounts: countOsMinorVersions(state.entities?.selectedEntities),\n    selectedSystemIds: (state.entities?.selectedEntities || []).map((e) => (e.id))\n});\n\nexport default compose(\n    connect(mapStateToProps),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(EditPolicySystems);\n","import React, { useEffect } from 'react';\nimport { compose } from 'redux';\nimport { Field, reduxForm, formValueSelector, propTypes as reduxFormPropTypes } from 'redux-form';\nimport { connect } from 'react-redux';\nimport propTypes from 'prop-types';\nimport { Form, FormGroup, Text, TextContent, TextVariants } from '@patternfly/react-core';\nimport { ReduxFormTextInput, ReduxFormTextArea } from 'PresentationalComponents/ReduxFormWrappers/ReduxFormWrappers';\nimport { ProfileThresholdField } from 'PresentationalComponents';\n\nconst EditPolicyDetails = ({ change, policy, refId }) => {\n\n    useEffect(() => {\n        if (policy && policy.refId !== refId) {\n            change('name', `${policy.name}`);\n            change('refId', `${policy.refId}`);\n            change('description', `${policy.description}`);\n        }\n    }, [policy]);\n\n    return (\n        <React.Fragment>\n            <TextContent>\n                <Text component={TextVariants.h1}>\n                    Details\n                </Text>\n            </TextContent>\n            <br/>\n            <Form id='editpolicydetails'>\n                <FormGroup label=\"Policy name\" isRequired fieldId=\"name\">\n                    <Field\n                        component={ReduxFormTextInput}\n                        type='text'\n                        isRequired={true}\n                        id=\"name\"\n                        name=\"name\"\n                        aria-describedby=\"name\" />\n                </FormGroup>\n                <FormGroup label=\"Reference ID\" isRequired fieldId=\"refId\">\n                    <Field\n                        type=\"text\"\n                        component={ReduxFormTextInput}\n                        isDisabled\n                        id=\"refId\"\n                        name=\"refId\"\n                        aria-describedby=\"refId\" />\n                </FormGroup>\n                <FormGroup label=\"Description\" fieldId=\"description\">\n                    <Field\n                        type=\"text\"\n                        component={ReduxFormTextArea}\n                        id=\"description\"\n                        name=\"description\"\n                        aria-describedby=\"description\" />\n                </FormGroup>\n                <FormGroup label=\"Business objective\" fieldId=\"businessObjective\">\n                    <Field\n                        type=\"text\"\n                        component={ ReduxFormTextInput }\n                        id=\"businessObjective\"\n                        name=\"businessObjective\"\n                        aria-describedby=\"businessObjective\"\n                        defaultValue={ policy.businessObjective } />\n                </FormGroup>\n                <ProfileThresholdField\n                    showTitle={ false }\n                    previousThreshold={ policy.complianceThreshold } />\n            </Form>\n        </React.Fragment>\n    );\n};\n\nconst selector = formValueSelector('policyForm');\n\nEditPolicyDetails.propTypes = {\n    policy: propTypes.object,\n    refId: propTypes.string,\n    change: reduxFormPropTypes.change\n};\n\nconst mapStateToProps = (state) => {\n    const policy = JSON.parse(selector(state, 'profile'));\n    return {\n        policy,\n        refId: selector(state, 'refId'),\n        initialValues: {\n            name: `${policy.name}`,\n            refId: `${policy.refId}`,\n            description: `${policy.description}`,\n            benchmark: selector(state, 'benchmark'),\n            osMajorVersion: selector(state, 'osMajorVersion'),\n            profile: selector(state, 'profile')\n        }\n    };\n};\n\nexport default compose(\n    connect(mapStateToProps),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(EditPolicyDetails);\n\nexport { EditPolicyDetails };\n","import React from 'react';\nimport {\n    Text,\n    TextVariants,\n    TextContent,\n    TextList,\n    TextListVariants,\n    TextListItem,\n    TextListItemVariants\n} from '@patternfly/react-core';\nimport { formValueSelector } from 'redux-form';\nimport { connect } from 'react-redux';\nimport gql from 'graphql-tag';\nimport propTypes from 'prop-types';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport { useQuery } from '@apollo/react-hooks';\n\nconst REVIEW = gql`\nquery review($benchmarkId: String!) {\n    benchmark(id: $benchmarkId) {\n        id\n        osMajorVersion\n    }\n}\n`;\n\nconst ReviewCreatedPolicy = ({\n    benchmarkId, name, businessObjective, complianceThreshold, parentProfileName, osMinorVersionCounts\n}) => {\n    const { data, error, loading } = useQuery(REVIEW, { variables: { benchmarkId } });\n\n    if (error) { return error; }\n\n    if (loading) { return <Spinner/>; }\n\n    const { benchmark: { osMajorVersion } } = data;\n\n    return (\n        <TextContent>\n            <Text component={TextVariants.h1}>\n                Review\n            </Text>\n            <Text>\n                Review your SCAP policy before finishing.\n            </Text>\n            <Text component={TextVariants.h3}>{ name }</Text>\n            <TextList component={TextListVariants.dl}>\n                <TextListItem component={TextListItemVariants.dt}>Policy type</TextListItem>\n                <TextListItem component={TextListItemVariants.dd}>{ parentProfileName }</TextListItem>\n                <TextListItem component={TextListItemVariants.dt}>Compliance threshold</TextListItem>\n                <TextListItem component={TextListItemVariants.dd}>{ complianceThreshold }%</TextListItem>\n                { businessObjective &&\n                    <React.Fragment>\n                        <TextListItem component={TextListItemVariants.dt}>Business objective</TextListItem>\n                        <TextListItem component={TextListItemVariants.dd}>{ businessObjective }</TextListItem>\n                    </React.Fragment>\n                }\n                <TextListItem component={TextListItemVariants.dt}>Systems</TextListItem>\n                <TextListItem component={TextListItemVariants.dd}>\n                    <TextList component={TextListVariants.dl}>\n                        { osMinorVersionCounts.map(({ osMinorVersion, count }) => (\n                            <React.Fragment key={osMinorVersion}>\n                                <TextListItem component={TextListItemVariants.dt} style={{ 'font-weight': 'normal' }}>\n                                    RHEL {osMajorVersion}.{osMinorVersion}\n                                </TextListItem>\n                                <TextListItem component={TextListItemVariants.dd}>\n                                    { count }\n                                </TextListItem>\n                            </React.Fragment>\n                        )) }\n                    </TextList>\n                </TextListItem>\n            </TextList>\n        </TextContent>\n    );\n};\n\nReviewCreatedPolicy.propTypes = {\n    benchmarkId: propTypes.string,\n    refId: propTypes.string,\n    name: propTypes.string,\n    businessObjective: propTypes.string,\n    complianceThreshold: propTypes.number,\n    parentProfileName: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    }))\n};\n\nconst selector = formValueSelector('policyForm');\n\nexport default connect(\n    state => ({\n        benchmarkId: selector(state, 'benchmark'),\n        refId: selector(state, 'refId'),\n        name: selector(state, 'name'),\n        businessObjective: selector(state, 'businessObjective'),\n        osMinorVersionCounts: selector(state, 'osMinorVersionCounts'),\n        complianceThreshold: parseFloat(selector(state, 'complianceThreshold')) || 100.0,\n        parentProfileName: JSON.parse(selector(state, 'profile')).name,\n        rulesCount: selector(state, 'selectedRuleRefIds').length\n    })\n)(ReviewCreatedPolicy);\n","import React, { useState, useEffect } from 'react';\nimport propTypes from 'prop-types';\nimport {\n    Title, Button, Bullseye, EmptyState, EmptyStateBody, EmptyStateSecondaryActions,\n    EmptyStateVariant, EmptyStateIcon, List, ListItem\n} from '@patternfly/react-core';\nimport { ProgressBar } from 'PresentationalComponents';\nimport { WrenchIcon } from '@patternfly/react-icons';\nimport { reduxForm, formValueSelector } from 'redux-form';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { withApollo } from '@apollo/react-hoc';\nimport usePolicy from 'SmartComponents/EditPolicy/usePolicy';\n\nconst FinishedCreatePolicy = ({\n    onWizardFinish,\n    cloneFromProfileId,\n    description,\n    name,\n    complianceThreshold,\n    businessObjective,\n    refId,\n    benchmarkId,\n    systemIds,\n    selectedRuleRefIds\n}) => {\n    const [percent, setPercent] = useState(0);\n    const [message, setMessage] = useState('This usually takes a minute or two.');\n    const [errors, setErrors] = useState(null);\n    const [failed, setFailed] = useState(false);\n    const updatePolicy = usePolicy();\n\n    const onProgress = (progress) => {\n        setPercent(progress * 100);\n    };\n\n    useEffect(() => {\n        const newPolicy = {\n            cloneFromProfileId,\n            description,\n            name,\n            complianceThreshold,\n            businessObjective: { title: businessObjective },\n            refId,\n            benchmarkId,\n            hosts: systemIds.map((id) => ({ id })),\n            selectedRuleRefIds\n        };\n\n        updatePolicy(null, newPolicy, onProgress).then(() => {\n            setPercent(100);\n            setMessage();\n        }).catch((error) => {\n            setMessage(error.networkError?.message);\n            setErrors(error.networkError?.result?.errors);\n            setFailed(true);\n        });\n    }, []);\n\n    let listErrors;\n    if (errors && Array.isArray(errors) && errors.length > 0) {\n        listErrors = errors.map((error) => (\n            <ListItem key={ error }>{ error }</ListItem>\n        ));\n    }\n\n    let secondaryActions;\n    if (percent === 100 || failed) {\n        secondaryActions = (\n            <Button\n                variant={'primary'}\n                onClick={() => { onWizardFinish(); }}>\n                { failed ? 'Back' : 'Return to application' }\n            </Button>\n        );\n    }\n\n    return (\n        <Bullseye>\n            <EmptyState variant={EmptyStateVariant.full}>\n                <EmptyStateIcon icon={WrenchIcon} />\n                <br/>\n                <Title headingLevel=\"h1\" size='lg'>\n                    Creating policy\n                </Title>\n                <EmptyStateBody>\n                    <ProgressBar percent={percent} failed={failed} />\n                </EmptyStateBody>\n                <EmptyStateBody className={failed && 'wizard-failed-message'}>\n                    { message }\n                </EmptyStateBody>\n                { listErrors &&\n                    <EmptyStateBody className='wizard-failed-errors'>\n                        <List>{ listErrors }</List>\n                    </EmptyStateBody>\n                }\n                <EmptyStateSecondaryActions>\n                    { secondaryActions }\n                </EmptyStateSecondaryActions>\n            </EmptyState>\n        </Bullseye>\n    );\n};\n\nFinishedCreatePolicy.propTypes = {\n    benchmarkId: propTypes.string.isRequired,\n    client: propTypes.object.isRequired,\n    businessObjective: propTypes.object,\n    cloneFromProfileId: propTypes.string.isRequired,\n    refId: propTypes.string.isRequired,\n    name: propTypes.string.isRequired,\n    description: propTypes.string,\n    systemIds: propTypes.array,\n    complianceThreshold: propTypes.number,\n    onWizardFinish: propTypes.func,\n    selectedRuleRefIds: propTypes.arrayOf(propTypes.string).isRequired\n};\n\nexport const selector = formValueSelector('policyForm');\n\nexport default compose(\n    connect(\n        state => ({\n            benchmarkId: selector(state, 'benchmark'),\n            businessObjective: selector(state, 'businessObjective'),\n            cloneFromProfileId: JSON.parse(selector(state, 'profile')).id,\n            refId: selector(state, 'refId'),\n            name: selector(state, 'name'),\n            description: selector(state, 'description'),\n            complianceThreshold: parseFloat(selector(state, 'complianceThreshold')) || 100.0,\n            systemIds: selector(state, 'systems'),\n            selectedRuleRefIds: selector(state, 'selectedRuleRefIds')\n        })\n    ),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: true,\n        forceUnregisterOnUnmount: true\n    }),\n    withApollo\n)(FinishedCreatePolicy);\n","import React, { useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { formValueSelector } from 'redux-form';\nimport { connect } from 'react-redux';\nimport propTypes from 'prop-types';\nimport { Wizard } from '@patternfly/react-core';\nimport CreateSCAPPolicy from './CreateSCAPPolicy';\nimport EditPolicyRules from './EditPolicyRules';\nimport EditPolicySystems from './EditPolicySystems';\nimport EditPolicyDetails from './EditPolicyDetails';\nimport ReviewCreatedPolicy from './ReviewCreatedPolicy';\nimport FinishedCreatePolicy from './FinishedCreatePolicy';\nimport { validateBenchmarkPage, validateDetailsPage, validateRulesPage, validateSystemsPage } from './validate';\n\nexport const CreatePolicy = ({\n    benchmark, osMajorVersion, complianceThreshold, name, profile, refId, selectedRuleRefIds, systemIds\n}) => {\n    const history = useHistory();\n    const [stepIdReached, setStepIdReached] = useState(1);\n\n    const resetAnchor = () => {\n        const { location } = history;\n        if (location.hash) {\n            history.push({ ...location, hash: '' });\n        }\n    };\n\n    const onNext = ({ id }) => {\n        setStepIdReached(stepIdReached < id ? id : stepIdReached);\n        resetAnchor();\n    };\n\n    const onClose = () => {\n        history.push('/scappolicies');\n    };\n\n    const steps = [\n        {\n            id: 1,\n            name: 'Create SCAP policy',\n            component: <CreateSCAPPolicy/>,\n            enableNext: validateBenchmarkPage(benchmark, osMajorVersion, profile)\n        },\n        {\n            id: 2,\n            name: 'Details',\n            component: <EditPolicyDetails/>,\n            canJumpTo: stepIdReached >= 2,\n            enableNext: validateDetailsPage(name, refId, complianceThreshold)\n        },\n        {\n            id: 3,\n            name: 'Systems',\n            component: <EditPolicySystems/>,\n            canJumpTo: stepIdReached >= 3,\n            enableNext: validateSystemsPage(systemIds)\n        },\n        {\n            id: 4,\n            name: 'Rules',\n            component: <EditPolicyRules/>,\n            canJumpTo: systemIds?.length > 0 && stepIdReached >= 4,\n            enableNext: validateRulesPage(selectedRuleRefIds)\n        },\n        {\n            id: 5,\n            name: 'Review',\n            component: <ReviewCreatedPolicy/>,\n            nextButtonText: 'Finish',\n            canJumpTo: (\n                validateRulesPage(selectedRuleRefIds) &&\n                systemIds?.length > 0 &&\n                stepIdReached >= 5\n            )\n        },\n        {\n            id: 6,\n            name: 'Finished',\n            component: <FinishedCreatePolicy onWizardFinish={ onClose } />,\n            isFinishedStep: true,\n            canJumpTo: systemIds?.length > 0 && stepIdReached >= 6\n        }\n    ];\n\n    return (\n        <React.Fragment>\n            <Wizard\n                isOpen\n                width={ 1220 }\n                onNext={ onNext }\n                onGoToStep={ resetAnchor }\n                onBack={ resetAnchor }\n                onClose={ onClose }\n                title=\"Create SCAP policy\"\n                description=\"Create a new policy for managing SCAP compliance\"\n                steps={ steps } />\n        </React.Fragment>\n    );\n};\n\nCreatePolicy.propTypes = {\n    benchmark: propTypes.string,\n    osMajorVersion: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    })),\n    complianceThreshold: propTypes.string,\n    businessObjective: propTypes.object,\n    dispatch: propTypes.func,\n    isOpen: propTypes.bool,\n    name: propTypes.string,\n    onWizardFinish: propTypes.func,\n    profile: propTypes.string,\n    refId: propTypes.string,\n    selectedRuleRefIds: propTypes.arrayOf(propTypes.string),\n    systemIds: propTypes.arrayOf(propTypes.string)\n};\n\nCreatePolicy.defaultProps = {\n    isOpen: false\n};\n\nconst selector = formValueSelector('policyForm');\nexport default connect(\n    state => ({\n        benchmark: selector(state, 'benchmark'),\n        osMajorVersion: selector(state, 'osMajorVersion'),\n        osMinorVersionCounts: selector(state, 'osMinorVersionCounts'),\n        businessObjective: selector(state, 'businessObjective'),\n        complianceThreshold: selector(state, 'complianceThreshold') || '100.0',\n        name: selector(state, 'name'),\n        profile: selector(state, 'profile'),\n        refId: selector(state, 'refId'),\n        selectedRuleRefIds: selector(state, 'selectedRuleRefIds'),\n        systemIds: selector(state, 'systems')\n    })\n)(CreatePolicy);\n","import React, { useState } from 'react';\nimport propTypes from 'prop-types';\nimport {\n    FormGroup, TextArea, TextInput\n} from '@patternfly/react-core';\nimport { thresholdValid } from '../CreatePolicy/validate';\n\nexport const useThresholdValidate = () => {\n    const [validThreshold, setValidThreshold] = useState(true);\n    return [validThreshold, (threshold) => {\n        const valid = thresholdValid(threshold);\n        setValidThreshold(valid);\n        return valid;\n    }];\n};\n\nconst EditPolicyDetailsTab = ({ policy, setUpdatedPolicy }) => {\n    const [validThreshold, validateThreshold] = useThresholdValidate();\n\n    return <React.Fragment>\n        <FormGroup label=\"Policy description\" isRequired fieldId=\"description\">\n            <TextArea\n                style={ { width: 800, height: 110 } }\n                isRequired\n                type=\"text\"\n                id=\"description\"\n                name=\"description\"\n                aria-describedby=\"description\"\n                defaultValue={ policy.description }\n                onChange={ (value) => {\n                    setUpdatedPolicy((policy) => ({\n                        ...policy,\n                        description: value\n                    }));\n                }} />\n        </FormGroup>\n\n        <FormGroup label=\"Business objective\" fieldId=\"business-objective\">\n            <TextInput\n                type=\"text\"\n                style={ { width: 300 } }\n                id=\"business-objective\"\n                name=\"business-objective\"\n                aria-describedby=\"business-objective\"\n                defaultValue={ policy?.businessObjective?.title }\n                onChange={ (value) => {\n                    setUpdatedPolicy((policy) =>({\n                        ...policy,\n                        businessObjective: {\n                            ...policy.businessObjective,\n                            title: value\n                        }\n                    }));\n                }} />\n        </FormGroup>\n\n        <FormGroup\n            validated={ validThreshold ? 'default' : 'error' }\n            label='Compliance threshold (%)'\n            fieldId='policy-threshold'\n            helperTextInvalid='Threshold has to be a number between 0 and 100'\n            helperText='A value of 95% or higher is recommended'>\n            <TextInput\n                type='number'\n                style={ { width: 150 } }\n                name='compliance-threshold'\n                id='compliance-threshold'\n                defaultValue={ policy.complianceThreshold }\n                aria-describedby=\"policy-threshold\"\n                onChange={ (value) => {\n                    setUpdatedPolicy((policy) =>({\n                        ...policy,\n                        complianceThreshold: value,\n                        complianceThresholdValid: validateThreshold(value)\n                    }));\n                }} />\n        </FormGroup>\n    </React.Fragment>;\n};\n\nEditPolicyDetailsTab.propTypes = {\n    policy: propTypes.shape({\n        description: propTypes.string,\n        businessObjective: propTypes.object,\n        complianceThreshold: propTypes.oneOfType([\n            propTypes.string,\n            propTypes.number\n        ])\n    }),\n    setUpdatedPolicy: propTypes.func\n};\n\nexport default EditPolicyDetailsTab;\n","import React, { useLayoutEffect } from 'react';\nimport { Text, TextContent } from '@patternfly/react-core';\nimport gql from 'graphql-tag';\nimport propTypes from 'prop-types';\nimport { useQuery } from '@apollo/react-hooks';\nimport EmptyTable from '@redhat-cloud-services/frontend-components/EmptyTable';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport { StateViewWithError, StateViewPart, TabbedRules } from 'PresentationalComponents';\nimport useCollection from 'Utilities/hooks/api/useCollection';\nimport { sortingByProp } from 'Utilities/helpers';\n\nconst PROFILES_QUERY = gql`\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n`;\n\nconst getBenchmarkBySupportedOsMinor = (benchmarks, osMinorVersion) => (\n    benchmarks.find((benchmark) =>\n        benchmark.latestSupportedOsMinorVersions?.includes(osMinorVersion)\n    )\n);\n\nconst getBenchmarkProfile = (benchmark, profileRefId) => (\n    benchmark.profiles.find((benchmarkProfile) => (benchmarkProfile.refId === profileRefId))\n);\n\nconst EditPolicyRulesTab = ({ handleSelect, policy, selectedRuleRefIds, osMinorVersionCounts }) => {\n    const osMajorVersion = policy?.osMajorVersion;\n    const benchmarkSearch = `os_major_version = ${ osMajorVersion } ` +\n        `and latest_supported_os_minor_version ^ (${ Object.keys(osMinorVersionCounts).sort().join(',') })`;\n\n    const { data: benchmarks, loading: benchmarksLoading } = useCollection('benchmarks', {\n        type: 'benchmark',\n        include: ['profiles'],\n        params: { search: benchmarkSearch }\n    }, [benchmarkSearch]);\n\n    let profileIds = [];\n    let tabsData = Object.values(osMinorVersionCounts).sort(\n        sortingByProp('osMinorVersion', 'desc')\n    ).map(({ osMinorVersion, count: systemCount }) => {\n        osMinorVersion = `${osMinorVersion}`;\n        let profile = policy.policy.profiles.find((profile) => (profile.osMinorVersion === osMinorVersion));\n\n        if (!profile && benchmarks) {\n            const benchmark = getBenchmarkBySupportedOsMinor(benchmarks.collection, osMinorVersion);\n            if (benchmark) {\n                const benchmarkProfile = getBenchmarkProfile(benchmark, policy.refId);\n                if (benchmarkProfile) {\n                    profile = policy.policy.profiles.find((profile) => (profile.parentProfileId === benchmarkProfile.id));\n\n                    profile = {\n                        ...benchmarkProfile,\n                        benchmark: benchmarkProfile.relationships?.benchmark?.data,\n                        rules: benchmarkProfile.relationships?.rules?.data,\n                        ...profile\n                    };\n                }\n            }\n        }\n\n        return {\n            profile,\n            systemCount,\n            newOsMinorVersion: osMinorVersion,\n            selectedRuleRefIds: selectedRuleRefIds?.find(({ id }) => id === profile?.id)?.ruleRefIds\n        };\n    });\n    tabsData = tabsData.filter(({ profile, newOsMinorVersion }) => !!profile && newOsMinorVersion);\n\n    tabsData.forEach((tab) => (profileIds.push(tab.profile.id)));\n\n    const filter = `${ (profileIds || []).map((i) => (`id = ${ i }`)).join(' OR ') }`;\n    const { data: profilesData, error, loading } = useQuery(PROFILES_QUERY, {\n        variables: {\n            filter\n        },\n        skip: filter.length === 0\n    });\n    const dataState = ((tabsData?.length > 0) ? profilesData : undefined);\n    const loadingState = ((loading || benchmarksLoading) ? true : undefined);\n\n    useLayoutEffect(() => {\n        if (profilesData) {\n            const profiles = profilesData?.profiles.edges.map((p) => (p.node)) || [];\n            profiles.forEach((profile) => {\n                const foundSelection = selectedRuleRefIds?.find(({ id }) => id === profile?.id);\n                if (!foundSelection) {\n                    const refIds = profile.rules.map((rule) => (rule.refId));\n                    handleSelect(profile, refIds);\n                }\n            });\n        }\n    }, [profilesData]);\n\n    return <StateViewWithError stateValues={ { error, data: dataState, loading: loadingState } }>\n        <StateViewPart stateKey=\"loading\">\n            <EmptyTable><Spinner/></EmptyTable>\n        </StateViewPart>\n        <StateViewPart stateKey=\"data\">\n            <TextContent>\n                <Text>\n                    Different release versions of RHEL are associated with different versions of\n                    the SCAP Security Guide (SSG), therefore each release must be customized independently.\n                </Text>\n            </TextContent>\n            <TabbedRules\n                tabsData={ tabsData }\n                remediationsEnabled={ false }\n                selectedFilter\n                level={ 1 }\n                handleSelect={ handleSelect } />\n        </StateViewPart>\n    </StateViewWithError>;\n};\n\nEditPolicyRulesTab.propTypes = {\n    handleSelect: propTypes.func,\n    policy: propTypes.object,\n    osMinorVersionCounts: propTypes.shape({\n        osMinorVersion: propTypes.shape({\n            osMinorVersion: propTypes.number,\n            count: propTypes.number\n        })\n    }),\n    selectedRuleRefIds: propTypes.array\n};\n\nexport default EditPolicyRulesTab;\n","import React from 'react';\nimport { Alert, AlertActionLink, Text, TextContent } from '@patternfly/react-core';\nimport { useSelector } from 'react-redux';\nimport { InventoryTable } from 'SmartComponents';\nimport { GET_SYSTEMS_WITHOUT_FAILED_RULES } from '../SystemsTable/constants';\nimport propTypes from 'prop-types';\nimport { useHistory } from 'react-router-dom';\n\nconst EditPolicySystemsTab = ({ osMajorVersion, policyOsMinorVersions }) => {\n    const { push, location } = useHistory();\n    const selectedSystemOsMinorVersions = useSelector(state => (\n        state?.entities?.selectedEntities?.map(entity => `${entity.osMinorVersion}`)\n    ));\n\n    const newOsMinorVersions = () => (\n        selectedSystemOsMinorVersions?.find((systemOsMinorVersion) => (\n            !policyOsMinorVersions.includes(systemOsMinorVersion)\n        ))\n    );\n\n    const columns = [{\n        key: 'display_name',\n        title: 'Name',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: (displayName, _id, { name }) => (displayName || name)\n    }, {\n        key: 'osMinorVersion',\n        title: 'Operating system',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: (osMinorVersion, _id, { osMajorVersion }) => `RHEL ${osMajorVersion}.${osMinorVersion}`\n    }];\n\n    const emptyStateComponent = (<React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                You do not have any <b>RHEL { osMajorVersion }</b> systems connected to Insights and enabled for Compliance.\n            </Text>\n        </TextContent>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Connect RHEL { osMajorVersion } systems to Insights.\n            </Text>\n        </TextContent>\n    </React.Fragment>);\n\n    const prependComponent = (<React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Select which of your <b>RHEL { osMajorVersion }</b> systems should be included\n                in this policy.\n            </Text>\n        </TextContent>\n    </React.Fragment>);\n\n    return (\n        <React.Fragment>\n            <InventoryTable\n                prependComponent={prependComponent}\n                emptyStateComponent={emptyStateComponent}\n                columns={columns}\n                compact\n                showActions={ false }\n                query={ GET_SYSTEMS_WITHOUT_FAILED_RULES }\n                defaultFilter={ osMajorVersion && `os_major_version = ${osMajorVersion}` }\n                enableExport={ false }\n                remediationsEnabled={ false }\n            />\n            {newOsMinorVersions() && <Alert\n                variant=\"info\"\n                isInline\n                title=\"You selected a system that has a release version previously not included in this policy.\"\n                actionLinks={\n                    <AlertActionLink onClick={ () => push({ ...location, hash: '#rules' }) }>Open rule editing</AlertActionLink>\n                }>\n                <p>If you have edited any rules for this policy, you will need to do so for this release version as well.</p>\n            </Alert>}\n        </React.Fragment>\n    );\n};\n\nEditPolicySystemsTab.propTypes = {\n    osMajorVersion: propTypes.string,\n    policyOsMinorVersions: propTypes.arrayOf(propTypes.number)\n};\n\nexport default EditPolicySystemsTab;\n","import React, { useState, useEffect } from 'react';\nimport propTypes from 'prop-types';\nimport { useParams } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/react-hooks';\nimport { Button, Form, Modal, Tab, TabTitleText, Spinner } from '@patternfly/react-core';\nimport { RoutedTabs } from 'PresentationalComponents';\nimport { uniq } from 'Utilities/helpers';\nimport { useLinkToBackground, useAnchor } from 'Utilities/Router';\nimport { useTitleEntity } from 'Utilities/hooks/useDocumentTitle';\nimport EditPolicyDetailsTab from './EditPolicyDetailsTab';\nimport EditPolicyRulesTab from './EditPolicyRulesTab';\nimport EditPolicySystemsTab from './EditPolicySystemsTab';\nimport usePolicy from './usePolicy';\nimport useFeature from 'Utilities/hooks/useFeature';\nimport { mapCountOsMinorVersions } from 'Store/Reducers/SystemStore';\n\nexport const MULTIVERSION_QUERY = gql`\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        osMajorVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                parentProfileId\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                benchmark {\n                    id\n                    title\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n            osMinorVersion\n            osMajorVersion\n        }\n    }\n}\n`;\n\nconst profilesToOsMinorMap = (profiles, hosts) => (\n    (profiles || []).reduce((acc, profile) => {\n        if (profile.osMinorVersion !== '') {\n            acc[profile.osMinorVersion] ||= { osMinorVersion: profile.osMinorVersion, count: 0 };\n        }\n\n        return acc;\n    }, mapCountOsMinorVersions(hosts || []))\n);\n\nexport const EditPolicy = ({ route }) => {\n    const { policy_id: policyId } = useParams();\n    let { data } = useQuery(MULTIVERSION_QUERY, {\n        variables: { policyId }\n    });\n    const policy = data?.profile;\n    const policyProfiles = policy?.policy?.profiles || [];\n    const newInventory = useFeature('newInventory');\n    const dispatch = useDispatch();\n    const anchor = useAnchor();\n    const [updatedPolicy, setUpdatedPolicy] = useState(null);\n    const [selectedRuleRefIds, setSelectedRuleRefIds] = useState([]);\n    const [osMinorVersionCounts, setOsMinorVersionCounts] = useState({});\n    const updatePolicy = usePolicy();\n    const linkToBackground = useLinkToBackground('/scappolicies');\n    const [isSaving, setIsSaving] = useState();\n    const selectedEntities = useSelector((state) => (state?.entities?.selectedEntities));\n    const saveEnabled = updatedPolicy && !updatedPolicy.complianceThresholdValid;\n\n    const linkToBackgroundWithHash = () => {\n        newInventory && dispatch({\n            type: 'SELECT_ENTITIES',\n            payload: { ids: [] }\n        });\n        linkToBackground({ hash: anchor });\n    };\n\n    const handleRuleSelect = (profile, newSelectedRuleRefIds) => {\n        const filteredSelection = selectedRuleRefIds.filter((selectedProfile) =>\n            selectedProfile.id !== profile.id\n        );\n        setSelectedRuleRefIds([\n            { id: profile.id, ruleRefIds: newSelectedRuleRefIds },\n            ...filteredSelection\n        ]);\n    };\n\n    const onSave = () => {\n        if (isSaving) { return; }\n\n        setIsSaving(true);\n        updatePolicy(policy, updatedPolicy).then(() => {\n            setIsSaving(false);\n            linkToBackgroundWithHash();\n        }).catch(() => {\n            // TODO report error\n            setIsSaving(false);\n            linkToBackgroundWithHash();\n        });\n    };\n\n    const actions = [\n        <Button\n            isDisabled={ saveEnabled }\n            key='save'\n            variant='primary'\n            spinnerAriaValueText='Saving'\n            isLoading={ isSaving }\n            onClick={ onSave }>\n            Save\n        </Button>,\n        <Button\n            key='cancel'\n            variant='secondary'\n            onClick={ () => linkToBackgroundWithHash() }>\n            Cancel\n        </Button>\n    ];\n\n    const updateSelectedRuleRefIds = () => {\n        if (policy) {\n            setSelectedRuleRefIds(policyProfiles.map((policyProfile) => ({\n                id: policyProfile.id,\n                ruleRefIds: policyProfile.rules.map((rule) => (rule.refId))\n            })));\n        }\n    };\n\n    useEffect(() => {\n        setUpdatedPolicy({\n            ...updatedPolicy,\n            hosts: selectedEntities ? selectedEntities : []\n        });\n        updateSelectedRuleRefIds();\n\n        setOsMinorVersionCounts(\n            profilesToOsMinorMap(policyProfiles, selectedEntities)\n        );\n    }, [selectedEntities]);\n\n    useEffect(() => setUpdatedPolicy({ ...updatedPolicy, selectedRuleRefIds }), [selectedRuleRefIds]);\n\n    useEffect(() => {\n        if (policy) {\n            const complianceThresholdValid =\n                (policy.complianceThreshold < 101 && policy.complianceThreshold > 0);\n            setUpdatedPolicy({\n                ...policy,\n                complianceThresholdValid\n            });\n            updateSelectedRuleRefIds();\n\n            dispatch({\n                type: 'SELECT_ENTITIES',\n                payload: { ids: policy?.hosts || [] }\n            });\n            setOsMinorVersionCounts(\n                profilesToOsMinorMap(policyProfiles, policy.hosts)\n            );\n        }\n    }, [policy]);\n\n    useTitleEntity(route, policy?.name);\n\n    return <Modal\n        isOpen\n        style={ { height: '400px' } }\n        width={ 1000 }\n        title={ `Edit ${ policy ? policy.name : '' }` }\n        onClose={ () => linkToBackgroundWithHash() }\n        actions={ actions }>\n        { policy ? <Form>\n            <RoutedTabs defaultTab='details'>\n                <Tab eventKey='details' title={<TabTitleText>Details</TabTitleText>}>\n                    <EditPolicyDetailsTab\n                        policy={ policy }\n                        setUpdatedPolicy={ setUpdatedPolicy } />\n                </Tab>\n\n                <Tab eventKey='rules' title={ <TabTitleText>Rules</TabTitleText> }>\n                    <EditPolicyRulesTab\n                        policy={ policy }\n                        handleSelect={ handleRuleSelect }\n                        selectedRuleRefIds={ selectedRuleRefIds }\n                        osMinorVersionCounts={ osMinorVersionCounts }\n                    />\n                </Tab>\n\n                <Tab eventKey='systems' title={ <TabTitleText>Systems</TabTitleText> }>\n                    <EditPolicySystemsTab\n                        osMajorVersion={ policy.osMajorVersion }\n                        policyOsMinorVersions={ uniq(policyProfiles.map(profile => profile.osMinorVersion)) }\n                    />\n                </Tab>\n            </RoutedTabs>\n        </Form> : <Spinner /> }\n    </Modal>;\n};\n\nEditPolicy.propTypes = {\n    route: propTypes.object\n};\n\nexport default EditPolicy;\n","import { useMutation } from '@apollo/react-hooks';\nimport {\n    ASSOCIATE_SYSTEMS_TO_PROFILES, CREATE_BUSINESS_OBJECTIVE, UPDATE_PROFILE, CREATE_PROFILE, ASSOCIATE_RULES_TO_PROFILE\n} from 'Utilities/graphql/mutations';\n\nconst useCreateBusinessObjective = () => {\n    const [create] = useMutation(CREATE_BUSINESS_OBJECTIVE);\n\n    return async (policy, newBusinessObjective) => {\n        if (policy?.businessObjective?.title === newBusinessObjective?.title) {\n            return policy?.businessObjective?.id;\n        } else if (newBusinessObjective?.title === '') {\n            return null;\n        } else {\n            const { data, error } = await create({ variables: {\n                input: { title: newBusinessObjective.title }\n            } });\n\n            if (error) { throw error; }\n\n            return data.createBusinessObjective.businessObjective.id;\n        }\n    };\n};\n\nconst useAssociateSystems = () => {\n    const [associateSystems] = useMutation(ASSOCIATE_SYSTEMS_TO_PROFILES);\n\n    return async ({ id }, hosts) => {\n        const { data, error } = await associateSystems({\n            variables: { input: {\n                id,\n                systemIds: hosts.map((h) => (h.id))\n            } }\n        });\n\n        if (error) { throw error; }\n\n        return data?.associateSystems?.profile;\n    };\n};\n\nconst useAssociateRules = () => {\n    const [associateRules] = useMutation(ASSOCIATE_RULES_TO_PROFILE);\n\n    return async ({ id, ruleRefIds }, profiles) => {\n        const profile = profiles.find((profile) => (\n            profile.id === id || profile.parentProfileId === id\n        ));\n        const ruleInput = {\n            id: profile?.id,\n            ruleRefIds\n        };\n\n        const { error } = await associateRules({ variables: { input: ruleInput } });\n        if (error) { throw error; }\n    };\n};\n\nconst usePolicy = () => {\n    const createBusinessObjective = useCreateBusinessObjective();\n    const [updateProfile] = useMutation(UPDATE_PROFILE);\n    const [createProfile] = useMutation(CREATE_PROFILE);\n    const associateSystems = useAssociateSystems();\n    const associateRules = useAssociateRules();\n\n    return async (policy, updatedPolicy, onProgress) => {\n        const selectedRuleRefIds = updatedPolicy?.selectedRuleRefIds || [];\n\n        const expectedUpdates = 3 + selectedRuleRefIds.length;\n        let progress = 0;\n        const dispatchProgress = () => {\n            if (onProgress) {\n                onProgress((++progress) / expectedUpdates);\n            }\n        };\n\n        const businessObjectiveId = await createBusinessObjective(policy, updatedPolicy?.businessObjective);\n        dispatchProgress();\n\n        let policyInput = {\n            name: updatedPolicy.name,\n            description: updatedPolicy.description,\n            complianceThreshold: parseFloat(updatedPolicy.complianceThreshold)\n        };\n\n        if (businessObjectiveId) {\n            policyInput.businessObjectiveId = businessObjectiveId;\n        }\n\n        if (policy === null) {\n            policyInput.cloneFromProfileId = updatedPolicy.cloneFromProfileId;\n            policyInput.refId = updatedPolicy.refId;\n            policyInput.benchmarkId = updatedPolicy.benchmarkId;\n\n            let {\n                data: { createProfile: { profile: { id } } },\n                error\n            } = await createProfile({ variables: { input: policyInput } });\n\n            if (error) { throw error; }\n\n            dispatchProgress();\n            policy = { id };\n        } else {\n            policyInput.id = policy.id;\n\n            let { error } = await updateProfile({ variables: { input: policyInput } });\n            if (error) { throw error; }\n\n            dispatchProgress();\n        }\n\n        const { policy: { profiles } } = await associateSystems(policy, updatedPolicy.hosts);\n        dispatchProgress();\n\n        for (const profileSelectedRuleRefIds of selectedRuleRefIds) {\n            await associateRules(profileSelectedRuleRefIds, profiles);\n            dispatchProgress();\n        }\n    };\n};\n\nexport default usePolicy;\n","import React from 'react';\nimport propTypes from 'prop-types';\nimport { UnsupportedSSGVersion } from 'PresentationalComponents';\n\nconst SSGVersion = ({ supported, ssgVersion }) => {\n    ssgVersion ||= 'Not available';\n    return supported ? ssgVersion :\n        <UnsupportedSSGVersion messageVariant='singular'>\n            { ssgVersion }\n        </UnsupportedSSGVersion>;\n};\n\nSSGVersion.propTypes = {\n    supported: propTypes.bool,\n    ssgVersion: propTypes.string\n};\n\nexport default {\n    SSGVersion\n};\n","import React, { memo } from 'react';\nimport propTypes from 'prop-types';\nimport { withApollo } from '@apollo/react-hoc';\nimport { connect } from 'react-redux';\nimport gql from 'graphql-tag';\nimport { pickBy } from 'lodash';\nimport SkeletonTable from '@redhat-cloud-services/frontend-components/SkeletonTable';\nimport ComplianceRemediationButton\n    from '@redhat-cloud-services/frontend-components-inventory-compliance/ComplianceRemediationButton';\nimport registry from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport {\n    NoSystemsTableBody\n} from 'PresentationalComponents';\n\nimport { exportFromState, selectAll, clearSelection, SELECT_ENTITY } from 'Store/ActionTypes';\nimport { systemsWithRuleObjectsFailed } from 'Utilities/ruleHelpers';\nimport { FilterConfigBuilder } from '@redhat-cloud-services/frontend-components-inventory-compliance/Utilities';\nimport { entitiesReducer } from 'Store/Reducers/SystemStore';\nimport {\n    DEFAULT_SYSTEMS_FILTER_CONFIGURATION, COMPLIANT_SYSTEMS_FILTER_CONFIGURATION,\n    systemsPolicyFilterConfiguration, systemsOsFilterConfiguration\n} from '@/constants';\nimport {\n    ErrorPage,\n    StateView,\n    StateViewPart\n} from 'PresentationalComponents';\nimport { TableVariant } from '@patternfly/react-table';\nimport { Alert } from '@patternfly/react-core';\nimport { InventoryTable } from '@redhat-cloud-services/frontend-components/Inventory';\n\nexport const GET_SYSTEMS = gql`\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n`;\n\nexport const GET_SYSTEMS_WITHOUT_FAILED_RULES = gql`\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n`;\n\nconst initFilterState = (filterConfig) => (\n    pickBy(filterConfig.initialDefaultState(), (value) => (!!value))\n);\n\nconst initialState = {\n    page: 1\n};\n\nconst policyFilter = (policies, osFilter) => ([\n    ...systemsPolicyFilterConfiguration(policies),\n    ...(osFilter ? systemsOsFilterConfiguration(policies) : [])\n]);\n\n@registry()\nclass SystemsTable extends React.Component {\n    inventory = React.createRef();\n    filterConfig = new FilterConfigBuilder([\n        ...DEFAULT_SYSTEMS_FILTER_CONFIGURATION,\n        ...(this.props.compliantFilter ? COMPLIANT_SYSTEMS_FILTER_CONFIGURATION : []),\n        ...(this.props.policies && this.props.policies.length > 0 ?\n            policyFilter(this.props.policies, this.props.showOsFilter) : [])\n    ]);\n    chipBuilder = this.filterConfig.getChipBuilder();\n    filterBuilder = this.filterConfig.getFilterBuilder();\n\n    state = {\n        ...initialState,\n        policyId: this.props.policyId,\n        perPage: 50,\n        totalCount: 0,\n        activeFilters: initFilterState(this.filterConfig)\n    }\n\n    componentDidMount = () => {\n        const { clearAll, selectedEntities } = this.props;\n        if (selectedEntities && selectedEntities.length > 0) {\n            clearAll();\n        }\n\n        (this.props.preselectedSystems ?\n            Promise.resolve(this.props.selectEntities(this.props.preselectedSystems)) : Promise.resolve())\n        .then(() => {\n            this.updateSystems();\n        });\n    }\n\n    componentDidUpdate = (prevProps) => {\n        if (prevProps.complianceThreshold !== this.props.complianceThreshold) {\n            this.updateSystems();\n        }\n    }\n\n    onRefresh = ({ page, per_page: perPage, ...options }) => {\n        const { showAllSystems } = this.props;\n        if (showAllSystems && this.inventory && this.inventory.current) {\n            this.setState({ page, perPage }, () => { this.inventory.current.onRefreshData({\n                page, perPage, ...options, per_page: perPage // eslint-disable-line camelcase\n            }); }\n            );\n        } else {\n            this.setState({ page, perPage }, () => this.updateSystems().then(() => {\n                if (this.inventory && this.inventory.current) {\n                    this.inventory.current.onRefreshData({\n                        page, perPage, ...options, per_page: perPage // eslint-disable-line camelcase\n                    });\n                }\n            }));\n        }\n    }\n\n    fetchSystems = () => {\n        const { defaultFilter, client, showOnlySystemsWithTestResults, remediationsEnabled } = this.props;\n        const { policyId, perPage, page, activeFilters } = this.state;\n        let filter = [\n            defaultFilter,\n            showOnlySystemsWithTestResults && 'has_test_results = true',\n            this.filterBuilder.buildFilterString(activeFilters)\n        ].filter((e)=>!!e).join(' and ');\n\n        let variables = { filter, perPage, page, policyId };\n\n        return client.query({\n            query: remediationsEnabled ? GET_SYSTEMS : GET_SYSTEMS_WITHOUT_FAILED_RULES,\n            fetchResults: true,\n            fetchPolicy: 'no-cache',\n            variables\n        });\n    }\n\n    updateSystems = () => {\n        const prevSystems = this.props.systems.map((s) => s.node.id).sort();\n        return this.fetchSystems().then((items) => this.props.updateSystems({\n            systems: items.data.systems.edges,\n            systemsCount: items.data.systems.totalCount\n        })\n        ).then(() => {\n            const newSystems = this.props.systems.map((s) => s.node.id).sort();\n            if (JSON.stringify(newSystems) === JSON.stringify(prevSystems)) {\n                this.props.updateRows();\n            }\n        }).catch((error) => {\n            this.setState(prevState => ({ ...prevState, error }));\n        });\n    }\n\n    onExportSelect = (_, format) => (\n        this.props.exportFromState(format)\n    )\n\n    onFilterUpdate = (filter, selectedValues) => {\n        this.props.updateSystems({\n            systems: [],\n            systemsCount: 0\n        });\n        this.setState({\n            ...initialState,\n            activeFilters: {\n                ...this.state.activeFilters,\n                [filter]: selectedValues\n            }\n        }, this.updateSystems);\n    }\n\n    deleteFilter = (chips) => {\n        const activeFilters =  this.filterConfig.removeFilterWithChip(\n            chips, this.state.activeFilters\n        );\n        this.setState({\n            ...initialState,\n            activeFilters\n        }, this.updateSystems);\n    }\n\n    clearAllFilter = () => {\n        this.setState({\n            ...initialState,\n            activeFilters: initFilterState(this.filterConfig)\n        }, this.updateSystems);\n    }\n\n    onFilterDelete = (_event, chips, clearAll = false) => {\n        clearAll ? this.clearAllFilter() : this.deleteFilter(chips[0]);\n    }\n\n    onBulkSelect = () => {\n        const { selectedEntities, selectAll, clearSelection, allSelectedOnPage } = this.props;\n\n        if (selectedEntities.length === 0 ||\n            (selectedEntities.length > 0 && !allSelectedOnPage)) {\n            selectAll();\n        } else {\n            clearSelection();\n        }\n    }\n\n    isExportDisabled = () => {\n        const { total, selectedEntities } = this.props;\n        return (total || 0) === 0 && selectedEntities.length === 0;\n    }\n\n    render() {\n        const {\n            remediationsEnabled, compact, enableExport, showAllSystems, showActions, showComplianceSystemsInfo,\n            selectedEntities, selectedEntitiesIds, systems, total, policyId, systemProps, columns\n        } = this.props;\n        const {\n            page, perPage, activeFilters, error\n        } = this.state;\n        let noError;\n        const filterConfig = this.filterConfig.buildConfiguration(\n            this.onFilterUpdate,\n            activeFilters,\n            { hideLabel: true }\n        );\n        const filterChips = this.chipBuilder.chipsFor(this.state.activeFilters);\n        const exportConfig = enableExport ? {\n            isDisabled: this.isExportDisabled(),\n            onSelect: this.onExportSelect\n        } : {};\n        const inventoryTableProps = {\n            ...systemProps,\n            onRefresh: this.onRefresh,\n            ref: this.inventory,\n            page,\n            perPage,\n            exportConfig,\n            tableProps: {\n                canSelectAll: false\n            },\n            bulkSelect: {\n                checked: selectedEntities.length > 0 ?\n                    (this.props.allSelectedOnPage ? true : null)\n                    : false,\n                onSelect: this.onBulkSelect,\n                count: selectedEntities.length,\n                label: selectedEntities.length > 0 ? `${ selectedEntities.length } Selected` : undefined\n            }\n        };\n\n        if (showActions) {\n            inventoryTableProps.actions = [{\n                title: 'View in inventory',\n                onClick: (_event, _index, { id }) => {\n                    const beta = window.location.pathname.split('/')[1] === 'beta';\n                    window.location.href = `${window.location.origin}${beta ? '/beta' : ''}/insights/inventory/${id}`;\n                }\n            }];\n        }\n\n        if (!showAllSystems) {\n            inventoryTableProps.total = total;\n            inventoryTableProps.items = systems.map((edge) => edge.node.id);\n            inventoryTableProps.filterConfig = filterConfig;\n            inventoryTableProps.activeFiltersConfig = {\n                filters: filterChips,\n                onDelete: this.onFilterDelete\n            };\n        }\n\n        if (compact) {\n            inventoryTableProps.variant = TableVariant.compact;\n        }\n\n        if (error === undefined) {\n            noError = true;\n        }\n\n        if (policyId && total === 0 && Object.keys(activeFilters).length === 0) {\n            inventoryTableProps.tableProps.rows = [{ cells: [{ title: <NoSystemsTableBody /> }] }];\n            inventoryTableProps.tableProps.columns = [];\n            inventoryTableProps.hasItems = false;\n            inventoryTableProps.hasCheckbox = false;\n        }\n\n        if (!showAllSystems && remediationsEnabled) {\n            inventoryTableProps.dedicatedAction = <ComplianceRemediationButton\n                allSystems={ systemsWithRuleObjectsFailed(systems.filter((edge) => (\n                    selectedEntitiesIds.includes(edge.node.id)\n                )).map(edge => edge.node)) }\n                selectedRules={ [] } />;\n        }\n\n        return (\n            <StateView stateValues={{ error, noError }}>\n                <StateViewPart stateKey='error'>\n                    <ErrorPage error={error}/>\n                </StateViewPart>\n                <StateViewPart stateKey='noError'>\n\n                    { showComplianceSystemsInfo && <Alert\n                        isInline\n                        variant=\"info\"\n                        title={ 'The list of systems in this view is different than those that appear in the Inventory. ' +\n                            'Only systems previously or currently associated with compliance policies are displayed.' } /> }\n                    <InventoryTable\n                        { ...inventoryTableProps }\n                        fallback={<SkeletonTable colSize={2} rowSize={15} />}\n                        onLoad={({ INVENTORY_ACTION_TYPES, mergeWithEntities }) => {\n                            this.getRegistry().register({\n                                ...mergeWithEntities(\n                                    entitiesReducer(\n                                        INVENTORY_ACTION_TYPES, columns, showAllSystems\n                                    ))\n                            });\n                        }}\n                    />\n                </StateViewPart>\n            </StateView>\n        );\n    }\n}\n\nSystemsTable.propTypes = {\n    allSelectedOnPage: propTypes.bool,\n    clearAll: propTypes.func,\n    clearInventoryFilter: propTypes.func,\n    clearSelection: propTypes.func,\n    client: propTypes.object,\n    columns: propTypes.array,\n    compact: propTypes.bool,\n    complianceThreshold: propTypes.number,\n    compliantFilter: propTypes.bool,\n    enableExport: propTypes.bool,\n    error: propTypes.object,\n    exportFromState: propTypes.func,\n    policies: propTypes.array,\n    policyId: propTypes.string,\n    defaultFilter: propTypes.string,\n    preselectedSystems: propTypes.array,\n    remediationsEnabled: propTypes.bool,\n    selectAll: propTypes.func,\n    selectEntities: propTypes.func,\n    selectedEntities: propTypes.array,\n    selectedEntitiesIds: propTypes.array,\n    showActions: propTypes.bool,\n    showAllSystems: propTypes.bool,\n    showOnlySystemsWithTestResults: propTypes.bool,\n    showOsFilter: propTypes.bool,\n    systems: propTypes.array,\n    total: propTypes.number,\n    updateRows: propTypes.func,\n    updateSystems: propTypes.func,\n    systemProps: propTypes.shape({\n        isFullView: propTypes.bool\n    }),\n    showComplianceSystemsInfo: propTypes.bool\n};\n\nSystemsTable.defaultProps = {\n    remediationsEnabled: true,\n    compact: false,\n    enableExport: true,\n    showAllSystems: false,\n    complianceThreshold: 0,\n    showOnlySystemsWithTestResults: false,\n    showActions: true,\n    compliantFilter: false,\n    selectedEntities: [],\n    selectedEntitiesIds: [],\n    systems: [],\n    clearAll: () => ({}),\n    exportFromState: () => ({}),\n    systemProps: {},\n    showComplianceSystemsInfo: false\n};\n\nconst mapStateToProps = state => {\n    if (state.entities === undefined || state.entities.rows === undefined) {\n        return { selectedEntities: [], systems: [] };\n    }\n\n    const allSelectedOnPage = state.entities.rows.filter((row) => (\n        !(state.entities.selectedEntities || []).map((e) => e.id).includes(row.id)\n    )).length === 0;\n\n    return {\n        allSelectedOnPage,\n        selectedEntities: state.entities.selectedEntities,\n        selectedEntitiesIds: (state.entities.selectedEntities || []).map((e) => (e.id)),\n        systems: state.entities.systems,\n        total: state.entities.total\n    };\n};\n\nconst mapDispatchToProps = dispatch => {\n    return {\n        clearInventoryFilter: () => dispatch({ type: 'CLEAR_FILTERS' }),\n        exportFromState: (format) => dispatch(exportFromState(format)),\n        updateSystems: (args) => {\n            dispatch({\n                type: 'UPDATE_SYSTEMS',\n                ...args\n            });\n        },\n        updateRows: () => dispatch({ type: 'UPDATE_ROWS' }),\n        selectAll: () => dispatch(selectAll()),\n        clearSelection: () => dispatch(clearSelection()),\n        clearAll: () => dispatch({\n            type: SELECT_ENTITY,\n            payload: { clearAll: true }\n        }),\n        selectEntities: (ids) => dispatch({\n            type: 'SELECT_ENTITIES',\n            payload: { ids }\n        })\n    };\n};\n\n// eslint-disable-next-line react/display-name\nconst ConnectedSystemsTable = memo((props) => {\n    return <SystemsTable {...props} />;\n});\n\nexport { default as Cells } from './Cells';\nexport { SystemsTable };\nexport const SystemsTableWithApollo = withApollo(ConnectedSystemsTable);\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(SystemsTableWithApollo);\n","import gql from 'graphql-tag';\nimport pickBy from 'lodash/pickBy';\nimport { systemsPolicyFilterConfiguration, systemsOsFilterConfiguration } from '@/constants';\n\nexport const GET_SYSTEMS = gql`\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    majorOsVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n`;\n\nexport const GET_SYSTEMS_WITHOUT_FAILED_RULES = gql`\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n`;\n\nexport const policyFilter = (policies, osFilter) => ([\n    ...systemsPolicyFilterConfiguration(policies),\n    ...(osFilter ? systemsOsFilterConfiguration(policies) : [])\n]);\n\nexport const initFilterState = (filterConfig) => (\n    pickBy(filterConfig.initialDefaultState(), (value) => (!!value))\n);\n","import React from 'react';\nimport propTypes from 'prop-types';\nimport Skeleton, { SkeletonSize } from '@redhat-cloud-services/frontend-components/Skeleton';\nimport { registryDecorator } from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport { InventoryDetail, DetailWrapper } from '@redhat-cloud-services/frontend-components/Inventory';\n\n@registryDecorator()\nclass InventoryDetails extends React.Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <DetailWrapper onLoad={({ mergeWithDetail }) => this.getRegistry().register({\n                ...mergeWithDetail()\n            })}>\n                <InventoryDetail fallback={<Skeleton size={ SkeletonSize.md } />} hideBack />\n            </DetailWrapper>\n        );\n    }\n}\n\nInventoryDetails.propTypes = {\n    entity: propTypes.object\n};\n\nconst ConnectedInventoryDetails = (props) => {\n    return <InventoryDetails {...props} />;\n};\n\nexport default ConnectedInventoryDetails;\n","import React, { useEffect, useState, useRef, useCallback } from 'react';\nimport { withApollo } from '@apollo/react-hoc';\nimport PropTypes from 'prop-types';\nimport { useStore, useDispatch, useSelector, shallowEqual } from 'react-redux';\nimport { getRegistry } from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport SkeletonTable from '@redhat-cloud-services/frontend-components/SkeletonTable';\nimport { policyFilter } from './constants';\nimport { systemsReducer } from 'Store/Reducers/SystemStore';\nimport { selectAll, clearSelection } from 'Store/ActionTypes';\nimport { exportFromState } from 'Utilities/Export';\nimport { DEFAULT_SYSTEMS_FILTER_CONFIGURATION, COMPLIANT_SYSTEMS_FILTER_CONFIGURATION } from '@/constants';\nimport debounce from 'lodash/debounce';\nimport {\n    ErrorPage,\n    StateView,\n    StateViewPart\n} from 'PresentationalComponents';\nimport { Alert } from '@patternfly/react-core';\nimport { TableVariant } from '@patternfly/react-table';\n// eslint-disable-next-line max-len\nimport ComplianceRemediationButton from '@redhat-cloud-services/frontend-components-inventory-compliance/ComplianceRemediationButton';\nimport { systemsWithRuleObjectsFailed } from 'Utilities/ruleHelpers';\nimport useFilterConfig from 'Utilities/hooks/useFilterConfig';\nimport { InventoryTable as FECInventoryTable } from '@redhat-cloud-services/frontend-components/Inventory';\n\nexport const InventoryTable = ({\n    columns,\n    showAllSystems,\n    policyId,\n    query,\n    client,\n    showActions,\n    enableExport,\n    compliantFilter,\n    policies,\n    showOnlySystemsWithTestResults,\n    showOsFilter,\n    error,\n    showComplianceSystemsInfo,\n    compact,\n    remediationsEnabled,\n    systemProps,\n    defaultFilter,\n    emptyStateComponent,\n    prependComponent\n}) => {\n    const store = useStore();\n    const dispatch = useDispatch();\n    const inventory = useRef(null);\n    const [pagination, setPagination] = useState({\n        perPage: 50,\n        page: 1\n    });\n    const [isLoaded, setIsLoaded] = useState(false);\n    const [isEmpty, setIsEmpty] = useState(false);\n    const { conditionalFilter, activeFilters, buildFilterString } = useFilterConfig([\n        ...DEFAULT_SYSTEMS_FILTER_CONFIGURATION,\n        ...(compliantFilter ? COMPLIANT_SYSTEMS_FILTER_CONFIGURATION : []),\n        ...(policies?.length > 0 ? policyFilter(policies, showOsFilter) : [])\n    ]);\n    const total = useSelector(({ entities }) => entities?.systemsCount) || 0;\n    const items = useSelector(({ entities } = {}) => (entities?.systems?.map((system) => (\n        system?.node?.id\n    )) || []), shallowEqual);\n    const selectedEntities = useSelector(({ entities } = {}) => (entities?.selectedEntities || []), shallowEqual);\n    const onBulkSelect = (isSelected) => isSelected ? dispatch(selectAll()) : dispatch(clearSelection());\n\n    const fetchSystems = (perPage = 50, page = 1) => {\n        setIsLoaded(false);\n\n        const filterString = buildFilterString();\n        const combindedFilter = [\n            ...showOnlySystemsWithTestResults ? ['has_test_results = true'] : [],\n            ...filterString?.length > 0 ? [filterString] : []\n        ].join(' and ');\n        const filter = defaultFilter ? `(${ defaultFilter }) and (${ combindedFilter })` : combindedFilter;\n\n        dispatch({ type: 'GET_SYSTEMS_PENDING' });\n        return client.query({\n            query,\n            fetchResults: true,\n            fetchPolicy: 'no-cache',\n            variables: {\n                filter,\n                perPage,\n                page,\n                ...policyId && { policyId }\n            }\n        }).then(({ data, loading }) => {\n            dispatch({\n                type: 'GET_SYSTEMS_FULFILLED',\n                systems: data.systems.edges,\n                systemsCount: data.systems.totalCount\n            });\n            setIsLoaded(true);\n            setPagination(() => ({ page, perPage }));\n\n            if (emptyStateComponent && !loading && data.systems.totalCount === 0) {\n                setIsEmpty(true);\n            }\n\n            return { data, loading };\n        });\n    };\n\n    const debounceFetchSystems = useCallback(\n        debounce(fetchSystems, 800),\n        [conditionalFilter.activeFiltersConfig.filters]\n    );\n\n    useEffect(() => {\n        if (conditionalFilter.activeFiltersConfig.filters) {\n            debounceFetchSystems(pagination.perPage, 1);\n        }\n    }, [activeFilters]);\n\n    const onRefresh = (options, callback) => {\n        query && fetchSystems(options.per_page, options.page);\n        if (!callback && inventory && inventory.current) {\n            inventory.current.onRefreshData(options);\n        } else if (callback) {\n            callback(options);\n        }\n    };\n\n    return <StateView stateValues={{ error, noError: error === undefined && !isEmpty, empty: isEmpty }}>\n        <StateViewPart stateKey='error'>\n            { !!prependComponent && prependComponent }\n            <ErrorPage error={error}/>\n        </StateViewPart>\n        <StateViewPart stateKey='empty'>\n            { emptyStateComponent }\n        </StateViewPart>\n        <StateViewPart stateKey='noError'>\n            { !!prependComponent && isLoaded && prependComponent }\n            { showComplianceSystemsInfo && <Alert\n                isInline\n                variant=\"info\"\n                title={ 'The list of systems in this view is different than those that appear in the Inventory. ' +\n                    'Only systems currently associated with or reporting against compliance policies are displayed.' } /> }\n            <FECInventoryTable\n                { ...systemProps }\n                onLoad={({\n                    INVENTORY_ACTION_TYPES,\n                    mergeWithEntities\n                }) => {\n                    getRegistry().register({\n                        ...mergeWithEntities(\n                            systemsReducer(\n                                INVENTORY_ACTION_TYPES, columns, showAllSystems, policyId\n                            ))\n                    });\n                }}\n                fallback={<SkeletonTable colSize={2} rowSize={15} />}\n                tableProps={{\n                    canSelectAll: false\n                }}\n                variant={compact ? TableVariant.compact : ''}\n                ref={inventory}\n                onRefresh={onRefresh}\n                bulkSelect={{\n                    checked: selectedEntities.length > 0 ?\n                        (items?.every(id => selectedEntities?.find((selected) => selected?.id === id)) ? true : null)\n                        : false,\n                    onSelect: onBulkSelect,\n                    count: selectedEntities.length,\n                    label: selectedEntities.length > 0 ? `${ selectedEntities.length } Selected` : undefined\n                }}\n                {...!showAllSystems && {\n                    ...pagination,\n                    isLoaded,\n                    items,\n                    total,\n                    ...conditionalFilter,\n                    ...remediationsEnabled && {\n                        dedicatedAction: <ComplianceRemediationButton\n                            allSystems={ systemsWithRuleObjectsFailed(selectedEntities) }\n                            selectedRules={ [] } />\n                    }\n                }}\n                {...enableExport && {\n                    exportConfig: {\n                        isDisabled: total === 0 && selectedEntities.length === 0,\n                        onSelect: (_, format) => exportFromState(store.getState()?.entities, format)\n                    }\n                }}\n                {...showActions && {\n                    actions: [{\n                        title: 'View in inventory',\n                        onClick: (_event, _index, { id }) => {\n                            const beta = window.location.pathname.split('/')[1] === 'beta';\n                            window.location.href = `${window.location.origin}${beta ? '/beta' : ''}/insights/inventory/${id}`;\n                        }\n                    }]\n                }}\n            />\n        </StateViewPart>\n    </StateView>;\n};\n\nInventoryTable.propTypes = {\n    columns: PropTypes.arrayOf(PropTypes.shape({})),\n    policies: PropTypes.arrayOf(PropTypes.shape({})),\n    client: PropTypes.object,\n    showAllSystems: PropTypes.bool,\n    policyId: PropTypes.string,\n    query: PropTypes.string,\n    showActions: PropTypes.bool,\n    enableExport: PropTypes.bool,\n    compliantFilter: PropTypes.bool,\n    showOnlySystemsWithTestResults: PropTypes.bool,\n    showOsFilter: PropTypes.bool,\n    showComplianceSystemsInfo: PropTypes.bool,\n    error: PropTypes.object,\n    compact: PropTypes.bool,\n    remediationsEnabled: PropTypes.bool,\n    defaultFilter: PropTypes.string,\n    systemProps: PropTypes.shape({\n        isFullView: PropTypes.bool\n    }),\n    emptyStateComponent: PropTypes.node,\n    prependComponent: PropTypes.node\n};\n\nInventoryTable.defaultProps = {\n    policyId: '',\n    showActions: true,\n    enableExport: true,\n    compliantFilter: false,\n    showOnlySystemsWithTestResults: false,\n    showComplianceSystemsInfo: false,\n    compact: false,\n    remediationsEnabled: true\n};\n\nexport default withApollo(InventoryTable);\n","const CSV_FILE_PREFIX = 'compliance-export';\nconst CSV_DELIMITER = ',';\n\nconst linkAndDownload = (data, filename) => {\n    if (!data) {\n        return;\n    }\n\n    let link = document.createElement('a');\n    link.setAttribute('href', data);\n    link.setAttribute('download', filename);\n    link.dispatchEvent(new MouseEvent(`click`, { bubbles: true, cancelable: true, view: window }));\n};\n\nconst getNestedObject = (nestedObj, path) => {\n    return path.split('.').reduce(\n        (obj, key) => (obj && obj[key] !== 'undefined') ? obj[key] : undefined, nestedObj\n    );\n};\n\nconst textCsvCell = (row, key) => {\n    let cell = getNestedObject(row, key);\n\n    if (cell.exportValue) {\n        cell = cell.exportValue;\n    }\n\n    if (typeof(cell) === 'object') {\n        cell = getNestedObject(row, key + '_text');\n    }\n\n    if (typeof(cell) === 'string' && cell.includes(',')) {\n        cell = '\"' + cell + '\"';\n    }\n\n    return cell;\n};\n\nexport const csvFromState = (state) => {\n    const { rows, columns, selectedEntities } = state;\n\n    if (rows) {\n        let csvRows = [columns.map((column) => column.title).join(CSV_DELIMITER)];\n        csvRows = csvRows.concat((selectedEntities || rows).map((row) => (\n            state.columns.map((column) => !column.noExport ? textCsvCell(row, column.key) : '').join(CSV_DELIMITER)\n        )));\n\n        return encodeURI('data:text/csv;charset=utf-8,' + csvRows.join('\\n'));\n    }\n};\n\nexport const jsonFromState = (state) => {\n    const { rows, columns, selectedEntities } = state;\n    let result;\n\n    if (rows) {\n        result = (selectedEntities || rows).map((row) => {\n            let object = {};\n            columns.forEach((column) => {\n                const keys = column.key.split('.');\n                const key = keys[keys.length - 1];\n                object[key] = textCsvCell(row, column.key);\n            });\n\n            return object;\n        });\n\n        return encodeURI('data:application/json;charset=utf-8,' + JSON.stringify(result));\n    }\n};\n\nconst filename = (format) => (\n    CSV_FILE_PREFIX + '-' + (new Date()).toISOString() + '.' + format\n);\n\nexport const exportFromState = (state, format) => {\n    let content;\n\n    if (format === 'csv') {\n        content = csvFromState(state);\n    } else if (format === 'json') {\n        content = jsonFromState(state);\n    }\n\n    linkAndDownload(content, filename(format));\n};\n\n","class ApiClient {\n    DEFAULT_API_HEADERS = {\n        'Content-Type': 'application/vnd.api+json',\n        Accept: 'application/json'\n    }\n\n    constructor(options = {}) {\n        this.apiBase = options.apiBase || '/api';\n        this.path = options.path || '';\n        this.authenticate = options.authenticate || (() => Promise.resolve({}));\n        this.onUnauthorised = options.onUnauthorised || (() => Promise.resolve({}));\n        this.defaultHeaders = options.headers || this.DEFAULT_API_HEADERS;\n    }\n\n    async request(path, apiProps, method, options = {}) {\n        return await this.callAuthenticate()\n        .then(() => this.fetch(path, apiProps, method, options))\n        .then(this.checkForEmptyResponse)\n        .then((response) => this.checkForErrors(response, options))\n        .then((response) => response.json())\n        .catch(this.finalCatch);\n    }\n\n    finalCatch(promise) {\n        if (promise.errors === undefined) {\n            return Promise.reject({ title: 'Error parsing' });\n        } else {\n            return Promise.reject({ ...promise });\n        }\n    }\n\n    fetch(path, apiProps, method, options) {\n        let params = {\n            method: method || 'get',\n            headers: this.defaultHeaders,\n            credentials: 'include'\n        };\n        const fullPath = `${ this.apiBase }${ this.path ? this.path : '' }${ path ? path : '' }`;\n        let url = new URL(fullPath, window.location.origin);\n        if (options.params) {\n            const params = Object.keys(options.params).map((key) => (\n                encodeURIComponent(key) + '=' + encodeURIComponent(options.params[key])\n            )).join('&');\n            url.search = new URLSearchParams(params);\n        }\n\n        if (apiProps) {\n            params.body = JSON.stringify(apiProps);\n        }\n\n        return fetch(\n            url, params\n        );\n    }\n\n    checkForEmptyResponse(response) {\n        return response.status === 204 ? { json: () => ({}) } : response;\n    }\n\n    checkForErrors(response, options = {}) {\n        if (response.status === 404 && options.ignore404) {\n            return { json: () => ({}) };\n        }\n\n        if (response.status === 401) {\n            return this.onUnauthorised();\n        }\n\n        const responseCloneJson = response.clone ? response.clone().json() : response;\n\n        if (response.status === 422) {\n            return responseCloneJson.then((json) =>\n                Promise.reject({ ...json, title: 'Validation error' })\n            );\n        }\n\n        if (response.status >= 400 && response.status <= 600) {\n            return responseCloneJson.then((json) =>\n                Promise.reject(json.errors[0])\n            );\n        }\n\n        return response;\n    }\n\n    callAuthenticate() {\n        return Promise.resolve(this.authenticate() || true);\n    }\n\n    create(path, apiProps) {\n        return this.request(path, apiProps, 'post');\n    }\n\n    update(path, apiProps) {\n        return this.request(path, apiProps, 'put');\n    }\n\n    get(path, options = {}) {\n        return this.request(path, null, 'get', options);\n    }\n\n    destroy(path) {\n        return this.request(path, null, 'delete');\n    }\n}\n\nexport default ApiClient;\n","import ApiClient from './utils/ApiClient';\n\nconst useApi = (options) => {\n    const apiClient = new ApiClient({\n        ...options\n    });\n\n    return apiClient;\n};\n\nexport default useApi;\n","import { useEffect, useState } from 'react';\nimport { COMPLIANCE_API_ROOT } from '@/constants';\nimport normalize from 'json-api-normalizer';\nimport useApi from './useApi';\n\nconst includePropAndDelete = (entity, prop) => {\n    const attributes = entity[prop];\n    let newEntity = entity;\n    delete newEntity[prop];\n    return { ...newEntity, ...attributes };\n};\n\nconst includeAttributes = (entity) => (\n    entity && includePropAndDelete(entity, 'attributes')\n);\n\nconst includeRelationship = (entity, normalizedJson) => {\n    let relationships = {};\n    Object.entries(entity?.relationships || []).forEach((item) => {\n        const [relationship, relationshipData] = item;\n        relationships[relationship] = relationshipData?.data.map((entity) => (\n            includeAttributes(normalizedJson?.[entity.type]?.[entity.id])\n        )).filter((v) => (!!v));\n    });\n    delete entity.relationships;\n    return { ...entity, ...relationships };\n};\n\nconst normalizeData = (json, type) => {\n    const jsonNormalized = normalize(json);\n    return Object.values(jsonNormalized[type] || {})?.map((entity) => (\n        includeRelationship(includeAttributes(entity), jsonNormalized)\n    ));\n};\n\nconst fetchCollection = async (apiClient, collection, params = {}, options = {}) => {\n    const json = await apiClient.get(`/${ collection }`, { params });\n    const normalized = await normalizeData(json, options?.type || collection);\n\n    return {\n        collection: normalized,\n        meta: json.meta,\n        total: json.meta.total,\n        json\n    };\n};\n\nconst useCollection = (collection, options = {}, effects = []) => {\n    const [collectionState, setCollectionState] = useState({\n        data: undefined,\n        loading: true,\n        error: undefined\n    });\n    const apiClient = useApi({\n        apiBase: COMPLIANCE_API_ROOT\n    });\n    const params = {\n        ...(options?.params || {}),\n        include: (options?.include || [])\n    };\n\n    useEffect(() => {\n        fetchCollection(apiClient, collection, params, options).then((data) => {\n            setCollectionState({\n                data,\n                loading: undefined,\n                error: undefined\n            });\n        });\n    }, effects);\n\n    return collectionState;\n};\n\nexport default useCollection;\n","export const profilesRulesFailed = (profiles) => (\n    profiles.flatMap(profile => profile.rules && profile.rules.filter(rule => !rule.compliant))\n);\n\nexport const profilesRulesPassed = (profiles) => (\n    profiles.flatMap(profile => profile.rules && profile.rules.filter(rule => rule.compliant))\n);\n\nexport const systemRulesPassed = (system) => (\n    system.testResultProfiles ? profilesRulesPassed(system.testResultProfiles) : []\n);\n\nexport const systemRulesFailed = (system) => (\n    system.testResultProfiles ? profilesRulesFailed(system.testResultProfiles) : []\n);\n\nexport const systemsWithRuleObjectsFailed = (systems) => (\n    systems.map(system => (\n        {\n            ...system,\n            ruleObjectsFailed: systemRulesFailed(system),\n            profiles: system.testResultProfiles\n        }\n    ))\n);\n","export const EXPORT = '@@COMPLIANCE/EXPORT';\nexport const SELECT_ENTITY = 'SELECT_ENTITY';\n\nexport const exportFromState = (format) => ({\n    type: EXPORT, payload: { format }\n});\n\nexport const selectAll = () => ({\n    type: SELECT_ENTITY,\n    payload: { id: 0, selected: true }\n});\n\nexport const clearSelection = () => ({\n    type: SELECT_ENTITY,\n    payload: { id: 0, selected: false }\n});\n","import React from 'react';\nimport { applyReducerHash } from '@redhat-cloud-services/frontend-components-utilities/ReducerRegistry';\nimport DateFormat from '@redhat-cloud-services/frontend-components/DateFormat';\nimport { Link } from 'react-router-dom';\nimport { EXPORT, SELECT_ENTITY } from 'Store/ActionTypes';\nimport { exportFromState } from 'Utilities/Export';\nimport {\n    ComplianceScore as complianceScore,\n    complianceScoreString\n} from 'PresentationalComponents';\nimport {\n    Tooltip,\n    Text,\n    TextContent,\n    TextVariants\n} from '@patternfly/react-core';\nimport {\n    profilesRulesPassed,\n    profilesRulesFailed\n} from 'Utilities/ruleHelpers';\nimport Truncate from 'react-truncate';\nimport { sortingByProp } from 'Utilities/helpers';\n\nconst NEVER = 'Never';\n\nexport const lastScanned = ({ testResultProfiles: profiles = [] }) => {\n    const dates = profiles.map((profile) => new Date(profile.lastScanned));\n    const last = new Date(Math.max.apply(null, dates.filter((date) => isFinite(date))));\n    const result = (last instanceof Date && isFinite(last)) ? last : NEVER;\n\n    return result;\n};\n\nexport const compliant = ({ testResultProfiles: profiles = [] }) => (\n    profiles.every(profile => profile.lastScanned === NEVER || profile.compliant === true)\n);\n\nexport const score = ({ testResultProfiles: profiles = [] }) => {\n    const scoreTotal = profiles.reduce((acc, profile) => acc + profile.score, 0);\n    const numScored = profiles.reduce((acc, profile) => {\n        if (profilesRulesPassed([profile]).length + profilesRulesFailed([profile]).length > 0) { return acc + 1; }\n\n        return acc;\n    }, 0);\n    if (numScored) { return scoreTotal / numScored; }\n\n    return 0;\n};\n\nexport const supported = ({ testResultProfiles: profiles = [] }) => (\n    profiles.reduce((acc, profile) => acc && profile.supported, true)\n);\n\nexport const policyNames = (system) => {\n    if (system === {}) { return ''; }\n\n    let policyNames = system.policies.map(({ name }) => name);\n    return policyNames.join(', ');\n};\n\nexport const policiesCell = ({ policyNames }) => ({\n    title: policyNames ? (\n        <Tooltip content={policyNames}>\n            <Truncate lines={2} width={540}>{policyNames}</Truncate>\n        </Tooltip>\n    ) : <Text className='grey-icon'>No policies</Text>,\n    exportValue: policyNames\n});\n\nexport const detailsLink = (system) => {\n    if (system.testResultProfiles && system.testResultProfiles.length > 0) {\n        return {\n            title: (\n                <Link to={{ pathname: `/systems/${system.id}` }}>\n                    View report\n                </Link>\n            )\n        };\n    }\n};\n\nexport const hasOsInfo = (matchingSystem) => (\n    typeof(matchingSystem.osMajorVersion) !== 'undefined' && typeof(matchingSystem.osMinorVersion) !== 'undefined' &&\n        matchingSystem.osMajorVersion !== null && matchingSystem.osMinorVersion !== null &&\n        !(matchingSystem.osMajorVersion === 0 && matchingSystem.osMinorVersion === 0)\n);\n\nconst displayNameCell = (system, matchingSystem) =>  ({\n    title: <TextContent>\n        { matchingSystem.name ? <Link to={{ pathname: `/systems/${matchingSystem.id}` }}>\n            { matchingSystem.name }\n        </Link> : system.display_name }\n        { hasOsInfo(matchingSystem) &&\n            <Text component={TextVariants.small}>RHEL {matchingSystem.osMajorVersion}.{matchingSystem.osMinorVersion}</Text> }\n    </TextContent>,\n    exportValue: system.display_name || matchingSystem.name\n});\n\nexport const systemName = (displayName, id, { osMajorVersion, osMinorVersion, name }) => (\n    <TextContent>\n        <Link to={{ pathname: `/systems/${id}` }}>\n            { displayName || name }\n        </Link>\n        { hasOsInfo({ osMajorVersion, osMinorVersion }) &&\n            <Text component={TextVariants.small}>RHEL {osMajorVersion}.{osMinorVersion}</Text> }\n    </TextContent>\n);\n\nconst isSelected = (id, selectedEntities) => (\n    !!(selectedEntities || []).find((entity) => (entity.id === id))\n);\n\nconst profilesSsgVersions = ({ testResultProfiles: profiles = [] }) => (\n    profiles.map((p) => (p.ssgVersion)).filter((version) => (!!version)).join(', ')\n);\n\nexport const mapCountOsMinorVersions = (systems) => {\n    if (!systems) { return {}; }\n\n    return systems.reduce((acc, { osMinorVersion }) => {\n        if (osMinorVersion !== undefined && osMinorVersion !== null) {\n            (acc[osMinorVersion] = acc[osMinorVersion] || { osMinorVersion, count: 0 }).count++;\n        }\n\n        return acc;\n    }, {});\n};\n\nexport const countOsMinorVersions = (systems) => (\n    Object.values(mapCountOsMinorVersions(systems)).sort(sortingByProp('osMinorVersion', 'desc'))\n);\n\nexport const systemsToInventoryEntities = (systems, entities, showAllSystems, selectedEntities) => (\n    entities.map(entity => {\n        // This should compare the inventory ID instead with\n        // the ID in compliance\n        if (entity.facts === undefined) { entity.facts = {}; }\n\n        let matchingSystem = systems.map((s) => s.node).find((system) => {\n            return entity.id === system.id;\n        });\n        if (matchingSystem === undefined) {\n            if (!showAllSystems) { return; }\n\n            matchingSystem = { testResultProfiles: [], policies: [] };\n        }\n\n        matchingSystem.policyNames = policyNames(matchingSystem);\n        matchingSystem.rulesPassed = profilesRulesPassed(matchingSystem.testResultProfiles).length;\n        matchingSystem.rulesFailed = profilesRulesFailed(matchingSystem.testResultProfiles).length;\n        matchingSystem.lastScanned = lastScanned(matchingSystem);\n        matchingSystem.compliant = compliant(matchingSystem);\n        matchingSystem.score = score(matchingSystem);\n        matchingSystem.supported = supported(matchingSystem);\n\n        return {\n            /* eslint-disable camelcase */\n            id: entity.id,\n            selected: isSelected(entity.id, selectedEntities),\n            account: entity.account,\n            bios_uuid: entity.bios_uuid,\n            created: entity.created,\n            display_name: entity.display_name || matchingSystem.name,\n            fqdn: entity.fqdn,\n            insights_id: entity.insights_id,\n            ip_addresses: entity.ip_addresses,\n            mac_addresses: entity.mac_addresses,\n            rhel_machine_id: entity.rhel_machine_id,\n            satellite_id: entity.satellite_id,\n            subscription_manager_id: entity.subscription_manager_id,\n            tags: entity.tags,\n            updated: entity.updated,\n            facts: {\n                inventory: {\n                    hostname: (entity.facts.inventory !== undefined) ?\n                        entity.facts.inventory.hostname :\n                        entity.facts.hostname,\n                    machine_id: (entity.facts.inventory !== undefined) ?\n                        entity.facts.inventory.machine_id :\n                        entity.facts.machine_id,\n                    release: (entity.facts.inventory !== undefined) ?\n                        entity.facts.inventory.release :\n                        entity.facts.release\n                },\n                compliance: {\n                    display_name: displayNameCell(entity, matchingSystem),\n                    policies: policiesCell(matchingSystem),\n                    details_link: detailsLink(matchingSystem),\n                    rules_passed: matchingSystem.rulesPassed,\n                    rules_failed: { title: <Link to={{\n                        pathname: `/systems/${matchingSystem.id}`,\n                        query: {\n                            hidePassed: true\n                        }\n                    }}>{matchingSystem.rulesFailed}</Link> },\n                    rules_failed_text: matchingSystem.rulesFailed,\n                    compliance_score: complianceScore(matchingSystem),\n                    compliance_score_text: complianceScoreString(matchingSystem),\n                    last_scanned: (matchingSystem.lastScanned instanceof Date) ?\n                        { title: <DateFormat date={Date.parse(matchingSystem.lastScanned)} type='relative' /> } :\n                        matchingSystem.lastScanned,\n                    last_scanned_text: matchingSystem.lastScanned,\n                    ssg_version: profilesSsgVersions(matchingSystem),\n                    supported: matchingSystem.supported\n                }\n            }\n            /* eslint-enable camelcase */\n        };\n    }).filter((value) => (!!value))\n);\n\nconst systemsToRows = (systems) => (\n    systems.map(({ node }) => ({\n        ...node,\n        policyNames: policyNames({ policies: node?.policies, testResultProfiles: [] }),\n        rulesPassed: profilesRulesPassed(node.testResultProfiles).length,\n        rulesFailed: profilesRulesFailed(node.testResultProfiles).length,\n        lastScanned: lastScanned(node),\n        compliant: compliant(node),\n        display_name: node.name, // eslint-disable-line camelcase\n        score: score(node),\n        supported: supported(node),\n        ssgVersion: profilesSsgVersions(node),\n        detailsLink: detailsLink(node)\n    }))\n);\n\nconst selectRowsByIds = (state, ids) => {\n    const rowsToSelect = state.rows.filter((row) => (\n        ids.includes(row.id) && !(state.selectedEntities || []).map((e) => (e.id)).includes(row.id)\n    ));\n\n    return {\n        ...state,\n        selectedEntities: (state.selectedEntities || []).concat(rowsToSelect)\n    };\n};\n\nconst deselectRowsByIds = (state, ids) => ({\n    ...state,\n    selectedEntities: (state.selectedEntities || []).filter((row) => !ids.includes(row.id))\n});\n\nconst selectAllRows = (state) => (\n    selectRowsByIds(state, state.rows.map((row) => (row.id)))\n);\n\nconst deselectAllRows = (state) => (\n    deselectRowsByIds(state, state.rows.map((row) => (row.id)))\n);\n\nconst selectRow = (state, id) => (\n    selectRowsByIds(state, [id])\n);\n\nconst deselectRow = (state, id) => (\n    deselectRowsByIds(state, [id])\n);\n\nexport const systemsReducer = (INVENTORY_ACTION, columns) => applyReducerHash({\n    ['GET_SYSTEMS_PENDING']: (state) => ({\n        ...state,\n        rows: [],\n        systems: undefined,\n        systemsCount: undefined,\n        columns,\n        loaded: false\n    }),\n    ['GET_SYSTEMS_FULFILLED']: (state, { systems, systemsCount }) => ({\n        ...state,\n        systems,\n        systemsCount,\n        total: systemsCount,\n        rows: systemsToRows(systems).map((row) => ({\n            ...row, selected: isSelected(row.id, state.selectedEntities)\n        })),\n        columns,\n        loaded: true\n    }),\n    [INVENTORY_ACTION.LOAD_ENTITIES_PENDING]: (state) => ({\n        ...state,\n        total: state.systemsCount,\n        rows: state.systems !== undefined ? systemsToRows(state.systems).map((row) => ({\n            ...row, selected: isSelected(row.id, state.selectedEntities)\n        })) : [],\n        columns,\n        loaded: state.systemsCount !== undefined\n    }),\n    [INVENTORY_ACTION.LOAD_ENTITIES_FULFILLED]: (state) => ({\n        ...state,\n        total: state.systemsCount,\n        rows: state.systems !== undefined ? systemsToRows(state.systems).map((row) => ({\n            ...row, selected: isSelected(row.id, state.selectedEntities)\n        })) : [],\n        columns,\n        loaded: state.systemsCount !== undefined\n    }),\n    [SELECT_ENTITY]: (state, { payload: { id, selected, clearAll } }) => {\n        let newState;\n\n        if (id === 0) {\n            newState = selected ? selectAllRows(state) : deselectAllRows(state);\n        } else {\n            newState = selected ? selectRow(state, id) : deselectRow(state, id);\n        }\n\n        if (newState.selectedEntities.length === 0 || clearAll) {\n            newState.selectedEntities = undefined;\n        }\n\n        return newState;\n    },\n    ['SELECT_ENTITIES']: (state, { payload: { ids } }) => ({\n        selectedEntities: ids\n    })\n});\n\nexport const entitiesReducer = (INVENTORY_ACTION, columns, showAllSystems) => applyReducerHash(\n    {\n        ['UPDATE_SYSTEMS']: (state, { systems, systemsCount }) => ({\n            ...state,\n            systems,\n            systemsCount\n        }),\n        ['UPDATE_ROWS']: (state) => ({\n            ...state,\n            loaded: true,\n            rows: systemsToInventoryEntities(\n                state.systems || [],\n                state.rows || [],\n                showAllSystems,\n                state.selectedEntities\n            )\n        }),\n        [INVENTORY_ACTION.LOAD_ENTITIES_FULFILLED]: (state) => ({\n            ...state,\n            rows: systemsToInventoryEntities(\n                state.systems || [],\n                state.rows,\n                showAllSystems,\n                state.selectedEntities\n            ),\n            total: !showAllSystems ? state.systemsCount : state.total,\n            columns: state.total > 0 ? columns : [{ title: '' }]\n        }),\n        [EXPORT]: (state, { payload: { format } }) => {\n            exportFromState(state, format);\n            return state;\n        },\n        [SELECT_ENTITY]: (state, { payload: { id, selected, clearAll } }) => {\n            let newState;\n\n            if (id === 0) {\n                newState = selected ? selectAllRows(state) : deselectAllRows(state);\n            } else {\n                newState = selected ? selectRow(state, id) : deselectRow(state, id);\n            }\n\n            if (newState.selectedEntities.length === 0 || clearAll) {\n                newState.selectedEntities = undefined;\n            }\n\n            return newState;\n        },\n        ['SELECT_ENTITIES']: (state, { payload: { ids } }) => ({\n            selectedEntities: ids\n        })\n    }\n);\n"],"sourceRoot":""}