(self.webpackChunkcompliance=self.webpackChunkcompliance||[]).push([[30],{10709:(e,t,n)=>{"use strict";n.d(t,{Dy:()=>v,Jd:()=>y,_M:()=>g,_v:()=>h,nT:()=>m,oI:()=>d,r0:()=>b});var r,o,i,l,a,c,s,u,p=n(30168),f=n(67521),m=(0,f.ZP)(r||(r=(0,p.Z)(["\n  mutation CreateProfile($input: createProfileInput!) {\n    createProfile(input: $input) {\n      profile {\n        id\n      }\n    }\n  }\n"]))),d=(0,f.ZP)(o||(o=(0,p.Z)(["\n  mutation associateSystems($input: associateSystemsInput!) {\n    associateSystems(input: $input) {\n      profile {\n        id\n        policy {\n          id\n          profiles {\n            id\n            parentProfileId\n            osMinorVersion\n            benchmark {\n              valueDefinitions {\n                defaultValue\n                description\n                id\n                refId\n                title\n                valueType\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),v=((0,f.ZP)(i||(i=(0,p.Z)(["\n  mutation associateProfiles($input: associateProfilesInput!) {\n    associateProfiles(input: $input) {\n      system {\n        id\n        name\n        profiles {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),(0,f.ZP)(l||(l=(0,p.Z)(["\n  mutation associateRules($input: associateRulesInput!) {\n    associateRules(input: $input) {\n      profile {\n        id\n      }\n    }\n  }\n"])))),b=(0,f.ZP)(a||(a=(0,p.Z)(["\n  mutation UpdateProfile($input: UpdateProfileInput!) {\n    updateProfile(input: $input) {\n      profile {\n        id\n        name\n        complianceThreshold\n        businessObjectiveId\n        description\n        values\n      }\n    }\n  }\n"]))),y=(0,f.ZP)(c||(c=(0,p.Z)(["\n  mutation createBusinessObjective($input: createBusinessObjectiveInput!) {\n    createBusinessObjective(input: $input) {\n      businessObjective {\n        id\n        title\n      }\n    }\n  }\n"]))),h=(0,f.ZP)(s||(s=(0,p.Z)(["\n  mutation DeleteProfile($input: deleteProfileInput!) {\n    deleteProfile(input: $input) {\n      profile {\n        id\n      }\n    }\n  }\n"]))),g=(0,f.ZP)(u||(u=(0,p.Z)(["\n  mutation DeleteReport($input: deleteTestResultsInput!) {\n    deleteTestResults(input: $input) {\n      profile {\n        id\n      }\n    }\n  }\n"])))},67026:(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n(4942),o=n(15861),i=n(70885),l=n(64687),a=n.n(l),c=n(61770),s=n(10709);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const f=function(){var e=(0,c.D)(s.r0),t=(0,i.Z)(e,1)[0],n=(0,c.D)(s.nT),r=(0,i.Z)(n,1)[0];return function(){var e=(0,o.Z)(a().mark((function e(n,o,i){var l,c,s,u,f,m,d,v,b,y,h,g,O,E,P,j;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=o.name,c=o.description,s=o.complianceThreshold,u=o.values,f=p(p(p(p(p({},l&&{name:l}),c&&{description:c}),(i||null===i)&&{businessObjectiveId:i}),s?{complianceThreshold:parseFloat(s)}:{}),u&&{values:u}),!n){e.next=11;break}return b=p({id:n},f),e.next=6,t({variables:{input:b}});case 6:y=e.sent,m=null===(v=y.data)||void 0===v||null===(v=v.updateProfile)||void 0===v?void 0:v.profile,d=y.error,e.next=18;break;case 11:return g=o.cloneFromProfileId,O=o.refId,E=o.benchmarkId,P=p(p({},f),{},{cloneFromProfileId:g,refId:O,benchmarkId:E}),e.next=15,r({variables:{input:P}});case 15:j=e.sent,m=null===(h=j.data)||void 0===h||null===(h=h.createProfile)||void 0===h?void 0:h.profile,d=j.error;case 18:if(!d){e.next=20;break}throw d;case 20:return e.abrupt("return",m);case 21:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}},4992:(e,t,n)=>{"use strict";n.d(t,{_v:()=>r._v,_M:()=>r._M,a7:()=>y});var r=n(10709),o=n(70885),i=n(4942),l=n(45987),a=n(15861),c=n(64687),s=n.n(c),u=n(61770);var p=n(67026);var f=["values","selectedRuleRefIds"];function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const y=function(){var e,t,n=(e=(0,u.D)(r.Jd),t=(0,o.Z)(e,1)[0],function(){var e=(0,a.Z)(s().mark((function e(n,r){var o,i,l,a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null==n||null===(o=n.businessObjective)||void 0===o?void 0:o.title)!==(null==r?void 0:r.title)){e.next=4;break}return e.abrupt("return",null==n||null===(i=n.businessObjective)||void 0===i?void 0:i.id);case 4:if(""!==(null==r?void 0:r.title)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,t({variables:{input:{title:r.title}}});case 10:if(l=e.sent,a=l.data,!(c=l.error)){e.next=15;break}throw c;case 15:return e.abrupt("return",a.createBusinessObjective.businessObjective.id);case 16:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),i=(0,p.Z)(),c=function(){var e=(0,u.D)(r.oI),t=(0,o.Z)(e,1)[0];return function(){var e=(0,a.Z)(s().mark((function e(n,r){var o,i,l,a,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.id,e.next=3,t({fetchPolicy:"no-cache",variables:{input:{id:i,systemIds:r.map((function(e){return e.id}))}}});case 3:if(l=e.sent,a=l.data,!(c=l.error)){e.next=8;break}throw c;case 8:return e.abrupt("return",null==a||null===(o=a.associateSystems)||void 0===o?void 0:o.profile);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}(),d=function(){var e=(0,u.D)(r.Dy),t=(0,o.Z)(e,1)[0];return function(){var e=(0,a.Z)(s().mark((function e(n,r){var o,i,l,a,c,u,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.id,i=n.osMinorVersion,l=n.ruleRefIds,a=r.find((function(e){return e.id===o||e.parentProfileId===o&&e.osMinorVersion===i})),c={id:null==a?void 0:a.id,ruleRefIds:l},e.next=5,t({fetchPolicy:"no-cache",variables:{input:c}});case 5:if(u=e.sent,!(p=u.error)){e.next=9;break}throw p;case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}();return function(){var e=(0,a.Z)(s().mark((function e(t,r,a){var u,p,v,y,h,g,O,E,P,j,w,x,T,C,Z,S,k,I;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p=r.values,v=void 0===p?{}:p,y=r.selectedRuleRefIds,h=(0,l.Z)(r,f),g=3+Object.keys(v).length+(y||[]).length,O=0,E=function(){a&&a(++O/g)},e.next=6,n(t,null==h?void 0:h.businessObjective);case 6:return P=e.sent,E(),e.next=10,i(null===(u=t)||void 0===u?void 0:u.id,b(b({},h),{},{selectedRuleRefIds:y}),P);case 10:return j=e.sent,E(),t||(t=j),e.next=15,c(t,h.hosts);case 15:w=e.sent,x=w.policy.profiles,E(),T=m(y||[]),e.prev=19,T.s();case 21:if((C=T.n()).done){e.next=28;break}return Z=C.value,e.next=25,d(Z,x);case 25:E();case 26:e.next=21;break;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(19),T.e(e.t0);case 33:return e.prev=33,T.f(),e.finish(33);case 36:S=s().mark((function e(){var t,n,r,l,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.Z)(I[k],2),n=t[0],r=t[1],l=x.find((function(e){var t=e.id,r=e.parentProfileId;return t===n||r===n})),a=Object.fromEntries(Object.entries(r).map((function(e){var t,n=(0,o.Z)(e,2),r=n[0],i=n[1];return[(null==l||null===(t=l.benchmark.valueDefinitions.find((function(e){return e.id===r})))||void 0===t?void 0:t.refId)||r,i]}))),e.next=5,i(l.id,{values:a});case 5:E();case 6:case"end":return e.stop()}}),e)})),k=0,I=Object.entries(v);case 38:if(!(k<I.length)){e.next=43;break}return e.delegateYield(S(),"t1",40);case 40:k++,e.next=38;break;case 43:return e.abrupt("return",j);case 44:case"end":return e.stop()}}),e,null,[[19,30,33,36]])})));return function(t,n,r){return e.apply(this,arguments)}}()}},19949:(e,t,n)=>{"use strict";n.d(t,{Z:()=>E});var r,o=n(30168),i=n(92950),l=n.n(i),a=n(45697),c=n.n(a),s=n(73980),u=n(48830),p=n(76309),f=n(92397),m=n(65115),d=n(7162),v=n(67521),b=n(90570),y=n(97481),h=n(70187),g=(0,v.ZP)(r||(r=(0,o.Z)(['\n  {\n    profiles(search: "external = false and canonical = false") {\n      totalCount\n    }\n  }\n']))),O=function(e){var t=e.title,n=e.mainButton,r=e.client,o=(0,b.a)(g,{fetchPolicy:"network-only",client:r}),i=o.data,a=o.error;if(o.loading)return l().createElement(y.Z,null);if(a){var c="Oops! Error loading System data: ".concat(a);return l().createElement(h._U,{errorMsg:c})}var s=i.profiles.totalCount,u=s>1?"policies":"policy",p=s>1?"have":"has";return l().createElement(m.EmptyState,null,l().createElement(m.EmptyStateIcon,{style:{fontWeight:"500",color:"var(--pf-global--primary-color--100)"},size:"xl",title:"Compliance",icon:d.ZP}),l().createElement(m.Title,{headingLevel:"h2",size:"lg"},t),l().createElement(m.EmptyStateBody,null,s>0?l().createElement(m.TextContent,null,l().createElement(f.Z,{to:"/scappolicies"},s," ",u)," ",p," been created but ",p," no reports."):l().createElement(l().Fragment,null),l().createElement(m.TextContent,null,"The Compliance service uses SCAP policies to track your organization's adherence to compliance requirements."),l().createElement(m.TextContent,null,"Get started by adding a policy, or read documentation about how to connect OpenSCAP to the Compliance service.")),l().createElement(m.EmptyStatePrimary,null,n),l().createElement(m.EmptyStateSecondaryActions,null,l().createElement(m.Button,{variant:"link",component:"a",target:"_blank",rel:"noopener noreferrer",href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/assessing_and_monitoring_security_policy_compliance_of_rhel_systems/index"},"Learn about OpenSCAP and Compliance")))};O.propTypes={title:c().string,mainButton:c().object,client:c().object},O.defaultProps={title:"No policies",mainButton:l().createElement(m.Button,{variant:"primary",component:"a",href:"/insights/compliance/scappolicies"},"Create new policy"),client:new s.fe({link:new u.u({uri:"/api/compliance/graphql",credentials:"include"}),cache:new p.h4})};const E=O},55942:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(92950),o=n.n(r),i=n(45697),l=n.n(i),a=n(65115),c=function(e){var t=e.text,n=void 0===t?"Remediate":t;return o().createElement(a.Button,{variant:"primary",isDisabled:!0},n)};c.propTypes={text:l().string};const s=c},80976:(e,t,n)=>{"use strict";n.d(t,{k:()=>d,w:()=>m});var r=n(42982),o=n(4942),i=n(89734),l=n.n(i);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(e){return{id:"ssg:rhel".concat(e.profile.osMajorVersion,"|").concat(e.profile.refId.split("xccdf_org.ssgproject.content_profile_")[1],"|").concat(e.refId),description:e.title,systems:e.systems}},p=function(e){var t=e.compliant,n=e.remediationAvailable;return!1===t&&n},f=function(e){return function(t,n){var o,i=function(e){return Array.from(new Set(e.testResultProfiles.flatMap((function(e){return e.rules.filter(p).map((function(t){return s(s({},t),{},{profile:e})}))}))))}(n),l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw i}}}}(i);try{for(l.s();!(o=l.n()).done;){var c,u=o.value,f=s(s(s({},u),t[u.refId]),{},{systems:Array.from(new Set([].concat((0,r.Z)((null===(c=t[u.refId])||void 0===c?void 0:c.systems)||[]),[n.id])))});(null==e?void 0:e.length)>0?e.map((function(e){return e.refId})).includes(u.refId)&&(t[u.refId]=f):t[u.refId]=f}}catch(e){l.e(e)}finally{l.f()}return t}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.systems,n=e.selectedRules,r=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter((function(e){return e.testResultProfiles.some((function(e){return e.supported}))}))}(t),o=function(e){return l()(e,["precedence"])}(function(e,t){return Object.values(e.reduce(f(t),[]))}(r,n)).map(u);return s({},o.length>0?{issues:o}:{})},d=function(e){if(e)return m({systems:e.reduce((function(e,t){var n=t.edges;return[].concat((0,r.Z)(e),(0,r.Z)(n.map((function(e){return e.node}))))}),[])})}},74726:(e,t,n)=>{"use strict";n.d(t,{_:()=>a,d:()=>c});var r=n(87462),o=n(92950),i=n.n(o),l=n(65115),a=function(e){return i().createElement(l.TextInput,(0,r.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))},c=function(e){return i().createElement(l.TextArea,(0,r.Z)({value:e.input.value||e.defaultValue,onChange:e.input.onChange},e))}},49269:(e,t,n)=>{"use strict";n.d(t,{Jr:()=>w,KH:()=>Z,GC:()=>E,pT:()=>S,$9:()=>O,zb:()=>C});var r=n(4942),o=n(92950),i=n.n(o),l=n(45697),a=n.n(l),c=n(65115),s=n(68778),u=n(43047),p=n(69957),f=n(73479),m=n(16712),d=function(e){var t=e.hasPlaybook,n=void 0!==t&&t;return i().createElement(i().Fragment,null,n&&i().createElement(m.ZP,null),n?" Playbook":" Manual")};d.propTypes={hasPlaybook:a().bool};const v=d;var b=n(77346);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g={title:a().string,identifier:a().object,profile:a().object,compliant:a().bool,remediationAvailable:a().bool,severity:a().string},O=function(e){var t=e.title,n=e.identifier,r=e.compliant,o=void 0===r||r,l=(0,b.ZP)("ruleGroups");return i().createElement(c.TextContent,{style:h({},!o&&l?{fontWeight:"bold",color:"var(--pf-global--danger-color--100)"}:{})},t,n?i().createElement(c.Text,{component:c.TextVariants.small},n.label):"")};O.propTypes=g;var E=function(e){return e.profile.name};E.propTypes=g;var P=function(){return i().createElement("span",null,i().createElement(u.ZP,{className:"ins-u-failed"})," High")},j=function(){return i().createElement("span",null,i().createElement(p.ZP,{className:"ins-u-warning"})," Medium")},w=function(){return i().createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 18 18",role:"img",style:{verticalAlign:"-0.125em"},xmlns:"http://www.w3.org/2000/svg"},i().createElement("path",{d:"M2 0h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm6.67 10.46a1.67 1.67 0 1 0 0 3.338 1.67 1.67 0 0 0 0-3.338zm-1.586-6l.27 4.935a.435.435 0 0 0 .434.411H9.55c.232 0 .422-.18.435-.411l.27-4.936A.435.435 0 0 0 9.818 4h-2.3c-.25 0-.448.21-.435.46z",fill:"#3A9CA6",fillRule:"evenodd"}))},x=function(){return i().createElement("span",null,i().createElement(w,null)," Low")},T=function(){return i().createElement("span",null,i().createElement(f.ZP,null)," Unknown")},C=function(e){var t=e.severity;return{high:i().createElement(P,null),medium:i().createElement(j,null),low:i().createElement(x,null)}[null==t?void 0:t.toLowerCase()]||i().createElement(T,null)};C.propTypes=g;var Z=function(e){return e.compliant?i().createElement(s.ZP,{className:"ins-u-passed"}):i().createElement(u.ZP,{className:"ins-u-failed"})};Z.propTypes=g;var S=function(e){var t=e.remediationAvailable;return i().createElement(v,{hasPlaybook:t})};S.propTypes=g},94263:(e,t,n)=>{"use strict";n.d(t,{VG:()=>l,ZP:()=>p,uH:()=>u,zb:()=>c});var r=n(46818),o=n(79886),i=n(49269),l={title:"Name",sortByProp:"title",renderExport:function(e){var t=e.title,n=e.identifier;return"".concat(t).concat(n?" - ".concat(n.label):"")},renderFunc:(0,o.SO)(i.$9)},a={title:"Policy",sortByFunction:function(e){var t;return null==e||null===(t=e.profile)||void 0===t?void 0:t.name},renderExport:function(e){var t;return null==e||null===(t=e.profile)||void 0===t?void 0:t.name},renderFunc:(0,o.SO)(i.GC)},c={title:"Severity",sortByProp:"severity",exportKey:"severity",sortByArray:["high","medium","low","unknown"],renderFunc:(0,o.SO)(i.zb)},s={title:"Rule state",sortByProp:"compliant",renderExport:function(e){return null!=e&&e.compliant?"Yes":"No"},renderFunc:(0,o.SO)(i.KH),transforms:[r.E0]},u={title:"Remediation",transforms:[r.P8],sortByFunction:function(e){return null==e?void 0:e.remediationAvailable},renderExport:function(e){return null!=e&&e.remediationAvailable?"Playbook":"Manual"},renderFunc:(0,o.SO)(i.pT)};const p=[l,a,c,s,u]},45465:(e,t,n)=>{"use strict";n.d(t,{Z:()=>ve});var r=n(4942),o=n(87462),i=n(70885),l=n(45987),a=n(92950),c=n.n(a),s=n(45697),u=n.n(s),p=n(72971),f=n(15861),m=n(64687),d=n.n(m),v=n(98132),b=n(65811),y=n(80976),h=n(55942),g=function(e){var t,n=e.allSystems,r=e.selectedRules,o=(0,a.useMemo)((function(){return(0,y.w)({systems:n,selectedRules:r})}),[null==n?void 0:n.map((function(e){return e.id})).join(),null==r?void 0:r.map((function(e){return e.refId})).join()]);return c().createElement(v.Z,{isDisabled:!((null===(t=o.issues)||void 0===t?void 0:t.length)>0),onRemediationCreated:function(e){return(0,b.q)(e.getNotification())},dataProvider:(0,f.Z)(d().mark((function e(){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",o);case 1:case"end":return e.stop()}}),e)}))),buttonProps:{ouiaId:"RemediateButton"},fallback:c().createElement(h.Z,null)},"Remediate")};g.propTypes={selectedRules:u().array,allSystems:u().arrayOf(u().shape({id:u().string,name:u().string,supported:u().bool.isRequired,profiles:u().arrayOf(u().shape({refId:u().string,name:u().string,rules:u().arrayOf(u().shape({title:u().string,severity:u().string,rationale:u().string,refId:u().string,description:u().string,compliant:u().bool,identifier:u().string,references:u().string}))}))})),addNotification:u().func};const O=g;var E=n(67702),P=n(82176),j=n(65115),w=n(70187),x=n(65413),T=n(7766),C=n(42982),Z=n(43047);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){return"".concat(e.profile.id,"|").concat(e.refId)},R=function e(t,n,r,o){var i=function(e,t){return e.children.filter((function(e){return"rule"===e.type})).map((function(e){var n=t(e);return n&&I(n)})).filter((function(e){return!!e}))}(t,n),l=function(t){return t.children.filter((function(e){return"rule_group"===e.type})).map((function(t){var o=e(t,n,r);return Object.keys(o).length>0&&o})).filter((function(e){return!!e}))}(t),a=t.children.filter((function(e){return"rule"===e.type&&n(e)&&!n(e).compliant})).length+l.reduce((function(e,t){return e+((null==t?void 0:t.failedCount)||0)}),0);return k(k(k(k({},l.length>0||i.length>0?k({title:c().createElement(j.Text,null,t.title," ",r&&a>0&&c().createElement(j.Label,{icon:c().createElement(Z.ZP,{className:"ins-u-failed"})},a,"x fail")),itemId:"".concat(o||"").concat(t.id)},r?{failedCount:a}:{}):{}),l.length>0?{twigs:l}:{}),i.length>0?{leaves:i}:{}),"rule"===t.type?{leaf:t.itemId}:{})},D=function(e,t,n){var r=((null==e?void 0:e.benchmark)||{}).ruleTree;if(r){var o=function(e){return t.find((function(t){return t.id===e.id}))};return r.reduce((function(t,r){var i=R(r,o,n,e.id),l=0===Object.keys(i).length;return[].concat((0,C.Z)(t),(0,C.Z)(l?[]:[i]))}),[])}console.log("No rule tree provided")},F={number:function(e){return/^\d*$/.test(e)}},V=function(e){return F[e.type]||function(){return!0}},N=function(e){return/(\n|\r|\\n|\\r)/.test(e)},B=n(67026),L=["value","valueDefinition"];function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t=e.value,n=e.valueDefinition,r=(0,l.Z)(e,L);return c().createElement("p",null,n.title,":"," ",c().createElement(w.Cg,(0,o.Z)({isDisabled:N(t||n.defaultValue),defaultValue:n.defaultValue,validate:V(n)},A(A({},r),{},{value:t}))))};_.propTypes={value:u().string,valueDefinition:u().object};const $=_;var H=function(e){var t=e.rule,n=e.onValueChange,r=e.onRuleValueReset,o=t.valueDefinitions,l=t.profile.id,s=t.ruleValues,u=(0,a.useState)(!1),p=(0,i.Z)(u,2),m=p[0],v=p[1],y=1===o.length,h=function(e){return function(t){null==n||n(l,e,t)}},g=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=(0,B.Z)(),l=(0,a.useState)(!1),c=(0,i.Z)(l,2),s=c[0],u=c[1],p=(0,a.useCallback)((0,f.Z)(d().mark((function l(){return d().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:o(e,{values:Object.fromEntries(Object.entries(t).map((function(e){var t=(0,i.Z)(e,1)[0],r=n.find((function(e){return e.refId===t||e.id===t}));return[r.refId,r.defaultValue]})))}).then((function(){(0,b.q)({variant:"success",title:"Rule values reset to default",autoDismiss:!0})})).catch((function(e){(0,b.q)({variant:"danger",title:"Error resetting rule value",description:e.message})})).finally((function(){return r()}));case 1:case"end":return l.stop()}}),l)}))),[e,n,t,r]);return(0,a.useEffect)((function(){return u(function(e,t){return Object.entries(e||{}).some((function(e){var n=(0,i.Z)(e,2),r=n[0],o=n[1],l=t.find((function(e){return e.refId===r||e.id===r}));return o!==(null==l?void 0:l.defaultValue)}))}(t,n))}),[n,t]),{resetValues:p,nonDefaultValues:s}}(l,s,o,r),O=g.resetValues,E=g.nonDefaultValues;return c().createElement(j.Stack,{style:{marginBottom:"var(--pf-global--spacer--lg)"}},c().createElement(j.StackItem,{style:{marginBottom:"var(--pf-global--spacer--xs)"}},c().createElement(j.Text,{className:"pf-c-form__label",component:j.TextVariants.h5},c().createElement("b",null,"Depends on values")," ",y&&c().createElement(j.Button,{className:"pf-u-ml-sm",onClick:function(){v((function(e){return!e}))},variant:"plain"},c().createElement(x.ZP,null)),E&&c().createElement(j.Button,{className:"pf-u-ml-sm",onClick:O,variant:"plain"},c().createElement(T.ZP,null))),o.map((function(e,t){return c().createElement($,{key:"rule-value-".concat(t),isOpen:m,value:(null==s?void 0:s[e.id])||(null==s?void 0:s[e.refId]),valueDefinition:e,onSave:h(e),enableEdit:!y})}))))};H.propTypes={rule:u().object,key:u().object,onValueChange:u().func,onRuleValueReset:u().func};const q=H;var z=function(e){var t=e.item,n=e.onValueChange,r=e.onRuleValueReset,o=t.refId,i=t.description,l=t.identifier,a=t.references,s=t.rationale,u=t.valueDefinitions,p="rule-child-row-".concat(o);return c().createElement("div",{key:p,style:{marginTop:"var(--pf-global--spacer--lg)"}},c().createElement(j.Stack,{id:"rule-description-".concat(p),style:{marginBottom:"var(--pf-global--spacer--md)"}},c().createElement(j.StackItem,{style:{marginBottom:"var(--pf-global--spacer--xs)"}},c().createElement(j.Text,{className:"pf-c-form__label",component:j.TextVariants.h5},c().createElement("b",null,"Description"))),c().createElement(j.StackItem,{isFilled:!0},i)),c().createElement(j.Stack,{id:"rule-identifiers-references-".concat(p),style:{marginBottom:"var(--pf-global--spacer--md)"}},c().createElement(j.Grid,null,l&&c().createElement(j.GridItem,{span:2},c().createElement(j.Text,{className:"pf-c-form__label",component:j.TextVariants.h5,style:{marginBottom:"var(--pf-global--spacer--xs)"}},c().createElement("b",null,"Identifier")),c().createElement(j.Text,null,c().createElement(w.MT,{href:l.system,target:"_blank"},l.label))),a&&a.length>0&&c().createElement(j.GridItem,{span:10},c().createElement(j.Text,{className:"pf-c-form__label",component:j.TextVariants.h5,style:{marginBottom:"var(--pf-global--spacer--xs)"}},c().createElement("b",null,"References")),c().createElement(j.Text,null,a.map((function(e,t){return c().createElement(w.MT,{href:e.href,target:"_blank",key:"".concat(o,"-reference-").concat(t)},e.label)})).reduce((function(e,t){return[e,", ",t]})))))),s&&c().createElement(j.Stack,{id:"rule-rationale-".concat(p),style:{marginBottom:"var(--pf-global--spacer--lg)"}},c().createElement(j.StackItem,{style:{marginBottom:"var(--pf-global--spacer--xs)"}},c().createElement(j.Text,{className:"pf-c-form__label",component:j.TextVariants.h5},c().createElement("b",null,"Rationale"))),c().createElement(j.StackItem,{isFilled:!0},s)),(null==u?void 0:u.length)>0&&c().createElement(q,{rule:t,key:p,onValueChange:n,onRuleValueReset:r}))};z.propTypes={item:u().object,onValueChange:u().func,onRuleValueReset:u().func};const Y=z;var G=n(58247);const U=function(e){return[{cells:[{title:c().createElement(G.Z,null,c().createElement(j.Bullseye,null,c().createElement(j.EmptyState,{variant:j.EmptyStateVariant.full},c().createElement(j.Title,{headingLevel:"h5",size:"lg"},"No matching rules found"),c().createElement(j.EmptyStateBody,null,"This filter criteria matches no rules. ",c().createElement("br",null)," Try changing your filter settings.")))),props:{colSpan:e.length}}]}]};var K=n(69957),J=n(73479),W=n(49269),Q=c().createElement("span",null,c().createElement(Z.ZP,{className:"ins-u-failed"})," High"),X=c().createElement("span",null,c().createElement(K.ZP,{className:"ins-u-warning"})," Medium"),ee=c().createElement("span",null,c().createElement(W.Jr,null)," Low"),te=c().createElement("span",null,c().createElement(J.ZP,null)," Unknown"),ne=n(83237),re=function(e,t,n){return e.filter((function(e){return t.map((function(t){return n(e,t)})).filter((function(e){return!!e})).length>0}))},oe=function(e,t,n){var r=[];return e.forEach((function(e){t.map((function(t){return n(e,t)})).filter((function(e){return!!e})).length>0&&r.push(e)})),r},ie=[{type:ne.Y.text,label:"Name",filter:function(e,t){return re(e,[t],(function(e,t){return e.title.toLowerCase().includes(t.toLowerCase())||e.identifier&&e.identifier.label.toLowerCase().includes(t.toLowerCase())||e.references.filter((function(e){return e.label.toLowerCase().includes(t.toLowerCase())})).length>0}))}},{type:ne.Y.checkbox,label:"Severity",items:[{label:Q,value:"high"},{label:X,value:"medium"},{label:ee,value:"low"},{label:te,value:"unknown"}],filter:function(e,t){return oe(e,t,(function(e,t){return e.severity===t}))}}],le={type:ne.Y.checkbox,label:"Rule state",items:[{label:"Passed rules",value:"passed"},{label:"Failed rules",value:"failed"}],filter:function(e,t){return oe(e,t,(function(e,t){return e.compliant===("passed"===t)}))}},ae={type:ne.Y.checkbox,label:"Ansible support",items:[{label:"Ansible remediation support",value:"true"},{label:"No Ansible remediation support",value:"false"}],filter:function(e,t){return oe(e,t,(function(e,t){return e.remediationAvailable===("true"===t)}))}};const ce=function(e){var t=e.showRuleStateFilter,n=e.policies,r=e.ansibleSupportFilter,o=[].concat(ie);return t&&o.push(le),n&&n.length>1&&o.push(function(e){return{type:ne.Y.checkbox,label:"Policy",items:e.map((function(e){return{label:e.name,value:e.id}})),filter:function(e,t){return re(e,t,(function(e,t){return e.profile.id===t}))}}}(n)),r&&o.push(ae),o};var se=n(94263),ue=n(77346),pe=["system","profileRules","columns","remediationsEnabled","ansibleSupportFilter","selectedFilter","handleSelect","selectedRules","hidePassed","options","activeFilters","showFailedCounts","setRuleValues","ruleValues","onRuleValueReset"];function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=function(e){var t=e.system,n=e.profileRules,r=e.columns,s=void 0===r?se.ZP:r,u=e.remediationsEnabled,f=void 0===u||u,m=e.ansibleSupportFilter,d=void 0!==m&&m,v=e.selectedFilter,b=void 0!==v&&v,y=e.handleSelect,h=e.selectedRules,g=void 0===h?[]:h,j=e.hidePassed,w=void 0!==j&&j,x=e.options,T=e.activeFilters,C=e.showFailedCounts,Z=void 0!==C&&C,S=e.setRuleValues,k=(e.ruleValues,e.onRuleValueReset),R=(0,l.Z)(e,pe),F=(0,ue.ZP)("ruleGroups"),V=(0,ue.ZP)("expandOnFilter"),N=y?[g,y]:(0,a.useState)([]),B=(0,i.Z)(N,2),L=B[0],M=B[1],A=(0,P.uJ)(n),_=function(e){return(e||[]).filter((function(e){return e.remediationAvailable}))},$=s.filter((function(e){return"Rule state"===e.title})).length>0,H=n.filter((function(e){return!!e.profile})).map((function(e){var t=e.profile;return{id:t.id,name:t.name}})),q=(0,a.useMemo)((function(){return function(e){return c().createElement(Y,(0,o.Z)({onValueChange:S,onRuleValueReset:k},e))}}),[S]);return c().createElement(E.v,(0,o.Z)({"aria-label":"Rules Table",items:A,columns:s,isStickyHeader:!0,filters:me({filterConfig:ce({showRuleStateFilter:$,policies:H,ansibleSupportFilter:d})},w&&{activeFilters:function(e){return me(me({},e),{},{passed:e.passed?e.passed:["failed"]},T)}}),options:me(me(me(me(me({},F?{tableTree:D(n[0].profile,A,Z)}:{}),p.yi),x),{},{identifier:I,onSelect:(y||f)&&M,preselected:L,detailsComponent:q,emptyRows:U(s),selectedFilter:b},V?{expandOnFilter:["name"]}:{}),f?{dedicatedAction:function(e){var n=e.selected;return c().createElement(O,{allSystems:n.length>0?[t]:void 0,selectedRules:_(n)})}}:{})},R))};de.propTypes={profileRules:u().array,loading:u().bool,hidePassed:u().bool,system:u().object,remediationsEnabled:u().bool,ansibleSupportFilter:u().bool,selectedRules:u().array,selectedFilter:u().bool,handleSelect:u().func,columns:u().array,options:u().object,activeFilters:u().object,showFailedCounts:u().number,setRuleValues:u().func,ruleValues:u().object,onRuleValueReset:u().func};const ve=de},66826:(e,t,n)=>{"use strict";n.d(t,{Hv:()=>H,uU:()=>L,TB:()=>N,b4:()=>B});var r=n(42982),o=n(45987),i=n(92950),l=n.n(i),a=n(45697),c=n.n(a),s=n(65115),u=n(70187),p=n(87462),f=n(70885),m=n(30168),d=n(90570),v=n(67521),b=n(91290),y=n(11443);const h=function(e){var t=e.profile,n=e.newOsMinorVersion;return"RHEL".concat("Â ",t.osMajorVersion,".").concat(t.osMinorVersion||n)};var g=n(15265),O=n(6238),E=function(e){var t=e.handleSelect,n=e.updateRules,r=e.profile,o=e.newOsMinorVersion,a=e.originalRules,c=e.loading,s=e.selectedRuleRefIds;return(0,i.useEffect)((function(){c||n(s)}),[c,a]),l().createElement("a",{className:"pf-u-ml-lg pf-u-mr-xl",onClick:function(){t&&t(r,o,a)}},l().createElement(O.ZP,{className:"pf-u-mr-sm"}),"Reset to default")};E.propTypes={handleSelect:c().func,updateRules:c().any,profile:c().any,newOsMinorVersion:c().any,originalRules:c().array,loading:c().bool,selectedRuleRefIds:c().array};const P=E;var j,w=n(77346),x=function(e){var t=e.count,n=void 0===t?0:t;return l().createElement(s.Badge,{isRead:!0},"".concat(n," ").concat((0,y._6)(n,"system")))};x.propTypes={profile:c().object,count:c().number};var T=function(e){var t=e.profile,n=e.newOsMinorVersion;return l().createElement(s.Text,{component:s.TextVariants.p},"SSG version: ",null==t?void 0:t.benchmark.version," ",l().createElement(s.Popover,{position:"right",bodyContent:l().createElement(C,{profile:t,newOsMinorVersion:n}),footerContent:l().createElement(u.bL,null)},l().createElement("span",{style:{cursor:"pointer"}},l().createElement(b.ZP,{className:"grey-icon"}))))};T.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var C=function(e){var t=e.profile,n=e.newOsMinorVersion;return l().createElement(s.TextContent,{style:{fontSize:"var(--pf-c-popover--FontSize)"}},l().createElement(s.Text,null,"This is the latest supported version of the SCAP Security Guide (SSG) for"," ",l().createElement(h,{profile:t,newOsMinorVersion:n})),l().createElement(s.Text,null,l().createElement(h,{profile:t,newOsMinorVersion:n})," systems assigned to this policy will report using this rule list."))};C.propTypes={profile:c().object.isRequired,newOsMinorVersion:c().string};var Z=(0,v.ZP)(j||(j=(0,m.Z)(["\n  query PTC_Benchmark($id: String!) {\n    benchmark(id: $id) {\n      id\n      osMajorVersion\n      rules {\n        id\n        title\n        severity\n        rationale\n        refId\n        description\n        remediationAvailable\n        identifier\n        values\n      }\n    }\n  }\n"]))),S=function(e){var t,n,r,o=e.profile,a=e.columns,c=e.handleSelect,m=e.systemCount,v=e.selectedRuleRefIds,b=e.rulesTableProps,y=e.newOsMinorVersion,O=e.resetLink,E=e.rulesPageLink,j=e.setRuleValues,C=e.ruleValues,S=e.onRuleValueReset,k=(0,w.ZP)("ruleGroups"),I=(0,d.a)(Z,{variables:{id:o.benchmark.id,enableRuleTree:k},skip:!c||!(null!==(t=o.benchmark)&&void 0!==t&&t.id)}),R=I.data,D=I.error,F=I.loading,V=c?null==R||null===(n=R.benchmark)||void 0===n?void 0:n.rules:null==o?void 0:o.rules,N=(0,i.useState)([]),B=(0,f.Z)(N,2),L=B[0],M=B[1];return l().createElement(l().Fragment,null,l().createElement(s.Grid,null,l().createElement(s.TextContent,{className:"pf-u-mt-md"},l().createElement(s.Text,{component:s.TextVariants.h3},l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(h,{profile:o,newOsMinorVersion:y})),l().createElement(x,{count:m})),l().createElement(s.Flex,null,l().createElement(s.FlexItem,null,l().createElement(T,{profile:o,newOsMinorVersion:y})),l().createElement(s.FlexItem,{align:{default:"alignRight"}},E&&l().createElement(u.nv,{to:"/scappolicies/".concat(null==o?void 0:o.id,"/default_ruleset"),target:"_blank",className:"pf-u-mr-xl"},"View policy rules",l().createElement(g.ZP,{className:"pf-u-ml-sm"})),O&&l().createElement(P,{handleSelect:c,updateRules:M,profile:o,newOsMinorVersion:y,originalRules:L,loading:F,selectedRuleRefIds:v}))))),l().createElement(u.tC,{stateValues:{error:D,loading:F,rules:V}},l().createElement(u.K7,{stateKey:"loading"},l().createElement(s.Spinner,null)),l().createElement(u.K7,{stateKey:"rules"},l().createElement(u.iK,(0,p.Z)({ansibleSupportFilter:!0,remediationsEnabled:!1,columns:a,profileRules:[{profile:o,rules:V||[],valueDefinitions:null==o||null===(r=o.benchmark)||void 0===r?void 0:r.valueDefinitions,ruleValues:C}],selectedRules:v.map((function(e){return"".concat(o.id,"|").concat(e)})),handleSelect:c&&function(e){return c(o,y,e.map((function(e){return e.split("|")[1]})))},setRuleValues:j,onRuleValueReset:S},b)))))};S.propTypes={profile:c().object,newOsMinorVersion:c().string,columns:c().array,handleSelect:c().func,systemCount:c().number,selectedRuleRefIds:c().array,rulesTableProps:c().object,resetLink:c().bool,rulesPageLink:c().bool,setRuleValues:c().func,ruleValues:c().array,onRuleValueReset:c().func};const k=S;var I=n(4942);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,I.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e,t,n){return e.id===t.id&&e.osMinorVersion===(n||t.osMinorVersion)},V=function(e,t,n){var r=(e||[]).find((function(e){return F(e,t,n)}));return(null==r?void 0:r.ruleRefIds)||[]},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).only,o=e.map((function(e){var r,o=t.find((function(t){return F(t,e)}));return o?n?o:void 0:(e.rules||console.error("Profile ".concat(e.id," is missing rules for selection!")),e.osMinorVersion||console.error("Profile ".concat(e.id," is missing osMinorVersion for selection!")),{id:e.id,osMinorVersion:e.osMinorVersion,ruleRefIds:(null===(r=e.rules)||void 0===r?void 0:r.map((function(e){return e.refId})))||[]})})).filter((function(e){return!!e}));return n?o:[].concat((0,r.Z)(t),(0,r.Z)(o))},B=function(e){var t={};return e.forEach((function(e){var n=e.profile,o=e.newOsMinorVersion;if(null!=n&&n.id){var i=o||n.osMinorVersion;t[n.id]=[].concat((0,r.Z)(t[n.id]||[]),[i])}})),t},L=function(e,t){return e.flatMap((function(e){return(t[e.id]||[void 0]).map((function(t){return D(D({},e),{},{osMinorVersion:t})}))}))},M=["tabsData","defaultTab","selectedRuleRefIds","setSelectedRuleRefIds","columns","level","ouiaId","resetLink","rulesPageLink","setRuleValues","ruleValues","onRuleValueReset"],A=function(e,t){var n=e.id,r=e.osMinorVersion;return"rules-".concat(n,"-").concat(r||t)},_=function(e,t){if(e&&0!==e.length){if(!t){var n=e[0];t={id:n.profile.id,osMinorVersion:n.profile.osMinorVersion||n.newOsMinorVersion}}return A(t)}},$=function(e){var t=e.tabsData,n=e.defaultTab,a=e.selectedRuleRefIds,c=e.setSelectedRuleRefIds,p=e.columns,f=e.level,m=void 0===f?0:f,d=e.ouiaId,v=e.resetLink,b=e.rulesPageLink,y=e.setRuleValues,g=e.ruleValues,O=e.onRuleValueReset,E=(0,o.Z)(e,M),P=(0,i.useCallback)((function(e,t,n){var o=(a||[]).filter((function(n){return!F(n,e,t)})),i={id:e.id,osMinorVersion:t||e.osMinorVersion,ruleRefIds:n};c([i].concat((0,r.Z)(o)))}),[a]);return l().createElement(u.tn,{ouiaId:d,level:m,defaultTab:_(t,n)},null==t?void 0:t.map((function(e){var t=e.profile,n=e.newOsMinorVersion,r=e.systemCount;return l().createElement(s.Tab,{key:A(t,n),eventKey:A(t,n),title:l().createElement("span",null,l().createElement("span",{className:"pf-u-pr-sm"},l().createElement(h,{profile:t,newOsMinorVersion:n})),l().createElement(s.Badge,{isRead:!0},r)),ouiaId:"RHEL ".concat(t.osMajorVersion,".").concat(t.osMinorVersion||n)},l().createElement(k,{profile:t,newOsMinorVersion:n,columns:p,rulesTableProps:E,systemCount:r,selectedRuleRefIds:V(a,t,n),handleSelect:c?P:void 0,setRuleValues:y,ruleValues:g,onRuleValueReset:O,resetLink:v,rulesPageLink:b}))})))};$.propTypes={tabsData:c().arrayOf(c().shape({profile:c().object.isRequired,selectedRuleRefIds:c().arrayOf(c().string),newOsMinorVersion:c().string,systemCount:c().number})).isRequired,selectedRuleRefIds:c().arrayOf(c().shape({id:c().string,ruleRefIds:c().arrayOf(c().string)})),setSelectedRuleRefIds:c().func,columns:c().arrayOf(c().object),defaultTab:c().shape({id:c().string,osMinorVersion:c().string}),level:c().number,ouiaId:c().string,resetLink:c().bool,rulesPageLink:c().bool,setRuleValues:c().func,ruleValues:c().array,onRuleValueReset:c().func};const H=$},70187:(e,t,n)=>{"use strict";n.d(t,{mR:()=>tt,MU:()=>lt,C:()=>xn,zm:()=>Un,OF:()=>ne,C$:()=>rn,MT:()=>Pn,X8:()=>Fe,_U:()=>F.Z,mf:()=>D,AY:()=>N,Nj:()=>Cn,Cg:()=>Hn,Qj:()=>Bn,nv:()=>Fn,Ir:()=>C,JS:()=>hn,V_:()=>zt,xB:()=>Bt,PL:()=>oe,NP:()=>he,o$:()=>Vt,w8:()=>Nt,_z:()=>tn,ko:()=>Se,Tq:()=>ie,vu:()=>Te,vm:()=>Rt,Ek:()=>kt,Jm:()=>Le,tn:()=>Me,iK:()=>gn.Z,Se:()=>$e,K7:()=>Ae,tC:()=>He,Zr:()=>bn,bL:()=>ln,UN:()=>Ge,Hv:()=>yn.Hv,cT:()=>dn,Vs:()=>qe,fz:()=>Je,zf:()=>Sn,Oq:()=>te});var r={};n.r(r),n.d(r,{nameFilter:()=>Lt});var o=n(42982),i=n(92950),l=n.n(i),a=n(3351),c=n(6934),s=n(22860),u=n(96541),p=n(45697),f=n.n(p),m=n(65115),d=n(46818),v=n(79886),b=function(e){var t=e.id,n=e.policy,r=e.policyType;return l().createElement(m.TextContent,null,l().createElement(Fn,{to:"/scappolicies/"+t},n.name),l().createElement(N,null,r))};b.propTypes={id:f().string,policy:f().object,policyType:f().string};var y={title:"Name",props:{width:45},sortByProp:"name",renderExport:function(e){return e.name},renderFunc:(0,v.SO)(b)},h=function(e){return"RHEL ".concat(e.osMajorVersion)},g={title:"Operating system",transforms:[d.E0],props:{width:15},sortByProp:"osMajorVersion",renderExport:h,renderFunc:function(e,t,n){return h(n)}},O={title:"Systems",props:{width:15},sortByProp:"totalHostCount",renderExport:function(e){return e.totalHostCount},renderFunc:function(e,t,n){return n.totalHostCount>0?n.totalHostCount:l().createElement(Ge,{count:n.totalHostCount,variant:"count"})}},E=function(e){return e.businessObjective&&e.businessObjective.title||"--"},P={title:"Business objective",sortByFunction:function(e){var t;return null==e||null===(t=e.businessObjective)||void 0===t?void 0:t.title},renderExport:E,renderFunc:function(e,t,n){return E(n)}},j=function(e){return"".concat(e.complianceThreshold,"%")},w={title:"Compliance threshold",sortByProp:"complianceThreshold",renderExport:j,renderFunc:function(e,t,n){return j(n)}},x=[y,{title:"Policy Type",renderExport:function(e){return e.policyType}},g,O,P,w];const T=[y,g,O,P,w],C=function(){return l().createElement(a.i,{"aria-label":"policies-table",ouiaId:"PoliciesTable",cells:T,rows:(0,o.Z)(Array(5)).map((function(){return{cells:[{title:l().createElement(u.Z,null),colSpan:5}]}}))},l().createElement(c.x,null),l().createElement(s.R,null))};var Z=n(56700),S=n(85333),k=n(2443),I=n(55140),R=function(e){var t=e.error,n=(0,I.Z)();return t.networkError&&401===t.networkError.statusCode?(n.auth.logout(!0),!1):t.networkError&&403===t.networkError.statusCode?l().createElement(S.Z,{serviceName:"Compliance"}):t.networkError&&404===t.networkError.statusCode?l().createElement(Z.Z,null):l().createElement(k.Z,null)};R.propTypes={error:f().object};const D=R;var F=n(54288),V=function(e){var t=e.children;return l().createElement(m.Text,{style:{color:"var(--pf-global--Color--200)"},component:m.TextVariants.small},t)};V.propTypes={children:f().node};const N=V;var B=n(70885),L=n(67563),M=n(88189),A=n(5936),_=n(48728),$=n(28858),H=function(e){var t=e.data,n=e.height,r=void 0===n?"20px":n,o=e.tooltipOrientation,a=void 0===o?"top":o,c=e.tooltipYOffset,s=void 0===c?-15:c,u=(0,i.useState)(167),p=(0,B.Z)(u,2),f=p[0],m=p[1],d=(0,i.useState)(24),v=(0,B.Z)(d,2),b=v[0],y=v[1],h=(0,i.useRef)(null);(0,i.useEffect)((function(){var e=new ResizeObserver((function(e){m(e[0].contentBoxSize[0].inlineSize),y(e[0].contentBoxSize[0].blockSize)}));return null!==h&&e.observe(h.current),function(){e.disconnect()}}));var g=t.reduce((function(e,t){return e+t.value}),0);return l().createElement("div",{ref:h,style:{height:r,padding:0}},l().createElement(L.k,{showAxis:!1,width:f,height:b,padding:0,containerComponent:l().createElement(M.B,{portalZIndex:110})},l().createElement(A.K,{horizontal:!0,colorScale:t.map((function(e){return e.color}))},t.map((function(e){return l().createElement(_.B,{key:e.title,data:[{name:e.title,x:"",y:e.value,label:e.label}],barWidth:parseFloat(r)-4,labelComponent:l().createElement($.h,{orientation:a,dy:s,dx:(t=g,n=f,o=e.value,-n*o/t/2)})});var t,n,o})))))};H.propTypes={data:f().array,height:f().oneOfType([f().number,f().string]),tooltipOrientation:f().oneOf(["top","bottom","right","left"]),tooltipYOffset:f().number};var q=n(72971);f().exact({totalResults:f().number,compliant:f().number,unsupported:f().number,total:f().number});var z=n(87462),Y=n(6455),G=function(e){var t=e.input,n=e.options,r=t.name,i=t.onChange,a=t.value;return l().createElement(l().Fragment,null,n.map((function(e,t){var n=e.label,c=e.value,s=e.defaultChecked;return l().createElement(m.Checkbox,{key:c,id:c,label:n,name:"".concat(r,"[").concat(t,"]"),value:c,isChecked:""===a?s:a.includes(c),onChange:function(e){return function(e,t){var n=(0,o.Z)(new Set(a));return e?n.push(t):n.splice(n.indexOf(t),1),i(n)}(e,c)}})})))};G.propTypes={input:f().shape({name:f().string.isRequired,onChange:f().func,value:f().string}),options:f().arrayOf(f().shape({label:f().string.isRequired,value:f().string.isRequired,defaultChecked:f().bool})).isRequired};f().arrayOf(f().shape({label:f().string.isRequired,value:f().string.isRequired,defaultChecked:f().bool})).isRequired;var U=n(19535),K=function(e){var t=e.profiles,n=e.onChange,r=e.selectedProfile;return l().createElement(l().Fragment,null,0===(null==t?void 0:t.length)&&l().createElement(m.TextContent,{style:{color:"var(--pf-c-content--blockquote--Color)"}},l().createElement(m.Text,null,"Select an operating system to view policy types.")),l().createElement(m.Grid,{hasGutter:!0},t.map((function(e){var t=e.description,o=e.name,i=e.id,a=e.disabled;return l().createElement(l().Fragment,{key:"profile-select-".concat(i)},l().createElement(m.GridItem,{span:8,rowSpan:2},l().createElement(m.Radio,{id:"profile-select-text-".concat(i),label:l().createElement(l().Fragment,null," ".concat(o," "),a&&l().createElement(Cn,null)),isDisabled:a,description:l().createElement(U.Z,{inline:!0,key:"profile-select-text-".concat(i),length:190,text:t}),isChecked:r===JSON.stringify(e),onChange:function(e,t){var r;return n(null===(r=t.currentTarget)||void 0===r?void 0:r.value)},value:JSON.stringify(e)})))}))))};K.propTypes={profiles:f().array,onChange:f().func,selectedProfile:f().object},K.defaultProps={profiles:[],onClick:function(){return{}}};var J=n(73479),W=n(68778),Q=n(43047),X=n(11443),ee=function(e){return e.supported||0===e.score?e.compliant?l().createElement(W.ZP,{color:"var(--pf-global--success-color--200)"}):l().createElement(Q.ZP,{color:"var(--pf-global--danger-color--100)"}):l().createElement(J.ZP,{color:"var(--pf-global--disabled-color--100)"})},te=function(e){return e.supported?e.score||0===e.score?" "+(0,X.P0)(e.score):" N/A":" Unsupported"};const ne=function(e){return l().createElement(m.Text,null,e.supported?l().createElement(m.Tooltip,{content:"The system compliance score is calculated by OpenSCAP and is a normalized weighted sum of rules selected for this policy."},l().createElement("span",null,l().createElement(ee,(0,z.Z)({key:"system-compliance-icon-".concat(e.id)},e)),te(e))):te(e))};var re=n(24561);const oe=function(){return l().createElement(re.ZP,{speed:2,width:1e3,height:400,viewBox:"0 0 1000 400",backgroundcolor:"#f3f3f3",foregroundcolor:"#ecebeb"},l().createElement("rect",{x:"-3",y:"7",rx:"3",ry:"3",width:"760",height:"19"}),l().createElement("rect",{x:"823",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"910",y:"3",rx:"3",ry:"3",width:"67",height:"29"}),l().createElement("rect",{x:"6",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"68",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"133",y:"54",rx:"0",ry:"0",width:"46",height:"19"}),l().createElement("rect",{x:"3",y:"110",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"1",y:"149",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"1",y:"185",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-1",y:"224",rx:"0",ry:"0",width:"187",height:"16"}),l().createElement("rect",{x:"-4",y:"267",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-6",y:"306",rx:"0",ry:"0",width:"47",height:"16"}),l().createElement("rect",{x:"-6",y:"342",rx:"0",ry:"0",width:"255",height:"17"}),l().createElement("rect",{x:"-8",y:"381",rx:"0",ry:"0",width:"187",height:"16"}))},ie=function(){return l().createElement(re.ZP,{height:320,width:1550,speed:2,primaryColor:"#f3f3f3",secondaryColor:"#ecebeb"},l().createElement("rect",{x:"18",y:"50",rx:"4",ry:"4",width:"478",height:"15"}),l().createElement("rect",{x:"19",y:"18",rx:"3",ry:"3",width:"220",height:"9"}),l().createElement("circle",{cx:"118",cy:"156",r:"73"}),l().createElement("rect",{x:"1002",y:"40",rx:"0",ry:"0",width:"69",height:"23"}),l().createElement("rect",{x:"47",y:"77",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"36",y:"77",rx:"0",ry:"0",width:"16",height:"0"}),l().createElement("rect",{x:"409",y:"149",rx:"0",ry:"0",width:"0",height:"0"}),l().createElement("rect",{x:"214",y:"145",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"216",y:"119",rx:"0",ry:"0",width:"205",height:"9"}),l().createElement("rect",{x:"526",y:"100",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"122",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"526",y:"146",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"170",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"194",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"527",y:"218",rx:"0",ry:"0",width:"431",height:"8"}),l().createElement("rect",{x:"529",y:"275",rx:"0",ry:"0",width:"231",height:"7"}))};var le=n(56163),ae=n.n(le),ce=n(4942),se=n(45987),ue=n(88326),pe=n(70597),fe=["text","policy","variant","propertyName","inlineClosedText","label","showTextUnderInline","textUnderInline","typeOfInput","Component"];function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){(0,ce.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){var t=e.text,n=e.policy,r=e.variant,o=e.propertyName,a=e.inlineClosedText,c=e.label,s=e.showTextUnderInline,u=e.textUnderInline,p=(e.typeOfInput,e.Component),f=void 0===p?m.TextInput:p,d=(0,se.Z)(e,fe),v=n,b=(0,i.useState)(t),y=(0,B.Z)(b,2),h=y[0],g=y[1],O=(0,i.useState)(!0),E=(0,B.Z)(O,2),P=E[0],j=E[1],w=function(){D(!1),g(t)},x=de(de({},v),{},"businessObjective"===o?(0,ce.Z)({},o,{title:h}):(0,ce.Z)({},o,h)),T=(0,ue.G)(n,x,w,n.id),C=(0,B.Z)(T,2),Z=C[0],S=C[1],k=(0,i.useState)(!1),I=(0,B.Z)(k,2),R=I[0],D=I[1],F=(0,i.useRef)();return(0,i.useEffect)((function(){R&&F&&F.current&&F.current.focus()}),[R]),l().createElement(m.FormGroup,{className:"pf-c-inline-edit pf-m-inline-editable"},l().createElement(m.Text,{component:m.TextVariants.h5},c,l().createElement(m.Button,{onClick:function(){D(!R),g(t)},variant:"plain",style:{"margin-left":"5px"}},l().createElement("i",{className:"fas fa-pencil-alt","aria-hidden":"true"})),"threshold"===r?l().createElement(Nt,null):"business"===r?l().createElement(Bt,null):null),l().createElement(m.Text,{className:"pf-c-inline-edit__value",id:"pf-global--spacer--xs"},t),l().createElement("div",{className:"pf-c-inline-edit__action pf-m-enable-editable"},l().createElement(m.Button,{className:"pf-c-button pf-m-plain",type:"button",id:"edit-button","aria-label":"Edit","aria-labelledby":"single-editable-edit-button"})),l().createElement("div",{className:"pf-c-inline-edit__group"},R?l().createElement(l().Fragment,null,l().createElement("div",null,l().createElement(f,(0,z.Z)({value:h,onChange:function(e,t){"policydetails-input-threshold"===t.target.id&&(!0===(0,pe.KJ)(e)?(g(e),j(!0)):j(!1)),g(e)}},d)),s&&P?l().createElement(m.Text,null,u):null,!P&&l().createElement(rn,{threshold:h})),l().createElement("div",{className:"pf-c-inline-edit__group pf-m-action-group pf-m-icon-group"},l().createElement("div",{className:"pf-c-inline-edit__action pf-m-valid"},l().createElement(m.Button,{className:"pf-c-button pf-m-plain",type:"button","aria-label":"Save edits",isDisabled:!P,isLoading:Z,onClick:S,style:{"margin-left":"5px"}},l().createElement("i",{className:"fas fa-check","aria-hidden":"true"}))),l().createElement("div",{className:"pf-c-inline-edit__action"},l().createElement(m.Button,{className:"pf-c-button pf-m-plain",type:"button","aria-label":"Cancel edits",onClick:w,style:{"margin-left":"5px"}},l().createElement("i",{className:"fas fa-times","aria-hidden":"true"}))))):"description"!==r?l().createElement(m.Text,{className:"labelClosedText",component:m.TextVariants.p},a):l().createElement(m.Text,{className:"textAreaClosedText",component:m.TextVariants.p},l().createElement(U.Z,{text:t,length:380,inline:!0}))))};ve.propTypes={text:f().string,variant:f().string,policy:f().object,propertyName:f().string,inlineClosedText:f().string,label:f().string,showTextUnderInline:f().string,textUnderInline:f().string,typeOfInput:f().string,Component:f().node};const be=ve;var ye=function(e){var t=e.policy,n="".concat((0,X.P0)(t.complianceThreshold,1),' of rules must be\n  passed for a system to be labeled "Compliant"'),r=t.businessObjective&&t.businessObjective.title||"-",o=ae()(t.description||"");return l().createElement(m.Card,{ouiaId:"PolicyDetailsCard"},l().createElement(m.CardHeader,null,l().createElement(m.Text,{style:{fontSize:20}},l().createElement("b",null,"Policy details"))),l().createElement(m.CardBody,null,l().createElement(m.TextContent,null,l().createElement(m.Text,null,l().createElement(be,{policy:t,text:t.complianceThreshold,variant:"threshold",inlineClosedText:n,label:"Compliance threshold (%)",showTextUnderInline:"true",textUnderInline:"A value of 95% or higher is recommended",propertyName:"complianceThreshold",type:"number",className:"pf-c-form-control pf-u-w-100-on-lg","aria-label":"editable text input",id:"policydetails-input-threshold"})),l().createElement(m.Text,null,l().createElement(be,{policy:t,text:r,variant:"business",inlineClosedText:r,label:"Business objective",propertyName:"businessObjective",typeOfInput:"text"})),l().createElement(m.Text,null,l().createElement(be,{component:m.TextArea,policy:t,text:o,variant:"description",inlineClosedText:r,label:"Policy description",propertyName:"description",className:"pf-c-form-control pf-u-w-100-on-lg"})),l().createElement(m.Text,{component:m.TextVariants.h5},"Operating system"),l().createElement(m.Text,{component:m.TextVariants.p},"RHEL ",t.osMajorVersion),l().createElement(m.Text,{component:m.TextVariants.h5},"Policy type "),l().createElement(m.Text,{component:m.TextVariants.p},t.policyType),l().createElement(m.Text,{component:m.TextVariants.h5},"Reference ID"),l().createElement(m.Text,{component:m.TextVariants.p},t.refId))))};ye.propTypes={policy:f().object};const he=ye;var ge=["children"],Oe=["children"],Ee={children:f().node},Pe=function(e){var t=e.children,n=(0,se.Z)(e,ge);return l().createElement(m.TextListItem,(0,z.Z)({},n,{component:m.TextListItemVariants.dt}),t)};Pe.propTypes=Ee;var je=function(e){var t=e.children,n=(0,se.Z)(e,Oe);return l().createElement(m.TextListItem,(0,z.Z)({},n,{component:m.TextListItemVariants.dd}),t)};je.propTypes=Ee;var we=function(e){var t=e.profile;return l().createElement(l().Fragment,null,l().createElement(m.TextList,{component:m.TextListVariants.dl},l().createElement(Pe,null,l().createElement(m.Text,{className:"ins-c-non-bold-h2"},"Policy details")),l().createElement(Pe,null,"Operating system"),l().createElement(je,null,"RHEL ",t.osMajorVersion),l().createElement(Pe,null,"Compliance threshold"),l().createElement(je,null,"".concat((0,X.P0)(t.complianceThreshold,1),' of rules must be\n        passed for a system to be labeled "Compliant"')),l().createElement(Pe,null,"Business objective"),l().createElement(je,null,t.businessObjective?t.businessObjective.title:"--")),l().createElement(Fn,{to:"/scappolicies/"+t.policy.id},"View policy"))};we.propTypes={profile:f().shape({id:f().string,complianceThreshold:f().number,businessObjective:f().object,osMajorVersion:f().string,policy:f().shape({id:f().string}),benchmark:f().shape({version:f().string})})};var xe=function(e){var t=e.profile;return l().createElement(m.TextContent,{className:"policy-details"},l().createElement(we,{profile:t}))};xe.propTypes={profile:f().object};const Te=xe;var Ce=n(48273),Ze=function(e){var t,n,r=e.percent,o=e.failed;return 100===r?(n="Success",t=Ce.ProgressVariant.success):o?(n="Error",t=Ce.ProgressVariant.danger):(n="Progress",t=Ce.ProgressVariant.info),l().createElement(Ce.Progress,{id:"finished-create-policy",value:r,title:n,variant:t,className:"wizard-progress-bar"})};Ze.propTypes={percent:f().number,failed:f().bool};const Se=Ze;var ke=n(62012),Ie=n(98773),Re=n(14890),De=["children","defaultTab","level","ouiaId"],Fe=function(e){return e.children},Ve=function(e,t){return e.find((function(e){return e.props.eventKey===t}))},Ne=function(e,t){var n=(0,Re.Z)(e).split("|");return{levels:n,currentAnchor:n[t]||e}},Be=function(e){var t=e.children,n=e.activeKey,r=e.defaultTab,o=Ve(t,n);return o?[o]:[r?Ve(t,r):t[0]]};Be.propTypes={activeTab:f().number,children:f().node};var Le=function(e){var t=e.children,n=e.defaultTab,r=e.level,o=Ne(n,r).currentAnchor;return l().createElement(Be,{activeKey:o},t)};Le.propTypes={children:f().node,defaultTab:f().string,level:f().number},Le.defaultProps={level:0};var Me=function(e){var t=e.children,n=e.defaultTab,r=e.level,o=e.ouiaId,i=(0,se.Z)(e,De),a=(0,Ie.Z)(),c=(0,ke.useLocation)(),s=c.pathname,u=c.state,p=Ne(n,r),f=p.currentAnchor,d=p.levels,v=t.map((function(e){return e.props.eventKey})).find((function(e){return e===f}));return l().createElement(m.Tabs,(0,z.Z)({},i,{ouiaId:o,onSelect:function(e,t){e.preventDefault();var n=t.replace("#",""),o=d;o[r]=n,a({state:u,to:s,hash:o.slice(0,r+1).join("|")})},activeKey:v?f:n}),t)};Me.defaultProps={level:0},Me.propTypes={children:f().node,defaultTab:f().string,level:f().number,ouiaId:f().string};var Ae=function(e){return e.children},_e={stateValues:f().object,children:f().node},$e=function(e){var t=e.stateValues;return e.children.flatMap((function(e){return e})).filter((function(e){return t[e.props.stateKey]}))};$e.propTypes=_e;var He=function(e){var t=e.stateValues,n=e.children;return l().createElement($e,{stateValues:t},l().createElement(Ae,{key:"error-state",stateKey:"error"},l().createElement(D,{error:t.error})),n)};He.propTypes=_e;var qe="Policies without systems will not have reports.",ze=function(e){var t=e.showTooltip,n=e.children;return t?l().createElement(m.Tooltip,{position:m.TooltipPosition.bottom,content:qe},n):n};ze.propTypes={showTooltip:f().bool,children:f().node};var Ye=function(e){var t,n=e.count,r=e.variant;switch(r){case"count":default:t=n;break;case"compact":t="No Systems";break;case"full":t=qe}return l().createElement(ze,{showTooltip:"count"===r||"compact"===r},l().createElement(Je,null,t))};Ye.defaultProps={variant:"compact"},Ye.propTypes={count:f().number.isRequired,variant:f().string};const Ge=Ye;var Ue=n(69957),Ke=function(e){var t=e.children;return l().createElement(l().Fragment,null,l().createElement(Ue.ZP,{className:"ins-u-warning"}),l().createElement(m.Text,{component:"span",className:"ins-c-warning-text"},"Â ",t))};Ke.propTypes={children:f().node};const Je=Ke;var We=["to","hash","children","state","backgroundLocation","Component","componentProps"];function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){(0,ce.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var et=function(e){var t=e.to,n=e.hash,r=e.children,o=e.state,i=e.backgroundLocation,a=e.Component,c=e.componentProps,s=void 0===c?{}:c,u=(0,se.Z)(e,We),p=a||Fn,f=Xe(Xe({},(0,ke.useLocation)()),i),m=Xe(Xe({},o),{},{background:f});return l().createElement(p,(0,z.Z)({to:{pathname:t,state:m,hash:n}},Xe(Xe({},u),s)),r)};et.propTypes={backgroundLocation:f().object,children:f().node,hash:f().string,state:f().object,to:f().string.isRequired,Component:f().node,componentProps:f().object};const tt=et;var nt=["href"],rt=["children"],ot=function(e){var t=e.href,n=(0,se.Z)(e,nt);return l().createElement(Fn,(0,z.Z)({},n,{to:t}))};ot.propTypes={href:f().string};var it=function(e){var t=e.children,n=(0,se.Z)(e,rt);return l().createElement(m.BreadcrumbItem,(0,z.Z)({},n,{component:ot}),t)};it.propTypes={children:f().node};const lt=it;var at=n(41532),ct=n(67702),st=n(77346),ut=n(53983),pt=n(93471),ft=function(e){var t;return l().createElement(m.TextContent,null,l().createElement(Fn,{to:"/reports/".concat(e.id),style:{marginRight:".5rem"}},null===(t=e.policy)||void 0===t?void 0:t.name),l().createElement(l().Fragment,null,l().createElement(Vt,{profile:e,position:"right"}),l().createElement(N,null,e.policyType)))};ft.propTypes={profile:f().object};var mt=function(e){var t=e.osMajorVersion,n=e.unsupportedHostCount,r=e.benchmark,o=e.policy,i=(r||{}).version,a=0===n,c="SSG: "+i;return l().createElement(l().Fragment,null,"RHEL ",t,null===o&&i&&l().createElement(m.Text,null,l().createElement(N,null,a?c:l().createElement(dn,null,c))))};mt.propTypes={osMajorVersion:f().string,benchmark:f().object,unsupportedHostCount:f().number,policy:f().object};var dt=function(e){return l().createElement(l().Fragment,null,l().createElement(pt.Z,{profile:e,hasLegend:!1,chartClass:"report-table-chart-container"}))};dt.propTypes={testResultHostCount:f().number,compliantHostCount:f().number,unsupportedHostCount:f().number,totalHostCount:f().number};var vt=function(e){var t=e.id;return l().createElement(tt,{to:"/reports/".concat(t,"/pdf"),Component:Bn,componentProps:{className:"pf-u-mr-md",variant:"plain",ouiaId:"ReportsDownloadReportPDFLink"}},l().createElement(ut.ZP,null))};vt.propTypes={id:f().string};var bt={title:"Policy",sortByProp:"name",props:{width:60},exportKey:"name",renderFunc:(0,v.SO)(ft)},yt={title:"Operating system",transforms:[d.E0],sortByProp:"osMajorVersion",props:{width:20},renderExport:function(e){var t=e.osMajorVersion;return"RHEL ".concat(t," ")},renderFunc:(0,v.SO)(mt)},ht={title:"Systems meeting compliance",transforms:[d.E0],sortByFunction:function(e){return 100/e.testResultHostCount*e.compliantHostCount},props:{width:20},renderExport:function(e){var t=e.testResultHostCount,n=void 0===t?0:t,r=e.compliantHostCount,o=void 0===r?0:r,i=e.unsupportedHostCount,l=void 0===i?0:i;return"".concat(o," of ").concat(n," systems").concat(l>0?" | ".concat(l," unsupported"):"")},renderFunc:(0,v.SO)(dt)},gt={title:"",renderFunc:(0,v.SO)(vt),managable:!1},Ot=[bt,{title:"Policy Type",renderExport:function(e){return e.policyType}},yt,ht];const Et=[bt,yt,ht];var Pt=n(83237),jt=[{type:Pt.Y.text,label:"Policy name",filter:function(e,t){var n=t.toLowerCase();return e.filter((function(e){return[e.name,e.policy.name].join().toLowerCase().includes(n)}))}}],wt=function(e){return[{type:Pt.Y.checkbox,label:"Policy type",filter:function(e,t){return e.filter((function(e){var n=e.policyType;return t.includes(n)}))},items:e.map((function(e){return{label:e,value:e}}))}]},xt=function(e){return[{type:Pt.Y.checkbox,label:"Operating system",filter:function(e,t){return e.filter((function(e){var n=e.osMajorVersion;return t.includes(n)}))},items:e.map((function(e){return{label:"RHEL ".concat(e),value:e}}))}]},Tt=[{type:Pt.Y.checkbox,label:"Systems meeting compliance",filter:function(e,t){return e.filter((function(e){var n=e.testResultHostCount,r=e.compliantHostCount,o=Math.round(100/n*r);return t.map((function(e){var t=e.split("-"),n=(0,B.Z)(t,2),r=n[0],i=n[1];return o>=r&&o<=i})).filter((function(e){return!!e})).length>0}))},items:[{label:"90 - 100%",value:"90-100"},{label:"70 - 89%",value:"70-89"},{label:"50 - 69%",value:"50-69"},{label:"Less than 50%",value:"0-49"}]}];function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){(0,ce.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var St=function(e){var t=e.profiles,n=(0,st.ZP)("manageColumns"),r=(0,st.ZP)("pdfReport"),i=(0,v.jj)(t.map((function(e){return e.policyType})).filter((function(e){return!!e}))),a=(0,v.jj)(t.map((function(e){return e.osMajorVersion})).filter((function(e){return!!e})));return l().createElement(ct.v,{"aria-label":"Reports",ouiaId:"ReportsTable",columns:[].concat((0,o.Z)(Et),(0,o.Z)(r&&[gt]||[])),items:t,isStickyHeader:!0,filters:{filterConfig:[].concat((0,o.Z)(jt),(0,o.Z)(i.length>0&&wt(i)||[]),(0,o.Z)(a.length>0&&xt(a)||[]),(0,o.Z)(Tt))},options:Zt(Zt({},q.yi),{},{exportable:Zt(Zt({},q.yi.exportable),{},{columns:Ot}),manageColumns:n,emptyRows:(0,at.fQ)("reports",Et.length)}),className:"reports-table"})};St.propTypes={profiles:f().array};const kt=St;var It=n(19949);const Rt=function(){return l().createElement(It.Z,{title:"No policies are reporting",mainButton:l().createElement(tt,{to:"/scappolicies/new",Component:Bn,componentProps:{variant:"primary",ouiaId:"CreateNewPolicyButton"}},"Create new policy")})};var Dt=n(91290),Ft=function(e){var t=e.profile,n=e.position,r=void 0===n?"top":n,o=t.policy,i=t.policyType,a=t.complianceThreshold,c=t.osMajorVersion,s=t.businessObjective;return l().createElement(m.Popover,{position:r,headerContent:l().createElement(m.TextContent,null,null==o?void 0:o.name,l().createElement(m.Text,{component:m.TextVariants.small},i)),footerContent:l().createElement(Fn,{to:"/scappolicies/"+(null==o?void 0:o.id),className:"pf-u-font-size-md"},"View policy"),bodyContent:l().createElement(m.TextContent,{className:"policy-details"},l().createElement(m.TextList,{component:m.TextListVariants.dl},l().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Operating system"),l().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},"RHEL ",c),l().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Compliance threshold"),l().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},(0,X.P0)(a,1)),s&&l().createElement(l().Fragment,null,l().createElement(m.TextListItem,{component:m.TextListItemVariants.dt},"Business objective"),l().createElement(m.TextListItem,{component:m.TextListItemVariants.dd},s.title))))},l().createElement(m.Button,{variant:"link",ouiaId:"PopoverViewPolicyLink",isInline:!0},l().createElement(Dt.ZP,{className:"grey-icon"})))};Ft.propTypes={profile:f().object,position:f().string};const Vt=Ft,Nt=function(){return l().createElement(m.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,'The compliance threshold defines what percentage of rules must be met in order for a system to be determined "compliant".')},l().createElement("span",null,"Â ",l().createElement(Dt.ZP,{className:"grey-icon"})))},Bt=function(){return l().createElement(m.Tooltip,{position:"right",content:l().createElement(i.Fragment,null,"This is an optional field that can be used to label policies that are related to specific business objectives.")},l().createElement("span",null,"Â ",l().createElement(Dt.ZP,{className:"grey-icon"})))};n(58247);var Lt={type:Pt.Y.text,label:"Name",filter:function(e,t){return e.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())}))}},Mt=n(95249),At=n(60076);const _t=function(e){var t=(0,At.U_)(e);return(0,Mt.c$)((null==t?void 0:t.requiredPermissions)||[],!1,!1)};function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){(0,ce.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qt=function(e){var t=e.policies,n=e.DedicatedAction,o=(0,st.ZP)("manageColumns"),i=Object.values(r),a=function(e){var t=(0,ke.useLocation)(),n=(0,Ie.Z)(),r=_t("/scappolicies/XYZ/delete"),o=r.hasAccess,i=r.isLoading,l=_t("/scappolicies/XYZ/edit"),a=l.hasAccess,c=l.isLoading,s=function(r,o){var i=o.itemId,l=e.find((function(e){return e.id===i}));n(r,{policy:l,background:t,state:{policy:l}})};return function(){return[{title:"Delete policy",isDisabled:!i&&!o,onClick:function(e,t,n){return s("/scappolicies/".concat(n.itemId,"/delete"),n)}},{title:"Edit policy",isDisabled:!c&&!a,onClick:function(e,t,n){return s("/scappolicies/".concat(n.itemId,"/edit"),n)}}]}}(t);return l().createElement(ct.v,{"aria-label":"Policies",ouiaId:"PoliciesTable",className:"compliance-policies-table",columns:T,items:t,isStickyHeader:!0,filters:{filterConfig:i},options:Ht(Ht(Ht({},q.yi),{},{actionResolver:a},n?{dedicatedAction:n}:{}),{},{exportable:Ht(Ht({},q.yi.exportable),{},{columns:x}),manageColumns:o,emptyRows:(0,at.fQ)("policies",T.length)})})};qt.propTypes={policies:f().array.isRequired,DedicatedAction:f().node},qt.defaultProps={policies:[]};const zt=qt;var Yt=n(15671),Gt=n(43144),Ut=n(97326),Kt=n(60136),Jt=n(82963),Wt=n(61120),Qt=n(46314),Xt=n(74726);var en=function(e){(0,Kt.Z)(o,e);var t,n,r=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,Wt.Z)(t);if(n){var o=(0,Wt.Z)(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return(0,Jt.Z)(this,e)});function o(){var e;(0,Yt.Z)(this,o);for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e=r.call.apply(r,[this].concat(n)),(0,ce.Z)((0,Ut.Z)(e),"state",{validThreshold:(0,pe.KJ)(e.props.previousThreshold),threshold:e.props.previousThreshold}),(0,ce.Z)((0,Ut.Z)(e),"handleThresholdChange",(function(t){e.setState({validThreshold:(0,pe.KJ)(t),threshold:t})})),e}return(0,Gt.Z)(o,[{key:"render",value:function(){var e=this.state,t=e.threshold,n=e.validThreshold;return l().createElement(l().Fragment,null,l().createElement(m.FormGroup,{fieldId:"policy-threshold",validated:n?"default":"error",helperTextInvalid:l().createElement(rn,{threshold:t}),helperText:"A value of 95% or higher is recommended",labelIcon:l().createElement(Nt,null),label:"Compliance threshold (%)"},l().createElement(Y.Z,{name:"complianceThreshold",id:"complianceThreshold",isRequired:!0,onChange:this.handleThresholdChange,validated:n?"default":"error",defaultValue:t,"aria-label":"compliance threshold",component:Xt._,type:"number",style:{width:"60%",display:"block"}})))}}]),o}(l().Component);en.propTypes={previousThreshold:f().number};const tn=(0,Qt.Z)({form:"policyForm",destroyOnUnmount:!1,forceUnregisterOnUnmount:!0})(en);var nn=function(e){var t=e.threshold,n=parseFloat(t);return l().createElement(l().Fragment,null,l().createElement(m.HelperText,null,(n<0||n>100||isNaN(n))&&l().createElement(m.HelperTextItem,{variant:"error"},"Threshold has to be a number between 0 and 100"),!(0,pe.$X)(n,1)&&l().createElement(m.HelperTextItem,{variant:"error"},"Threshold values can have a maximum of one decimal place")))};nn.propTypes={threshold:f().string};const rn=nn;var on=n(15265);const ln=function(){return l().createElement("a",{target:"_blank",rel:"noopener noreferrer",href:q.iK},"Supported SSG versions ",l().createElement(on.ZP,null))};function an(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?an(Object(n),!0).forEach((function(t){(0,ce.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):an(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sn=l().createElement(l().Fragment,null,l().createElement(m.Text,{variant:"p",style:{marginBottom:"1rem"}},"These systems are running unsupported versions of the SCAP Security Guide (SSG) for the version of RHEL installed on them. Assessment of rules failed/passed on these systems is a best-guess effort and may not be accurate."),l().createElement(m.Text,{variant:"p"},"The policy's compliance score excludes these systems.")),un=function(e){var t=e.children,n=e.variant,r=void 0===n?"plural":n;return l().createElement(m.Popover,{id:"unsupported-popover",maxWidth:"25rem",headerContent:"Unsupported SSG versions",bodyContent:"plural"===r?sn:"This system was using an incompatible version of the SSG at the time this report was generated. Assessment of rules failed/passed on this system is a best-guess effort and may not be accurate.",footerContent:l().createElement(ln,null)},t)};un.propTypes={children:f().node,variant:f().oneOf(["singular","plural"])};var pn=function(e){var t=e.children,n=e.content;return l().createElement(m.Tooltip,{content:n,position:"bottom"},t)};pn.propTypes={content:f().string,children:f().node};var fn=function(e){var t=e.variant,n=e.children,r=e.tooltipProps,o={tooltip:{Component:pn,componentProps:r},popover:{Component:un,componentProps:{showHeader:r.showPopupHeader,variant:r.messageVariant}}}[t],i=o.Component,a=o.componentProps;return l().createElement(i,a,n)};fn.propTypes={children:f().node,variant:f().oneOf(["tooltip","popover"]),tooltipProps:f().object};var mn=function(e){var t=e.children,n=e.showWarningIcon,r=void 0===n||n,o=e.showHelpIcon,i=void 0!==o&&o,a=e.style,c=e.tooltipText,s=e.messageVariant,u={variant:c?"tooltip":"popover",tooltipProps:cn(cn({},c&&{content:l().createElement("div",null,c)}),{},{messageVariant:s})},p=c?{}:{cursor:"pointer"};return l().createElement("span",{style:cn(cn({},a),{},{display:"inline-block"})},r&&l().createElement(fn,u,l().createElement("span",{style:p,className:"pf-u-mr-xs"},l().createElement(Ue.ZP,{color:"var(--pf-global--warning-color--100)"}))),t,i&&l().createElement(fn,u,l().createElement("span",{style:p,className:"pf-u-ml-xs"},l().createElement(Dt.ZP,{className:"grey-icon"}))))};mn.propTypes={showWarningIcon:f().bool,showHelpIcon:f().bool,style:f().object,tooltipText:f().string,children:f().node,variant:f().string,messageVariant:f().string,showPopupHeader:f().bool};const dn=mn;var vn=function(e){var t=e.children;return l().createElement(m.Text,{component:"h2",style:{color:"var(--pf-global--Color--200)",lineHeight:"2rem"}},t)};vn.propTypes={children:f().node};const bn=vn;var yn=n(66826);const hn=function(){return l().createElement(m.Bullseye,null,l().createElement(m.EmptyState,{variant:m.EmptyStateVariant.full},l().createElement(m.Title,{headingLevel:"h2",size:"lg",style:{fontWeight:"bold"}},"No systems on this policy"),l().createElement(m.EmptyStateBody,null,l().createElement(m.TextContent,null,l().createElement(m.Text,{component:m.TextVariants.p},"Add systems to this policy from the systems page"),l().createElement(m.Text,{style:{color:"var(--pf-global--warning-color--100)"}},l().createElement(Ue.ZP,null)," ",qe)))))};var gn=n(45465),On=["children","href"],En=function(e){var t=e.children,n=e.href,r=(0,se.Z)(e,On);return n&&l().createElement("a",(0,z.Z)({href:n},r),t)||t||""};En.propTypes={children:f().node,href:f().string};const Pn=En;var jn=["children","className"],wn=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,o=(0,se.Z)(e,jn);return l().createElement(m.Modal,(0,z.Z)({className:"compliance".concat(r?" ".concat(r):"")},o),t)};wn.propTypes={children:f().node,className:f().string};const xn=wn;var Tn=function(e){var t=e.compact;return l().createElement(m.Tooltip,{position:"right",content:"A policy of this type is already in use. Only one policy per policy type can be created for a major release of RHEL."},l().createElement(m.Label,{color:"orange",style:{lineHeight:"1.5em",marginRight:"16px"},compact:t},"In use"))};Tn.propTypes={compact:f().boolean};const Cn=Tn;var Zn=function(e){var t=e.children,n=e.requiredPermissions,r=void 0===n?[]:n,o=e.hide,i=void 0!==o&&o,a=(0,st.ZP)("rbac"),c=(0,Mt.c$)(r,!1,!1),s=c.hasAccess,u=c.isLoading;return a?u?"":s?t:!i&&l().createElement(S.Z,{serviceName:"Compliance"}):t};Zn.propTypes={children:f().node,requiredPermissions:f().array,hide:f().bool};const Sn=Zn;var kn=n(92397),In=["to","children"],Rn=function(e){return e.children};Rn.propTypes={children:f().node};var Dn=function(e){var t=e.to,n=e.children,r=(0,se.Z)(e,In),o=_t(t),i=o.hasAccess,a=!o.isLoading&&i,c=a?Rn:m.Tooltip;return l().createElement(c,{content:l().createElement("div",null,"You do not have permissions to perform this action")},l().createElement(kn.Z,(0,z.Z)({app:"compliance",to:t},r,{isDisabled:!a}),n))};Dn.propTypes={to:f().oneOfType([f().string,f().object]),children:f().node};const Fn=Dn;var Vn=["children","to"],Nn=function(e){var t=e.children,n=e.to,r=(0,se.Z)(e,Vn),o=(0,Ie.Z)();return l().createElement(m.Button,(0,z.Z)({onClick:function(){return o(n)}},r),t)};Nn.propTypes={navigate:f().func,children:f().node,to:f().oneOfType([f().string,f().object])};const Bn=Nn;var Ln=n(98614),Mn=n(24307),An=n(65413),_n=["value","defaultValue","variant","validate","onSave","label","enableEdit","isOpen","Component"],$n=function(e){var t=e.value,n=e.defaultValue,r=(e.variant,e.validate),o=e.onSave,a=(e.label,e.enableEdit),c=void 0===a||a,s=e.isOpen,u=void 0!==s&&s,p=e.Component,f=void 0===p?m.TextInput:p,d=(0,se.Z)(e,_n),v=(0,i.useRef)(),b=(0,i.useState)((function(){return t||n})),y=(0,B.Z)(b,2),h=y[0],g=y[1],O=(0,i.useState)(null),E=(0,B.Z)(O,2),P=E[0],j=E[1],w=(0,i.useState)((function(){return u||!1})),x=(0,B.Z)(w,2),T=x[0],C=x[1],Z=(0,i.useState)(!1),S=(0,B.Z)(Z,2),k=S[0],I=S[1];return(0,i.useEffect)((function(){T&&null!=v&&v.current&&v.current.focus()}),[T]),(0,i.useEffect)((function(){C(u)}),[u]),l().createElement(m.FormGroup,{className:"pf-c-inline-edit pf-m-inline-editable",style:{display:"inline-block"}},l().createElement("div",{className:"pf-c-inline-edit__group"},T?l().createElement(l().Fragment,null,l().createElement("div",null,l().createElement(f,(0,z.Z)({value:h,onChange:function(e){g(e),j(e!==h?(null==r?void 0:r(e))||!0:null)}},d))),l().createElement("div",{className:"pf-c-inline-edit__group pf-m-action-group pf-m-icon-group"},l().createElement("div",{className:"pf-c-inline-edit__action pf-m-valid"},l().createElement(m.Button,{className:"pf-c-button pf-m-plain pf-u-ml-sm",type:"button","aria-label":"Save edits",isDisabled:!P,isLoading:k,onClick:function(){I(!0),null==o||o(h)}},l().createElement(Ln.ZP,null))),l().createElement("div",{className:"pf-c-inline-edit__action"},l().createElement(m.Button,{className:"pf-c-button pf-m-plain pf-u-ml-sm",type:"button","aria-label":"Cancel edits",onClick:function(){g(t||n),C(!1)}},l().createElement(Mn.ZP,null))))):l().createElement(m.Text,{className:"textAreaClosedText",component:m.TextVariants.p},l().createElement(U.Z,{text:h,length:380,inline:!0}),c&&l().createElement(m.Button,{className:"pf-u-ml-sm",onClick:function(){C(!0)},variant:"plain"},l().createElement(An.ZP,null)))))};$n.propTypes={defaultValue:f().string,variant:f().string,Component:f().node,label:f().string,validate:f().func,onSave:f().func,isOpen:f().bool,enableEdit:f().bool,value:f().string};const Hn=$n;var qn=n(7648);function zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(n),!0).forEach((function(t){(0,ce.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gn=function(e){var t=e.component,n=e.path,r=e.props,o=e.title,a=e.requiredPermissions,c=(0,ke.useLocation)(),s=(0,qn.Z)(),u=!!(0,ke.matchPath)({path:n,end:!0},c.pathname),p=o.includes("$entityTitle"),f=Yn(Yn({},r),{},{route:Yn(Yn({},e),{},{isCurrent:u,setTitle:s})});return(0,i.useEffect)((function(){u&&!p&&s(o)}),[]),a?l().createElement(Sn,{requiredPermissions:a},l().createElement(t,f)):l().createElement(t,f)};Gn.propTypes={component:f().node,modal:f().bool,path:f().string,props:f().object,title:f().string,requiredPermissions:f().array};const Un=Gn},60076:(e,t,n)=>{"use strict";n.d(t,{U_:()=>x,ZP:()=>T});var r=n(45987),o=n(70885),i=n(4942),l=n(92950),a=n.n(l),c=n(62012),s=n(22663),u=n(2443),p=n(9669),f=n.n(p),m=n(70187),d=["path"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y="Reports",h=["compliance:*:*"],g=[{path:"reports",title:y,requiredPermissions:[].concat(h,["compliance:report:read"]),component:(0,l.lazy)((function(){return n.e(322).then(n.bind(n,70730))}))},{path:"reports/:report_id",title:"Report: $entityTitle - ".concat(y),requiredPermissions:[].concat(h,["compliance:report:read"]),defaultTitle:y,component:(0,l.lazy)((function(){return Promise.all([n.e(592),n.e(20),n.e(726),n.e(365),n.e(72)]).then(n.bind(n,62114))}))},{path:"reports/:report_id/delete",title:"Delete report - ".concat(y),requiredPermissions:[].concat(h,["compliance:report:delete"]),component:(0,l.lazy)((function(){return n.e(953).then(n.bind(n,57481))})),modal:!0},{path:"reports/:report_id/pdf",title:"Export report - ".concat(y),requiredPermissions:[].concat(h,["compliance:report:read"]),defaultTitle:y,modal:!0,component:(0,l.lazy)((function(){return Promise.all([n.e(592),n.e(20),n.e(726),n.e(365),n.e(72)]).then(n.bind(n,85217))}))}],O="SCAP policies",E=[{path:"scappolicies",title:O,requiredPermissions:[].concat(h,["compliance:policy:read"]),component:(0,l.lazy)((function(){return n.e(565).then(n.bind(n,95790))}))},{path:"scappolicies/new",title:O,requiredPermissions:[].concat(h,["compliance:policy:create"]),component:(0,l.lazy)((function(){return Promise.all([n.e(592),n.e(726),n.e(402)]).then(n.bind(n,88718))})),modal:!0},{path:"scappolicies/:policy_id",title:"$entityTitle - ".concat(O),requiredPermissions:[].concat(h,["compliance:policy:read"]),defaultTitle:O,component:(0,l.lazy)((function(){return Promise.all([n.e(592),n.e(726),n.e(705)]).then(n.bind(n,48497))}))},{path:"scappolicies/:policy_id/edit",title:"$entityTitle - ".concat(O),defaultTitle:O,requiredPermissions:[].concat(h,["compliance:policy:update"]),component:(0,l.lazy)((function(){return Promise.all([n.e(592),n.e(726),n.e(402)]).then(n.bind(n,30845))})),modal:!0},{path:"scappolicies/:policy_id/delete",title:"Delete policy - ".concat(O),requiredPermissions:[].concat(h,["compliance:policy:delete"]),component:(0,l.lazy)((function(){return n.e(164).then(n.bind(n,89671))})),modal:!0},{path:"scappolicies/:policy_id/default_ruleset",title:"Default policy rules - ".concat(O),requiredPermissions:[].concat(h,["compliance:policy:read"]),component:(0,l.lazy)((function(){return n.e(671).then(n.bind(n,49978))}))}],P="Compliance systems",j=[{path:"systems",title:P,requiredPermissions:[].concat(h,["compliance:system:read"]),component:(0,l.lazy)((function(){return Promise.all([n.e(592),n.e(726),n.e(402)]).then(n.bind(n,44434))}))},{path:"systems/:inventoryId",title:"$entityTitle - ".concat(P),defaultTitle:P,requiredPermissions:[].concat(h,["compliance:system:read"]),component:(0,l.lazy)((function(){return Promise.all([n.e(592),n.e(726),n.e(253),n.e(539)]).then(n.bind(n,40033))}))}],w=[].concat(E,g,j),x=function(e){var t="string"==typeof e?{pathname:e}:e;return w.find((function(e){return(0,c.matchPath)(b(b({},e),{},{exact:!0}),t.pathname)}))};const T=function(){var e=(0,l.useState)(!0),t=(0,o.Z)(e,2),n=t[0],i=t[1];return(0,l.useEffect)((function(){try{f().get("".concat("/api/inventory/v1/hosts","?page=1&per_page=1")).then((function(e){var t=e.data;i(t.total>0)}))}catch(e){console.log(e)}}),[n]),n?a().createElement(c.Routes,null,w.map((function(e){var t=e.path,n=(0,r.Z)(e,d);return a().createElement(c.Route,{path:t,key:"route-".concat(t.replace("/","-")),element:a().createElement(m.zm,b(b({},n),{},{path:t}))})})),a().createElement(c.Route,{path:"*",element:a().createElement(c.Navigate,{to:"reports"})})):a().createElement(s.Z,{appId:"compliance_zero_state",appName:"dashboard",module:"./AppZeroState",scope:"dashboard",ErrorComponent:a().createElement(u.Z,null),app:"Compliance"})}},70597:(e,t,n)=>{"use strict";n.d(t,{$H:()=>r,$X:()=>o,Ay:()=>l,KJ:()=>i,Qy:()=>c,hT:()=>a});var r=function(e,t,n){return!!(e&&t&&n)},o=function(e,t){return new RegExp("^[-]?\\d+(\\.\\d{1".concat(t>1?","+t:"","})?$"),"g").test(e.toString())},i=function(e){var t=parseFloat(e);return t<=100&&t>=0&&o(t,1)},l=function(e,t,n){return!!(e&&t&&n&&i(n))},a=function(e){return(null==e?void 0:e.length)>0},c=function(e){return!!e&&e.length>0}},88326:(e,t,n)=>{"use strict";n.d(t,{G:()=>p,f8:()=>u,kq:()=>s});var r=n(70885),o=n(92950),i=n(4992),l=n(14890),a=n(41105),c=n(65811),s=function(){var e=(0,l.Z)(),t=(0,a.Z)("/scappolicies");return function(){t({hash:e})}},u=function(e,t){var n=(0,i.a7)(),l=s(),a=(0,o.useState)(!1),u=(0,r.Z)(a,2),p=u[0],f=u[1],m=(0,o.useCallback)((function(){if(p)return Promise.resolve({});f(!0),n(e,t).then((function(){f(!1),(0,c.q)({variant:"success",title:"Policy updated",autoDismiss:!0}),l()})).catch((function(e){f(!1),(0,c.q)({variant:"danger",title:"Error updating policy",description:e.message}),l()}))}),[p,e,t]);return[p,m]},p=function(e,t,n,s){var u=(0,i.a7)(),p=function(e){var t=(0,l.Z)(),n=(0,a.Z)("/scappolicies/".concat(e));return function(){n({hash:t})}}(s),f=(0,o.useState)(!1),m=(0,r.Z)(f,2),d=m[0],v=m[1];return[d,function(){v(!0),n(),u(e,t).then((function(){v(!1),(0,c.q)({variant:"success",title:"Policy updated",autoDismiss:!0}),p()})).catch((function(e){v(!1),(0,c.q)({variant:"danger",title:"Error updating policy",description:e.message}),p()}))}]}},93471:(e,t,n)=>{"use strict";n.d(t,{Z:()=>C});var r=n(92950),o=n.n(r),i=n(45697),l=n.n(i),a=n(65115),c=n(62369),s=n(91290),u=function(e){var t=e.color,n=void 0===t?"#FFFFFF":t;return o().createElement("span",{style:{width:"10px",height:"10px",display:"inline-block",background:n}},"Â ")};u.propTypes={color:l().string};var p=function(e){var t=e.legendData,n=void 0===t?[]:t;return o().createElement(a.List,null,n.map((function(e,t){var n,r,i,l,c,p,f,m=e.name,d=e.symbol,v=e.tooltip,b=e.popover;return o().createElement(a.ListItem,{key:t,icon:o().createElement(u,{color:null==d?void 0:d.fill}),style:{verticalAlign:"middle"}},m,v&&o().createElement(a.Tooltip,{content:o().createElement(o().Fragment,null," ",v," ")},o().createElement("span",null,"Â ",o().createElement(s.ZP,{className:"grey-icon"}))),b&&(i=void 0===(r=(n=b).title)?"":r,c=void 0===(l=n.content)?"":l,f=void 0===(p=n.footer)?"":p,o().createElement(a.Popover,{maxWidth:"25rem",headerContent:i,bodyContent:c,footerContent:f},o().createElement("span",null,"Â ",o().createElement(s.ZP,{className:"grey-icon",style:{cursor:"pointer",marginTop:"3px"}})))))})))};p.propTypes={legendData:l().array};const f=p;var m=n(87462),d=n(45987),v=n(10310),b=n(52067),y=n(28858),h=n(72971),g=n(11443),O=n(42982),E=n(70187);var P=n(90952),j=["x","y","datum","chartColorScale","flyoutValues"],w=function(e){var t=e.x,n=e.y,r=e.datum,i=e.chartColorScale,l=e.flyoutValues,c=(0,d.Z)(e,j),s=t-l[r._x-1]/2+5,u=(r.endAngle-r.startAngle)/360;return c.text="".concat(c.text,": ").concat((100*u).toFixed(2),"%"),o().createElement("g",null,o().createElement("foreignObject",{height:"100%",width:"100%",x:s,y:n-11},o().createElement(a.Icon,null,o().createElement(P.ZP,{color:i[r._x-1]}))),o().createElement(v.Df,(0,m.Z)({x:t+10,y:n},c)))};w.propTypes={x:l().number,y:l().number,datum:l().object,chartColorScale:l().array,flyoutValues:l().array};const x=function(e){var t,n=e.compliantHostCount,r=void 0===n?0:n,i=e.testResultHostCount,l=void 0===i?0:i,c=e.unsupportedHostCount,s=void 0===c?0:c,u=e.totalHostCount,p=void 0===u?0:u,f=p-s-l,m=l-r,d=(null===(t=e.name)||void 0===t?void 0:t.replace(/ /g,""))||"donut-chart",v=[{x:"Compliant",y:r},{x:"Non-compliant",y:m},{x:"Unsupported",y:s},{x:"Not reporting",y:f}],P=0===p&&[h.um.black300]||[h.um.blue300,h.um.blue200,h.um.gold300,h.um.black200],j=[150,180,170,170],x=function(e,t){var n=t.testResultHostCount,r=void 0===n?0:n,i=t.unsupportedHostCount,l=void 0===i?0:i,c=t.totalHostCount,s=(void 0===c?0:c)-l-r;return[{name:"".concat(e[0].y," ").concat((0,g._6)(e[0].y,"system")," compliant"),symbol:{fill:h.um.blue300}},{name:"".concat(e[1].y," ").concat((0,g._6)(e[1].y,"system")," non-compliant"),symbol:{fill:h.um.blue200}}].concat((0,O.Z)(l>0?[{name:"".concat(e[2].y," ").concat((0,g._6)(e[2].y,"system")," not supported"),symbol:{fill:h.um.gold300},popover:{title:"Unsupported SSG versions",content:o().createElement(o().Fragment,null,o().createElement(a.Text,{variant:"p"},"These systems are running unsupported versions of the SCAP Security Guide (SSG) for the version of RHEL installed on them. Assessment of rules failed/passed on these systems is a best-guess effort and may not be accurate."),o().createElement(a.Text,{variant:"p"},"The policy's compliance score excludes these systems.")),footer:o().createElement(E.bL,null)}}]:[]),(0,O.Z)(s>0?[{name:"".concat(s," ").concat((0,g._6)(s,"system")," never reported"),popover:{title:"Systems never reported",content:"".concat(s," ").concat((0,g._6)(s,"system")," are not reporting scan results. This may be because the system is disconnected, or the insights-client is not properly configured to use Compliance.")},symbol:{fill:h.um.black200}}]:[]))}(v,e),T=(0,g.P0)(p>0?Math.floor(r/p*100):0);return{chartProps:{data:v,labelComponent:o().createElement(y.h,{flyoutWidth:function(e){var t=e.index;return j[t]},labelComponent:o().createElement(w,{chartColorScale:P,flyoutValues:j}),constrainToVisibleArea:!0}),identifier:d,title:T,subTitle:"Compliant",themeVariant:b.py.light,colorScale:P,style:{fontSize:20},innerRadius:88,constrainToVisibleArea:!0},legendData:x}};var T=function(e){var t=e.profile,n=void 0===t?{}:t,r=e.hasLegend,i=void 0===r||r,l=e.chartClass,s=x(n),u=s.chartProps,p=s.legendData;return o().createElement(a.Grid,{className:l},o().createElement(a.GridItem,{span:i?6:12},o().createElement(c.HS,u)),i?o().createElement(a.GridItem,{span:6,className:"pf-u-display-flex pf-u-align-items-center",style:{fontSize:".85em",height:"100%"}},o().createElement(f,{legendData:p})):null)};T.propTypes={profile:l().object,hasLegend:l().bool,chartClass:l().string};const C=T},65811:(e,t,n)=>{"use strict";n.d(t,{C:()=>i,q:()=>l});var r=n(30319),o=n(83215);function i(e){return(0,r.bh)().dispatch(e)}var l=function(e){i((0,o.wN)(e))}},11443:(e,t,n)=>{"use strict";n.d(t,{P0:()=>r,_6:()=>o});var r=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(null===(t=parseFloat(e))||void 0===t?void 0:t.toFixed(n))+(r?"%":"")},o=function(e,t,n){return n||(n=t+"s"),e>1||0===e?n:t}},79886:(e,t,n)=>{"use strict";n.d(t,{$s:()=>y,AZ:()=>g,SO:()=>m,Sj:()=>f,Uv:()=>O,dY:()=>v,eV:()=>h,jj:()=>p,qk:()=>b});var r,o=n(30168),i=n(87462),l=n(42982),a=n(92950),c=n.n(a),s=n(64640),u=n(67521),p=function(e){return(0,l.Z)(new Set(e))},f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(n,r){var o="asc"!=t,i=n&&n[e]||"",l=r&&r[e]||"";return(0,s.Z)({desc:o})(i,l)}},m=function(e,t){return function(n,r,o){return c().createElement(e,(0,i.Z)({},o,t))}},d=function(e,t){return"function"==typeof e?e(t):t[e]},v=function(e,t,n){return t.sort((function(t,r){return"asc"===n?String(d(e,t)).localeCompare(String(d(e,r))):-String(d(e,t)).localeCompare(String(d(e,r)))}))},b=function(e,t,n,r){var o=n.flatMap((function(n){return e.filter((function(e){return e[t]===n}))}));return"asc"!==r?o.reverse():o},y=function e(t,n,r){var o=n.split("."),i=o.shift();return void 0!==t[i]?o.length>0?e(t[i],o.join("."),r):t[i]:r},h=function(e){return e.split(/[-_\W]+/g).map((function(e){return e.trim()})).map((function(e){return e[0].toUpperCase()+e.substring(1)})).join("")},g=function(e){var t={},n=null==e?void 0:e.map((function(e){return e.key}));return null==n||n.forEach((function(e){return t[e+"Column"]=!0})),{query:(0,u.Ps)(r||(r=(0,o.Z)(["\n    fragment NameColumn on System {\n      name\n      osMajorVersion\n      osMinorVersion\n    }\n\n    fragment OsColumn on System {\n      osMajorVersion\n      osMinorVersion\n    }\n\n    fragment SsgVersionColumn on System {\n      testResultProfiles(policyId: $policyId) {\n        supported\n        benchmark {\n          version\n        }\n      }\n    }\n\n    fragment PoliciesColumn on System {\n      policies(policyId: $policyId) {\n        id\n        name\n      }\n    }\n\n    fragment FailedRulesColumn on System {\n      testResultProfiles(policyId: $policyId) {\n        rulesFailed\n        supported\n        osMajorVersion\n        score\n      }\n    }\n\n    fragment ComplianceScoreColumn on System {\n      testResultProfiles(policyId: $policyId) {\n        compliant\n        supported\n        score\n      }\n    }\n\n    fragment LastScannedColumn on System {\n      testResultProfiles(policyId: $policyId) {\n        lastScanned\n      }\n    }\n\n    fragment UpdatedColumn on System {\n      updated\n      culledTimestamp\n      staleWarningTimestamp\n      staleTimestamp\n    }\n\n    fragment TagsColumn on System {\n      tags\n    }\n\n    query U_Systems(\n      $filter: String!\n      $policyId: ID\n      $perPage: Int\n      $page: Int\n      $sortBy: [String!]\n      $tags: [String!]\n      $nameColumn: Boolean = false\n      $operatingSystemColumn: Boolean = false\n      $ssg_versionColumn: Boolean = false\n      $policiesColumn: Boolean = false\n      $failedRulesColumn: Boolean = false\n      $complianceScoreColumn: Boolean = false\n      $lastScannedColumn: Boolean = false\n      $updatedColumn: Boolean = false\n      $tagsColumn: Boolean = false\n    ) {\n      systems(\n        search: $filter\n        limit: $perPage\n        offset: $page\n        sortBy: $sortBy\n        tags: $tags\n      ) {\n        totalCount\n        edges {\n          node {\n            id\n            testResultProfiles(policyId: $policyId) {\n              id\n            }\n            ...NameColumn @include(if: $nameColumn)\n            ...OsColumn @include(if: $operatingSystemColumn)\n            ...SsgVersionColumn @include(if: $ssg_versionColumn)\n            ...PoliciesColumn @include(if: $policiesColumn)\n            ...FailedRulesColumn @include(if: $failedRulesColumn)\n            ...ComplianceScoreColumn @include(if: $complianceScoreColumn)\n            ...LastScannedColumn @include(if: $lastScannedColumn)\n            ...UpdatedColumn @include(if: $updatedColumn)\n            ...TagsColumn @include(if: $tagsColumn)\n          }\n        }\n      }\n    }\n  "]))),fragments:t}},O=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,o=t;r<o.length;r++){var i=o[r];i&&console.error(i)}return(null==t?void 0:t.filter((function(e){return!!e})).length)>0||void 0}},14890:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(62012);const o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,r.useLocation)();return((t.hash&&t.hash.length>0?t.hash:void 0)||e).replace("#","")}},7648:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c,a:()=>a});var r=n(92950),o=n(62012),i=n(55140),l=n(72971),a=function(e,t){var n=(0,o.useLocation)();(0,r.useEffect)((function(){var n=t?e.title.replace("$entityTitle",t):e.defaultTitle;e.setTitle(n)}),[t,n,e])};const c=function(){var e=(0,i.Z)();return function(t){e.updateDocumentTitle(function(e){return"".concat(e).concat(l.IJ)}(t||l.i2))}}},77346:(e,t,n)=>{"use strict";n.d(t,{Br:()=>s,ZP:()=>u});var r=n(92950),o=n(72971),i=n(62012),l="insights:compliance",a=function(e){var t=o.R2[e];return!!localStorage.getItem("".concat(l,":").concat(e))||t},c=function(e,t){var n="enable"===e||"true"===e,r=a("debugFeatures");n?(r&&console.log("Setting feature value for ".concat(t," to ").concat(n)),localStorage.setItem("".concat(l,":").concat(t),n)):(r&&console.log("Removing feature setting of ".concat(t)),localStorage.removeItem("".concat(l,":").concat(t)))},s=function(){var e=(0,i.useLocation)(),t=e.search,n=e.pathName,r=(0,i.useNavigate)();t&&(new URLSearchParams(t).forEach(c),r(n))};const u=function(e){var t=(0,r.useMemo)((function(){return a("debugFeatures")}),[]),n=(0,r.useMemo)((function(){return a(e)}),[e]);return(0,r.useEffect)((function(){t&&console.log("Feature ".concat(e," is set to ").concat(n))}),[e,n,t]),e?n:void 0}},41105:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(4942),o=n(62012),i=n(98773);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const a=function(e){var t=(0,o.useLocation)(),n=(0,i.Z)();return function(o){var i,a=null==t||null===(i=t.state)||void 0===i?void 0:i.background;n(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({pathname:a?a.pathname:e,hash:a?a.hash:void 0},o))}}},41532:(e,t,n)=>{"use strict";n.d(t,{fQ:()=>u});var r=n(92950),o=n.n(r),i=n(45697),l=n.n(i),a=n(65115),c=n(58247),s=function(e){var t=e.kind,n=void 0===t?"results":t;return o().createElement(c.Z,null,o().createElement(a.Bullseye,null,o().createElement(a.EmptyState,{variant:a.EmptyStateVariant.full},o().createElement(a.Title,{headingLevel:"h5",size:"lg"},"No matching ",n," found"),o().createElement(a.EmptyStateBody,null,"This filter criteria matches no ",n,".",o().createElement("br",null),"Try changing your filter settings."))))};s.propTypes={kind:l().string};var u=function(e,t){return[{cells:[{title:function(){return o().createElement(s,{kind:e})},props:{colSpan:t}}]}]}},67702:(e,t,n)=>{"use strict";n.d(t,{v:()=>ve});var r=n(42982),o=n(4942),i=n(37948),l=n(70885),a=n(92950),c=n.n(a),s=n(7732),u=n(79886);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(e){return e.map((function(e){return f(f({},e),function(e){return e.sortByProp||e.sortByFunction}(e)?{transforms:(0,u.jj)([].concat((0,r.Z)((null==e?void 0:e.transforms)||[]),[s.p]))}:{})}))};function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=n(41532);function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(e){var t,n;return e.key||(null===(t=e.original)||void 0===t?void 0:t.toLowerCase())||(null===(n=e.title)||void 0===n?void 0:n.toLowerCase())},E=function(e,t,n,o,i){return(n.length>0?n:[function(e){return e}]).flatMap((function(n){var l,a=function(e,t){return{props:g({},e.props||{}),itemId:e.itemId,cells:t.map((function(t){return{title:t.renderFunc?t.renderFunc(void 0,void 0,e):e[O(t)]}}))}}(e,t),s=n?n(a,e,t,i):a,u=(null===(l=e.props)||void 0===l?void 0:l.isExpanded)&&o&&function(e,t,n,r){return{props:{"aria-level":e.props["aria-level"],isDetailsRow:!0},cells:[{title:c().createElement(n,{item:e,key:"item-"+e.rowId}),props:g(g({},r?{colSpan:r}:{}),{},{className:"compliance-rule-details"})}]}}(e,0,o,t.length);return[s].concat((0,r.Z)(u?[u]:[]))}))},P=function e(t,n,o,i,l,a,s){var u,p,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,m=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,v=arguments.length>10?arguments[10]:void 0,b=arguments.length>11?arguments[11]:void 0,y=arguments.length>12?arguments[12]:void 0,h=arguments.length>13?arguments[13]:void 0,O=f+1,P=t.leaf||t.itemId,j=y&&h.flat().length>0||o.includes(P),w=function(e,r){var o=(null===(r=t.leaves)||void 0===r?void 0:r.map((function(e){return n.find((function(t){return t.itemId===e}))})).filter((function(e){return!!e})).map((function(t){var n;return g(g({},t),{},{props:g(g({},b?{isChecked:null===(n=t.rowProps)||void 0===n?void 0:n.selected}:{}),{},{isExpanded:y&&(null==h?void 0:h.flat().length)>0||e.includes(t.itemId),"aria-level":O,"aria-setsize":1})})})))||[],a=function(e,t,n,r){return e.flatMap((function(e,o){return E(e,t,n,r,o)})).filter((function(e){return!!e}))}((null==v?void 0:v(o))||o,i,l,d);return a}(o),x=t.twigs?t.twigs.flatMap((function(t){var r,c;return e(t,n,o,i,l,a,s,O,((null===(r=t.twigs)||void 0===r?void 0:r.length)||0)+((null===(c=t.leaves)||void 0===c?void 0:c.length)||0),d,v,b,y,h)})):[],T=x.length>0||w.length>0?[{cells:[{title:c().createElement("strong",null,t.title),props:{colSpan:i.length}}],itemId:P,isTreeBranch:!0,props:g(g({},b?{isChecked:(u=w.length>0||x.length>0,p=[].concat((0,r.Z)(x||[]),(0,r.Z)(w||[])),!(!u||!p.filter((function(e){return!e.props.isDetailsRow})).every((function(e){return!0===e.props.isChecked})))||!(!u||!p.some((function(e){return!0===e.props.isChecked})))&&null)}:{}),{},{isExpanded:j,"aria-level":f,"aria-setsize":m||(x.length||0)+(w.length||0)})}]:[];return t.leaf?E(n.find((function(e){return e.itemId===t.leaf})),i,l,s):[].concat(T,(0,r.Z)(j?[].concat((0,r.Z)(x),(0,r.Z)(w)):[]))},j=n(1522);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t,n;return e.key||(null===(t=e.original)||void 0===t?void 0:t.toLowerCase())||(null===(n=e.title)||void 0===n?void 0:n.toLowerCase())};const C=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.transformer,i=void 0===o?[]:o,c=n.rowTransformer,s=void 0===c?[]:c,u=n.tableTree,p=n.itemIdentifier,f=n.detailsComponent,m=n.selectItems,d=n.unselectItems,v=n.expandOnFilter,y=n.activeFilters,h=n.showTreeTable,g=n.onCollapse,O=n.openItems,E=n.emptyRows||b.fQ,w=i?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map((function(e){return function(e,t){var n=e;return t.forEach((function(e){e&&(n=e(n))})),n}(e,t)}))}(e,i):e,C=null!=n&&n.filter?n.filter(w):w,Z=null!=n&&n.sorter?n.sorter(C):C,S=null!=n&&n.paginator?null==n?void 0:n.paginator(Z):Z,k=(0,a.useMemo)((function(){return 0===Z.length?E:u&&h?function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(e){return e.id},a=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,s=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=arguments.length>9?arguments[9]:void 0,p=arguments.length>10?arguments[10]:void 0;return e.reduce((function(e,f,m){return[].concat((0,r.Z)(e),(0,r.Z)(P(f,t,o,n,i,l,m,1,void 0,a,c,s,u,p)))}),[])}(u,Z,t,O,s,p,f,null==n?void 0:n.sorter,!!m,!!v,!!v&&Object.entries(y||{}).filter((function(e){var t=(0,l.Z)(e,1)[0];return v.includes(t)})).map((function(e){return(0,l.Z)(e,2)[1]})).filter((function(e){return!!e}))):function(e,t,n){return e.length>0?e.flatMap((function(e,r){return function(e,t,n,r){return n.flatMap((function(n){var o=function(e,t){return x(x({},e.rowProps),{},{itemId:e.itemId,cells:t.map((function(t){return{title:t.renderFunc?t.renderFunc(void 0,void 0,e):e[T(t)]}}))})}(e,t);return n?n(o,e,t,r):o}))}(e,t,n,r)})).filter((function(e){return!!e})):[]}(S,t,s)}),[Z,S,O,t,y,h]),I=null!=n&&n.pagination?x(x({},n.pagination),{},{itemCount:C.length}):void 0,R=function(e,t,n,o,i){if(i.isTreeBranch){var l=function(e,t){return e.reduce((function e(n,o,i,l,a){var c,s=a||!t||o.itemId===t,u=null==o||null===(c=o.twigs)||void 0===c?void 0:c.flatMap((function(t){return e([],t,i,l,s)}));return[].concat((0,r.Z)(n),(0,r.Z)(u||[]),(0,r.Z)(s&&o.leaves||[]),(0,r.Z)(s&&o.leave?[o.leave]:[]))}),[])}(u,i.itemId);i.props.isChecked?d(l):m(l)}else t?m([i.itemId]):d([i.itemId])};return{tableProps:x({rows:k},u&&h&&Z.length>0?{isTreeTable:!0,cells:function(e){return[x(x({},e[0]),{},{cellTransforms:[].concat((0,r.Z)(e[0].cellTransforms||[]),[m?(0,j.G)(g,R):(0,j.G)(g)])})].concat((0,r.Z)(e.slice(1)))}(t)}:{}),toolbarProps:{pagination:I}}};var Z=n(77592);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var I=function(e){return e[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"id"]};function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(e,t,n,r){return void 0!==(null==n?void 0:n.detailsComponent)&&function(e,t,n,r){return{parent:2*t,fullWidth:!0,cells:[{title:c().createElement(n,{item:e,key:"item-"+e.rowId}),props:{colSpan:r}}]}}(e,t,n.detailsComponent,function(e,t){var n=e.length+1;return(t.selectable||t.hasRadioSelect)&&n++,n}(r,n))};const V=function(e){var t=!!e.detailsComponent&&!e.showTreeTable,n=(0,a.useMemo)((function(){return t=e.tableTree,function(e){var n;return function e(){var t,o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw i}}}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);try{for(l.s();!(t=l.n()).done;){var a,c=t.value;if((null===(a=c.leaves)||void 0===a?void 0:a.some((function(e){return e===o})))||c.leaf===o){n=[c.itemId].concat((0,r.Z)(i));break}e(c.twigs||[],o,[c.itemId].concat((0,r.Z)(i)))}}catch(e){l.e(e)}finally{l.f()}}(t,e),n||[]};var t}),[e.tableTreee]),o=(0,a.useState)([]),i=(0,l.Z)(o,2),c=i[0],s=i[1],u=(0,a.useCallback)((function(e,t,o,i){var l=n(i.itemId);c.includes(i.itemId)?s((function(e){return e.filter((function(e){return e!==i.itemId}))})):s((function(e){return[].concat((0,r.Z)(e),(0,r.Z)(l),[i.itemId])}))}),[c,s]);return t?{transformer:function(t,n,r,o){var i=c.includes(n.itemId);return[D(D({},t),{},{isOpen:i}),F(n,o,e,r)]},tableProps:{onCollapse:u},openItems:c}:{tableProps:{onCollapse:u},openItems:c}};var N=n(45697),B=n.n(N),L=n(65115),M=function(e){var t=e.column,n=e.onChange,r=e.isSelected,o=e.isDisabled,i=e.id;return c().createElement(L.DataListItem,null,c().createElement(L.DataListItemRow,null,c().createElement(L.DataListControl,null,c().createElement(L.DataListCheck,{checked:r,onChange:n,otherControls:!0,isDisabled:o,id:"".concat(i,"-id"),name:"".concat(i,"-id")})),c().createElement(L.DataListItemCells,{dataListCells:[c().createElement(L.DataListCell,{key:"".concat(i,"-cell")},c().createElement("label",{htmlFor:"".concat(i,"-id")},t.title))]})))};M.propTypes={id:B().string,column:B().object,onChange:B().func,isSelected:B().bool,isDisabled:B().bool};const A=M;var _=function(e){var t=e.isOpen,n=e.columns,o=e.onSave,i=e.onClose,s=e.selectedColumns,u=void 0===s?[]:s,p=(0,a.useState)(u),f=(0,l.Z)(p,2),m=f[0],d=f[1],v=function(e){var t=e.title;return m.includes(t)},b=function(){d(u),i&&i()},y=c().createElement(L.TextContent,null,c().createElement(L.Text,{component:L.TextVariants.p},"Selected categories will be displayed in the table."),c().createElement(L.Button,{isInline:!0,onClick:function(){d(n.map((function(e){return e.title})))},variant:"link"},"Select all"));return c().createElement(L.Modal,{title:"Manage columns",isOpen:t,variant:"small",onClose:b,ouiaId:"ManageColumns",description:y,actions:[c().createElement(L.Button,{key:"save",variant:"primary",ouiaId:"Save",onClick:function(){o&&o(m)}},"Save"),c().createElement(L.Button,{key:"cancel",variant:"secondary",ouiaId:"Cancel",onClick:b},"Cancel")]},c().createElement(L.DataList,{"aria-label":"Table column management",id:"table-column-management",isCompact:!0},n.map((function(e,t){return c().createElement(A,{key:"column-".concat(t),id:"column-".concat(t),column:e,isSelected:v(e),onChange:function(){!function(e){v(e)?d(m.filter((function(t){return t!==e.title}))):d([].concat((0,r.Z)(m),[e.title]))}(e)},isDisabled:0===t})}))))};_.propTypes={columns:B().array,selectedColumns:B().array,isOpen:B().bool,onSave:B().func,onClose:B().func};const $=_;function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=function(e,t){return e.filter((function(e){return t.includes(e.title)}))};var Y=n(45987),G=["items"];function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var K=["items"];function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var W=n(76316),Q=n(4585);const X=function(){return c().createElement("svg",{width:"14px",height:"14px",viewBox:"0 0 14 14",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",style:{fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:2}},c().createElement("g",{transform:"matrix(1,0,0,1,-60.5538,-10.4896)"},c().createElement("rect",{x:"59.391",y:"12.428",width:"14.103",height:"2.066"})),c().createElement("g",{transform:"matrix(1,0,0,1,-56.566,-5.40626)"},c().createElement("rect",{x:"59.391",y:"12.428",width:"14.103",height:"2.066"})),c().createElement("g",{transform:"matrix(1,0,0,1,-56.4533,-0.438152)"},c().createElement("rect",{x:"59.391",y:"12.428",width:"14.103",height:"2.066"})))};var ee=function(e){var t=e.onToggle,n=e.tableType;return c().createElement(L.ToggleGroup,null,c().createElement(L.ToggleGroupItem,{icon:c().createElement(Q.ZP,null),"aria-label":"list",isSelected:"list"===n,onChange:t}),c().createElement(L.ToggleGroupItem,{icon:c().createElement(X,null),"aria-label":"tree",isSelected:"tree"===n,onChange:t}))};ee.propTypes={onToggle:B().function,tableType:B().string};const te=ee;function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe=function(e,t,n){var r=t?t(e):e;return n?n(r):r};const ie=function(){var e,t,n,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},b=d.toolbarProps,y=d.tableProps,h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(null==t?void 0:t.identifier)||I;return e.map((function(e){return function(e,t){return k(k({},e),{},"string"==typeof t?{itemId:I(e,t)}:{itemId:t(e)})}(e,n)}))}(s,d),g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.map((function(e){return void 0===(null==e?void 0:e.managable)?q(q({},e),{},{managable:!0}):e})).filter((function(e){return!0===e.managable})),r=(0,a.useState)(e.map((function(e){return e.title}))),o=(0,l.Z)(r,2),i=o[0],s=o[1],u=(0,a.useState)(!1),p=(0,l.Z)(u,2),f=p[0],m=p[1],d=t.manageColumns,v=function(e){s(e),m(!1)};return d?{columns:z(e,i),columnManagerAction:{label:"Manage columns",onClick:function(){m(!0)}},ColumnManager:function(){return c().createElement($,{columns:n,isOpen:f,onClose:function(){return m(!1)},selectedColumns:i,onSave:v})}}:{columns:e}}(p,d),O=g.columnManagerAction,E=g.ColumnManager,P=g.columns,j=function(e){var t=!!e.tableTree,n=(0,a.useState)("tree"),r=(0,l.Z)(n,2),o=r[0],i=r[1],s=(0,a.useCallback)((function(){i("list"===o?"tree":"list")}),[o]),u=(0,a.useMemo)((function(){return function(){return c().createElement(te,{onToggle:s,tableType:o})}}),[o]);return t?{toolbarProps:{variant:"compact"},showTreeTable:"tree"===o,tableType:o,setTableType:i,TreeTableToggle:u}:{}}(d),w=j.toolbarProps,x=j.showTreeTable,T=j.TreeTableToggle,S=j.setTableType,R=j.tableType,D=(e=re(re({},d),{},{actions:[].concat((0,r.Z)((null==d?void 0:d.actions)||[]),(0,r.Z)(O&&[O]||[]))}),n=e.actions,{toolbarProps:{actionsConfig:{actions:(t=void 0===n?[]:n,[void 0].concat((0,r.Z)(t)))}}}).toolbarProps,F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.perPage,n=void 0===t?10:t,r=!1!==e.pagination&&!e.showTreeTable,o=(0,a.useState)({perPage:n,page:1}),i=(0,l.Z)(o,2),c=i[0],s=i[1],u=function(e){return s(v(v({},c),e))};return r?{paginator:function(e){var t=c.page,n=c.perPage,r=(t-1)*n,o=r+n;return e.slice(r,o)},setPage:function(e){var t=e<0?c.page+e:e;u({page:t>0?t:1})},toolbarProps:{pagination:v(v({},c),{},{onSetPage:function(e,t){return u(v(v({},c),{},{page:t}))},onPerPageSelect:function(e,t){return u({page:1,perPage:t})}})}}:{}}(re(re({},d),{},{showTreeTable:x})),N=F.toolbarProps,B=F.setPage,L=F.paginator,M=(0,i.Z)(re(re({},d),{},{setPage:B,onFilter:function(){return null==S?void 0:S("list")}})),A=M.toolbarProps,_=M.filter,H=M.selectedFilterToolbarProps,Q=M.activeFilters,X=V(re(re({},d),{},{showTreeTable:x})),ee=X.transformer,ne=X.tableProps,ie=X.openItems,le=function(e,t,n){var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,a.useState)(function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{index:"tree"===r.tableType?(null===(e=r.sortBy)||void 0===e?void 0:e.index)-1:(null===(t=r.sortBy)||void 0===t?void 0:t.index)||1,direction:(null===(n=r.sortBy)||void 0===n?void 0:n.direction)||"asc"}}(t)),r=(0,l.Z)(n,2),o=r[0],i=r[1],c=(0,a.useCallback)((function(n){var r=e[o.index-("tree"===t.tableType?0:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return("function"==typeof e.onSelect||e.hasRadioSelect?1:0)+(void 0!==e.detailsComponent)}(t))-1];return null!=r&&r.sortByArray?(0,u.qk)(n,null==r?void 0:r.sortByProp,null==r?void 0:r.sortByArray,o.direction):(0,u.dY)((null==r?void 0:r.sortByProp)||(null==r?void 0:r.sortByFunction),n,o.direction)}),[o,e,t.tableType]);return{sorter:c,tableProps:{onSort:function(e,t,n){i({index:t,direction:n})},sortBy:o,cells:m(e)}}}(t,n),o=r.tableProps,i=r.sorter;return{tableProps:f(f({},o),{},{sortBy:e.length>0?o.sortBy:void 0}),sorter:i}}(s,P,re(re({},d),{},{tableType:R})),ae=le.tableProps,ce=le.sorter,se=(0,Z.n)(re(re({},d),{},{items:ce(h),filter:_,paginator:L,setPage:B,showTreeTable:x})),ue=se.transformer,pe=se.toolbarProps,fe=se.tableProps,me=se.selectedItems,de=se.selectItems,ve=se.unselectItems,be=function(e){var t,n,r,i=e.items,l=(0,Y.Z)(e,G),a=(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({items:i,total:i.length},l),n=t.onRadioSelect,r=t.total,n&&r>0?{tableProps:{onSelect:n,selectVariant:"radio"}}:{});return a}(re({items:oe(h,_,ce)},d)).tableProps,ye=function(e){var t=e.items,n=(0,Y.Z)(e,K),r=t.length>0?function(e){var t=e.actionResolver;return t?{tableProps:{actionResolver:t}}:{}}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({items:t},n)):{};return r}(re(re({items:oe(h,_,ce)},d),y)).tableProps,he=function(e){var t=!!e.dedicatedAction,n=e.dedicatedAction,r=e.AdditionalDedicatedActions,o=e.selected;return t?{toolbarProps:{dedicatedAction:c().createElement("div",null,n&&c().createElement(n,o&&{selected:o}),r&&c().createElement(r,o&&{selected:o}))}}:{}}(re(re({},d),{},{selected:me,additionalDedicatedActions:null==H?void 0:H.dedicatedAction})).toolbarProps,ge=(0,W.E9)(oe((null==me?void 0:me.length)>0?me:s,_,ce),P,d).toolbarProps,Oe=C(h,ae.cells,{emptyRows:d.emptyRows,transformer:[ue],rowTransformer:[ee],pagination:null==N?void 0:N.pagination,paginator:L,filter:_,sorter:ce,itemIdentifier:d.identifier,tableTree:d.tableTree,detailsComponent:d.detailsComponent,selectItems:de,unselectItems:ve,expandOnFilter:d.expandOnFilter,activeFilters:Q,showTreeTable:x,onCollapse:null==ne?void 0:ne.onCollapse,openItems:ie}),Ee=Oe.toolbarProps,Pe=Oe.tableProps;return{toolbarProps:re(re(re(re(re(re(re(re(re(re({},N),pe),A),H),he),Ee),b),ge),D),w),tableProps:re(re(re(re(re(re(re({cells:P},ae),fe),ne),be),ye),y),Pe),ColumnManager:E,TreeTableToggle:T}};var le=n(87462),ae=n(3351),ce=n(22860),se=n(6934),ue=n(3962),pe=n(65550),fe=["items","columns","filters","options","toolbarProps"];function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var de=function(e){var t=e.items,n=void 0===t?[]:t,r=e.columns,i=void 0===r?[]:r,l=e.filters,a=void 0===l?[]:l,s=e.options,u=void 0===s?{}:s,p=e.toolbarProps,f=(0,Y.Z)(e,fe),m=ie(n,i,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({filters:a,toolbarProps:p,tableProps:f},u)),d=m.toolbarProps,v=m.tableProps,b=m.ColumnManager,y=m.TreeTableToggle;return c().createElement(c().Fragment,null,c().createElement(ue.Z,d,y&&c().createElement(y,null)),c().createElement(ae.i,v,c().createElement(se.x,null),c().createElement(ce.R,null)),c().createElement(pe.Z,{isFooter:!0,results:-1,selected:-1},d.pagination&&c().createElement(L.Pagination,(0,le.Z)({variant:L.PaginationVariant.bottom},d.pagination))),b&&c().createElement(b,null))};de.propTypes={items:B().array.isRequired,columns:B().arrayOf(B().shape({title:B().node,transforms:B().array,sortByProperty:B().string,sortByArray:B().array,sortByFunction:B().func,renderFunc:B().func})).isRequired,filters:B().object,options:B().object,toolbarProps:B().object};const ve=de},77592:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g,n:()=>E});var r=n(45987),o=n(4942),i=n(15861),l=n(70885),a=n(42982),c=n(64687),s=n.n(c),u=n(92950),p=(n(79886),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e.itemId)}))}),f=["onSelect","items","filter","paginator","preselected","setPage"],m=["selectNone","selectedIds"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(e){return e?"Unselect":"Select"},y=function(e){return e.map((function(e){return e.itemId}))},h=function(e,t){return Array.from(new Set([].concat((0,a.Z)(e),(0,a.Z)(t))))},g=function(e){var t,n,r,o=e.total,a=e.onSelect,c=e.preselected,p=e.itemIdsInTable,f=e.itemIdsOnPage,m=e.identifier,d=void 0===m?"id":m,y=e.showTreeTable,g=!!a,O=(0,u.useState)(c),E=(0,l.Z)(O,2),P=E[0],j=E[1],w=(P||[]).length,x=f().length,T=w===o,C=0===w,Z=(t=f(),0!==(n=P||[]).length&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter((function(e){return t.includes(e)})).length===e.length}(t,n)),S=0===o,k=0!==(r=w)&&(r===o||null),I=function(e,t){return"".concat(e," selected")}(w),R=function(){var e=(0,i.Z)(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:n=e.sent,j(n),a&&a(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(e){return h(P,e)},F=function(e){return P.filter((function(t){return!e.includes(t)}))},V=function(){return[]},N=function(){return R(V)},B=function(){return R((function(){var e=f();return h(P,e).length===P.length?F(e):D(e)}))};return(0,u.useEffect)((function(){j(c)}),[c]),g?{selectedIds:P,selectNone:N,selectItems:function(e){return R((function(){return D(e)}))},unselectItems:function(e){return R((function(){return F(e)}))},tableProps:v(v({},y?{}:{onSelect:o>0?function(e,t,n,r){R((function(){return t?D([r[d]]):F([r[d]])}))}:void 0}),{},{canSelectAll:!1}),toolbarProps:{bulkSelect:{toggleProps:{children:[I]},isDisabled:S,items:[{title:"Select none",onClick:N,props:{isDisabled:C}},{title:"".concat(b(Z)," page (").concat(x," items)"),onClick:B},{title:"".concat(b(T)," all (").concat(o," items)"),onClick:function(){return R((0,i.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!T){e.next=4;break}e.t0=[],e.next=9;break;case 4:return e.t1=D,e.next=7,p();case 7:e.t2=e.sent,e.t0=(0,e.t1)(e.t2);case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)}))))}}],checked:k,onSelect:S?void 0:B}}}:{}},O=function(e,t){return v(v({},e),{},{rowProps:{selected:(t||[]).includes(e.itemId)}})},E=function(e){var t=e.onSelect,n=e.items,o=e.filter,i=e.paginator,l=e.preselected,a=e.setPage,c=(0,r.Z)(e,f),s=!!t,d=n.map((function(e){return O(e,l)})),b=d.length,h=o?o(d):d,E=h.length,P=E!==b,j=i?i(h):h,w=j.length,x=P?E:b;(0,u.useEffect)((function(){0===w&&a&&(null==a||a(-1))}),[w]);var T=g(v(v({},c),{},{total:x,onSelect:t,preselected:l,itemIdsInTable:function(){return y(P?h:d)},itemIdsOnPage:function(){return y(j)},identifier:"itemId"})),C=T.selectNone,Z=T.selectedIds,S=(0,r.Z)(T,m);return s?v({transformer:function(e){return O(e,Z)},selectedItems:p(d,Z),selected:Z,clearSelection:C},S):{}}},76316:(e,t,n)=>{"use strict";n.d(t,{E9:()=>h,ZP:()=>g});var r=n(71002),o=n(15861),i=n(42982),l=n(64687),a=n.n(l),c=n(79886),s={csv:"text/csv",json:"application/json"},u=function(e){return"compliance-export-"+(new Date).toISOString()+"."+e},p=function(e){return"data:".concat(s[e],";charset=utf-8")},f=function(e,t){var n=document.createElement("a");n.href=e,n.download=t,n.click()},m=function(e,t){var n=t.exportKey,r=t.renderExport,o=n?(0,c.$s)(e,n):e;return r?r(o):o},d=function(e){var t=e.items,n=e.columns,r=[n.map((function(e){return e.original||e.title})).join(",")].concat((0,i.Z)(t.map((function(e){return n.map((function(t){return'"'.concat(m(e,t),'"')})).join(",")}))));return encodeURI("".concat(p("csv"),",").concat(r.join("\n")))},v=function(e){var t=e.items,n=e.columns,r=t.map((function(e){return n.reduce((function(t,n){var r=(0,c.eV)(n.original||n.title),o=m(e,n);return t[r]=o,t}),{})}));return encodeURI("".concat(p("json"),",").concat(JSON.stringify(r)))},b=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e&&e.apply(void 0,n)},y=function(e){var t=e.exporter,n=e.columns,r=void 0===n?[]:n,i=e.isDisabled,l=void 0!==i&&i,c=e.onStart,s=e.onComplete,p=e.onError,m=r.filter((function(e){return!1!==e.export&&(e.exportKey||e.renderExport)})),y=function(){var e=(0,o.Z)(a().mark((function e(n){var r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(c),e.next=3,t().then((function(e){return b(s,e),e})).catch((function(e){return b(p,e)}));case 3:if(r=e.sent,o="csv"===n?d:v,!r){e.next=9;break}return e.abrupt("return",f(o({items:r,columns:m}),u(n)));case 9:return console.info("No items returned for export"),e.abrupt("return");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{toolbarProps:{exportConfig:{isDisabled:l,onSelect:function(e,t){return y(t)}}}}},h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=null==n?void 0:n.exportable,i="object"===(0,r.Z)(n.exportable)?n.exportable:{},l=i.columns,a=i.onStart,c=i.onComplete,s=(l||t).filter((function(e){return t.includes(e)})),u=y({exporter:function(){return Promise.resolve(e)},columns:s,isDisabled:0===e.length,onStart:a,onComplete:c});return o?u:{}};const g=y},37948:(e,t,n)=>{"use strict";n.d(t,{Z:()=>D});var r=n(42982),o=n(15861),i=n(4942),l=n(70885),a=n(71002),c=n(64687),s=n.n(c),u=n(92950),p=n.n(u),f=n(45987),m=n(43144),d=n(15671),v=n(83237),b=function(e){return e.split(" ").join("").toLowerCase()};const y=(0,m.Z)((function e(t){var n=this;(0,d.Z)(this,e),(0,i.Z)(this,"buildFilterFilterString",(function(e,t){var n=e.type,r=e.filterString;if("hidden"!==n&&!t)return[];switch(n){case v.Y.text:return[r(t)];case v.Y.checkbox:return t.map((function(e){return r(e)}));case v.Y.group:return r(t);case"hidden":return r();default:return[]}})),(0,i.Z)(this,"combineFilterStrings",(function(e){var t=e.map((function(e){return e.length})).filter((function(e){return e>0})).length>=2;return e.map((function(e){return e.join(" or ")})).join(t?" and ":"")})),(0,i.Z)(this,"buildFilterString",(function(e){var t=n.config.map((function(t){return n.buildFilterFilterString(t,e[b(t.label)])})).filter((function(e){return e.length>0}));return n.combineFilterStrings(t)})),this.filterConfig=t,this.config=this.filterConfig.config}));var h=function(e){return function(t){return String(t.value)===String(e)}};const g=(0,m.Z)((function e(t){var n=this;(0,d.Z)(this,e),(0,i.Z)(this,"textFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:t}]}:null})),(0,i.Z)(this,"checkboxFilterChip",(function(e,t){return t&&t.length>0?{category:e,chips:t.map((function(t){return{name:n.filterConfig.labelForValue(t,e)}}))}:null})),(0,i.Z)(this,"radioFilterChip",(function(e,t){return t&&""!==t?{category:e,chips:[{name:n.filterConfig.labelForValue(t,e)}]}:null})),(0,i.Z)(this,"groupFilterChip",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,o=Object.keys(t).flatMap((function(e){var o=n.items.find(h(e));return Object.keys(t[e]).map((function(n){return t[e][n]?[].concat((0,r.Z)(o.groupSelectable?[{label:o.label,value:o.value}]:[]),(0,r.Z)((null==o?void 0:o.items)||[])).find(h(n)):null}))})).filter((function(e){return!!e}));return t&&o.length>0?{category:e,chips:o.map((function(e){return{name:e.label}}))}:null})),(0,i.Z)(this,"chipFor",(function(e,t){var r=n.filterConfig.getCategoryForLabel(e),o=r||{label:e,type:null},i=o.label;switch(o.type){case v.Y.text:return n.textFilterChip(i,t);case v.Y.checkbox:return n.checkboxFilterChip(i,t);case v.Y.radio:return n.radioFilterChip(i,t);case v.Y.group:return n.groupFilterChip(i,t,r);default:return null}})),(0,i.Z)(this,"chipsFor",(function(e){return Object.keys(e).map((function(t){return n.chipFor(t,e[t])})).filter((function(e){return!!e}))})),this.filterConfig=t,this.config=this.filterConfig.config}));function O(e){var t=function(e,t){if("object"!==(0,a.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==(0,a.Z)(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===(0,a.Z)(t)?t:String(t)}function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=function(e){return"Filter by ".concat(e.toLowerCase())};const w=(0,m.Z)((function e(t){var n=this;(0,d.Z)(this,e),(0,i.Z)(this,"chipBuilder",null),(0,i.Z)(this,"filterBuilder",null),(0,i.Z)(this,"addConfigItem",(function(e){return n.config=n.config.filter((function(t){return t.label!==e.label})).concat(e)})),(0,i.Z)(this,"getChipBuilder",(function(e){return e&&(n.config=e),n.chipBuilder=n.chipBuilder?n.chipBuilder:new g(n)})),(0,i.Z)(this,"getFilterBuilder",(function(e){return e&&(n.config=e),n.filterBuilder=n.filterBuilder?n.filterBuilder:new y(n)})),(0,i.Z)(this,"toTextFilterConfig",(function(e,t,n){return{type:v.Y.text,label:e.label,placeholder:j(e.label),id:b(e.label),filterValues:(0,i.Z)({value:n},e.event||"onChange",(function(n,r){t(b(e.label),r)}))}})),(0,i.Z)(this,"toCheckboxFilterConfig",(function(e,t,n){return{type:v.Y.checkbox,label:e.label,placeholder:j(e.label),id:b(e.label),filterValues:{value:n,items:e.items,onChange:function(n,r){t(b(e.label),r)}}}})),(0,i.Z)(this,"toRadioFilterConfig",(function(e,t,n){return{type:v.Y.radio,label:e.label,placeholder:j(e.label),id:b(e.label),filterValues:{value:n,items:e.items,onChange:function(n,r){t(b(e.label),r)}}}})),(0,i.Z)(this,"toGroupedFilterConfig",(function(e,t,n){return{type:v.Y.group,label:e.label,id:b(e.label),className:e.className,filterValues:{selected:n,onChange:function(n,r){t(b(e.label),r)},groups:e.items.map((function(e){return P(P({},e),{},{type:"checkbox",items:e.items.map((function(e){return P(P({},e),{},{type:"checkbox"})}))})}))}}})),(0,i.Z)(this,"toFilterConfigItem",(function(e,t,r){switch(e.type){case v.Y.text:return n.toTextFilterConfig(e,t,r);case v.Y.checkbox:return n.toCheckboxFilterConfig(e,t,r);case v.Y.radio:return n.toRadioFilterConfig(e,t,r);case v.Y.group:return n.toGroupedFilterConfig(e,t,r);default:return null}})),(0,i.Z)(this,"buildConfiguration",(function(e,t){var r=arguments.length>3?arguments[3]:void 0;return P(P({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),{},{items:(r||n.config).map((function(r){return n.toFilterConfigItem(r,e,t[b(r.label)])})).filter((function(e){return!!e}))})})),(0,i.Z)(this,"defaultValueForFilter",(function(e){switch(e.type){case v.Y.text:return"";case v.Y.checkbox:return[];case"hidden":return e.default||!1;default:return}})),(0,i.Z)(this,"initialDefaultState",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return((arguments.length>1?arguments[1]:void 0)||n.config).reduce((function(t,r){var o=b(r.key||r.label),i=e[o]||n.defaultValueForFilter(r);return t[o]=i||void 0,t}),{})})),(0,i.Z)(this,"categoryLabelForValue",(function(e){var t=n.config.filter((function(t){return!!t.items&&t.items.map((function(e){return e.value})).includes(e)}))[0];return t?t.label:e})),(0,i.Z)(this,"getCategoryForLabel",(function(e){return n.config.filter((function(t){return b(t.key||t.label)===b(e)}))[0]||{}})),(0,i.Z)(this,"getItemByLabelOrValue",(function(e,t){var r=n.getCategoryForLabel(t),o=((r.type!==v.Y.group?r.items:r.items.flatMap((function(e){return e.items.map((function(t){return P(P({},t),{},{parentValue:e.value})}))})))||[]).filter((function(t){return t.value===e||t.label===e}));return 1===o.length?o[0]:o.length>1?(console.info("Multiple items found for ".concat(e," in ").concat(t,"! Returning first one.")),o[0]):void console.info("No item found for "+e+" in ",t)})),(0,i.Z)(this,"labelForValue",(function(e,t){var r=n.getItemByLabelOrValue(e,t);return r?r.label:e})),(0,i.Z)(this,"valueForLabel",(function(e,t){var r=n.getItemByLabelOrValue(e,t);return r?r.value:e})),(0,i.Z)(this,"applyFilterToObjectArray",(function(e,t){var o=(0,r.Z)(e);return Object.keys(t).forEach((function(e){var r=n.getCategoryForLabel(e),i=t[e];r&&i&&(i.length>0||"hidden"===r.type&&"boolean"==typeof i)&&(o=r.filter(o,i))})),o})),(0,i.Z)(this,"removeFilterFromFilterState",(function(e,t){return"string"==typeof e?"":e.filter((function(e){return e!==t}))})),(0,i.Z)(this,"removeFilterFromGroupFilterState",(function(e,t,n){var r=e[n.parentValue],o=n.value,l=(r[o],(0,f.Z)(r,[o].map(O)));return P(P({},e),{},(0,i.Z)({},n.parentValue,l))})),(0,i.Z)(this,"removeFilterWithChip",(function(e,t){var r=e.category,o=e.chips[0].name,l=n.getItemByLabelOrValue(o,r),a=l?l.value:o,c=b(r),s=t[c],u=(n.getCategoryForLabel(r).type===v.Y.group?n.removeFilterFromGroupFilterState:n.removeFilterFromFilterState)(s,a,l);return P(P({},t),{},(0,i.Z)({},c,u))})),this.config=t}));var x=n(65115),T=n(45697),C=n.n(T),Z=function(e){var t=e.isChecked,n=e.setActiveFilter;return p().createElement(x.Switch,{label:"Selected only",isChecked:t,onChange:function(){return n("selected",!t)}})};Z.propTypes={isChecked:C().bool,setActiveFilter:C().func};const S=Z;function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=new w([]);const D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filters,n=e.setPage,c=e.selectedFilter,f=e.onDeleteFilter,m=e.onFilter,d=!!t,v=t||{},b=v.filterConfig,y=void 0===b?[]:b,h=v.activeFilters,g=(0,u.useState)({}),O=(0,l.Z)(g,2),E=O[0],P=O[1],j=function(e,t){return"function"==typeof e?e(t):e}(h,E),w=function(e,t){P((function(n){return I(I({},n),{},(0,i.Z)({},e,t))})),"name"===e&&(null==m||m()),n&&n(1)},x=function(e){R.addConfigItem(e),P(R.initialDefaultState(E))},T=function(e){return P(R.removeFilterWithChip(e,E))},C=function(){var e=(0,o.Z)(s().mark((function e(t,n){var r,o=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]&&o[2],e.next=3,r;case 3:if(!e.sent){e.next=7;break}P(R.initialDefaultState()),e.next=8;break;case 7:T(n[0]);case 8:f&&f(n,r);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(e){var t=e.setActiveFilter,n=e.activeFilters,r=!!e.selectedFilter,o="selected",i={type:"hidden",label:"selectFilter",key:o,default:!0,filter:function(e,t){return e.filter((function(e){var n;return(null==e||null===(n=e.rowProps)||void 0===n?void 0:n.selected)===t}))}},l=!0===n[o];return r?{filterItem:i,toolbarProps:{dedicatedAction:p().createElement(S,{setActiveFilter:t,isChecked:l})}}:{}}({activeFilters:E,setActiveFilter:w,selectedFilter:c}),k=Z.toolbarProps,D=Z.filterItem,F=(0,u.useMemo)((function(){return function(e){return Object.values(e).filter((function(e){return(0,a.Z)(e)===Object?Object.values(e).length>0:(0,a.Z)(e)===Array?e.length>0:!!e}))}(E)}),[E]),V=[].concat((0,r.Z)(y),(0,r.Z)(D?[D]:[]));return(0,u.useEffect)((function(){return R.config=[],V.filter((function(e){return!!e})).forEach(x),P(R.initialDefaultState(j||[]),y),function(){R.config=[]}}),[JSON.stringify(j)]),d?{filter:function(e){return R.applyFilterToObjectArray(e,E)},selectedFilterToolbarProps:k,toolbarProps:{filterConfig:R.buildConfiguration(w,E,{},V),activeFiltersConfig:{filters:R.getChipBuilder(V).chipsFor(E),onDelete:C}},setActiveFilter:w,activeFilters:E,activeFilterValues:F,addConfigItem:x,filterConfigBuilder:R,filterString:function(){return R.getFilterBuilder(V).buildFilterString(E)}}:{}}},82176:(e,t,n)=>{"use strict";n.d(t,{C4:()=>s,RT:()=>b,qN:()=>d,uJ:()=>v});var r=n(70885),o=n(45987),i=n(4942),l=["identifier","references"];function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var s="Never",u=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return!e.compliant}))}))},p=function(e){return e.flatMap((function(e){return e.rules&&e.rules.filter((function(e){return e.compliant}))}))},f=function(e){return e.testResultProfiles?u(e.testResultProfiles):[]},m=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce((function(e,t){return e&&!!t.supported}),!0)},d=function(e){return e.map((function(e){return c(c({},e),{},{ruleObjectsFailed:f(e),supported:m(e.testResultProfiles),profiles:e.testResultProfiles})}))},v=function(e){return e.flatMap((function(e){return e.rules.map((function(t){var n,i,a,s=t.identifier,u=t.references,p=(0,o.Z)(t,l),f=null===(n=e.valueDefinitions)||void 0===n?void 0:n.filter((function(e){var t,n=e.id;return null===(t=p.values)||void 0===t?void 0:t.includes(n)})),m=Object.fromEntries(Object.entries((null===(i=e.ruleValues)||void 0===i?void 0:i[e.id])||(null===(a=e.ruleValues)||void 0===a?void 0:a[e.profile.id])||{}).filter((function(e){var t=(0,r.Z)(e,1)[0];return f.map((function(e){return e.refId})).includes(t)||f.map((function(e){return e.id})).includes(t)})));return c(c({},p),{},{references:u||[],identifier:s&&s.label?s:null,profile:e.profile,policyId:e.id,valueDefinitions:f,ruleValues:m})}))}))},b=function(e){var t=e.reduce((function(e,t){return e+t.score}),0),n=p(e).length,r=u(e).length,o=e.reduce((function(e,t){return p([t]).length+u([t]).length>0?e+1:e}),0);return{score:o?t/o:0,rulesPassed:n,rulesFailed:r,compliant:e.every((function(e){return e.lastScanned===s||!0===e.compliant})),supported:m(e)}}},72971:(e,t,n)=>{"use strict";n.d(t,{dT:()=>d,p5:()=>Z,yi:()=>S,rN:()=>C,qo:()=>E,i2:()=>f,IJ:()=>m,z7:()=>R,R2:()=>k,um:()=>I,iK:()=>v,iz:()=>w,n3:()=>T,RM:()=>P});var r=n(83237),o=n(65811),i=n(89734),l=n.n(i),a=n(92950),c=n.n(a),s=n(43047),u=n(69957),p=n(73479),f="Compliance | Red Hat Insights",m=" - ".concat(f),d="/api/compliance",v="https://access.redhat.com/articles/6644131",b=c().createElement("svg",{width:"1em",height:"1em",viewBox:"0 0 18 18",role:"img",style:{verticalAlign:"-0.125em"},xmlns:"http://www.w3.org/2000/svg"},c().createElement("path",{d:"M2 0h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm6.67 10.46a1.67 1.67 0 1 0 0 3.338 1.67 1.67 0 0 0 0-3.338zm-1.586-6l.27 4.935a.435.435 0 0 0 .434.411H9.55c.232 0 .422-.18.435-.411l.27-4.936A.435.435 0 0 0 9.818 4h-2.3c-.25 0-.448.21-.435.46z",fill:"#3A9CA6",fillRule:"evenodd"})),y=c().createElement(c().Fragment,null,c().createElement(s.ZP,{className:"ins-u-failed"})," High"),h=c().createElement(c().Fragment,null,c().createElement(u.ZP,{className:"ins-u-warning"})," Medium"),g=c().createElement(c().Fragment,null,b," Low"),O=c().createElement(c().Fragment,null,c().createElement(p.ZP,null)," Unknown"),E=[{type:r.Y.text,label:"Name",filterString:function(e){return"name ~ ".concat(e)}}],P=function(e){return[{type:r.Y.checkbox,label:"Policy",filterString:function(e){return"policy_id = ".concat(e)},items:e.map((function(e){return{label:e.name,value:e.id}}))}]},j=function(e){return Array.from(new Set(e.map((function(e){return e.osMajorVersion}))))},w=function(e){return[{type:r.Y.checkbox,label:"Operating system",filterString:function(e){return"os_major_version = ".concat(e)},items:j(e).map((function(e){return{label:"RHEL ".concat(e),value:e}}))}]},x={value:"",isDisabled:!0,items:[{value:"",label:c().createElement("div",{className:"ins-c-osfilter__no-os"},"No OS versions available"),isDisabled:!0,items:[],className:"ins-c-osfilter__os-filter-button"}]},T=function(e){var t=l()(Object.keys(e).map(Number)).reverse(),n=t.length>0?t.map(function(e){return function(t){return{label:"RHEL ".concat(t),value:t,groupSelectable:!0,items:l()(e[t]).reverse().map((function(e){return{label:"RHEL ".concat(t,".").concat(e),value:e}}))}}}(e)):[x];return[{type:r.Y.group,label:"Operating system",filterString:function(e){return[Object.keys(e).flatMap((function(t){return Object.keys(e[t]).map((function(n){return e[t][n]&&"(os_major_version = ".concat(t," AND os_minor_version = ").concat(n,")")}))})).filter((function(e){return!!e})).join(" OR ")]},items:n}]},C=[{type:r.Y.checkbox,label:"Compliance",filterString:function(e){return"".concat(e)},items:[{label:"Compliant",value:"compliant = true AND supported_ssg = true"},{label:"Non-compliant",value:"compliant = false AND supported_ssg = true"},{label:"Not supported",value:"supported_ssg = false"},{label:"Never reported",value:"reported = false"}]},{type:r.Y.checkbox,label:"Compliance score",filterString:function(e){var t=e.split("-");return"(compliance_score >= ".concat(t[0]," and compliance_score < ").concat(t[1],")")},items:[{label:"90 - 100%",value:"90-101"},{label:"70 - 89%",value:"70-90"},{label:"50 - 69%",value:"50-70"},{label:"Less than 50%",value:"0-50"}]}],Z=[{type:r.Y.checkbox,label:"Failed rule severity",filterString:function(e){return"failed_rules_with_severity ^ (".concat(e,")")},items:[{label:y,value:"high"},{label:h,value:"medium"},{label:g,value:"low"},{label:O,value:"unknown"}]}],S={exportable:{onStart:function(){(0,o.q)({variant:"info",title:"Preparing export",description:"Once complete, your download will start automatically."})},onComplete:function(){(0,o.q)({variant:"success",title:"Downloading export"})}},manageColumns:!0},k={pdfReport:!0,manageColumns:!0,systemsNotReporting:!0,rbac:!0,valueEditing:!0,ruleGroups:!0,expandOnFilter:!1},I={black300:"#D2D2D2",black200:"#F0F0F0",blue200:"#73BCF7",blue300:"#2B9AF3",blue400:"#0066CC",gold300:"#F4C145"},R={light300:"#f0f0f0"}},30319:(e,t,n)=>{"use strict";n.d(t,{S1:()=>u,bh:()=>p});var r,o=n(42982),i=n(67336),l=n(83215),a=n(57283),c=n.n(a),s=n(30496);function u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=(0,i.JH)({},[c()].concat((0,o.Z)(t.filter((function(e){return void 0!==e})))))).register({form:s.Z,notifications:l.ee}),r}function p(){return r.getStore()}},45467:()=>{},65088:()=>{},11452:()=>{},34946:()=>{},32857:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},37739:()=>{},66822:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},49854:()=>{},87234:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/30.56817a4698459e97f16c7d216fc0c001.js.map