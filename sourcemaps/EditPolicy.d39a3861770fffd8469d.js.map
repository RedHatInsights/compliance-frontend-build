{"version":3,"sources":["webpack:///./src/SmartComponents/ComplianceSystems/ComplianceSystems.js","webpack:///./src/SmartComponents/CreatePolicy/CreateSCAPPolicy.js","webpack:///./src/SmartComponents/CreatePolicy/EditPolicyProfilesRules.js","webpack:///./src/SmartComponents/CreatePolicy/EditPolicySystems.js","webpack:///./src/SmartComponents/CreatePolicy/EditPolicyDetails.js","webpack:///./src/SmartComponents/CreatePolicy/ReviewCreatedPolicy.js","webpack:///./src/SmartComponents/CreatePolicy/FinishedCreatePolicy.js","webpack:///./src/SmartComponents/CreatePolicy/CreatePolicy.js","webpack:///./src/SmartComponents/EditPolicy/EditPolicyDetailsTab.js","webpack:///./src/SmartComponents/EditPolicy/EditPolicyRulesTab.js","webpack:///./src/SmartComponents/EditPolicy/EditPolicySystemsTab.js","webpack:///./src/SmartComponents/EditPolicy/EditPolicyForm.js","webpack:///./src/SmartComponents/EditPolicy/EditPolicy.js","webpack:///./src/SmartComponents/EditPolicy/usePolicy.js","webpack:///./src/SmartComponents/SystemsTable/constants.js","webpack:///./src/SmartComponents/InventoryDetails/InventoryDetails.js","webpack:///./src/Utilities/Export.js","webpack:///./src/Utilities/hooks/api/utils/ApiClient.js","webpack:///./src/Utilities/hooks/api/useApi.js","webpack:///./src/Utilities/hooks/api/useCollection.js","webpack:///./src/SmartComponents/SystemsTable/hooks.js","webpack:///./src/SmartComponents/SystemsTable/InventoryTable.js","webpack:///./src/Utilities/ruleHelpers.js","webpack:///./src/store/ActionTypes.js","webpack:///./src/store/Reducers/SystemStore.js"],"names":["QUERY","gql","ComplianceSystems","useQuery","data","error","loading","dispatch","useDispatch","columns","key","title","props","width","isStatic","renderFunc","systemName","policyNames","policiesCell","id","detailsLink","testResultProfiles","policies","profiles","edges","map","node","useLayoutEffect","type","payload","ids","className","stateValues","stateKey","query","GET_SYSTEMS","defaultFilter","systemProps","isFullView","showOsFilter","showComplianceSystemsInfo","enableEditPolicy","remediationsEnabled","BENCHMARKS_AND_PROFILES","PolicyTooltip","Tooltip","position","content","style","opacity","CreateSCAPPolicy","change","selectedBenchmarkId","fetchPolicy","Spinner","selectedBenchmark","validProfiles","benchmark","benchmarks","latestBenchmarks","find","userProfileRefIds","filter","profile","refId","disabled","includes","TextContent","Text","component","TextVariants","Form","FormGroup","label","isRequired","fieldId","sort","a","b","localeCompare","osMajorVersion","Tile","onClick","setBenchmark","isSelected","isStacked","labelIcon","propTypes","reduxFormPropTypes","selector","formValueSelector","compose","connect","state","reduxForm","form","destroyOnUnmount","forceUnregisterOnUnmount","PROFILES_QUERY","BENCHMARKS_QUERY","EditPolicyProfilesRules","policy","selectedRuleRefIds","osMinorVersionCounts","selectRulesTableColumns","osMinorVersions","i","osMinorVersion","benchmarkSearch","join","variables","skip","length","benchmarksData","benchmarksError","benchmarksLoading","nodes","profileIds","tabsData","profileSelectedRuleRefIds","systemCount","count","latestSupportedOsMinorVersions","getBenchmarkBySupportedOsMinor","profileRefId","benchmarkProfile","getBenchmarkProfile","push","newOsMinorVersion","ruleRefIds","skipProfilesQuery","profilesData","profilesError","profilesLoading","dataState","undefined","loadingState","noRuleSets","p","rules","rule","name","EmptyState","Title","headingLevel","size","EmptyStateBody","EmptyTable","selectedFilter","level","handleSelect","newSelectedRuleRefIds","newSelection","JSON","parse","WizardContextConsumer","goToStepById","Button","PrependComponent","EditPolicySystems","selectedSystemIds","useEffect","showOsMinorVersionFilter","prependComponent","emptyStateComponent","displayName","_id","compact","showActions","GET_SYSTEMS_WITHOUT_FAILED_RULES","enableExport","defaultProps","countOsMinorVersions","entities","selectedEntities","e","EditPolicyDetails","description","Field","ReduxFormTextInput","aria-describedby","isDisabled","ReduxFormTextArea","defaultValue","businessObjective","showTitle","previousThreshold","complianceThreshold","initialValues","REVIEW","ReviewCreatedPolicy","benchmarkId","parentProfileName","marginTop","TextList","TextListVariants","TextListItem","TextListItemVariants","parseFloat","rulesCount","EmtpyStateWithErrors","errors","Array","isArray","List","ListItem","FinishedCreatePolicy","onWizardFinish","cloneFromProfileId","systemIds","useState","percent","setPercent","message","setMessage","setErrors","failed","setFailed","updatePolicy","usePolicy","onProgress","progress","newPolicy","hosts","then","catch","networkError","result","Bullseye","variant","EmptyStateVariant","EmptyStateIcon","icon","WrenchIcon","EmptyStateSecondaryActions","withApollo","CreatePolicy","history","useHistory","stepIdReached","setStepIdReached","resetAnchor","location","hash","onClose","steps","enableNext","validateBenchmarkPage","canJumpTo","validateDetailsPage","validateSystemsPage","validateRulesPage","nextButtonText","isFinishedStep","Wizard","isOpen","onNext","onGoToStep","onBack","EditPolicyDetailsTab","setUpdatedPolicy","validThreshold","setValidThreshold","threshold","valid","thresholdValid","useThresholdValidate","validateThreshold","TextArea","height","onChange","value","TextInput","validated","helperTextInvalid","helperText","complianceThresholdValid","EditPolicyRulesTabEmptyState","EditPolicyRulesTab","Object","keys","values","sortingByProp","parentProfileId","toTabsData","tab","forEach","refIds","empty","EditPolicySystemsTab","policyOsMinorVersions","selectedSystemOsMinorVersions","useSelector","entity","systemOsMinorVersion","Alert","isInline","actionLinks","AlertActionLink","profilesToOsMinorMap","reduce","acc","mapCountOsMinorVersions","EditPolicyForm","updatedPolicy","policyProfiles","setSelectedRuleRefIds","setOsMinorVersionCounts","updateSelectedRuleRefIds","policyProfile","defaultTab","Tab","eventKey","TabTitleText","filteredSelection","selectedProfile","uniq","MULTIVERSION_QUERY","EditPolicy","route","policyId","useParams","policy_id","anchor","useAnchor","linkToBackground","useLinkToBackground","isSaving","setIsSaving","saveEnabled","linkToBackgroundWithHash","actions","spinnerAriaValueText","isLoading","useTitleEntity","Modal","create","createBusinessObjective","useMutation","CREATE_BUSINESS_OBJECTIVE","newBusinessObjective","input","UPDATE_PROFILE","updateProfile","CREATE_PROFILE","createProfile","associateSystems","ASSOCIATE_SYSTEMS_TO_PROFILES","h","useAssociateSystems","associateRules","ASSOCIATE_RULES_TO_PROFILE","ruleInput","useAssociateRules","expectedUpdates","dispatchProgress","businessObjectiveId","policyInput","policyFilter","osFilter","systemsPolicyFilterConfiguration","systemsOsFilterConfiguration","osMinorVersionFilter","systemsOsMinorFilterConfiguration","InventoryDetails","registryDecorator","DetailWrapper","onLoad","mergeWithDetail","getRegistry","register","InventoryDetail","fallback","Skeleton","SkeletonSize","hideBack","React","getNestedObject","nestedObj","path","split","obj","textCsvCell","row","cell","exportValue","options","Accept","this","apiBase","authenticate","Promise","resolve","onUnauthorised","defaultHeaders","headers","DEFAULT_API_HEADERS","apiProps","method","callAuthenticate","fetch","checkForEmptyResponse","response","checkForErrors","json","finalCatch","promise","reject","params","credentials","fullPath","url","URL","window","origin","encodeURIComponent","search","URLSearchParams","body","stringify","status","ignore404","responseCloneJson","clone","request","ApiClient","includeAttributes","prop","attributes","newEntity","includePropAndDelete","normalizeData","jsonNormalized","normalize","normalizedJson","relationships","entries","item","relationship","relationshipData","v","includeRelationship","fetchCollection","apiClient","collection","get","normalized","meta","total","useOsMinorVersionFilter","showFilter","supportedSsgs","dependencies","collectionState","setCollectionState","useApi","COMPLIANCE_API_ROOT","include","useCollection","showVersion","version","String","currentValue","Set","groupByMajorVersion","InventoryTable","showAllSystems","client","compliantFilter","showOnlySystemsWithTestResults","store","useStore","inventory","useRef","perPage","page","pagination","setPagination","isLoaded","setIsLoaded","isEmpty","setIsEmpty","useFilterConfig","DEFAULT_SYSTEMS_FILTER_CONFIGURATION","COMPLIANT_SYSTEMS_FILTER_CONFIGURATION","conditionalFilter","activeFilters","buildFilterString","systemsCount","items","systems","system","shallowEqual","fetchSystems","filterString","combindedFilter","fetchResults","totalCount","debounceFetchSystems","useCallback","debounce","activeFiltersConfig","filters","noError","INVENTORY_ACTION_TYPES","mergeWithEntities","systemsReducer","SkeletonTable","colSize","rowSize","tableProps","canSelectAll","TableVariant","ref","onRefresh","callback","per_page","current","onRefreshData","bulkSelect","checked","every","selected","onSelect","selectAll","clearSelection","dedicatedAction","ComplianceRemediationButton","allSystems","systemsWithRuleObjectsFailed","selectedRules","exportConfig","_","format","rows","csvRows","column","concat","noExport","encodeURI","csvFromState","object","jsonFromState","filename","link","document","createElement","setAttribute","dispatchEvent","MouseEvent","bubbles","cancelable","view","linkAndDownload","CSV_FILE_PREFIX","Date","toISOString","exportFromState","getState","_event","_index","beta","pathname","href","PropTypes","profilesRulesFailed","flatMap","compliant","profilesRulesPassed","systemRulesFailed","ruleObjectsFailed","SELECT_ENTITY","NEVER","lines","Link","to","matchingSystem","systemsToRows","scoreTotal","numScored","dates","last","rulesPassed","rulesFailed","lastScanned","Math","max","apply","date","isFinite","display_name","score","supported","ssgVersion","selectRowsByIds","rowsToSelect","deselectRowsByIds","INVENTORY_ACTION","applyReducerHash","loaded","LOAD_ENTITIES_PENDING","LOAD_ENTITIES_FULFILLED","newState","clearAll","selectAllRows","deselectAllRows","selectRow","deselectRow"],"mappings":"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","file":"js/EditPolicy.5e83621738d56b6fb398.js","sourcesContent":["/* eslint-disable react/display-name */\nimport React, { useLayoutEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/client';\nimport PageHeader, { PageHeaderTitle } from '@redhat-cloud-services/frontend-components/PageHeader';\nimport Main from '@redhat-cloud-services/frontend-components/Main';\nimport { StateViewPart, StateViewWithError } from 'PresentationalComponents';\nimport { InventoryTable } from 'SmartComponents';\nimport { GET_SYSTEMS } from '../SystemsTable/constants';\nimport { systemName, detailsLink, policiesCell } from 'Store/Reducers/SystemStore';\n\nconst QUERY = gql`\n{\n    profiles(search: \"external = false and canonical = false\") {\n        edges {\n            node {\n                id\n                name\n                refId\n                majorOsVersion\n            }\n        }\n    }\n}\n`;\n\nconst DEFAULT_FILTER = 'has_test_results = true or has_policy = true';\n\nexport const ComplianceSystems = () => {\n    const { data, error, loading } = useQuery(QUERY);\n    const dispatch = useDispatch();\n    const columns = [{\n        key: 'display_name',\n        title: 'Name',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: systemName\n    }, {\n        key: 'policyNames',\n        title: 'Policies',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: (policyNames) => {\n            const { title } = policiesCell({ policyNames }) || { title: '' };\n            return title;\n        }\n    }, {\n        key: 'testResultProfiles',\n        title: '',\n        props: {\n            width: 20, isStatic: true\n        },\n        renderFunc: (data, id) => {\n            const { title } = detailsLink({ testResultProfiles: data, id }) || { title: '' };\n            return title;\n        }\n    }];\n    const policies = data?.profiles?.edges.map(({ node }) => node);\n\n    useLayoutEffect(() => { dispatch({ type: 'SELECT_ENTITIES', payload: { ids: [] } }); }, []);\n\n    return (\n        <React.Fragment>\n            <PageHeader className='page-header'>\n                <PageHeaderTitle title=\"Systems\" />\n            </PageHeader>\n            <Main>\n                <StateViewWithError stateValues={ { error, data, loading } }>\n                    <StateViewPart stateKey=\"data\">\n                        { policies && <InventoryTable\n                            query={GET_SYSTEMS}\n                            defaultFilter={ DEFAULT_FILTER }\n                            systemProps={{\n                                isFullView: true\n                            }}\n                            showOsFilter\n                            showComplianceSystemsInfo\n                            enableEditPolicy={ false }\n                            remediationsEnabled={ false }\n                            columns={ columns }\n                            policies={ policies } /> }\n                    </StateViewPart>\n                </StateViewWithError>\n            </Main>\n        </React.Fragment>\n    );\n};\n\nexport default ComplianceSystems;\n","import React from 'react';\nimport { OutlinedQuestionCircleIcon } from '@patternfly/react-icons';\nimport {\n    Form,\n    FormGroup,\n    Text,\n    TextContent,\n    TextVariants,\n    Tile,\n    Tooltip\n} from '@patternfly/react-core';\nimport { ProfileTypeSelect } from 'PresentationalComponents';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/client';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport { propTypes as reduxFormPropTypes, formValueSelector, reduxForm } from 'redux-form';\nimport { connect, useDispatch } from 'react-redux';\nimport { compose } from 'redux';\nimport propTypes from 'prop-types';\n\nconst BENCHMARKS_AND_PROFILES = gql`\nquery benchmarksAndProfiles {\n    latestBenchmarks {\n        id\n        title\n        refId\n        version\n        osMajorVersion\n        profiles {\n            id\n            name\n            refId\n            description\n            complianceThreshold\n        }\n    }\n    profiles(search: \"external = false and canonical = false\") {\n        edges {\n            node {\n                id\n                refId\n                benchmark {\n                    refId\n                }\n            }\n        }\n    }\n}\n`;\n\nconst PolicyTooltip = () => (\n    <Tooltip\n        position=\"right\"\n        content=\"Policy types are OpenSCAP policies that are supported by RHEL.\n        For each major version of RHEL, users can create one policy of each type.\">\n        <OutlinedQuestionCircleIcon style={{ opacity: 0.5 }}/>\n    </Tooltip>\n);\n\nexport const CreateSCAPPolicy = ({ change, selectedBenchmarkId }) => {\n    const { data, error, loading } = useQuery(BENCHMARKS_AND_PROFILES, { fetchPolicy: 'no-cache' });\n\n    const inUseProfileRefIds = (profiles, benchmark) => (\n        profiles.filter(profile => benchmark.refId === profile.node.benchmark.refId).map(profile => profile.node.refId)\n    );\n\n    const dispatch = useDispatch();\n\n    if (error) { return error; }\n\n    if (loading) { return <Spinner/>; }\n\n    const benchmarks = data.latestBenchmarks;\n    let selectedBenchmark;\n    let validProfiles;\n    if (selectedBenchmarkId) {\n        selectedBenchmark = benchmarks.find(benchmark => benchmark.id === selectedBenchmarkId);\n        const userProfileRefIds = inUseProfileRefIds(data.profiles.edges, selectedBenchmark);\n        validProfiles = selectedBenchmark.profiles.map((profile) => ({\n            ...profile,\n            disabled: userProfileRefIds.includes(profile.refId)\n        }));\n    }\n\n    const setBenchmark = ({ id, osMajorVersion }) => {\n        if (selectedBenchmark?.osMajorVersion !== osMajorVersion) {\n            change('systems', []);\n            dispatch({\n                type: 'SELECT_ENTITIES',\n                payload: { ids: [] }\n            });\n        }\n\n        change('benchmark', id);\n        change('osMajorVersion', osMajorVersion);\n    };\n\n    return (\n        <React.Fragment>\n            <TextContent>\n                <Text component={TextVariants.h1} className=\"pf-u-mb-md\">\n                    Create SCAP policy\n                </Text>\n                <Text className=\"pf-u-mb-md\">\n                    Select the operating system and policy type for this policy.\n                </Text>\n            </TextContent>\n            <Form>\n                <FormGroup\n                    label=\"Operating system\"\n                    isRequired\n                    fieldId=\"benchmark\">\n                    { benchmarks && benchmarks.sort((a, b) => a.refId.localeCompare(b.refId)).map((benchmark) => {\n                        const { id, osMajorVersion } = benchmark;\n                        return (\n                            <Tile\n                                key={id}\n                                className=\"pf-u-mr-md\"\n                                title={ `RHEL ${osMajorVersion}` }\n                                onClick={ () => setBenchmark(benchmark) }\n                                isSelected={ selectedBenchmarkId === id }\n                                isStacked />\n                        );\n                    })}\n                </FormGroup>\n                <FormGroup\n                    isRequired\n                    labelIcon={<PolicyTooltip/>}\n                    label=\"Policy type\"\n                    fieldId=\"policy-type\">\n                    <ProfileTypeSelect\n                        profiles={selectedBenchmark && validProfiles }\n                        onClick={ () => {\n                            change('selectedRuleRefIds', null);\n                        }}/>\n                </FormGroup>\n            </Form>\n        </React.Fragment>\n    );\n};\n\nCreateSCAPPolicy.propTypes = {\n    selectedBenchmarkId: propTypes.string,\n    change: reduxFormPropTypes.change\n};\n\nconst selector = formValueSelector('policyForm');\n\nexport default compose(\n    connect(\n        state => ({\n            selectedBenchmarkId: selector(state, 'benchmark')\n        })\n    ),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(CreateSCAPPolicy);\n","import React, { useLayoutEffect } from 'react';\nimport { propTypes as reduxFormPropTypes, formValueSelector, reduxForm } from 'redux-form';\nimport {\n    selectColumns as selectRulesTableColumns\n} from '@redhat-cloud-services/frontend-components-inventory-compliance/SystemRulesTable';\nimport EmptyTable from '@redhat-cloud-services/frontend-components/EmptyTable';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport {\n    Title, Text, TextContent, TextVariants,\n    EmptyState, EmptyStateBody\n} from '@patternfly/react-core';\nimport gql from 'graphql-tag';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport propTypes from 'prop-types';\nimport { useQuery } from '@apollo/client';\nimport { StateViewWithError, StateViewPart, TabbedRules } from 'PresentationalComponents';\n\nconst PROFILES_QUERY = gql`\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n`;\n\nconst BENCHMARKS_QUERY = gql`\nquery Benchmarks($filter: String!){\n    benchmarks(search: $filter){\n        nodes {\n            id\n            latestSupportedOsMinorVersions\n            profiles {\n                id\n                refId\n                osMajorVersion\n            }\n        }\n    }\n}\n`;\n\nconst getBenchmarkProfile = (benchmark, profileRefId) => (\n    benchmark.profiles.find((benchmarkProfile) => (benchmarkProfile.refId === profileRefId))\n);\n\nconst getBenchmarkBySupportedOsMinor = (benchmarks, osMinorVersion) => (\n    benchmarks.find((benchmark) =>\n        benchmark.latestSupportedOsMinorVersions?.includes(osMinorVersion)\n    )\n);\n\nexport const EditPolicyProfilesRules = ({ policy, selectedRuleRefIds, change, osMajorVersion, osMinorVersionCounts }) => {\n    const columns = selectRulesTableColumns(['Name', 'Severity', 'Ansible']);\n    const osMinorVersions = osMinorVersionCounts.map((i) => (i.osMinorVersion)).sort();\n    const benchmarkSearch = `os_major_version = ${ osMajorVersion } ` +\n        `and latest_supported_os_minor_version ^ \"${ osMinorVersions.join(',') }\"`;\n\n    const handleSelectCallback = (profile, newSelectedRuleRefIds) => {\n        const newSelection = selectedRuleRefIds.map((profileSelectedRuleRefIds) => {\n            if (profileSelectedRuleRefIds.id === profile.id) {\n                return {\n                    id: profileSelectedRuleRefIds.id,\n                    ruleRefIds: newSelectedRuleRefIds\n                };\n            } else {\n                return profileSelectedRuleRefIds;\n            }\n        });\n\n        change('selectedRuleRefIds', newSelection);\n    };\n\n    const {\n        data: benchmarksData,\n        error: benchmarksError,\n        loading: benchmarksLoading\n    } = useQuery(BENCHMARKS_QUERY, {\n        variables: {\n            filter: benchmarkSearch\n        },\n        skip: osMinorVersions.length === 0\n    });\n\n    const benchmarks = benchmarksData?.benchmarks?.nodes;\n\n    let profileIds = [];\n    let tabsData = osMinorVersionCounts.map(({ osMinorVersion, count: systemCount }) => {\n        osMinorVersion = `${osMinorVersion}`;\n        let profile;\n        let profileSelectedRuleRefIds;\n        if (benchmarks) {\n            const benchmark = getBenchmarkBySupportedOsMinor(benchmarks, osMinorVersion);\n            if (benchmark) {\n                profile = getBenchmarkProfile(benchmark, policy.refId);\n                if (profile) {\n                    profile = {\n                        ...profile,\n                        benchmark\n                    };\n                    profileSelectedRuleRefIds = selectedRuleRefIds?.find(({ id }) => id === profile.id);\n                    profileIds.push(profile.id);\n                }\n            }\n        }\n\n        return {\n            profile,\n            systemCount,\n            newOsMinorVersion: osMinorVersion,\n            selectedRuleRefIds: profileSelectedRuleRefIds?.ruleRefIds\n        };\n    });\n    tabsData = tabsData.filter(({ profile }) => !!profile);\n\n    const filter = `${ (profileIds || []).map((i) => (`id = ${ i }`)).join(' OR ') }`;\n    const skipProfilesQuery = benchmarksLoading || filter.length === 0;\n    const { data: profilesData, error: profilesError, loading: profilesLoading } = useQuery(PROFILES_QUERY, {\n        variables: {\n            filter\n        },\n        skip: skipProfilesQuery\n    });\n    const error = benchmarksError || profilesError;\n    const dataState = ((profileIds?.length > 0) ? profilesData : undefined);\n    const loadingState = ((profilesLoading || benchmarksLoading) ? true : undefined);\n    const noRuleSets = !error && !loadingState && profileIds?.length === 0;\n    const profiles = skipProfilesQuery ? [] : profilesData?.profiles.edges.map((p) => (p.node));\n\n    useLayoutEffect(() => {\n        if (!loadingState) {\n            change('selectedRuleRefIds', profiles.map((profile) => ({\n                id: profile.id,\n                ruleRefIds: selectedRuleRefIds?.find(({ id }) => id === profile.id)?.ruleRefIds ||\n                            profile.rules.map((rule) => (rule.refId))\n            })));\n        }\n    }, [profiles, loadingState]);\n\n    return <React.Fragment>\n        <TextContent className='pf-u-pb-md'>\n            <Text component={TextVariants.h1}>\n                Rules\n            </Text>\n            <Text>\n                Customize your <b>{ policy.name }</b> SCAP policy by including and excluding rules.\n            </Text>\n            <Text>\n                Each release of RHEL is supported with a unique and specific version of the SCAP Security\n                Guide (SSG). You must customize each version of SSG for each release of RHEL.\n            </Text>\n        </TextContent>\n\n        <StateViewWithError stateValues={ { error, data: dataState, loading: loadingState, noRuleSets } }>\n            <StateViewPart stateKey=\"noRuleSets\">\n                <EmptyState>\n                    <Title headingLevel=\"h1\" size=\"xl\">\n                        No rules can be configured\n                    </Title>\n                    <EmptyStateBody>\n                        The policy type selected does not exist for the systems and\n                        OS versions selected in the previous steps.\n                    </EmptyStateBody>\n                </EmptyState>\n            </StateViewPart>\n            <StateViewPart stateKey=\"loading\">\n                <EmptyTable><Spinner/></EmptyTable>\n            </StateViewPart>\n            <StateViewPart stateKey=\"data\">\n                <TabbedRules\n                    tabsData={ tabsData }\n                    columns={ columns }\n                    remediationsEnabled={ false }\n                    selectedFilter\n                    level={ 1 }\n                    handleSelect={ handleSelectCallback } />\n            </StateViewPart>\n        </StateViewWithError>\n    </React.Fragment>;\n};\n\nEditPolicyProfilesRules.propTypes = {\n    policy: propTypes.object,\n    change: reduxFormPropTypes.change,\n    osMajorVersion: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    })),\n    selectedRuleRefIds: propTypes.array\n};\n\nconst selector = formValueSelector('policyForm');\n\nexport default compose(\n    connect(\n        state => ({\n            policy: JSON.parse(selector(state, 'profile')),\n            osMajorVersion: selector(state, 'osMajorVersion'),\n            osMinorVersionCounts: selector(state, 'osMinorVersionCounts'),\n            selectedRuleRefIds: selector(state, 'selectedRuleRefIds')\n        })\n    ),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(EditPolicyProfilesRules);\n","import React, { useEffect } from 'react';\nimport { propTypes as reduxFormPropTypes, reduxForm, formValueSelector } from 'redux-form';\nimport { Button, Form, FormGroup, Text, TextContent, TextVariants, WizardContextConsumer } from '@patternfly/react-core';\nimport { InventoryTable } from 'SmartComponents';\nimport { GET_SYSTEMS_WITHOUT_FAILED_RULES } from '../SystemsTable/constants';\nimport { compose } from 'redux';\nimport propTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { countOsMinorVersions } from 'Store/Reducers/SystemStore';\n\nconst EmptyState = ({ osMajorVersion }) => (\n    <React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                You do not have any <b>RHEL { osMajorVersion }</b> systems connected to Insights and enabled for Compliance.<br/>\n                Policies must be created with at least one system.\n            </Text>\n        </TextContent>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Choose a different operating system, or connect <b>RHEL { osMajorVersion }</b> systems to Insights.\n            </Text>\n        </TextContent>\n        <WizardContextConsumer>\n            { ({ goToStepById }) => <Button onClick={() => goToStepById(1)}>Choose a different operating system</Button> }\n        </WizardContextConsumer>\n    </React.Fragment>\n);\n\nEmptyState.propTypes = {\n    osMajorVersion: propTypes.number\n};\n\nconst PrependComponent = ({ osMajorVersion }) => (\n    <React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Select which of your <b>RHEL { osMajorVersion }</b> systems should be included\n                in this policy.<br />\n                Systems can be added or removed at any time.\n            </Text>\n        </TextContent>\n    </React.Fragment>\n);\n\nPrependComponent.propTypes = {\n    osMajorVersion: propTypes.number\n};\n\nconst EditPolicySystems = ({ change, osMajorVersion, osMinorVersionCounts, selectedSystemIds }) => {\n    const columns = [{\n        key: 'display_name',\n        title: 'Name',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: (displayName, _id, { name }) => (displayName || name)\n    }, {\n        key: 'osMinorVersion',\n        title: 'Operating system',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: (osMinorVersion, _id, { osMajorVersion }) => `RHEL ${osMajorVersion}.${osMinorVersion}`\n    }];\n\n    useEffect(() => {\n        if (selectedSystemIds) {\n            change('systems', selectedSystemIds);\n        }\n\n        if (osMinorVersionCounts) {\n            change('osMinorVersionCounts', osMinorVersionCounts);\n        }\n    }, [selectedSystemIds, osMinorVersionCounts, change]);\n\n    return (\n        <React.Fragment>\n            <TextContent className=\"pf-u-mb-md\">\n                <Text component={TextVariants.h1}>\n                    Systems\n                </Text>\n            </TextContent>\n            <Form>\n                <FormGroup>\n                    <InventoryTable\n                        showOsMinorVersionFilter={ [osMajorVersion] }\n                        prependComponent={ <PrependComponent osMajorVersion={ osMajorVersion } /> }\n                        emptyStateComponent={ <EmptyState osMajorVersion={ osMajorVersion } /> }\n                        columns={columns}\n                        remediationsEnabled={false}\n                        compact\n                        showActions={ false }\n                        query={ GET_SYSTEMS_WITHOUT_FAILED_RULES }\n                        defaultFilter={ osMajorVersion && `os_major_version = ${osMajorVersion}` }\n                        enableExport={ false }/>\n                </FormGroup>\n            </Form>\n        </React.Fragment>\n    );\n};\n\nEditPolicySystems.propTypes = {\n    osMajorVersion: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    })),\n    selectedSystemIds: propTypes.array,\n    change: reduxFormPropTypes.change\n};\n\nEditPolicySystems.defaultProps = {\n    selectedSystemIds: [],\n    osMinorVersionCounts: []\n};\n\nconst selector = formValueSelector('policyForm');\nconst mapStateToProps = (state) => ({\n    osMajorVersion: selector(state, 'osMajorVersion'),\n    osMinorVersionCounts: countOsMinorVersions(state.entities?.selectedEntities),\n    selectedSystemIds: (state.entities?.selectedEntities || []).map((e) => (e.id))\n});\n\nexport default compose(\n    connect(mapStateToProps),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(EditPolicySystems);\n","import React, { useEffect } from 'react';\nimport { compose } from 'redux';\nimport { Field, reduxForm, formValueSelector, propTypes as reduxFormPropTypes } from 'redux-form';\nimport { connect } from 'react-redux';\nimport propTypes from 'prop-types';\nimport { Form, FormGroup, Text, TextContent, TextVariants } from '@patternfly/react-core';\nimport { ReduxFormTextInput, ReduxFormTextArea } from 'PresentationalComponents/ReduxFormWrappers/ReduxFormWrappers';\nimport { ProfileThresholdField } from 'PresentationalComponents';\n\nexport const EditPolicyDetails = ({ change, policy, refId }) => {\n\n    useEffect(() => {\n        if (policy && policy.refId !== refId) {\n            change('name', `${policy.name}`);\n            change('refId', `${policy.refId}`);\n            change('description', `${policy.description}`);\n        }\n    }, [policy]);\n\n    return (\n        <React.Fragment>\n            <TextContent>\n                <Text component={TextVariants.h1}>\n                    Details\n                </Text>\n            </TextContent>\n            <br/>\n            <Form id='editpolicydetails'>\n                <FormGroup label=\"Policy name\" isRequired fieldId=\"name\">\n                    <Field\n                        component={ReduxFormTextInput}\n                        type='text'\n                        isRequired={true}\n                        id=\"name\"\n                        name=\"name\"\n                        aria-describedby=\"name\" />\n                </FormGroup>\n                <FormGroup label=\"Reference ID\" isRequired fieldId=\"refId\">\n                    <Field\n                        type=\"text\"\n                        component={ReduxFormTextInput}\n                        isDisabled\n                        id=\"refId\"\n                        name=\"refId\"\n                        aria-describedby=\"refId\" />\n                </FormGroup>\n                <FormGroup label=\"Description\" fieldId=\"description\">\n                    <Field\n                        type=\"text\"\n                        component={ReduxFormTextArea}\n                        id=\"description\"\n                        name=\"description\"\n                        aria-describedby=\"description\" />\n                </FormGroup>\n                <FormGroup label=\"Business objective\" fieldId=\"businessObjective\">\n                    <Field\n                        type=\"text\"\n                        component={ ReduxFormTextInput }\n                        id=\"businessObjective\"\n                        name=\"businessObjective\"\n                        aria-describedby=\"businessObjective\"\n                        defaultValue={ policy.businessObjective } />\n                </FormGroup>\n                <ProfileThresholdField\n                    showTitle={ false }\n                    previousThreshold={ policy.complianceThreshold } />\n            </Form>\n        </React.Fragment>\n    );\n};\n\nconst selector = formValueSelector('policyForm');\n\nEditPolicyDetails.propTypes = {\n    policy: propTypes.object,\n    refId: propTypes.string,\n    change: reduxFormPropTypes.change\n};\n\nconst mapStateToProps = (state) => {\n    const policy = JSON.parse(selector(state, 'profile'));\n    return {\n        policy,\n        refId: selector(state, 'refId'),\n        initialValues: {\n            name: `${policy.name}`,\n            refId: `${policy.refId}`,\n            description: `${policy.description}`,\n            benchmark: selector(state, 'benchmark'),\n            osMajorVersion: selector(state, 'osMajorVersion'),\n            profile: selector(state, 'profile')\n        }\n    };\n};\n\nexport default compose(\n    connect(mapStateToProps),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: false,\n        forceUnregisterOnUnmount: true\n    })\n)(EditPolicyDetails);\n","import React from 'react';\nimport {\n    Text,\n    TextVariants,\n    TextContent,\n    TextList,\n    TextListVariants,\n    TextListItem,\n    TextListItemVariants\n} from '@patternfly/react-core';\nimport { formValueSelector } from 'redux-form';\nimport { connect } from 'react-redux';\nimport gql from 'graphql-tag';\nimport propTypes from 'prop-types';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport { useQuery } from '@apollo/client';\n\nconst REVIEW = gql`\nquery review($benchmarkId: String!) {\n    benchmark(id: $benchmarkId) {\n        id\n        osMajorVersion\n    }\n}\n`;\n\nconst ReviewCreatedPolicy = ({\n    benchmarkId, name, businessObjective, complianceThreshold, parentProfileName, osMinorVersionCounts\n}) => {\n    const { data, error, loading } = useQuery(REVIEW, { variables: { benchmarkId } });\n\n    if (error) { return error; }\n\n    if (loading) { return <Spinner/>; }\n\n    const { benchmark: { osMajorVersion } } = data;\n\n    return (\n        <TextContent>\n            <Text component={TextVariants.h1}>\n                Review\n            </Text>\n            <Text>\n                Review your SCAP policy before finishing.\n            </Text>\n            <Text component={TextVariants.h3} style={ { marginTop: 0 } }>{ name }</Text>\n            <TextList component={TextListVariants.dl}>\n                <TextListItem component={TextListItemVariants.dt}>Policy type</TextListItem>\n                <TextListItem component={TextListItemVariants.dd}>{ parentProfileName }</TextListItem>\n                <TextListItem component={TextListItemVariants.dt}>Compliance threshold</TextListItem>\n                <TextListItem component={TextListItemVariants.dd}>{ complianceThreshold }%</TextListItem>\n                { businessObjective &&\n                    <React.Fragment>\n                        <TextListItem component={TextListItemVariants.dt}>Business objective</TextListItem>\n                        <TextListItem component={TextListItemVariants.dd}>{ businessObjective }</TextListItem>\n                    </React.Fragment>\n                }\n                <TextListItem component={TextListItemVariants.dt}>Systems</TextListItem>\n                <TextListItem component={TextListItemVariants.dd}>\n                    <TextList component={TextListVariants.dl}>\n                        { osMinorVersionCounts.map(({ osMinorVersion, count }) => (\n                            <React.Fragment key={osMinorVersion}>\n                                <TextListItem component={TextListItemVariants.dt} style={{ 'font-weight': 'normal' }}>\n                                    RHEL {osMajorVersion}.{osMinorVersion}\n                                </TextListItem>\n                                <TextListItem component={TextListItemVariants.dd}>\n                                    { count } { count > 1 ? 'systems' : 'system' }\n                                </TextListItem>\n                            </React.Fragment>\n                        )) }\n                    </TextList>\n                </TextListItem>\n            </TextList>\n        </TextContent>\n    );\n};\n\nReviewCreatedPolicy.propTypes = {\n    benchmarkId: propTypes.string,\n    refId: propTypes.string,\n    name: propTypes.string,\n    businessObjective: propTypes.string,\n    complianceThreshold: propTypes.number,\n    parentProfileName: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    }))\n};\n\nconst selector = formValueSelector('policyForm');\n\nexport default connect(\n    state => ({\n        benchmarkId: selector(state, 'benchmark'),\n        refId: selector(state, 'refId'),\n        name: selector(state, 'name'),\n        businessObjective: selector(state, 'businessObjective'),\n        osMinorVersionCounts: selector(state, 'osMinorVersionCounts'),\n        complianceThreshold: parseFloat(selector(state, 'complianceThreshold')) || 100.0,\n        parentProfileName: JSON.parse(selector(state, 'profile')).name,\n        rulesCount: selector(state, 'selectedRuleRefIds').length\n    })\n)(ReviewCreatedPolicy);\n","import React, { useState, useEffect } from 'react';\nimport propTypes from 'prop-types';\nimport {\n    Title, Button, Bullseye, EmptyState, EmptyStateBody, EmptyStateSecondaryActions,\n    EmptyStateVariant, EmptyStateIcon, List, ListItem\n} from '@patternfly/react-core';\nimport { ProgressBar } from 'PresentationalComponents';\nimport { WrenchIcon } from '@patternfly/react-icons';\nimport { reduxForm, formValueSelector } from 'redux-form';\nimport { connect } from 'react-redux';\nimport { compose } from 'redux';\nimport { withApollo } from '@apollo/client/react/hoc';\nimport usePolicy from 'SmartComponents/EditPolicy/usePolicy';\n\nconst EmtpyStateWithErrors = ({ errors }) => (\n    (errors && Array.isArray(errors) && errors.length > 0) ? (\n        <EmptyStateBody className='wizard-failed-errors'>\n            <List>\n                {\n                    errors.map((error) => (\n                        <ListItem key={ error }>{ error }</ListItem>\n                    ))\n                }\n            </List>\n        </EmptyStateBody>\n    ) : null\n);\n\nEmtpyStateWithErrors.propTypes = {\n    errors: propTypes.array\n};\n\nexport const FinishedCreatePolicy = ({\n    onWizardFinish,\n    cloneFromProfileId,\n    description,\n    name,\n    complianceThreshold,\n    businessObjective,\n    refId,\n    benchmarkId,\n    systemIds,\n    selectedRuleRefIds\n}) => {\n    const [percent, setPercent] = useState(0);\n    const [message, setMessage] = useState('This usually takes a minute or two.');\n    const [errors, setErrors] = useState(null);\n    const [failed, setFailed] = useState(false);\n    const updatePolicy = usePolicy();\n\n    const onProgress = (progress) => {\n        setPercent(progress * 100);\n    };\n\n    useEffect(() => {\n        const newPolicy = {\n            cloneFromProfileId,\n            description,\n            name,\n            complianceThreshold,\n            businessObjective: { title: businessObjective },\n            refId,\n            benchmarkId,\n            hosts: systemIds.map((id) => ({ id })),\n            selectedRuleRefIds\n        };\n\n        updatePolicy(null, newPolicy, onProgress).then(() => {\n            setPercent(100);\n            setMessage();\n        }).catch((error) => {\n            setMessage(error.networkError?.message);\n            setErrors(error.networkError?.result?.errors);\n            setFailed(true);\n        });\n    }, []);\n\n    return (\n        <Bullseye>\n            <EmptyState variant={EmptyStateVariant.full}>\n                <EmptyStateIcon icon={WrenchIcon} />\n                <br/>\n                <Title headingLevel=\"h1\" size='lg'>\n                    Creating policy\n                </Title>\n                <EmptyStateBody>\n                    <ProgressBar percent={percent} failed={failed} />\n                </EmptyStateBody>\n                <EmptyStateBody className={failed && 'wizard-failed-message'}>\n                    { message }\n                </EmptyStateBody>\n                <EmtpyStateWithErrors error={ errors } />\n                <EmptyStateSecondaryActions>\n                    {\n                        (percent === 100 || failed) &&\n                            <Button\n                                variant={'primary'}\n                                onClick={() => { onWizardFinish(); }}>\n                                { failed ? 'Back' : 'Return to application' }\n                            </Button>\n                    }\n                </EmptyStateSecondaryActions>\n            </EmptyState>\n        </Bullseye>\n    );\n};\n\nFinishedCreatePolicy.propTypes = {\n    benchmarkId: propTypes.string.isRequired,\n    businessObjective: propTypes.object,\n    cloneFromProfileId: propTypes.string.isRequired,\n    refId: propTypes.string.isRequired,\n    name: propTypes.string.isRequired,\n    description: propTypes.string,\n    systemIds: propTypes.array,\n    complianceThreshold: propTypes.number,\n    onWizardFinish: propTypes.func,\n    selectedRuleRefIds: propTypes.arrayOf(propTypes.string).isRequired\n};\n\nexport const selector = formValueSelector('policyForm');\n\nexport default compose(\n    connect(\n        state => ({\n            benchmarkId: selector(state, 'benchmark'),\n            businessObjective: selector(state, 'businessObjective'),\n            cloneFromProfileId: JSON.parse(selector(state, 'profile')).id,\n            refId: selector(state, 'refId'),\n            name: selector(state, 'name'),\n            description: selector(state, 'description'),\n            complianceThreshold: parseFloat(selector(state, 'complianceThreshold')) || 100.0,\n            systemIds: selector(state, 'systems'),\n            selectedRuleRefIds: selector(state, 'selectedRuleRefIds')\n        })\n    ),\n    reduxForm({\n        form: 'policyForm',\n        destroyOnUnmount: true,\n        forceUnregisterOnUnmount: true\n    }),\n    withApollo\n)(FinishedCreatePolicy);\n","import React, { useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { formValueSelector } from 'redux-form';\nimport { connect } from 'react-redux';\nimport propTypes from 'prop-types';\nimport { Wizard } from '@patternfly/react-core';\nimport CreateSCAPPolicy from './CreateSCAPPolicy';\nimport { default as EditPolicyRules } from './EditPolicyProfilesRules';\nimport EditPolicySystems from './EditPolicySystems';\nimport EditPolicyDetails from './EditPolicyDetails';\nimport ReviewCreatedPolicy from './ReviewCreatedPolicy';\nimport FinishedCreatePolicy from './FinishedCreatePolicy';\nimport { validateBenchmarkPage, validateDetailsPage, validateRulesPage, validateSystemsPage } from './validate';\n\nexport const CreatePolicy = ({\n    benchmark, osMajorVersion, complianceThreshold, name, profile, refId, selectedRuleRefIds, systemIds\n}) => {\n    const history = useHistory();\n    const [stepIdReached, setStepIdReached] = useState(1);\n\n    const resetAnchor = () => {\n        const { location } = history;\n        if (location.hash) {\n            history.push({ ...location, hash: '' });\n        }\n    };\n\n    const onNext = ({ id }) => {\n        setStepIdReached(stepIdReached < id ? id : stepIdReached);\n        resetAnchor();\n    };\n\n    const onClose = () => {\n        history.push('/scappolicies');\n    };\n\n    const steps = [\n        {\n            id: 1,\n            name: 'Create SCAP policy',\n            component: <CreateSCAPPolicy/>,\n            enableNext: validateBenchmarkPage(benchmark, osMajorVersion, profile)\n        },\n        {\n            id: 2,\n            name: 'Details',\n            component: <EditPolicyDetails/>,\n            canJumpTo: stepIdReached >= 2,\n            enableNext: validateDetailsPage(name, refId, complianceThreshold)\n        },\n        {\n            id: 3,\n            name: 'Systems',\n            component: <EditPolicySystems/>,\n            canJumpTo: stepIdReached >= 3,\n            enableNext: validateSystemsPage(systemIds)\n        },\n        {\n            id: 4,\n            name: 'Rules',\n            component: <EditPolicyRules/>,\n            canJumpTo: systemIds?.length > 0 && stepIdReached >= 4,\n            enableNext: validateRulesPage(selectedRuleRefIds)\n        },\n        {\n            id: 5,\n            name: 'Review',\n            component: <ReviewCreatedPolicy/>,\n            nextButtonText: 'Finish',\n            canJumpTo: (\n                validateRulesPage(selectedRuleRefIds) &&\n                systemIds?.length > 0 &&\n                stepIdReached >= 5\n            )\n        },\n        {\n            id: 6,\n            name: 'Finished',\n            component: <FinishedCreatePolicy onWizardFinish={ onClose } />,\n            isFinishedStep: true,\n            canJumpTo: systemIds?.length > 0 && stepIdReached >= 6\n        }\n    ];\n\n    return (\n        <React.Fragment>\n            <Wizard\n                isOpen\n                width={ 1220 }\n                onNext={ onNext }\n                onGoToStep={ resetAnchor }\n                onBack={ resetAnchor }\n                onClose={ onClose }\n                title=\"Create SCAP policy\"\n                description=\"Create a new policy for managing SCAP compliance\"\n                steps={ steps } />\n        </React.Fragment>\n    );\n};\n\nCreatePolicy.propTypes = {\n    benchmark: propTypes.string,\n    osMajorVersion: propTypes.string,\n    osMinorVersionCounts: propTypes.arrayOf(propTypes.shape({\n        osMinorVersion: propTypes.number,\n        count: propTypes.number\n    })),\n    complianceThreshold: propTypes.string,\n    businessObjective: propTypes.object,\n    dispatch: propTypes.func,\n    isOpen: propTypes.bool,\n    name: propTypes.string,\n    onWizardFinish: propTypes.func,\n    profile: propTypes.string,\n    refId: propTypes.string,\n    selectedRuleRefIds: propTypes.arrayOf(propTypes.string),\n    systemIds: propTypes.arrayOf(propTypes.string)\n};\n\nCreatePolicy.defaultProps = {\n    isOpen: false\n};\n\nconst selector = formValueSelector('policyForm');\nexport default connect(\n    state => ({\n        benchmark: selector(state, 'benchmark'),\n        osMajorVersion: selector(state, 'osMajorVersion'),\n        osMinorVersionCounts: selector(state, 'osMinorVersionCounts'),\n        businessObjective: selector(state, 'businessObjective'),\n        complianceThreshold: selector(state, 'complianceThreshold') || '100.0',\n        name: selector(state, 'name'),\n        profile: selector(state, 'profile'),\n        refId: selector(state, 'refId'),\n        selectedRuleRefIds: selector(state, 'selectedRuleRefIds'),\n        systemIds: selector(state, 'systems')\n    })\n)(CreatePolicy);\n","import React, { useState } from 'react';\nimport propTypes from 'prop-types';\nimport {\n    FormGroup, TextArea, TextInput\n} from '@patternfly/react-core';\nimport { thresholdValid } from '../CreatePolicy/validate';\n\nexport const useThresholdValidate = () => {\n    const [validThreshold, setValidThreshold] = useState(true);\n    return [validThreshold, (threshold) => {\n        const valid = thresholdValid(threshold);\n        setValidThreshold(valid);\n        return valid;\n    }];\n};\n\nconst EditPolicyDetailsTab = ({ policy, setUpdatedPolicy }) => {\n    const [validThreshold, validateThreshold] = useThresholdValidate();\n\n    return <div className=\"pf-c-form\">\n        <FormGroup label=\"Policy description\" isRequired fieldId=\"description\">\n            <TextArea\n                style={ { width: 800, height: 110 } }\n                isRequired\n                type=\"text\"\n                id=\"description\"\n                name=\"description\"\n                aria-describedby=\"description\"\n                defaultValue={ policy.description }\n                onChange={ (value) => {\n                    setUpdatedPolicy((policy) => ({\n                        ...policy,\n                        description: value\n                    }));\n                }} />\n        </FormGroup>\n\n        <FormGroup label=\"Business objective\" fieldId=\"business-objective\">\n            <TextInput\n                type=\"text\"\n                style={ { width: 300 } }\n                id=\"business-objective\"\n                name=\"business-objective\"\n                aria-describedby=\"business-objective\"\n                defaultValue={ policy?.businessObjective?.title }\n                onChange={ (value) => {\n                    setUpdatedPolicy((policy) =>({\n                        ...policy,\n                        businessObjective: {\n                            ...policy.businessObjective,\n                            title: value\n                        }\n                    }));\n                }} />\n        </FormGroup>\n\n        <FormGroup\n            validated={ validThreshold ? 'default' : 'error' }\n            label='Compliance threshold (%)'\n            fieldId='policy-threshold'\n            helperTextInvalid='Threshold has to be a number between 0 and 100'\n            helperText='A value of 95% or higher is recommended'>\n            <TextInput\n                type='number'\n                style={ { width: 150 } }\n                name='compliance-threshold'\n                id='compliance-threshold'\n                defaultValue={ policy.complianceThreshold }\n                aria-describedby=\"policy-threshold\"\n                onChange={ (value) => {\n                    setUpdatedPolicy((policy) =>({\n                        ...policy,\n                        complianceThreshold: value,\n                        complianceThresholdValid: validateThreshold(value)\n                    }));\n                }} />\n        </FormGroup>\n    </div>;\n};\n\nEditPolicyDetailsTab.propTypes = {\n    policy: propTypes.shape({\n        description: propTypes.string,\n        businessObjective: propTypes.object,\n        complianceThreshold: propTypes.oneOfType([\n            propTypes.string,\n            propTypes.number\n        ])\n    }),\n    setUpdatedPolicy: propTypes.func\n};\n\nexport default EditPolicyDetailsTab;\n","import React, { useLayoutEffect } from 'react';\nimport {\n    EmptyState, EmptyStateBody, Text, TextContent, Title\n} from '@patternfly/react-core';\nimport gql from 'graphql-tag';\nimport propTypes from 'prop-types';\nimport { useQuery } from '@apollo/client';\nimport EmptyTable from '@redhat-cloud-services/frontend-components/EmptyTable';\nimport Spinner from '@redhat-cloud-services/frontend-components/Spinner';\nimport { StateViewWithError, StateViewPart, TabbedRules } from 'PresentationalComponents';\nimport { sortingByProp } from 'Utilities/helpers';\n\nconst PROFILES_QUERY = gql`\nquery Profiles($filter: String!){\n    profiles(search: $filter){\n        edges {\n            node {\n                id\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                policy {\n                    id\n\n                }\n                policyType\n                benchmark {\n                    id\n                    refId\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                ssgVersion\n                rules {\n                    id\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n    }\n}\n`;\n\nconst BENCHMARKS_QUERY = gql`\nquery Benchmarks($filter: String!){\n    benchmarks(search: $filter){\n        nodes {\n            id\n            latestSupportedOsMinorVersions\n            profiles {\n                id\n                refId\n                ssgVersion\n            }\n        }\n    }\n}\n`;\n\nconst getBenchmarkBySupportedOsMinor = (benchmarks, osMinorVersion) => (\n    benchmarks.find((benchmark) =>\n        benchmark.latestSupportedOsMinorVersions?.includes(osMinorVersion)\n    )\n);\n\nconst getBenchmarkProfile = (benchmark, profileRefId) => (\n    benchmark.profiles.find((benchmarkProfile) => (benchmarkProfile.refId === profileRefId))\n);\n\nconst EditPolicyRulesTabEmptyState = () => <EmptyState>\n    <Title headingLevel=\"h5\" size=\"lg\">\n        No rules can be configured\n    </Title>\n    <EmptyStateBody>\n        This policy has no associated systems, and therefore no rules can be configured.\n    </EmptyStateBody>\n    <EmptyStateBody>\n        Add at least one system to configure rules for this policy.\n    </EmptyStateBody>\n</EmptyState>;\n\nexport const toTabsData = (policy, osMinorVersionCounts, benchmarks, selectedRuleRefIds) => (\n    Object.values(osMinorVersionCounts).sort(\n        sortingByProp('osMinorVersion', 'desc')\n    ).map(({ osMinorVersion, count: systemCount }) => {\n        osMinorVersion = `${osMinorVersion}`;\n        let profile = policy.policy.profiles.find((profile) => (profile.osMinorVersion === osMinorVersion));\n        let osMajorVersion = policy.osMajorVersion;\n\n        if (!profile && benchmarks) {\n            const benchmark = getBenchmarkBySupportedOsMinor(benchmarks, osMinorVersion);\n            if (benchmark) {\n                const benchmarkProfile = getBenchmarkProfile(benchmark, policy.refId);\n                if (benchmarkProfile) {\n                    profile = policy.policy.profiles.find((profile) => (profile.parentProfileId === benchmarkProfile.id));\n\n                    profile = {\n                        ...benchmarkProfile,\n                        benchmark,\n                        osMajorVersion,\n                        ...profile\n                    };\n                }\n            }\n        }\n\n        return {\n            profile,\n            systemCount,\n            newOsMinorVersion: osMinorVersion,\n            selectedRuleRefIds: selectedRuleRefIds?.find(({ id }) => id === profile?.id)?.ruleRefIds\n        };\n    }).filter(({ profile, newOsMinorVersion }) => !!profile && newOsMinorVersion)\n);\n\nexport const EditPolicyRulesTab = ({ handleSelect, policy, selectedRuleRefIds, osMinorVersionCounts }) => {\n    const osMajorVersion = policy?.osMajorVersion;\n    const osMinorVersions = Object.keys(osMinorVersionCounts).sort();\n    const benchmarkSearch = `os_major_version = ${ osMajorVersion } ` +\n        `and latest_supported_os_minor_version ^ \"${ osMinorVersions.join(',') }\"`;\n\n    const {\n        data: benchmarksData,\n        error: benchmarksError,\n        loading: benchmarksLoading\n    } = useQuery(BENCHMARKS_QUERY, {\n        variables: {\n            filter: benchmarkSearch\n        },\n        skip: osMinorVersions.length === 0\n    });\n\n    const benchmarks = benchmarksData?.benchmarks?.nodes;\n\n    const tabsData = toTabsData(policy, osMinorVersionCounts, benchmarks, selectedRuleRefIds);\n    const profileIds = tabsData.map((tab) => (tab.profile.id));\n    const filter = `${ (profileIds || []).map((i) => (`id = ${ i }`)).join(' OR ') }`;\n    const {\n        data: profilesData, error: profilesError, loading: profilesLoading\n    } = useQuery(PROFILES_QUERY, {\n        variables: {\n            filter\n        },\n        skip: filter.length === 0\n    });\n    const loadingState = ((profilesLoading || benchmarksLoading) ? true : undefined);\n    const dataState = ((!loadingState && tabsData?.length > 0) ? profilesData : undefined);\n\n    useLayoutEffect(() => {\n        if (profilesData) {\n            const profiles = profilesData?.profiles.edges.map((p) => (p.node)) || [];\n            profiles.forEach((profile) => {\n                const foundSelection = selectedRuleRefIds?.find(({ id }) => id === profile?.id);\n                if (!foundSelection) {\n                    const refIds = profile.rules.map((rule) => (rule.refId));\n                    handleSelect(profile, refIds);\n                }\n            });\n        }\n    }, [profilesData]);\n    const error = benchmarksError || profilesError;\n\n    return <StateViewWithError stateValues={ {\n        error,\n        data: !error && dataState,\n        loading: loadingState,\n        empty: !loadingState && !dataState && !error\n    } }>\n        <StateViewPart stateKey=\"loading\">\n            <EmptyTable><Spinner/></EmptyTable>\n        </StateViewPart>\n        <StateViewPart stateKey=\"data\">\n            <TextContent>\n                <Text>\n                    Different release versions of RHEL are associated with different versions of\n                    the SCAP Security Guide (SSG), therefore each release must be customized independently.\n                </Text>\n            </TextContent>\n            <TabbedRules\n                tabsData={ tabsData }\n                remediationsEnabled={ false }\n                selectedFilter\n                level={ 1 }\n                handleSelect={ handleSelect } />\n        </StateViewPart>\n        <StateViewPart stateKey=\"empty\">\n            <EditPolicyRulesTabEmptyState />\n        </StateViewPart>\n    </StateViewWithError>;\n};\n\nEditPolicyRulesTab.propTypes = {\n    handleSelect: propTypes.func,\n    policy: propTypes.object,\n    osMinorVersionCounts: propTypes.shape({\n        osMinorVersion: propTypes.shape({\n            osMinorVersion: propTypes.number,\n            count: propTypes.number\n        })\n    }),\n    selectedRuleRefIds: propTypes.array\n};\n\nexport default EditPolicyRulesTab;\n","import React from 'react';\nimport { Alert, AlertActionLink, Text, TextContent } from '@patternfly/react-core';\nimport { useSelector } from 'react-redux';\nimport { InventoryTable } from 'SmartComponents';\nimport { GET_SYSTEMS_WITHOUT_FAILED_RULES } from '../SystemsTable/constants';\nimport propTypes from 'prop-types';\nimport { useHistory } from 'react-router-dom';\n\nconst EmptyState = ({ osMajorVersion }) => (\n    <React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                You do not have any <b>RHEL { osMajorVersion }</b> systems connected to Insights and enabled for Compliance.\n            </Text>\n        </TextContent>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Connect RHEL { osMajorVersion } systems to Insights.\n            </Text>\n        </TextContent>\n    </React.Fragment>\n);\n\nEmptyState.propTypes = {\n    osMajorVersion: propTypes.number\n};\n\nconst PrependComponent = ({ osMajorVersion }) => (\n    <React.Fragment>\n        <TextContent className=\"pf-u-mb-md\">\n            <Text>\n                Select which of your <b>RHEL { osMajorVersion }</b> systems should be included\n                in this policy.\n            </Text>\n        </TextContent>\n    </React.Fragment>\n);\n\nPrependComponent.propTypes = {\n    osMajorVersion: propTypes.number\n};\n\nconst EditPolicySystemsTab = ({ osMajorVersion, policyOsMinorVersions }) => {\n    const { push, location } = useHistory();\n    const selectedSystemOsMinorVersions = useSelector(state => (\n        state?.entities?.selectedEntities?.map((entity) => (`${entity.osMinorVersion}`))\n    ));\n\n    const newOsMinorVersions = () => (\n        selectedSystemOsMinorVersions?.find((systemOsMinorVersion) => (\n            !policyOsMinorVersions.includes(systemOsMinorVersion)\n        ))\n    );\n\n    const columns = [{\n        key: 'display_name',\n        title: 'Name',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: (displayName, _id, { name }) => (displayName || name)\n    }, {\n        key: 'osMinorVersion',\n        title: 'Operating system',\n        props: {\n            width: 40, isStatic: true\n        },\n        renderFunc: (osMinorVersion, _id, { osMajorVersion }) => `RHEL ${osMajorVersion}.${osMinorVersion}`\n    }];\n\n    return (\n        <React.Fragment>\n            <InventoryTable\n                showOsMinorVersionFilter={ [osMajorVersion] }\n                prependComponent={ <PrependComponent osMajorVersion={ osMajorVersion } />  }\n                emptyStateComponent={ <EmptyState osMajorVersion={ osMajorVersion } />  }\n                columns={ columns }\n                compact\n                showActions={ false }\n                query={ GET_SYSTEMS_WITHOUT_FAILED_RULES }\n                defaultFilter={ osMajorVersion && `os_major_version = ${osMajorVersion}` }\n                enableExport={ false }\n                remediationsEnabled={ false }\n            />\n            {newOsMinorVersions() && <Alert\n                variant=\"info\"\n                isInline\n                title=\"You selected a system that has a release version previously not included in this policy.\"\n                actionLinks={\n                    <AlertActionLink onClick={ () => push({ ...location, hash: '#rules' }) }>Open rule editing</AlertActionLink>\n                }>\n                <p>If you have edited any rules for this policy, you will need to do so for this release version as well.</p>\n            </Alert>}\n        </React.Fragment>\n    );\n};\n\nEditPolicySystemsTab.propTypes = {\n    osMajorVersion: propTypes.string,\n    policyOsMinorVersions: propTypes.arrayOf(propTypes.number)\n};\n\nexport default EditPolicySystemsTab;\n","import React, { useState, useEffect } from 'react';\nimport propTypes from 'prop-types';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { Form, Tab, TabTitleText } from '@patternfly/react-core';\nimport { RoutedTabs } from 'PresentationalComponents';\nimport { uniq } from 'Utilities/helpers';\nimport EditPolicyDetailsTab from './EditPolicyDetailsTab';\nimport EditPolicyRulesTab from './EditPolicyRulesTab';\nimport EditPolicySystemsTab from './EditPolicySystemsTab';\nimport { mapCountOsMinorVersions } from 'Store/Reducers/SystemStore';\n\nconst profilesToOsMinorMap = (profiles, hosts) => (\n    (profiles || []).reduce((acc, profile) => {\n        if (profile.osMinorVersion !== '') {\n            acc[profile.osMinorVersion] ||= { osMinorVersion: profile.osMinorVersion, count: 0 };\n        }\n\n        return acc;\n    }, mapCountOsMinorVersions(hosts || []))\n);\n\nexport const EditPolicyForm = ({ policy, updatedPolicy, setUpdatedPolicy }) => {\n    const policyProfiles = policy?.policy?.profiles || [];\n    const dispatch = useDispatch();\n    const [selectedRuleRefIds, setSelectedRuleRefIds] = useState([]);\n    const [osMinorVersionCounts, setOsMinorVersionCounts] = useState({});\n    const selectedEntities = useSelector((state) => (state?.entities?.selectedEntities));\n\n    const handleRuleSelect = (profile, newSelectedRuleRefIds) => {\n        const filteredSelection = selectedRuleRefIds.filter((selectedProfile) =>\n            selectedProfile.id !== profile.id\n        );\n        setSelectedRuleRefIds([\n            { id: profile.id, ruleRefIds: newSelectedRuleRefIds },\n            ...filteredSelection\n        ]);\n    };\n\n    const updateSelectedRuleRefIds = () => {\n        if (policy) {\n            setSelectedRuleRefIds(policyProfiles.map((policyProfile) => ({\n                id: policyProfile.id,\n                ruleRefIds: policyProfile.rules.map((rule) => (rule.refId))\n            })));\n        }\n    };\n\n    useEffect(() => {\n        setUpdatedPolicy({\n            ...updatedPolicy,\n            hosts: selectedEntities ? selectedEntities : []\n        });\n        updateSelectedRuleRefIds();\n\n        setOsMinorVersionCounts(\n            profilesToOsMinorMap(policyProfiles, selectedEntities)\n        );\n    }, [selectedEntities]);\n\n    useEffect(() => {\n        if (policy) {\n            const complianceThresholdValid =\n                (policy.complianceThreshold < 101 && policy.complianceThreshold > 0);\n            setUpdatedPolicy({\n                ...policy,\n                complianceThresholdValid\n            });\n            updateSelectedRuleRefIds();\n\n            dispatch({\n                type: 'SELECT_ENTITIES',\n                payload: { ids: policy?.hosts || [] }\n            });\n            setOsMinorVersionCounts(\n                profilesToOsMinorMap(policyProfiles, policy.hosts)\n            );\n        }\n    }, [policy]);\n\n    useEffect(() => setUpdatedPolicy({ ...updatedPolicy, selectedRuleRefIds }), [selectedRuleRefIds]);\n\n    return (\n        <Form>\n            <RoutedTabs defaultTab='details'>\n                <Tab eventKey='details' title={<TabTitleText>Details</TabTitleText>}>\n                    <EditPolicyDetailsTab\n                        policy={ policy }\n                        setUpdatedPolicy={ setUpdatedPolicy } />\n                </Tab>\n\n                <Tab eventKey='rules' title={ <TabTitleText>Rules</TabTitleText> }>\n                    <EditPolicyRulesTab\n                        policy={ policy }\n                        handleSelect={ handleRuleSelect }\n                        selectedRuleRefIds={ selectedRuleRefIds }\n                        osMinorVersionCounts={ osMinorVersionCounts }\n                    />\n                </Tab>\n\n                <Tab eventKey='systems' title={ <TabTitleText>Systems</TabTitleText> }>\n                    <EditPolicySystemsTab\n                        osMajorVersion={ policy.osMajorVersion }\n                        policyOsMinorVersions={ uniq(policyProfiles.map(profile => profile.osMinorVersion)) }\n                    />\n                </Tab>\n            </RoutedTabs>\n        </Form>\n    );\n};\n\nEditPolicyForm.propTypes = {\n    policy: propTypes.object,\n    updatedPolicy: propTypes.object,\n    setUpdatedPolicy: propTypes.func\n};\n\nexport default EditPolicyForm;\n","import React, { useState } from 'react';\nimport propTypes from 'prop-types';\nimport { useParams } from 'react-router-dom';\nimport { useDispatch } from 'react-redux';\nimport gql from 'graphql-tag';\nimport { useQuery } from '@apollo/client';\nimport { Button, Modal, Spinner } from '@patternfly/react-core';\nimport { useLinkToBackground, useAnchor } from 'Utilities/Router';\nimport { useTitleEntity } from 'Utilities/hooks/useDocumentTitle';\nimport { StateViewWithError, StateViewPart } from 'PresentationalComponents';\nimport EditPolicyForm from './EditPolicyForm';\nimport usePolicy from './usePolicy';\n\nexport const MULTIVERSION_QUERY = gql`\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        external\n        description\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        osMajorVersion\n        lastScanned\n        policyType\n        policy {\n            id\n            name\n            refId\n            profiles {\n                id\n                ssgVersion\n                parentProfileId\n                name\n                refId\n                osMinorVersion\n                osMajorVersion\n                benchmark {\n                    id\n                    title\n                    latestSupportedOsMinorVersions\n                    osMajorVersion\n                }\n                rules {\n                    title\n                    severity\n                    rationale\n                    refId\n                    description\n                    remediationAvailable\n                    identifier\n                }\n            }\n        }\n        businessObjective {\n            id\n            title\n        }\n        hosts {\n            id\n            osMinorVersion\n            osMajorVersion\n        }\n    }\n}\n`;\n\nexport const EditPolicy = ({ route }) => {\n    const { policy_id: policyId } = useParams();\n    const { data, loading, error } = useQuery(MULTIVERSION_QUERY, {\n        variables: { policyId }\n    });\n    const policy = data?.profile;\n    const dispatch = useDispatch();\n    const anchor = useAnchor();\n    const [updatedPolicy, setUpdatedPolicy] = useState(null);\n    const updatePolicy = usePolicy();\n    const linkToBackground = useLinkToBackground('/scappolicies');\n    const [isSaving, setIsSaving] = useState();\n    const saveEnabled = updatedPolicy && !updatedPolicy.complianceThresholdValid;\n\n    const linkToBackgroundWithHash = () => {\n        dispatch({\n            type: 'SELECT_ENTITIES',\n            payload: { ids: [] }\n        });\n        linkToBackground({ hash: anchor });\n    };\n\n    const onSave = () => {\n        if (isSaving) { return; }\n\n        setIsSaving(true);\n        updatePolicy(policy, updatedPolicy).then(() => {\n            setIsSaving(false);\n            linkToBackgroundWithHash();\n        }).catch(() => {\n            // TODO report error\n            setIsSaving(false);\n            linkToBackgroundWithHash();\n        });\n    };\n\n    const actions = [\n        <Button\n            isDisabled={ saveEnabled }\n            key='save'\n            variant='primary'\n            spinnerAriaValueText='Saving'\n            isLoading={ isSaving }\n            onClick={ onSave }>\n            Save\n        </Button>,\n        <Button\n            key='cancel'\n            variant='link'\n            onClick={ () => linkToBackgroundWithHash() }>\n            Cancel\n        </Button>\n    ];\n\n    useTitleEntity(route, policy?.name);\n\n    return <Modal\n        isOpen\n        style={ { height: '768px' } }\n        width={ 1220 }\n        title={ `Edit ${ policy ? policy.name : '' }` }\n        onClose={ () => linkToBackgroundWithHash() }\n        actions={ actions }>\n\n        <StateViewWithError stateValues={ { policy, loading, error } }>\n            <StateViewPart stateKey=\"loading\">\n                <Spinner />\n            </StateViewPart>\n            <StateViewPart stateKey=\"policy\">\n                <EditPolicyForm { ...{ policy, updatedPolicy, setUpdatedPolicy } } />\n            </StateViewPart>\n        </StateViewWithError>\n    </Modal>;\n};\n\nEditPolicy.propTypes = {\n    route: propTypes.object\n};\n\nexport default EditPolicy;\n","import { useMutation } from '@apollo/client';\nimport {\n    ASSOCIATE_SYSTEMS_TO_PROFILES, CREATE_BUSINESS_OBJECTIVE, UPDATE_PROFILE, CREATE_PROFILE, ASSOCIATE_RULES_TO_PROFILE\n} from 'Utilities/graphql/mutations';\n\nconst useCreateBusinessObjective = () => {\n    const [create] = useMutation(CREATE_BUSINESS_OBJECTIVE);\n\n    return async (policy, newBusinessObjective) => {\n        if (policy?.businessObjective?.title === newBusinessObjective?.title) {\n            return policy?.businessObjective?.id;\n        } else if (newBusinessObjective?.title === '') {\n            return null;\n        } else {\n            const { data, error } = await create({ variables: {\n                input: { title: newBusinessObjective.title }\n            } });\n\n            if (error) { throw error; }\n\n            return data.createBusinessObjective.businessObjective.id;\n        }\n    };\n};\n\nconst useAssociateSystems = () => {\n    const [associateSystems] = useMutation(ASSOCIATE_SYSTEMS_TO_PROFILES);\n\n    return async ({ id }, hosts) => {\n        const { data, error } = await associateSystems({\n            variables: { input: {\n                id,\n                systemIds: hosts.map((h) => (h.id))\n            } }\n        });\n\n        if (error) { throw error; }\n\n        return data?.associateSystems?.profile;\n    };\n};\n\nconst useAssociateRules = () => {\n    const [associateRules] = useMutation(ASSOCIATE_RULES_TO_PROFILE);\n\n    return async ({ id, ruleRefIds }, profiles) => {\n        const profile = profiles.find((profile) => (\n            profile.id === id || profile.parentProfileId === id\n        ));\n        const ruleInput = {\n            id: profile?.id,\n            ruleRefIds\n        };\n\n        const { error } = await associateRules({ variables: { input: ruleInput } });\n        if (error) { throw error; }\n    };\n};\n\nconst usePolicy = () => {\n    const createBusinessObjective = useCreateBusinessObjective();\n    const [updateProfile] = useMutation(UPDATE_PROFILE);\n    const [createProfile] = useMutation(CREATE_PROFILE);\n    const associateSystems = useAssociateSystems();\n    const associateRules = useAssociateRules();\n\n    return async (policy, updatedPolicy, onProgress) => {\n        const selectedRuleRefIds = updatedPolicy?.selectedRuleRefIds || [];\n\n        const expectedUpdates = 3 + selectedRuleRefIds.length;\n        let progress = 0;\n        const dispatchProgress = () => {\n            if (onProgress) {\n                onProgress((++progress) / expectedUpdates);\n            }\n        };\n\n        const businessObjectiveId = await createBusinessObjective(policy, updatedPolicy?.businessObjective);\n        dispatchProgress();\n\n        let policyInput = {\n            name: updatedPolicy.name,\n            description: updatedPolicy.description,\n            complianceThreshold: parseFloat(updatedPolicy.complianceThreshold)\n        };\n\n        if (businessObjectiveId) {\n            policyInput.businessObjectiveId = businessObjectiveId;\n        }\n\n        if (policy === null) {\n            policyInput.cloneFromProfileId = updatedPolicy.cloneFromProfileId;\n            policyInput.refId = updatedPolicy.refId;\n            policyInput.benchmarkId = updatedPolicy.benchmarkId;\n\n            let {\n                data: { createProfile: { profile: { id } } },\n                error\n            } = await createProfile({ variables: { input: policyInput } });\n\n            if (error) { throw error; }\n\n            dispatchProgress();\n            policy = { id };\n        } else {\n            policyInput.id = policy.id;\n\n            let { error } = await updateProfile({ variables: { input: policyInput } });\n            if (error) { throw error; }\n\n            dispatchProgress();\n        }\n\n        const { policy: { profiles } } = await associateSystems(policy, updatedPolicy.hosts);\n        dispatchProgress();\n\n        for (const profileSelectedRuleRefIds of selectedRuleRefIds) {\n            await associateRules(profileSelectedRuleRefIds, profiles);\n            dispatchProgress();\n        }\n    };\n};\n\nexport default usePolicy;\n","import gql from 'graphql-tag';\nimport pickBy from 'lodash/pickBy';\nimport {\n    systemsPolicyFilterConfiguration, systemsOsFilterConfiguration, systemsOsMinorFilterConfiguration\n} from '@/constants';\n\nexport const GET_SYSTEMS = gql`\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    refId\n                    lastScanned\n                    compliant\n                    external\n                    score\n                    supported\n                    ssgVersion\n                    majorOsVersion\n                    rules {\n                        refId\n                        title\n                        compliant\n                        remediationAvailable\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n`;\n\nexport const GET_SYSTEMS_WITHOUT_FAILED_RULES = gql`\nquery getSystems($filter: String!, $policyId: ID, $perPage: Int, $page: Int) {\n    systems(search: $filter, limit: $perPage, offset: $page) {\n        totalCount\n        edges {\n            node {\n                id\n                name\n                osMajorVersion\n                osMinorVersion\n                testResultProfiles(policyId: $policyId) {\n                    id\n                    name\n                    lastScanned\n                    external\n                    compliant\n                    score\n                    supported\n                    ssgVersion\n                    policy {\n                        id\n                    }\n                }\n                policies(policyId: $policyId) {\n                    id\n                    name\n                }\n            }\n        }\n    }\n}\n`;\n\nexport const policyFilter = (policies, osFilter) => ([\n    ...systemsPolicyFilterConfiguration(policies),\n    ...(osFilter ? systemsOsFilterConfiguration(policies) : [])\n]);\n\nexport const osMinorVersionFilter = (...args) => systemsOsMinorFilterConfiguration(...args);\n\nexport const initFilterState = (filterConfig) => (\n    pickBy(filterConfig.initialDefaultState(), (value) => (!!value))\n);\n","import React from 'react';\nimport propTypes from 'prop-types';\nimport Skeleton, { SkeletonSize } from '@redhat-cloud-services/frontend-components/Skeleton';\nimport { registryDecorator } from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport { InventoryDetail, DetailWrapper } from '@redhat-cloud-services/frontend-components/Inventory';\n\n@registryDecorator()\nclass InventoryDetails extends React.Component {\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <DetailWrapper onLoad={({ mergeWithDetail }) => this.getRegistry().register({\n                ...mergeWithDetail()\n            })}>\n                <InventoryDetail fallback={<Skeleton size={ SkeletonSize.md } />} hideBack />\n            </DetailWrapper>\n        );\n    }\n}\n\nInventoryDetails.propTypes = {\n    entity: propTypes.object\n};\n\nconst ConnectedInventoryDetails = (props) => {\n    return <InventoryDetails {...props} />;\n};\n\nexport default ConnectedInventoryDetails;\n","const CSV_FILE_PREFIX = 'compliance-export';\nconst CSV_DELIMITER = ',';\n\nconst linkAndDownload = (data, filename) => {\n    if (!data) {\n        return;\n    }\n\n    let link = document.createElement('a');\n    link.setAttribute('href', data);\n    link.setAttribute('download', filename);\n    link.dispatchEvent(new MouseEvent(`click`, { bubbles: true, cancelable: true, view: window }));\n};\n\nconst getNestedObject = (nestedObj, path) => {\n    return path.split('.').reduce(\n        (obj, key) => (obj && obj[key] !== 'undefined') ? obj[key] : undefined, nestedObj\n    );\n};\n\nconst textCsvCell = (row, key) => {\n    let cell = getNestedObject(row, key);\n\n    if (cell.exportValue) {\n        cell = cell.exportValue;\n    }\n\n    if (typeof(cell) === 'object') {\n        cell = getNestedObject(row, key + '_text');\n    }\n\n    if (typeof(cell) === 'string' && cell.includes(',')) {\n        cell = '\"' + cell + '\"';\n    }\n\n    return cell;\n};\n\nexport const csvFromState = (state) => {\n    const { rows, columns, selectedEntities } = state;\n\n    if (rows) {\n        let csvRows = [columns.map((column) => column.title).join(CSV_DELIMITER)];\n        csvRows = csvRows.concat((selectedEntities || rows).map((row) => (\n            state.columns.map((column) => !column.noExport ? textCsvCell(row, column.key) : '').join(CSV_DELIMITER)\n        )));\n\n        return encodeURI('data:text/csv;charset=utf-8,' + csvRows.join('\\n'));\n    }\n};\n\nexport const jsonFromState = (state) => {\n    const { rows, columns, selectedEntities } = state;\n    let result;\n\n    if (rows) {\n        result = (selectedEntities || rows).map((row) => {\n            let object = {};\n            columns.forEach((column) => {\n                const keys = column.key.split('.');\n                const key = keys[keys.length - 1];\n                object[key] = textCsvCell(row, column.key);\n            });\n\n            return object;\n        });\n\n        return encodeURI('data:application/json;charset=utf-8,' + JSON.stringify(result));\n    }\n};\n\nconst filename = (format) => (\n    CSV_FILE_PREFIX + '-' + (new Date()).toISOString() + '.' + format\n);\n\nexport const exportFromState = (state, format) => {\n    let content;\n\n    if (format === 'csv') {\n        content = csvFromState(state);\n    } else if (format === 'json') {\n        content = jsonFromState(state);\n    }\n\n    linkAndDownload(content, filename(format));\n};\n\n","class ApiClient {\n    DEFAULT_API_HEADERS = {\n        'Content-Type': 'application/vnd.api+json',\n        Accept: 'application/json'\n    }\n\n    constructor(options = {}) {\n        this.apiBase = options.apiBase || '/api';\n        this.path = options.path || '';\n        this.authenticate = options.authenticate || (() => Promise.resolve({}));\n        this.onUnauthorised = options.onUnauthorised || (() => Promise.resolve({}));\n        this.defaultHeaders = options.headers || this.DEFAULT_API_HEADERS;\n    }\n\n    async request(path, apiProps, method, options = {}) {\n        return await this.callAuthenticate()\n        .then(() => this.fetch(path, apiProps, method, options))\n        .then(this.checkForEmptyResponse)\n        .then((response) => this.checkForErrors(response, options))\n        .then((response) => response.json())\n        .catch(this.finalCatch);\n    }\n\n    finalCatch(promise) {\n        if (promise.errors === undefined) {\n            return Promise.reject({ title: 'Error parsing' });\n        } else {\n            return Promise.reject({ ...promise });\n        }\n    }\n\n    fetch(path, apiProps, method, options) {\n        let params = {\n            method: method || 'get',\n            headers: this.defaultHeaders,\n            credentials: 'include'\n        };\n        const fullPath = `${ this.apiBase }${ this.path ? this.path : '' }${ path ? path : '' }`;\n        let url = new URL(fullPath, window.location.origin);\n        if (options.params) {\n            const params = Object.keys(options.params).map((key) => (\n                encodeURIComponent(key) + '=' + encodeURIComponent(options.params[key])\n            )).join('&');\n            url.search = new URLSearchParams(params);\n        }\n\n        if (apiProps) {\n            params.body = JSON.stringify(apiProps);\n        }\n\n        return fetch(\n            url, params\n        );\n    }\n\n    checkForEmptyResponse(response) {\n        return response.status === 204 ? { json: () => ({}) } : response;\n    }\n\n    checkForErrors(response, options = {}) {\n        if (response.status === 404 && options.ignore404) {\n            return { json: () => ({}) };\n        }\n\n        if (response.status === 401) {\n            return this.onUnauthorised();\n        }\n\n        const responseCloneJson = response.clone ? response.clone().json() : response;\n\n        if (response.status === 422) {\n            return responseCloneJson.then((json) =>\n                Promise.reject({ ...json, title: 'Validation error' })\n            );\n        }\n\n        if (response.status >= 400 && response.status <= 600) {\n            return responseCloneJson.then((json) =>\n                Promise.reject(json.errors[0])\n            );\n        }\n\n        return response;\n    }\n\n    callAuthenticate() {\n        return Promise.resolve(this.authenticate() || true);\n    }\n\n    create(path, apiProps) {\n        return this.request(path, apiProps, 'post');\n    }\n\n    update(path, apiProps) {\n        return this.request(path, apiProps, 'put');\n    }\n\n    get(path, options = {}) {\n        return this.request(path, null, 'get', options);\n    }\n\n    destroy(path) {\n        return this.request(path, null, 'delete');\n    }\n}\n\nexport default ApiClient;\n","import ApiClient from './utils/ApiClient';\n\nconst useApi = (options) => {\n    const apiClient = new ApiClient({\n        ...options\n    });\n\n    return apiClient;\n};\n\nexport default useApi;\n","import { useEffect, useState } from 'react';\nimport { COMPLIANCE_API_ROOT } from '@/constants';\nimport normalize from 'json-api-normalizer';\nimport useApi from './useApi';\n\nconst includePropAndDelete = (entity, prop) => {\n    const attributes = entity[prop];\n    let newEntity = entity;\n    delete newEntity[prop];\n    return { ...newEntity, ...attributes };\n};\n\nconst includeAttributes = (entity) => (\n    entity && includePropAndDelete(entity, 'attributes')\n);\n\nconst includeRelationship = (entity, normalizedJson) => {\n    let relationships = {};\n    Object.entries(entity?.relationships || []).forEach((item) => {\n        const [relationship, relationshipData] = item;\n        relationships[relationship] = relationshipData?.data.map((entity) => (\n            includeAttributes(normalizedJson?.[entity.type]?.[entity.id])\n        )).filter((v) => (!!v));\n    });\n    delete entity.relationships;\n    return { ...entity, ...relationships };\n};\n\nconst normalizeData = (json, type) => {\n    const jsonNormalized = normalize(json);\n    return Object.values(jsonNormalized[type] || {})?.map((entity) => (\n        includeRelationship(includeAttributes(entity), jsonNormalized)\n    ));\n};\n\nconst fetchCollection = async (apiClient, collection, params = {}, options = {}) => {\n    const json = await apiClient.get(`/${ collection }`, { params });\n    const normalized = await normalizeData(json, options?.type || collection);\n\n    return {\n        collection: normalized,\n        meta: json.meta,\n        total: json.meta.total,\n        json\n    };\n};\n\nconst useCollection = (collection, options = {}, dependencies = []) => {\n    const [collectionState, setCollectionState] = useState({\n        data: undefined,\n        loading: false,\n        error: undefined\n    });\n    const apiClient = useApi({\n        apiBase: COMPLIANCE_API_ROOT\n    });\n    const params = {\n        ...(options?.params || {}),\n        include: (options?.include || [])\n    };\n\n    useEffect(() => {\n        if (!options?.skip) {\n            setCollectionState({\n                data: undefined,\n                loading: true,\n                error: undefined\n            });\n\n            fetchCollection(apiClient, collection, params, options).then((data) => {\n                setCollectionState({\n                    data,\n                    loading: false,\n                    error: undefined\n                });\n            });\n        }\n    }, [...dependencies, options?.skip]);\n\n    return collectionState;\n};\n\nexport default useCollection;\n","import useCollection from 'Utilities/hooks/api/useCollection';\nimport { osMinorVersionFilter } from './constants';\n\nconst groupByMajorVersion = (versions = [], showFilter) => {\n    const showVersion = (version) => {\n        if (showFilter.length > 0) {\n            return Array(showFilter).map(String).includes(String(version));\n        } else {\n            return true;\n        }\n    };\n\n    return versions.reduce((acc, currentValue) => {\n        if (showVersion(currentValue.osMajorVersion)) {\n            acc[String(currentValue.osMajorVersion)] = [...new Set(\n                [...acc[currentValue.osMajorVersion] || [], currentValue.osMinorVersion]\n            )];\n        }\n\n        return acc;\n    }, []);\n};\n\nexport const useOsMinorVersionFilter = (showFilter) => {\n    const { data: supportedSsgs } = useCollection('supported_ssgs', {\n        type: 'supportedSsg',\n        skip: !showFilter\n    });\n\n    return showFilter ? osMinorVersionFilter(groupByMajorVersion(supportedSsgs?.collection, showFilter)) : [];\n};\n","import React, { useEffect, useState, useRef, useCallback } from 'react';\nimport { withApollo } from '@apollo/client/react/hoc';\nimport PropTypes from 'prop-types';\nimport { useStore, useDispatch, useSelector, shallowEqual } from 'react-redux';\nimport { getRegistry } from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport SkeletonTable from '@redhat-cloud-services/frontend-components/SkeletonTable';\nimport { policyFilter } from './constants';\nimport { systemsReducer } from 'Store/Reducers/SystemStore';\nimport { selectAll, clearSelection } from 'Store/ActionTypes';\nimport { exportFromState } from 'Utilities/Export';\nimport { DEFAULT_SYSTEMS_FILTER_CONFIGURATION, COMPLIANT_SYSTEMS_FILTER_CONFIGURATION } from '@/constants';\nimport debounce from 'lodash/debounce';\nimport {\n    ErrorPage,\n    StateView,\n    StateViewPart\n} from 'PresentationalComponents';\nimport { Alert } from '@patternfly/react-core';\nimport { TableVariant } from '@patternfly/react-table';\n// eslint-disable-next-line max-len\nimport ComplianceRemediationButton from '@redhat-cloud-services/frontend-components-inventory-compliance/ComplianceRemediationButton';\nimport { systemsWithRuleObjectsFailed } from 'Utilities/ruleHelpers';\nimport useFilterConfig from 'Utilities/hooks/useFilterConfig';\nimport { InventoryTable as FECInventoryTable } from '@redhat-cloud-services/frontend-components/Inventory';\nimport { useOsMinorVersionFilter } from './hooks';\n\nexport const InventoryTable = ({\n    columns,\n    showAllSystems,\n    policyId,\n    query,\n    client,\n    showActions,\n    enableExport,\n    compliantFilter,\n    policies,\n    showOnlySystemsWithTestResults,\n    showOsFilter,\n    error,\n    showComplianceSystemsInfo,\n    compact,\n    remediationsEnabled,\n    systemProps,\n    defaultFilter,\n    emptyStateComponent,\n    prependComponent,\n    showOsMinorVersionFilter\n}) => {\n    const store = useStore();\n    const dispatch = useDispatch();\n    const inventory = useRef(null);\n    const [pagination, setPagination] = useState({\n        perPage: 50,\n        page: 1\n    });\n    const [isLoaded, setIsLoaded] = useState(false);\n    const [isEmpty, setIsEmpty] = useState(false);\n    const osMinorVersionFilter = useOsMinorVersionFilter(showOsMinorVersionFilter);\n    const { conditionalFilter, activeFilters, buildFilterString } = useFilterConfig([\n        ...DEFAULT_SYSTEMS_FILTER_CONFIGURATION,\n        ...(compliantFilter ? COMPLIANT_SYSTEMS_FILTER_CONFIGURATION : []),\n        ...(policies?.length > 0 ? policyFilter(policies, showOsFilter) : []),\n        ...osMinorVersionFilter\n    ]);\n\n    const total = useSelector(({ entities }) => entities?.systemsCount) || 0;\n    const items = useSelector(({ entities } = {}) => (entities?.systems?.map((system) => (\n        system?.node?.id\n    )) || []), shallowEqual);\n    const selectedEntities = useSelector(({ entities } = {}) => (entities?.selectedEntities || []), shallowEqual);\n    const onBulkSelect = (isSelected) => isSelected ? dispatch(selectAll()) : dispatch(clearSelection());\n\n    const fetchSystems = (perPage = 50, page = 1) => {\n        setIsLoaded(false);\n\n        const filterString = buildFilterString();\n        const combindedFilter = [\n            ...showOnlySystemsWithTestResults ? ['has_test_results = true'] : [],\n            ...filterString?.length > 0 ? [filterString] : []\n        ].join(' and ');\n        const filter = defaultFilter ? `(${ defaultFilter }) and (${ combindedFilter })` : combindedFilter;\n\n        dispatch({ type: 'GET_SYSTEMS_PENDING' });\n        return client.query({\n            query,\n            fetchResults: true,\n            fetchPolicy: 'no-cache',\n            variables: {\n                filter,\n                perPage,\n                page,\n                ...policyId && { policyId }\n            }\n        }).then(({ data, loading }) => {\n            dispatch({\n                type: 'GET_SYSTEMS_FULFILLED',\n                systems: data.systems.edges,\n                systemsCount: data.systems.totalCount\n            });\n            setIsLoaded(true);\n            setPagination(() => ({ page, perPage }));\n\n            if (emptyStateComponent && !loading && data.systems.totalCount === 0 && combindedFilter.length === 0) {\n                setIsEmpty(true);\n            }\n\n            return { data, loading };\n        });\n    };\n\n    const debounceFetchSystems = useCallback(\n        debounce(fetchSystems, 800),\n        [conditionalFilter.activeFiltersConfig.filters]\n    );\n\n    useEffect(() => {\n        if (conditionalFilter.activeFiltersConfig.filters) {\n            debounceFetchSystems(pagination.perPage, 1);\n        }\n    }, [activeFilters]);\n\n    const onRefresh = (options, callback) => {\n        query && fetchSystems(options.per_page, options.page);\n        if (!callback && inventory && inventory.current) {\n            inventory.current.onRefreshData(options);\n        } else if (callback) {\n            callback(options);\n        }\n    };\n\n    return <StateView stateValues={{ error, noError: error === undefined && !isEmpty, empty: isEmpty }}>\n        <StateViewPart stateKey='error'>\n            { !!prependComponent && prependComponent }\n            <ErrorPage error={error}/>\n        </StateViewPart>\n        <StateViewPart stateKey='empty'>\n            { emptyStateComponent }\n        </StateViewPart>\n        <StateViewPart stateKey='noError'>\n            { !!prependComponent && isLoaded && prependComponent }\n            { showComplianceSystemsInfo && <Alert\n                isInline\n                variant=\"info\"\n                title={ 'The list of systems in this view is different than those that appear in the Inventory. ' +\n                    'Only systems currently associated with or reporting against compliance policies are displayed.' } /> }\n            <FECInventoryTable\n                { ...systemProps }\n                onLoad={({\n                    INVENTORY_ACTION_TYPES,\n                    mergeWithEntities\n                }) => {\n                    getRegistry().register({\n                        ...mergeWithEntities(\n                            systemsReducer(\n                                INVENTORY_ACTION_TYPES, columns, showAllSystems, policyId\n                            ))\n                    });\n                }}\n                fallback={<SkeletonTable colSize={2} rowSize={15} />}\n                tableProps={{\n                    canSelectAll: false\n                }}\n                variant={compact ? TableVariant.compact : ''}\n                ref={inventory}\n                onRefresh={onRefresh}\n                bulkSelect={{\n                    checked: selectedEntities.length > 0 ?\n                        (items?.every(id => selectedEntities?.find((selected) => selected?.id === id)) ? true : null)\n                        : false,\n                    onSelect: onBulkSelect,\n                    count: selectedEntities.length,\n                    label: selectedEntities.length > 0 ? `${ selectedEntities.length } Selected` : undefined\n                }}\n                {...!showAllSystems && {\n                    ...pagination,\n                    isLoaded,\n                    items,\n                    total,\n                    ...conditionalFilter,\n                    ...remediationsEnabled && {\n                        dedicatedAction: <ComplianceRemediationButton\n                            allSystems={ systemsWithRuleObjectsFailed(selectedEntities) }\n                            selectedRules={ [] } />\n                    }\n                }}\n                {...enableExport && {\n                    exportConfig: {\n                        isDisabled: total === 0 && selectedEntities.length === 0,\n                        onSelect: (_, format) => exportFromState(store.getState()?.entities, format)\n                    }\n                }}\n                {...showActions && {\n                    actions: [{\n                        title: 'View in inventory',\n                        onClick: (_event, _index, { id }) => {\n                            const beta = window.location.pathname.split('/')[1] === 'beta';\n                            window.location.href = `${window.location.origin}${beta ? '/beta' : ''}/insights/inventory/${id}`;\n                        }\n                    }]\n                }}\n            />\n        </StateViewPart>\n    </StateView>;\n};\n\nInventoryTable.propTypes = {\n    columns: PropTypes.arrayOf(PropTypes.shape({})),\n    policies: PropTypes.arrayOf(PropTypes.shape({})),\n    client: PropTypes.object,\n    showAllSystems: PropTypes.bool,\n    policyId: PropTypes.string,\n    query: PropTypes.string,\n    showActions: PropTypes.bool,\n    enableExport: PropTypes.bool,\n    compliantFilter: PropTypes.bool,\n    showOnlySystemsWithTestResults: PropTypes.bool,\n    showOsFilter: PropTypes.bool,\n    showComplianceSystemsInfo: PropTypes.bool,\n    error: PropTypes.object,\n    compact: PropTypes.bool,\n    remediationsEnabled: PropTypes.bool,\n    defaultFilter: PropTypes.string,\n    systemProps: PropTypes.shape({\n        isFullView: PropTypes.bool\n    }),\n    emptyStateComponent: PropTypes.node,\n    prependComponent: PropTypes.node,\n    showOsMinorVersionFilter: PropTypes.oneOfType([\n        PropTypes.bool,\n        PropTypes.arrayOf(PropTypes.number)\n    ])\n};\n\nInventoryTable.defaultProps = {\n    policyId: '',\n    showActions: true,\n    enableExport: true,\n    compliantFilter: false,\n    showOnlySystemsWithTestResults: false,\n    showComplianceSystemsInfo: false,\n    compact: false,\n    remediationsEnabled: true\n};\n\nexport default withApollo(InventoryTable);\n","export const profilesRulesFailed = (profiles) => (\n    profiles.flatMap(profile => profile.rules && profile.rules.filter(rule => !rule.compliant))\n);\n\nexport const profilesRulesPassed = (profiles) => (\n    profiles.flatMap(profile => profile.rules && profile.rules.filter(rule => rule.compliant))\n);\n\nexport const systemRulesPassed = (system) => (\n    system.testResultProfiles ? profilesRulesPassed(system.testResultProfiles) : []\n);\n\nexport const systemRulesFailed = (system) => (\n    system.testResultProfiles ? profilesRulesFailed(system.testResultProfiles) : []\n);\n\nexport const systemsWithRuleObjectsFailed = (systems) => (\n    systems.map(system => (\n        {\n            ...system,\n            ruleObjectsFailed: systemRulesFailed(system),\n            profiles: system.testResultProfiles\n        }\n    ))\n);\n","export const EXPORT = '@@COMPLIANCE/EXPORT';\nexport const SELECT_ENTITY = 'SELECT_ENTITY';\n\nexport const exportFromState = (format) => ({\n    type: EXPORT, payload: { format }\n});\n\nexport const selectAll = () => ({\n    type: SELECT_ENTITY,\n    payload: { id: 0, selected: true }\n});\n\nexport const clearSelection = () => ({\n    type: SELECT_ENTITY,\n    payload: { id: 0, selected: false }\n});\n","import React from 'react';\nimport { applyReducerHash } from '@redhat-cloud-services/frontend-components-utilities/ReducerRegistry';\nimport { Link } from 'react-router-dom';\nimport { SELECT_ENTITY } from 'Store/ActionTypes';\nimport {\n    Tooltip,\n    Text,\n    TextContent,\n    TextVariants\n} from '@patternfly/react-core';\nimport {\n    profilesRulesPassed,\n    profilesRulesFailed\n} from 'Utilities/ruleHelpers';\nimport Truncate from 'react-truncate';\nimport { sortingByProp } from 'Utilities/helpers';\n\nconst NEVER = 'Never';\n\nexport const lastScanned = ({ testResultProfiles: profiles = [] }) => {\n    const dates = profiles.map((profile) => new Date(profile.lastScanned));\n    const last = new Date(Math.max.apply(null, dates.filter((date) => isFinite(date))));\n    const result = (last instanceof Date && isFinite(last)) ? last : NEVER;\n\n    return result;\n};\n\nexport const compliant = ({ testResultProfiles: profiles = [] }) => (\n    profiles.every(profile => profile.lastScanned === NEVER || profile.compliant === true)\n);\n\nexport const score = ({ testResultProfiles: profiles = [] }) => {\n    const scoreTotal = profiles.reduce((acc, profile) => acc + profile.score, 0);\n    const numScored = profiles.reduce((acc, profile) => {\n        if (profilesRulesPassed([profile]).length + profilesRulesFailed([profile]).length > 0) { return acc + 1; }\n\n        return acc;\n    }, 0);\n    if (numScored) { return scoreTotal / numScored; }\n\n    return 0;\n};\n\nexport const supported = ({ testResultProfiles: profiles = [] }) => (\n    profiles.reduce((acc, profile) => acc && profile.supported, true)\n);\n\nexport const policyNames = (system) => {\n    if (system === {}) { return ''; }\n\n    let policyNames = system.policies.map(({ name }) => name);\n    return policyNames.join(', ');\n};\n\nexport const policiesCell = ({ policyNames }) => ({\n    title: policyNames ? (\n        <Tooltip content={policyNames}>\n            <Truncate lines={2} width={540}>{policyNames}</Truncate>\n        </Tooltip>\n    ) : <Text className='grey-icon'>No policies</Text>,\n    exportValue: policyNames\n});\n\nexport const detailsLink = (system) => {\n    if (system.testResultProfiles && system.testResultProfiles.length > 0) {\n        return {\n            title: (\n                <Link to={{ pathname: `/systems/${system.id}` }}>\n                    View report\n                </Link>\n            )\n        };\n    }\n};\n\nexport const hasOsInfo = (matchingSystem) => (\n    typeof(matchingSystem.osMajorVersion) !== 'undefined' && typeof(matchingSystem.osMinorVersion) !== 'undefined' &&\n        matchingSystem.osMajorVersion !== null && matchingSystem.osMinorVersion !== null &&\n        !(matchingSystem.osMajorVersion === 0 && matchingSystem.osMinorVersion === 0)\n);\n\nexport const systemName = (displayName, id, { osMajorVersion, osMinorVersion, name }) => (\n    <TextContent>\n        <Link to={{ pathname: `/systems/${id}` }}>\n            { displayName || name }\n        </Link>\n        { hasOsInfo({ osMajorVersion, osMinorVersion }) &&\n            <Text component={TextVariants.small}>RHEL {osMajorVersion}.{osMinorVersion}</Text> }\n    </TextContent>\n);\n\nconst isSelected = (id, selectedEntities) => (\n    !!(selectedEntities || []).find((entity) => (entity.id === id))\n);\n\nconst profilesSsgVersions = ({ testResultProfiles: profiles = [] }) => (\n    profiles.map((p) => (p.ssgVersion)).filter((version) => (!!version)).join(', ')\n);\n\nexport const mapCountOsMinorVersions = (systems) => {\n    if (!systems) { return {}; }\n\n    return systems.reduce((acc, { osMinorVersion }) => {\n        if (osMinorVersion !== undefined && osMinorVersion !== null) {\n            (acc[osMinorVersion] = acc[osMinorVersion] || { osMinorVersion, count: 0 }).count++;\n        }\n\n        return acc;\n    }, {});\n};\n\nexport const countOsMinorVersions = (systems) => (\n    Object.values(mapCountOsMinorVersions(systems)).sort(sortingByProp('osMinorVersion', 'desc'))\n);\n\nexport const systemsToRows = (systems) => (\n    systems.map(({ node }) => ({\n        ...node,\n        policyNames: policyNames({ policies: node?.policies, testResultProfiles: [] }),\n        rulesPassed: profilesRulesPassed(node.testResultProfiles).length,\n        rulesFailed: profilesRulesFailed(node.testResultProfiles).length,\n        lastScanned: lastScanned(node),\n        compliant: compliant(node),\n        display_name: node.name, // eslint-disable-line camelcase\n        score: score(node),\n        supported: supported(node),\n        ssgVersion: profilesSsgVersions(node),\n        detailsLink: detailsLink(node)\n    }))\n);\n\nconst selectRowsByIds = (state, ids) => {\n    const rowsToSelect = state.rows.filter((row) => (\n        ids.includes(row.id) && !(state.selectedEntities || []).map((e) => (e.id)).includes(row.id)\n    ));\n\n    return {\n        ...state,\n        selectedEntities: (state.selectedEntities || []).concat(rowsToSelect)\n    };\n};\n\nconst deselectRowsByIds = (state, ids) => ({\n    ...state,\n    selectedEntities: (state.selectedEntities || []).filter((row) => !ids.includes(row.id))\n});\n\nconst selectAllRows = (state) => (\n    selectRowsByIds(state, state.rows.map((row) => (row.id)))\n);\n\nconst deselectAllRows = (state) => (\n    deselectRowsByIds(state, state.rows.map((row) => (row.id)))\n);\n\nconst selectRow = (state, id) => (\n    selectRowsByIds(state, [id])\n);\n\nconst deselectRow = (state, id) => (\n    deselectRowsByIds(state, [id])\n);\n\nexport const systemsReducer = (INVENTORY_ACTION, columns) => applyReducerHash({\n    ['GET_SYSTEMS_PENDING']: (state) => ({\n        ...state,\n        rows: [],\n        systems: undefined,\n        systemsCount: undefined,\n        columns,\n        loaded: false\n    }),\n    ['GET_SYSTEMS_FULFILLED']: (state, { systems, systemsCount }) => ({\n        ...state,\n        systems,\n        systemsCount,\n        total: systemsCount,\n        rows: systemsToRows(systems).map((row) => ({\n            ...row, selected: isSelected(row.id, state.selectedEntities)\n        })),\n        columns,\n        loaded: true\n    }),\n    [INVENTORY_ACTION.LOAD_ENTITIES_PENDING]: (state) => ({\n        ...state,\n        total: state.systemsCount,\n        rows: state.systems !== undefined ? systemsToRows(state.systems).map((row) => ({\n            ...row, selected: isSelected(row.id, state.selectedEntities)\n        })) : [],\n        columns,\n        loaded: state.systemsCount !== undefined\n    }),\n    [INVENTORY_ACTION.LOAD_ENTITIES_FULFILLED]: (state) => ({\n        ...state,\n        total: state.systemsCount,\n        rows: state.systems !== undefined ? systemsToRows(state.systems).map((row) => ({\n            ...row, selected: isSelected(row.id, state.selectedEntities)\n        })) : [],\n        columns,\n        loaded: state.systemsCount !== undefined\n    }),\n    [SELECT_ENTITY]: (state, { payload: { id, selected, clearAll } }) => {\n        let newState;\n\n        if (id === 0) {\n            newState = selected ? selectAllRows(state) : deselectAllRows(state);\n        } else {\n            newState = selected ? selectRow(state, id) : deselectRow(state, id);\n        }\n\n        if (newState.selectedEntities.length === 0 || clearAll) {\n            newState.selectedEntities = undefined;\n        }\n\n        return newState;\n    },\n    ['SELECT_ENTITIES']: (state, { payload: { ids } }) => ({\n        selectedEntities: ids\n    })\n});\n"],"sourceRoot":""}