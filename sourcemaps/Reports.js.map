{"version":3,"sources":["webpack:///./src/SmartComponents/Reports/Reports.js"],"names":["QUERY","gql","Reports","reportCards","useQuery","fetchPolicy","data","error","loading","pageHeader","style","paddingBottom","title","profiles","edges","map","profile","node","filter","totalHostCount","length","className","i","sm","md","lg","xl","key","mainButton","onWizardFinish","location","reload","Fragment","stateValues","stateKey","gutter","routerParams"],"mappings":"+kCAmBA,IAAMA,EAAQC,IAAH,KAmCEC,EAAU,WAAM,IAErBC,EAFqB,EACQC,mBAASJ,EAAO,CAAEK,YAAa,sBAAxDC,EADiB,EACjBA,KAAMC,EADW,EACXA,MAAOC,EADI,EACJA,QAEjBC,EAAa,kBAAC,aAAD,CAAYC,MAAO,CAAEC,cAAe,KAAM,kBAAC,kBAAD,CAAiBC,MAAM,wBAElF,IAAKJ,GAAWF,EAAM,CAClB,IAAMO,EAAWP,EAAKO,SAASC,MAAMC,KAAI,SAAAC,GAAO,OAAIA,EAAQC,QAAMC,QAAO,SAACF,GAAD,OAAaA,EAAQG,eAAiB,KAE3GN,EAASO,QACTX,EAAa,kBAAC,aAAD,CAAYY,UAAU,oBAC/B,kBAAC,kBAAD,CAAiBT,MAAM,uBACvB,kBAAC,IAAD,OAEJT,EAAcU,EAASE,KACnB,SAACC,EAASM,GAAV,OACI,kBAAC,IAAD,CAAUC,GAAI,GAAIC,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAGC,IAAKL,GACzC,kBAAC,IAAD,CACIK,IAAKL,EACLN,QAASA,SAKzBb,EAAc,kBAAC,uBAAD,CAAsBS,MAAO,4BACvCgB,WAAY,kBAAC,IAAD,CAAcC,eAAgB,WAAQC,SAASC,cAKvE,OAAO,kBAAC,IAAMC,SAAP,KACDvB,EACF,kBAAC,OAAD,KACI,kBAAC,IAAD,CAAoBwB,YAAc,CAAE1B,QAAOD,OAAME,YAC7C,kBAAC,IAAD,CAAe0B,SAAS,WACpB,yBAAKb,UAAU,mBACX,kBAAC,IAAD,CAAMc,OAAO,MACT,kBAAC,IAAD,SAIZ,kBAAC,IAAD,CAAeD,SAAS,QACpB,yBAAKb,UAAU,mBACX,kBAAC,IAAD,CAAMc,OAAO,MACPhC,SASfiC,cAAalC","file":"js/Reports.js","sourcesContent":["import React from 'react';\nimport {\n    ReportTabs,\n    LoadingComplianceCards,\n    ReportCard,\n    StateViewWithError,\n    StateViewPart\n} from 'PresentationalComponents';\nimport { CreatePolicy } from 'SmartComponents';\nimport { ComplianceEmptyState } from '@redhat-cloud-services/frontend-components-inventory-compliance';\nimport { PageHeader, PageHeaderTitle, Main } from '@redhat-cloud-services/frontend-components';\nimport routerParams from '@redhat-cloud-services/frontend-components-utilities/files/RouterParams';\nimport { useQuery } from '@apollo/react-hooks';\nimport gql from 'graphql-tag';\nimport {\n    Grid,\n    GridItem\n} from '@patternfly/react-core';\n\nconst QUERY = gql`\n{\n    profiles(search: \"has_test_results = true\", limit: 1000){\n        edges {\n            node {\n                id\n                name\n                refId\n                description\n                totalHostCount\n                compliantHostCount\n                majorOsVersion\n                complianceThreshold\n                businessObjective {\n                    id\n                    title\n                }\n                policy {\n                    id\n                    benchmark {\n                        id\n                        version\n                    }\n                }\n                benchmark {\n                    id\n                    version\n                }\n            }\n        }\n\n    }\n}\n`;\n\nexport const Reports = () => {\n    const { data, error, loading } = useQuery(QUERY, { fetchPolicy: 'cache-and-network' });\n    let reportCards;\n    let pageHeader = <PageHeader style={{ paddingBottom: 22 }}><PageHeaderTitle title=\"Compliance reports\" /></PageHeader>;\n\n    if (!loading && data) {\n        const profiles = data.profiles.edges.map(profile => profile.node).filter((profile) => profile.totalHostCount > 0);\n\n        if (profiles.length) {\n            pageHeader = <PageHeader className='page-header-tabs'>\n                <PageHeaderTitle title=\"Compliance reports\" />\n                <ReportTabs/>\n            </PageHeader>;\n            reportCards = profiles.map(\n                (profile, i) =>\n                    <GridItem sm={12} md={12} lg={6} xl={4} key={i}>\n                        <ReportCard\n                            key={i}\n                            profile={profile}\n                        />\n                    </GridItem>\n            );\n        } else {\n            reportCards = <ComplianceEmptyState title={'No policies are reporting'}\n                mainButton={<CreatePolicy onWizardFinish={() => { location.reload(); }} />}\n            />;\n        }\n    }\n\n    return <React.Fragment>\n        { pageHeader }\n        <Main>\n            <StateViewWithError stateValues={ { error, data, loading } }>\n                <StateViewPart stateKey='loading'>\n                    <div className=\"policies-donuts\">\n                        <Grid gutter='md'>\n                            <LoadingComplianceCards/>\n                        </Grid>\n                    </div>\n                </StateViewPart>\n                <StateViewPart stateKey='data'>\n                    <div className=\"policies-donuts\">\n                        <Grid gutter='md'>\n                            { reportCards }\n                        </Grid>\n                    </div>\n                </StateViewPart>\n            </StateViewWithError>\n        </Main>\n    </React.Fragment>;\n};\n\nexport default routerParams(Reports);\n"],"sourceRoot":""}