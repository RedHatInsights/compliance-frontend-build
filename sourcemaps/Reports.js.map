{"version":3,"sources":["webpack:///./src/SmartComponents/Reports/Reports.js"],"names":["QUERY","gql","Reports","reportCards","pageHeader","useQuery","fetchPolicy","data","error","loading","profiles","edges","map","profile","node","filter","totalHostCount","length","className","title","i","sm","md","lg","xl","key","style","paddingBottom","mainButton","onWizardFinish","location","reload","stateValues","stateKey","gutter","routerParams"],"mappings":"+kCAmBA,IAAMA,EAAQC,IAAH,KAmCEC,EAAU,WAAM,IAErBC,EACAC,EAHqB,EACQC,YAASL,EAAO,CAAEM,YAAa,sBAAxDC,EADiB,EACjBA,KAAMC,EADW,EACXA,MAAOC,EADI,EACJA,QAIrB,IAAKA,GAAWF,EAAM,CAClB,IAAMG,EAAWH,EAAKG,SAASC,MAAMC,KAAI,SAAAC,GAAO,OAAIA,EAAQC,QAAMC,QAAO,SAACF,GAAD,OAAaA,EAAQG,eAAiB,KAE3GN,EAASO,QACTb,EAAa,kBAAC,aAAD,CAAYc,UAAU,oBAC/B,kBAAC,kBAAD,CAAiBC,MAAM,uBACvB,kBAAC,IAAD,OAEJhB,EAAcO,EAASE,KACnB,SAACC,EAASO,GAAV,OACI,kBAAC,IAAD,CAAUC,GAAI,GAAIC,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAGC,IAAKL,GACzC,kBAAC,IAAD,CACIK,IAAKL,EACLP,QAASA,UAKzBT,EAAa,kBAAC,aAAD,CAAYsB,MAAO,CAAEC,cAAe,KAAM,kBAAC,kBAAD,CAAiBR,MAAM,gBAC9EhB,EAAc,kBAAC,uBAAD,CAAsBgB,MAAO,4BACvCS,WAAY,kBAAC,IAAD,CAAcC,eAAgB,WAAQC,SAASC,eAKvE,OAAO,kBAAC,IAAD,CAAoBC,YAAc,CAAExB,QAAOD,OAAME,YACpD,kBAAC,IAAD,CAAewB,SAAS,WACpB,kBAAC,aAAD,KACI,kBAAC,kBAAD,CAAiBd,MAAM,gBAE3B,kBAAC,OAAD,KACI,yBAAKD,UAAU,mBACX,kBAAC,IAAD,CAAMgB,OAAO,MACT,kBAAC,IAAD,UAKhB,kBAAC,IAAD,CAAeD,SAAS,QAClB7B,EACF,kBAAC,OAAD,KACI,yBAAKc,UAAU,mBACX,kBAAC,IAAD,CAAMgB,OAAO,MACP/B,QAQXgC,cAAajC","file":"js/Reports.js","sourcesContent":["import React from 'react';\nimport {\n    ReportTabs,\n    LoadingComplianceCards,\n    ReportCard,\n    StateViewWithError,\n    StateViewPart\n} from 'PresentationalComponents';\nimport { CreatePolicy } from 'SmartComponents';\nimport { ComplianceEmptyState } from '@redhat-cloud-services/frontend-components-inventory-compliance';\nimport { PageHeader, PageHeaderTitle, Main } from '@redhat-cloud-services/frontend-components';\nimport routerParams from '@redhat-cloud-services/frontend-components-utilities/files/RouterParams';\nimport { useQuery } from '@apollo/react-hooks';\nimport gql from 'graphql-tag';\nimport {\n    Grid,\n    GridItem\n} from '@patternfly/react-core';\n\nconst QUERY = gql`\n{\n    profiles(search: \"has_test_results = true\", limit: 1000){\n        edges {\n            node {\n                id\n                name\n                refId\n                description\n                totalHostCount\n                compliantHostCount\n                majorOsVersion\n                complianceThreshold\n                businessObjective {\n                    id\n                    title\n                }\n                policy {\n                    id\n                    benchmark {\n                        id\n                        version\n                    }\n                }\n                benchmark {\n                    id\n                    version\n                }\n            }\n        }\n\n    }\n}\n`;\n\nexport const Reports = () => {\n    const { data, error, loading } = useQuery(QUERY, { fetchPolicy: 'cache-and-network' });\n    let reportCards;\n    let pageHeader;\n\n    if (!loading && data) {\n        const profiles = data.profiles.edges.map(profile => profile.node).filter((profile) => profile.totalHostCount > 0);\n\n        if (profiles.length) {\n            pageHeader = <PageHeader className='page-header-tabs'>\n                <PageHeaderTitle title=\"Compliance reports\" />\n                <ReportTabs/>\n            </PageHeader>;\n            reportCards = profiles.map(\n                (profile, i) =>\n                    <GridItem sm={12} md={12} lg={6} xl={4} key={i}>\n                        <ReportCard\n                            key={i}\n                            profile={profile}\n                        />\n                    </GridItem>\n            );\n        } else {\n            pageHeader = <PageHeader style={{ paddingBottom: 22 }}><PageHeaderTitle title=\"Compliance\" /></PageHeader>;\n            reportCards = <ComplianceEmptyState title={'No policies are reporting'}\n                mainButton={<CreatePolicy onWizardFinish={() => { location.reload(); }} />}\n            />;\n        }\n    }\n\n    return <StateViewWithError stateValues={ { error, data, loading } }>\n        <StateViewPart stateKey='loading'>\n            <PageHeader>\n                <PageHeaderTitle title=\"Compliance\" />\n            </PageHeader>\n            <Main>\n                <div className=\"policies-donuts\">\n                    <Grid gutter='md'>\n                        <LoadingComplianceCards/>\n                    </Grid>\n                </div>\n            </Main>\n        </StateViewPart>\n        <StateViewPart stateKey='data'>\n            { pageHeader }\n            <Main>\n                <div className=\"policies-donuts\">\n                    <Grid gutter='md'>\n                        { reportCards }\n                    </Grid>\n                </div>\n            </Main>\n        </StateViewPart>\n    </StateViewWithError>;\n};\n\nexport default routerParams(Reports);\n"],"sourceRoot":""}