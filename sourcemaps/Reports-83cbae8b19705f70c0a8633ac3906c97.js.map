{"version":3,"sources":["webpack:///./src/SmartComponents/Reports/Reports.js","webpack:///./node_modules/@redhat-cloud-services/frontend-components/components/cjs/Skeleton.js","webpack:///./src/Utilities/hooks/useFeature.js","webpack:///./node_modules/@redhat-cloud-services/frontend-components/components/cjs/SkeletonTable.js"],"names":["QUERY","gql","LoadingView","showTableView","colSize","rowSize","propTypes","bool","ReportsHeader","title","Reports","profiles","showView","location","useLocation","useQuery","data","error","loading","refetch","useFeature","View","ReportsTable","ReportCardGrid","useEffect","undefined","edges","map","profile","node","filter","totalHostCount","profilesFromEdges","length","stateValues","stateKey","_interopDefault","e","default","Object","defineProperty","exports","value","_extends","objectWithoutProperties","React__default","PropTypes__default","classNames","SkeletonSize","xs","sm","md","lg","Skeleton","t","size","s","isDark","r","className","o","_objectWithoutProperties","a","concat","_defineProperty","createElement","string","oneOf","values","defaultProps","setFeatureFlag","featureValue","feature","console","log","localStorage","setItem","removeItem","featureDefault","features","search","path","history","pathName","useHistory","URLSearchParams","forEach","push","featureEnabled","getItem","getLocatStateFlag","toConsumableArray","getPrototypeOf","reactTable","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","prototype","toString","call","SkeletonTable","_inherits","_getPrototypeOf","this","constructor","arguments","apply","_possibleConstructorReturn","_createSuper","_classCallCheck","Array","n","_assertThisInitialized","props","_toConsumableArray","paddingColumnSize","columns","newArray","createColumns","l","cells","_createClass","key","Table","getColumns","rows","createRows","sortBy","TableHeader","TableBody","Component","number","array","shape","index","direction"],"mappings":"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","file":"js/Reports-629948f4d935ecf8aed4.js","sourcesContent":["import React, { useEffect } from 'react';\nimport propTypes from 'prop-types';\nimport { useLocation } from 'react-router-dom';\nimport { useQuery } from '@apollo/react-hooks';\nimport gql from 'graphql-tag';\nimport { PageHeader, PageHeaderTitle, Main, SkeletonTable } from '@redhat-cloud-services/frontend-components';\nimport {\n    ReportCardGrid, ReportsTable, StateViewPart, StateViewWithError, ReportsEmptyState, LoadingComplianceCards\n} from 'PresentationalComponents';\nimport useFeature from 'Utilities/hooks/useFeature';\n\nconst QUERY = gql`\n{\n    profiles(search: \"has_test_results = true\", limit: 1000){\n        edges {\n            node {\n                id\n                name\n                refId\n                description\n                totalHostCount\n                compliantHostCount\n                majorOsVersion\n                complianceThreshold\n                businessObjective {\n                    id\n                    title\n                }\n                policy {\n                    id\n                    name\n                    benchmark {\n                        id\n                        version\n                    }\n                }\n                benchmark {\n                    id\n                    version\n                }\n            }\n        }\n\n    }\n}\n`;\n\nconst profilesFromEdges = (data) => (\n    (data?.profiles?.edges || []).map((profile) => (\n        profile.node\n    )).filter((profile) => (\n        profile.totalHostCount > 0\n    ))\n);\n\nconst LoadingView = ({ showTableView }) => (\n    showTableView ? <SkeletonTable colSize={ 3 } rowSize={ 10 } /> : <LoadingComplianceCards />\n);\n\nLoadingView.propTypes = {\n    showTableView: propTypes.bool\n};\n\nconst ReportsHeader = () => (\n    <PageHeader>\n        <PageHeaderTitle title=\"Reports\" />\n    </PageHeader>\n);\n\nexport const Reports = () => {\n    let profiles = [];\n    let showView = false;\n    const location = useLocation();\n    let { data, error, loading, refetch } = useQuery(QUERY);\n    const showTableView = useFeature('reportsTableView');\n    const View = showTableView ? ReportsTable : ReportCardGrid;\n\n    useEffect(() => {\n        refetch();\n    }, [location]);\n\n    if (data) {\n        profiles = profilesFromEdges(data);\n        error = undefined;\n        loading = undefined;\n        showView = profiles && profiles.length > 0;\n    }\n\n    return <StateViewWithError stateValues={ { error, data, loading } }>\n        <StateViewPart stateKey='loading'>\n            <ReportsHeader />\n            <Main>\n                <LoadingView { ...{ showTableView } } />\n            </Main>\n        </StateViewPart>\n        <StateViewPart stateKey='data'>\n            <ReportsHeader />\n            <Main>\n                { showView ? <View { ...{ profiles } } /> : <ReportsEmptyState /> }\n            </Main>\n        </StateViewPart>\n    </StateViewWithError>;\n};\n\nexport default Reports;\n","\"use strict\";function _interopDefault(e){return e&&\"object\"==typeof e&&\"default\"in e?e.default:e}Object.defineProperty(exports,\"__esModule\",{value:!0}),require(\"./_commonjsHelpers-32c5d30b.js\");var _extends=require(\"./extends-7fa7e501.js\"),defineProperty=require(\"./defineProperty-cf06dcaa.js\"),objectWithoutProperties=require(\"./objectWithoutProperties-9e2b4e81.js\"),React=require(\"react\"),React__default=_interopDefault(React),PropTypes=require(\"prop-types\"),PropTypes__default=_interopDefault(PropTypes),classNames=_interopDefault(require(\"classnames\")),SkeletonSize={xs:\"xs\",sm:\"sm\",md:\"md\",lg:\"lg\"},Skeleton=function Skeleton(e){var t=e.size,s=e.isDark,r=e.className,o=objectWithoutProperties._objectWithoutProperties(e,[\"size\",\"isDark\",\"className\"]),a=classNames(\"ins-c-skeleton\",\"ins-c-skeleton__\".concat(t),defineProperty._defineProperty({},\"ins-m-dark\",s),r);return React__default.createElement(\"div\",_extends._extends({className:a},o),\" \")};Skeleton.propTypes={className:PropTypes__default.string,size:PropTypes__default.oneOf(Object.values(SkeletonSize)),isDark:PropTypes__default.bool},Skeleton.defaultProps={size:SkeletonSize.md,isDark:!1},exports.Skeleton=Skeleton,exports.SkeletonSize=SkeletonSize;\n","import { features } from '@/constants';\nimport { useLocation, useHistory } from 'react-router-dom';\nconst LOCAL_STORE_FEATURE_PREFIX = 'insights:compliance';\n\nconst setFeatureFlag = (featureValue, feature) => {\n    const value = featureValue === 'enable';\n\n    if (!value) {\n        console.log(`Removing feature setting of ${feature}`);\n        localStorage.removeItem(`${LOCAL_STORE_FEATURE_PREFIX}:${feature}`);\n    } else {\n        console.log(`Setting feature value for ${feature} to ${value}`);\n        localStorage.setItem(`${LOCAL_STORE_FEATURE_PREFIX}:${feature}`, value);\n    }\n};\n\n// Allows setting feature flag values via ?feature|(enable/disable)\nconst setFlagsFromUrl = () => {\n    const { search, pathName: path } = useLocation();\n    const history = useHistory();\n    if (!search) {\n        return;\n    }\n\n    const urlParams = new URLSearchParams(search);\n    urlParams.forEach(setFeatureFlag);\n\n    history.push(path);\n};\n\n// Queries the local storage for feature flag values\nconst getLocatStateFlag = (feature) => (\n    localStorage.getItem(`${LOCAL_STORE_FEATURE_PREFIX}:${feature}`)\n);\n\n// A hook to query feature values\nconst useFeature = (feature) => {\n    const featureDefault = features[feature];\n    if (!feature) {\n        return;\n    }\n\n    setFlagsFromUrl();\n\n    const localStoreValue = getLocatStateFlag(feature);\n    const featureEnabled = localStoreValue || featureDefault;\n\n    console.log(`Feature ${feature} is set to ${featureEnabled}`);\n    return featureEnabled;\n};\n\nexport default useFeature;\n\n","\"use strict\";function _interopDefault(e){return e&&\"object\"==typeof e&&\"default\"in e?e.default:e}Object.defineProperty(exports,\"__esModule\",{value:!0}),require(\"./_commonjsHelpers-32c5d30b.js\"),require(\"./extends-7fa7e501.js\");var defineProperty=require(\"./defineProperty-cf06dcaa.js\");require(\"./objectWithoutProperties-9e2b4e81.js\");var React=require(\"react\"),React__default=_interopDefault(React),PropTypes=require(\"prop-types\"),PropTypes__default=_interopDefault(PropTypes);require(\"classnames\");var toConsumableArray=require(\"./toConsumableArray-8bfc60c2.js\"),getPrototypeOf=require(\"./getPrototypeOf-c749744b.js\"),reactTable=require(\"@patternfly/react-table\"),Skeleton=require(\"./Skeleton.js\");function _createSuper(e){return function(){var t,r=getPrototypeOf._getPrototypeOf(e);if(_isNativeReflectConstruct()){var o=getPrototypeOf._getPrototypeOf(this).constructor;t=Reflect.construct(r,arguments,o)}else t=r.apply(this,arguments);return getPrototypeOf._possibleConstructorReturn(this,t)}}function _isNativeReflectConstruct(){if(\"undefined\"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var SkeletonTable=function(e){getPrototypeOf._inherits(SkeletonTable,e);var t=_createSuper(SkeletonTable);function SkeletonTable(){var e;getPrototypeOf._classCallCheck(this,SkeletonTable);for(var r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];return e=t.call.apply(t,[this].concat(o)),defineProperty._defineProperty(getPrototypeOf._assertThisInitialized(e),\"createColumns\",(function(){var t=e.props.colSize;return toConsumableArray._toConsumableArray(Array(t)).map((function(){return{title:React__default.createElement(Skeleton.Skeleton,{size:Skeleton.SkeletonSize.sm})}}))})),defineProperty._defineProperty(getPrototypeOf._assertThisInitialized(e),\"getColumns\",(function(){var t=e.props,r=t.paddingColumnSize,o=t.columns;return e.newArray(r).map((function(){return\"\"})).concat(o||e.createColumns())})),defineProperty._defineProperty(getPrototypeOf._assertThisInitialized(e),\"createRows\",(function(){var t=e.props,r=t.colSize,o=t.rowSize,n=t.columns,a=t.paddingColumnSize,l=n?n.length:r;return e.newArray(o).map((function(){return{cells:e.newArray(a).map((function(){return\"\"})).concat(e.newArray(l).map((function(){return{title:React__default.createElement(Skeleton.Skeleton,{size:Skeleton.SkeletonSize.md})}})))}}))})),defineProperty._defineProperty(getPrototypeOf._assertThisInitialized(e),\"newArray\",(function(e){return toConsumableArray._toConsumableArray(Array(e))})),e}return getPrototypeOf._createClass(SkeletonTable,[{key:\"render\",value:function render(){return React__default.createElement(reactTable.Table,{cells:this.getColumns(),rows:this.createRows(),sortBy:this.props.sortBy,\"aria-label\":\"Loading\"},React__default.createElement(reactTable.TableHeader,null),React__default.createElement(reactTable.TableBody,null))}}]),SkeletonTable}(React__default.Component);SkeletonTable.propTypes={colSize:PropTypes__default.number,rowSize:PropTypes__default.number,columns:PropTypes__default.array,paddingColumnSize:PropTypes__default.number,sortBy:PropTypes__default.shape({index:PropTypes__default.number,direction:PropTypes__default.oneOf([\"asc\",\"desc\"])})},SkeletonTable.defaultProps={rowSize:0,paddingColumnSize:0},exports.SkeletonTable=SkeletonTable;\n"],"sourceRoot":""}