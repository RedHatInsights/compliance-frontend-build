{"version":3,"sources":["webpack:///./src/SmartComponents/ReportDetails/ReportDetails.scss?1b44","webpack:///./src/SmartComponents/ReportDetails/ReportDetails.scss","webpack:///./src/SmartComponents/ReportDetails/ReportDetails.js","webpack:///./src/Utilities/hooks/useFeature.js","webpack:///./node_modules/@patternfly/react-core/dist/js/components/Breadcrumb/Breadcrumb.js"],"names":["content","module","i","options","transform","undefined","locals","exports","___CSS_LOADER_API_IMPORT___","push","QUERY","gql","ReportDetails","showSsgVersions","policyName","legendData","compliancePercentage","showSsgVersionsFeature","useFeature","policyId","useParams","report_id","useQuery","variables","data","error","loading","donutValues","donutId","profile","policy","name","compliantHostCount","totalHostCount","replace","x","y","pluralize","fixedPercentage","Math","floor","columns","key","title","props","width","stateValues","stateKey","to","isActive","hasGutter","sm","md","lg","xl","className","state","id","variant","isInline","identifier","subTitle","themeColor","ChartThemeColor","blue","themeVariant","ChartThemeVariant","light","style","fontSize","innerRadius","legendPosition","legendOrientation","padding","bottom","left","right","top","span","showOnlySystemsWithTestResults","compliantFilter","setFeatureFlag","featureValue","feature","value","console","log","localStorage","setItem","removeItem","featureDefault","features","search","path","history","useLocation","pathName","useHistory","URLSearchParams","forEach","featureEnabled","getItem","getLocatStateFlag","Object","defineProperty","tslib_1","React","__importStar","breadcrumb_1","__importDefault","react_styles_1","helpers_1","Breadcrumb","_a","children","ariaLabel","ouiaId","ouiaSafe","__rest","createElement","assign","css","default","breadcrumb","getOUIAProps","displayName","breadcrumbList","Children","map","child","index","showDivider","isValidElement","cloneElement"],"mappings":"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","file":"js/ReportDetails-d832efa91f48376dba9c.js","sourcesContent":["\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??ref--5-2!./ReportDetails.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??ref--5-2!./ReportDetails.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??ref--5-2!./ReportDetails.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".threshold-tooltip{margin-bottom:var(--pf-global--spacer--md)}.grey-icon{color:var(--pf-global--Color--200)}.policy-details{padding-top:10px}.report-details-button{text-align:right}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import React from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport { useQuery } from '@apollo/react-hooks';\nimport gql from 'graphql-tag';\n\nimport { ChartDonut, ChartThemeColor, ChartThemeVariant } from '@patternfly/react-charts';\nimport { Breadcrumb, BreadcrumbItem, Button, Grid, GridItem } from '@patternfly/react-core';\n\nimport {\n    PageHeader, PageHeaderTitle, Main, EmptyTable, Spinner\n} from '@redhat-cloud-services/frontend-components';\n\nimport { fixedPercentage, pluralize } from 'Utilities/TextHelper';\nimport useFeature from 'Utilities/hooks/useFeature';\nimport {\n    BackgroundLink, BreadcrumbLinkItem, ReportDetailsContentLoader, ReportDetailsDescription,\n    StateViewWithError, StateViewPart\n} from 'PresentationalComponents';\nimport { SystemsTable } from 'SmartComponents';\n\nimport '@/Charts.scss';\nimport './ReportDetails.scss';\n\nexport const QUERY = gql`\nquery Profile($policyId: String!){\n    profile(id: $policyId) {\n        id\n        name\n        refId\n        totalHostCount\n        compliantHostCount\n        complianceThreshold\n        majorOsVersion\n        lastScanned\n        policy {\n            id\n            name\n        }\n        benchmark {\n            id\n            version\n        }\n        businessObjective {\n            id\n            title\n        }\n    }\n}\n`;\n\nexport const ReportDetails = () => {\n    let showSsgVersions;\n    let showSsgVersionsFeature = useFeature('showSsgVersions');\n    const { report_id: policyId } = useParams();\n    const { data, error, loading } = useQuery(QUERY, {\n        variables: { policyId }\n    });\n    let donutValues = [];\n    let donutId = 'loading-donut';\n    let profile = {};\n    let policyName;\n    let legendData;\n    let compliancePercentage;\n\n    if (!loading && data) {\n        profile = data.profile;\n        policyName = profile.policy ? profile.policy.name : profile.name;\n        showSsgVersions = !!profile?.policy && showSsgVersionsFeature;\n        const compliantHostCount = profile.compliantHostCount;\n        const totalHostCount = profile.totalHostCount;\n        donutId = profile.name.replace(/ /g, '');\n        donutValues = [\n            { x: 'Compliant', y: compliantHostCount },\n            { x: 'Non-compliant', y: totalHostCount - compliantHostCount }\n        ];\n        legendData = [\n            { name: donutValues[0].y + ' ' + pluralize(donutValues[0].y, 'system') + ' compliant' },\n            { name: donutValues[1].y + ' ' + pluralize(donutValues[1].y, 'system') + ' non-compliant' }\n        ];\n        compliancePercentage = fixedPercentage(Math.floor(100 *\n                (donutValues[0].y / (donutValues[0].y + donutValues[1].y))));\n    }\n\n    const columns = [{\n        key: 'facts.compliance.display_name',\n        title: 'System name',\n        props: {\n            width: 30\n        }\n    }, {\n        key: 'facts.compliance.rules_failed',\n        title: 'Rules failed',\n        props: {\n            width: 5\n        }\n    }, ...showSsgVersions ? [{\n        key: 'facts.compliance.ssg_version',\n        title: 'SSG version',\n        props: {\n            width: 5\n        }\n    }] : [], {\n        key: 'facts.compliance.compliance_score',\n        title: 'Compliance score',\n        props: {\n            width: 5\n        }\n    }, {\n        key: 'facts.compliance.last_scanned',\n        title: 'Last scanned',\n        props: {\n            width: 10\n        }\n    }];\n\n    return <StateViewWithError stateValues={ { error, data, loading } }>\n        <StateViewPart stateKey='loading'>\n            <PageHeader><ReportDetailsContentLoader/></PageHeader>\n            <Main><EmptyTable><Spinner/></EmptyTable></Main>\n        </StateViewPart>\n        <StateViewPart stateKey='data'>\n            <PageHeader>\n                <Breadcrumb>\n                    <BreadcrumbLinkItem to='/reports'>\n                        Reports\n                    </BreadcrumbLinkItem>\n                    <BreadcrumbItem isActive>{policyName}</BreadcrumbItem>\n                </Breadcrumb>\n                <Grid hasGutter>\n                    <GridItem sm={9} md={9} lg={9} xl={9}>\n                        <PageHeaderTitle title={policyName + ' report'} />\n                    </GridItem>\n                    <GridItem className='report-details-button' sm={3} md={3} lg={3} xl={3}>\n                        <BackgroundLink\n                            state={ { profile } }\n                            to={ `/reports/${ profile.id }/delete` }>\n                            <Button variant='link' isInline>Delete report</Button>\n                        </BackgroundLink>\n                    </GridItem>\n                </Grid>\n                <Grid hasGutter>\n                    <GridItem sm={12} md={12} lg={12} xl={6}>\n                        <div className='chart-inline'>\n                            <div className='chart-container'>\n                                <ChartDonut data={donutValues}\n                                    identifier={donutId}\n                                    title={compliancePercentage}\n                                    subTitle=\"Compliant\"\n                                    themeColor={ChartThemeColor.blue}\n                                    themeVariant={ChartThemeVariant.light}\n                                    style={{ fontSize: 20 }}\n                                    innerRadius={88}\n                                    width={462}\n                                    legendPosition='right'\n                                    legendData={legendData}\n                                    legendOrientation='vertical'\n                                    padding={{\n                                        bottom: 20,\n                                        left: 0,\n                                        right: 250,\n                                        top: 20\n                                    }}\n                                />\n                            </div>\n                        </div>\n                    </GridItem>\n                    <GridItem sm={12} md={12} lg={12} xl={6}>\n                        <ReportDetailsDescription profile={profile} />\n                    </GridItem>\n                </Grid>\n            </PageHeader>\n            <Main>\n                <Grid hasGutter>\n                    <GridItem span={12}>\n                        <SystemsTable\n                            showOnlySystemsWithTestResults\n                            compliantFilter\n                            policyId={profile.id}\n                            columns={columns} />\n                    </GridItem>\n                </Grid>\n            </Main>\n        </StateViewPart>\n    </StateViewWithError>;\n};\n\nexport default ReportDetails;\n","import { features } from '@/constants';\nimport { useLocation, useHistory } from 'react-router-dom';\nconst LOCAL_STORE_FEATURE_PREFIX = 'insights:compliance';\n\nconst setFeatureFlag = (featureValue, feature) => {\n    const value = featureValue === 'enable';\n\n    if (!value) {\n        console.log(`Removing feature setting of ${feature}`);\n        localStorage.removeItem(`${LOCAL_STORE_FEATURE_PREFIX}:${feature}`);\n    } else {\n        console.log(`Setting feature value for ${feature} to ${value}`);\n        localStorage.setItem(`${LOCAL_STORE_FEATURE_PREFIX}:${feature}`, value);\n    }\n};\n\n// Allows setting feature flag values via ?feature|(enable/disable)\nconst setFlagsFromUrl = () => {\n    const { search, pathName: path } = useLocation();\n    const history = useHistory();\n    if (!search) {\n        return;\n    }\n\n    const urlParams = new URLSearchParams(search);\n    urlParams.forEach(setFeatureFlag);\n\n    history.push(path);\n};\n\n// Queries the local storage for feature flag values\nconst getLocatStateFlag = (feature) => (\n    !!localStorage.getItem(`${LOCAL_STORE_FEATURE_PREFIX}:${feature}`)\n);\n\n// A hook to query feature values\nconst useFeature = (feature) => {\n    const featureDefault = features[feature];\n    if (!feature) {\n        return;\n    }\n\n    setFlagsFromUrl();\n\n    const localStoreValue = getLocatStateFlag(feature);\n    const featureEnabled = localStoreValue || featureDefault;\n\n    console.log(`Feature ${feature} is set to ${featureEnabled}`);\n    return featureEnabled;\n};\n\nexport default useFeature;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\nconst React = tslib_1.__importStar(require(\"react\"));\nconst breadcrumb_1 = tslib_1.__importDefault(require(\"@patternfly/react-styles/css/components/Breadcrumb/breadcrumb\"));\nconst react_styles_1 = require(\"@patternfly/react-styles\");\nconst helpers_1 = require(\"../../helpers\");\nexports.Breadcrumb = (_a) => {\n    var { children = null, className = '', 'aria-label': ariaLabel = 'Breadcrumb', ouiaId, ouiaSafe = true } = _a, props = tslib_1.__rest(_a, [\"children\", \"className\", 'aria-label', \"ouiaId\", \"ouiaSafe\"]);\n    return (React.createElement(\"nav\", Object.assign({}, props, { \"aria-label\": ariaLabel, className: react_styles_1.css(breadcrumb_1.default.breadcrumb, className) }, helpers_1.getOUIAProps(exports.Breadcrumb.displayName, ouiaId, ouiaSafe)),\n        React.createElement(\"ol\", { className: breadcrumb_1.default.breadcrumbList }, React.Children.map(children, (child, index) => {\n            const showDivider = index > 0;\n            if (React.isValidElement(child)) {\n                return React.cloneElement(child, { showDivider });\n            }\n            return child;\n        }))));\n};\nexports.Breadcrumb.displayName = 'Breadcrumb';\n//# sourceMappingURL=Breadcrumb.js.map"],"sourceRoot":""}